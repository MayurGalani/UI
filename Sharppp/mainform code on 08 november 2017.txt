using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Drawing.Imaging;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;
using iTextSharp.text;
using iTextSharp.text.pdf;
using System.Net;
using System.Net.Mail;
using System.Diagnostics;
using System.Data.SQLite;
using System.Media;
//test tfs
//using System.Data.SqlClient;
//using Microsoft.SqlServer.Management.Common;
//using Microsoft.SqlServer.Management.Smo;
using System.Data.OleDb;
using System.Globalization;
using System.Reflection;
//using System.Web.Mail;
using Excel = Microsoft.Office.Interop.Excel;
using Zen.Barcode;



namespace SHARP_ACCOUNTING
{
    public partial class MainForm : Form
    {
        #region variables

        bool bstdcode = true;
        bool new_sale_invoice = true;
        bool new_purc_invoice = true;
        bool sale_invoice_saved = false;
        bool purchase_invoice_saved = false;
        bool add_header_footer = true;
        bool require_header_footer = true;
        bool shade_pdf_line = true;
        public OleDbConnection VoterConn;
        public OleDbCommand oleDbCmd = new OleDbCommand();
        public OleDbDataAdapter adapter;
        public DataSet ds = new DataSet();

        List<string> list_of_emerg_data = new List<string>();
        List<string> list_of_temporary_emerg_data = new List<string>();
        List<string> temp_temp_emerg_data = new List<string>();
        List<string> item_details_from_05 = new List<string>();
        List<int> lstTableWidth = new List<int>();
        List<string> item_stock = new List<string>();
        List<string> item_sale_list = new List<string>();
        List<string> item_purchase_list = new List<string>();
        List<string> invoice_item_list = new List<string>();
        List<string> temporary_list_array = new List<string>();
        List<string> period_array = new List<string>();
        List<string> list_of_period_array = new List<string>();
        List<string> list_of_balance_amount = new List<string>();
        List<string> State_gst_code = new List<string>();
        List<string> gst_csv_list = new List<string>();
        List<string> gst_tax_brief_sale_list_array = new List<string>();
        List<string> gst_csv_list_b2b = new List<string>();
        List<string> gst_csv_list_b2cs = new List<string>();
        List<string> temporary_list_1 = new List<string>();
        List<string> temporary_list_2 = new List<string>();
        List<string> temporary_list_3 = new List<string>();

        public static List<string> account_detail_from_01 = new List<string>();
        public static List<string> account_detail_from_04 = new List<string>();

        OleDbConnection conn = new OleDbConnection();
        DataTable dtStdCodes = new DataTable();

        DataTable dtSearchResults = null;
        string temp_prd, temp_a_n, temp_s_a, strExcelFileName, old_gstnumber, qr_image_details, qr_filename;
        double bp_total_basic_amt, bp_gross_amt, total_double, old_cash_received_against_sale_invoice;
        int temp_d_n, temp_d_c, current_pdf_page_number = 1;
        List<string> gst_amount_list = new List<string>();
        double gst_debit_credit_amount, gst_last_month_credit_debit_amount;
        string temp_gst_json_full_details, temp_gst_company_details, temp_gst_b2b_details, temp_gst_tax_details, temp_gst_invoice_details, temp_gst_number_details;
        double total_value, total_taxable_value, total_integerated_tax, total_central_tax, total_state_ut_tax, total_cess, total_number, total_cancelled;
        string encoded, decoded, stdisd_filename, exe_filename, setup_filename;
        string new_word, record_number, old_purchase_invoice_number = "", mbook;
        double si_cgst_tax_amount, si_sgst_tax_amount, si_igst_tax_amount, si_cgst_tax_per, si_sgst_tax_per, si_igst_tax_per, si_gst_item_basic_amount;
        double si_cgst_total_tax_amount, si_sgst_total_tax_amount, si_igst_total_tax_amount, si_gst_item_total_basic_amount;
        double pi_cgst_tax_amount, pi_sgst_tax_amount, pi_igst_tax_amount, pi_cgst_tax_per, pi_sgst_tax_per, pi_igst_tax_per, pi_gst_item_basic_amount;
        double pi_cgst_total_tax_amount, pi_sgst_total_tax_amount, pi_igst_total_tax_amount, pi_gst_item_total_basic_amount;
        string file_folder, strImageFileName, strScanImageModule, img_prefix;
        string text_to_display_on_top;
        public static string current_working_tab, scan_image_type, words, software_for, function_working;
        public static string access_line1, access_line2, access_line3, access_line4, access_line5;
        public static int total_sms_count;
        bool bLoadUserSettingsInitial = false;
        bool periodofgst = false;
        Control cntObject;
        public static string[] reload_from_file;
        //public static string[] field_name;
        string[] stdisd_array;
        public static string[] data_in_record;
        public static string[] cellArray;
        public static string[] temporary_datagridview_data;
        //public static string[] tax_array_for_sale_purchase;
        public static string[] temporary_array;
        //public static string[] company_details;
        public static string[] balance_amount;
        public static string[] party_name;
        public static string[] item_name;
        public static string[] sale_purchase_party;
        public static string[] sale_purchase_item;
        public static string emailfrom, emailto, emailSubject, emailmessage, emailAttachmentPath, emailpassword, font_name, font_size, header_text_message;
        public static string text_for_sms, myExeDir;
        PdfWriter writer;
        Document doc1;
        string mdrive = "", version;
        //string mfound = "";
        int date_int, month_int, year_int, mpacking, temp_amt;
        string sqlite_filename, bank_filename;
        string m_new_nik, working_journal_payer_payee;
        string mtbname = "", selectedpartyname, selectedpartycity, selectedcitylist, selectedtaxlist, search_account_name, image_filename;
        string fieldnamedata, pdf_top_heading, where_selected_query, emerg_prd, emerg_oprd, emerg_nprd;
        string report_filename, report_filetype, csv_filename;
        string temp_word, temp_word1, temp_word2, mfound, multiple_choice;
        string start_period, end_period, temp_start_period, temp_end_period;
        int temp_int, temp_int2, total_line_length, isRecord, packing, temp_count, lineno, actual_line_number_of_page;
        long temp_long;
        double basicamount, taxamount, grossamount, cessamount, tax_rate;
        double old_sale_invoice_amount, old_sale_replace_amount, old_purchase_invoice_amount, old_bank_receipt_amount, old_bank_payment_amount, old_bank_deposit_amount, old_bank_withdrawal_amount, old_bank_transfer_amount, old_cash_receipt_amount, old_cash_payment_amount, old_journal_amount;
        double old_bank_balance, old_cash_balance, bank_balance, cash_balance;
        float temp_float;
        double temp_double, temp_double2, mold_amount;
        DateTime temp_datetime, prd_start_date, prd_end_date;
        DateTime first_date, last_date;
        string start_date, end_date;
        public static int column_pointer, row_pointer, row_pointer2, row_counter, column_counter, array_counter1, array_counter2, array_counter3;
        public static int asc_value;
        public static double si_invoice_basic_amount, si_invoice_tax_amount, si_invoice_gross_amount;
        public static double pi_invoice_basic_amount, pi_invoice_tax_amount, pi_invoice_gross_amount;
        public static double debitamount, creditamount, balanceamt;
        ConnectionWithAccess ConnectionCommand = new ConnectionWithAccess();
        string xmouse_point, ymouse_point;
        string madd1, madd2, madd3, mcity, mpincode, mtin, mtpt, memail, mstd, mwebsite, mgst_number;
        long momobile, mphone1, mphone12, mphone2, mphone22, mfax;
        string ledger_filename, trading_filename;
        //string mtxcode, ntxcode;
        public static int mUserFeaturesLength;
        int mRowIndex, monthDiff, isExists;
        public static string mtype = "", mitem_code = "", mtitle = "", mtx_code = "", mtx_desc = "", excel_filename, notepad_filename, pdf_filename;
        public static int columnIndex;
        public static int rowIndex, siitemlistrowindex, piitemlistrowindex, sritemlistrowindex, soitemlistrowindex;
        public static double mcase, mbox, mqty, mprice, mamount, sale_invoice_amount, sale_replace_amount, sale_order_amount, purchase_invoice_amount, mtx_rate;
        public static double sale_replacement_amount, purchase_replacement_amount;
        public static string mtext, pdf_top_heading_text;
        string update_database_text_filename;
        string word, file_number, cheque_pdf;
        string msalepdf;
        public static string[] report_columns_size;
        public static string[] report_columns_name;
        public static string[] report_column_header;
        public static string[] report_column_type;
        public static string[] field_name;
        string data_type;
        public static string party_add1, party_add2, party_add3, party_city, party_bst, party_bst_dt, party_cst, party_cst_dt, party_tin_num;
        public static string invoice_jpg_filename, barcode_filename;
        iTextSharp.text.Font arabic_14 = FontFactory.GetFont("Simplified Arabic", 14);
        iTextSharp.text.Font arabic_14_red = FontFactory.GetFont("Simplified Arabic", 14, BaseColor.RED);
        iTextSharp.text.Font cour_7 = FontFactory.GetFont("Courier New", 7);
        iTextSharp.text.Font cour_7_red = FontFactory.GetFont("Courier New", 7, BaseColor.RED);
        iTextSharp.text.Font cour_7_bold = FontFactory.GetFont("Courier New", 7, iTextSharp.text.Font.BOLD);
        iTextSharp.text.Font cour_9 = FontFactory.GetFont("Courier New", 9);
        iTextSharp.text.Font cour_9_red = FontFactory.GetFont("Courier New", 9, BaseColor.RED);
        iTextSharp.text.Font cour_9_bold = FontFactory.GetFont("Courier New", 9, iTextSharp.text.Font.BOLD);
        iTextSharp.text.Font cour_10 = FontFactory.GetFont("Courier New", 10);
        iTextSharp.text.Font cour_11 = FontFactory.GetFont("Courier New", 11);
        iTextSharp.text.Font cour_11_red = FontFactory.GetFont("Courier New", 11, BaseColor.RED);
        iTextSharp.text.Font cour_11_bold = FontFactory.GetFont("Courier New", 11, iTextSharp.text.Font.BOLD);
        iTextSharp.text.Font cour_11_bold_red = FontFactory.GetFont("Courier New", 11, iTextSharp.text.Font.BOLD, BaseColor.RED);
        iTextSharp.text.Font cour_15 = FontFactory.GetFont("Courier New", 15);
        iTextSharp.text.Font cour_15_red = FontFactory.GetFont("Courier New", 15, BaseColor.RED);
        iTextSharp.text.Font cour_15_bold = FontFactory.GetFont("Courier New", 15, iTextSharp.text.Font.BOLD);
        iTextSharp.text.Font cour_20 = FontFactory.GetFont("Courier New", 20);
        iTextSharp.text.Font cour_20_red = FontFactory.GetFont("Courier New", 20, BaseColor.RED);
        iTextSharp.text.Font cour_24_red = FontFactory.GetFont("Courier New", 24, BaseColor.RED);
        iTextSharp.text.Font cour_27_red = FontFactory.GetFont("Courier New", 27, BaseColor.RED);

        static BaseFont ARIAL = iTextSharp.text.pdf.BaseFont.CreateFont("C:\\WINDOWS\\Fonts\\ARIAL.TTF", BaseFont.IDENTITY_H, BaseFont.EMBEDDED); // --> CHANGED
        iTextSharp.text.Font arial_12 = new iTextSharp.text.Font(ARIAL, 12, iTextSharp.text.Font.NORMAL);
        iTextSharp.text.Font arial_15 = new iTextSharp.text.Font(ARIAL, 15, iTextSharp.text.Font.NORMAL);
        iTextSharp.text.Font arial_20 = new iTextSharp.text.Font(ARIAL, 20, iTextSharp.text.Font.NORMAL);

        iTextSharp.text.Font bell_mt = FontFactory.GetFont("bell mt", 24, BaseColor.RED);
        iTextSharp.text.Font mongolian_baiti_regular_24_blue = FontFactory.GetFont("mongolian baiti regular", 24, BaseColor.BLUE);
        iTextSharp.text.Font Arial_10_blue = FontFactory.GetFont("Arial", 10, BaseColor.BLUE);

        Paragraph para = new Paragraph();
        MessageScreen MessageTitle = new MessageScreen();
        PdfContentByte cb;
        PdfTemplate headerTemplate, footerTemplate;
        BaseFont bf = BaseFont.CreateFont(Environment.GetEnvironmentVariable("windir") + @"\fonts\cour.ttf", BaseFont.IDENTITY_H, true);
        public static int header_top_location, header_position, footer_bottom_location, footer_position;
        string break_point;
        OleDbDataAdapter dataadapter;
        DataSet dataset = new DataSet();

        DateTime exe_file_creation_date_time;
        DateTime exe_file_modification_date_time;
        #endregion

        public MainForm()
        {
            InitializeComponent();

            //select [desc], city, (select [desc] from ap2_0001 where a_n = '2002' and s_a=''  ) as [desc] from ap2_0001 where a_n = '2002' and s_a = 'ap1'
            //ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + Convert.ToInt32(sidbc.Text) + " and d_n = 999999) and s_a = '@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + Convert.ToInt32(sidbc.Text) + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='') and [desc] like '%" + sipartycode.Text + "%'";
            //select A_n, S_A, sum(GAMT) as 'Total' from ap2_0021 where prd = 'A' group by A_N, S_A

            //select [Type], Item_Code , sum(QTY) as 'Total' from ap2_0003 group by [Type], Item_Code
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            AFAnalysis.ButtonClick += new EventHandler(UserControl_ButtonClick);
            AFOutstanding.ButtonClick += new EventHandler(AFOutstanding_ButtonClick);

            myExeDir = new FileInfo(Assembly.GetEntryAssembly().Location).Directory.ToString();

            //temp_word = System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location);
            //temp_word = AppDomain.CurrentDomain.BaseDirectory;
            //temp_word = System.IO.Directory.GetCurrentDirectory();
            //temp_word = Environment.CurrentDirectory;
            //temp_word = System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().GetName().CodeBase);
            //temp_word = System.IO.Path.GetDirectoryName(Application.ExecutablePath);




            // Get the Current System culture.
            ConnectionWithAccess.com_senderid = "ANUPEG";
            PleaseWait objPleaseWait = new PleaseWait("Please wait Loading All files");
            objPleaseWait.Show();
            Application.DoEvents();
            check_system_date_format();
            read_company_text_file();
            load_company_font_style();
            replace_user_id_and_password_with_admin();
            //remove readonly from file folder
            //File.SetAttributes(filePath, File.GetAttributes(filePath) & ~FileAttributes.ReadOnly);

            //FileInfo file = new FileInfo("c:\\microsoft.text");
            //file.IsReadOnly = false;
            //if (ConnectionWithAccess.muser != "admin" && ConnectionWithAccess.mpassword != "admin")
            readusersettingsfromfiletoMemory(ConnectionWithAccess.muser, ConnectionWithAccess.mpassword);
            lbl_user.Text = ("User : " + ConnectionWithAccess.muser).Trim();
            this.KeyUp += new System.Windows.Forms.KeyEventHandler(KeyEvent);
            version = "1.1.1";
            this.Text = ConnectionWithAccess.company_details[1] + " " + version + "ver";
            // TODO: This line of code loads data into the 'aP2DataSet.salesreport' table. You can move, or remove it, as needed.
            //this.salesreportTableAdapter.Fill(this.aP2DataSet.salesreport);
            font_name = "Microsoft Sans Serif";
            font_size = "12F";
            ToolStripStatusLabel6.Text = DateTime.Today.ToShortDateString();
            //ConnectionCommand.ConnectionStringCode();
            //ConnectionWithAccess.connection.ConnectionString = ConfigurationManager.ConnectionStrings["AccessConnectionString"].ToString() + ConnectionWithAccess.mDataFile; //Kunal

            ConnectionCommand.get_start_period();
            ConnectionCommand.currentperiod();
            load_all_period_values();
            ToolStripStatusPeriod.Text = ConnectionWithAccess.mprd.ToString() + "  " + ConnectionWithAccess.msdate + "  To  " + ConnectionWithAccess.medate.ToString();
            show_ip_address();
            ToolStripStatusCompany.Text = ConnectionWithAccess.company_details[1];
            ReportGenerator();
            load_nessasary_variables();
            load_necessary_values();
            text_to_display_on_top = ConnectionWithAccess.company_details[1] + " " + version + "ver                                                              " + ToolStripStatusPeriod.Text;
            this.Text = text_to_display_on_top;
            if (DateTime.Now.Date >= Convert.ToDateTime("03/11/2017"))
                if (DateTime.ParseExact(DateTime.Now.Date.ToString("dd/mm/yyyy"), "dd/mm/yyyy", CultureInfo.InvariantCulture) >= DateTime.ParseExact("30/07/2017", "dd/mm/yyyy", CultureInfo.InvariantCulture))
                {
                    System.Environment.Exit(1);
                    System.Windows.Forms.Application.Exit();
                    Application.Exit();
                    this.Close();
                }
            lbl_software_for.Text = "Software for " + software_for;
            ConnectionWithAccess.query = "select mobilenumber from " + ConnectionWithAccess.tablename[10] + " order by mobilenumber";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
                lbl_balance_sms_count.Text = "Available Sms : " + (total_sms_count - dtData1.Rows.Count).ToString();
            else
                lbl_balance_sms_count.Text = "Available Sms : " + total_sms_count.ToString();
            objPleaseWait.Close();
        }

        private void AFOutstanding_ButtonClick(object sender, EventArgs e)
        {
            btnGenerateOutstandingReport.Visible = true;
            dgvOutstanding.Visible = false;
            dgvOutStandingItems.Visible = false;
        }

        private void replace_user_id_and_password_with_admin()
        {
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[52] + " set [f1] = 'admin' , [f2] = 'admin' WHERE [F1] = 'SANJAY' AND [F2] = 'OK'";
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void check_system_date_format()
        {
            CultureInfo ci = CultureInfo.CurrentCulture;
            DateTimeFormatInfo dtfi = ci.DateTimeFormat;
            string[] SystemDateTimePatterns = new string[250];
            int i = 0;
            foreach (string name in dtfi.GetAllDateTimePatterns('d'))
            {
                SystemDateTimePatterns[i] = name;
                i++;
            }
            string[] myDateTimeFormat = { "dd/MM/yyyy", "dd-MM-yyyy" };
            if (myDateTimeFormat[0].Equals(SystemDateTimePatterns[0]) || myDateTimeFormat[1].Equals(SystemDateTimePatterns[0]))
                //MessageBox.Show("Your System DateTime Format " + SystemDateTimePatterns[0] + " is OK");
                temp_word = "";
            else
            {
                MessageBox.Show("Your System DateTime Format is: " + SystemDateTimePatterns[0] + "\n" + "Required DateTime Format: dd/MM/yyyy OR dd-MM-yyyy");
                System.Environment.Exit(1);
                System.Windows.Forms.Application.Exit();
                Application.Exit();
                this.Close();
            }
        }

        private void load_company_font_style()
        {
            var cvt = new FontConverter();
            System.Drawing.Font f = cvt.ConvertFromString(ConnectionWithAccess.company_font) as System.Drawing.Font;
            foreach (Control c in this.Controls)
            {
                c.Font = f;
            }
            //if (ConnectionWithAccess.company_details[36].Length > 20)
            //{
            //    var cvt = new FontConverter();
            //    System.Drawing.Font f = cvt.ConvertFromString(ConnectionWithAccess.company_font) as System.Drawing.Font;
            //    foreach (Control c in this.Controls)
            //    {
            //        c.Font = f;
            //    }
            //}
        }

        //public string encode(string old_english)
        //{
        //    int asc_value;
        //    string encoded = null;
        //    if (old_english != null)
        //    {
        //        encoded = null;
        //        for (int i = 0; i < old_english.Length; i++)
        //        {
        //            char c = Convert.ToChar(old_english.Substring(i, 1));
        //            asc_value = Convert.ToInt32(c);
        //            if (asc_value == 1)
        //                c = Convert.ToChar(asc_value + 228);
        //            else if (asc_value == 32)
        //                c = Convert.ToChar(asc_value + 196);
        //            else if (asc_value >= 33 && asc_value < 65)
        //                c = Convert.ToChar(asc_value + 90);
        //            else if (asc_value >= 65 && asc_value < 75)
        //                c = Convert.ToChar(asc_value + 92);
        //            else if (asc_value >= 75 && asc_value < 85)
        //                c = Convert.ToChar(asc_value + 94);
        //            else if (asc_value >= 85 && asc_value < 97)
        //                c = Convert.ToChar(asc_value + 96);
        //            else if (asc_value >= 97 && asc_value < 107)
        //                c = Convert.ToChar(asc_value + 98);
        //            else if (asc_value >= 107 && asc_value < 117)
        //                c = Convert.ToChar(asc_value + 100);
        //            else if (asc_value >= 117 && asc_value < 126)
        //                c = Convert.ToChar(asc_value + 102);
        //            else
        //                temp_word = "Sanjay";
        //            encoded += Convert.ToString(c);
        //        }
        //    }
        //    encoded = old_english;
        //    return encoded;
        //}

        //public string decode(string encoded)
        //{
        //    int asc_value;
        //    string decoded = null;
        //    if (encoded != null)
        //    {

        //        for (int i = 0; i < encoded.Length; i++)
        //        {
        //            char c = Convert.ToChar(encoded.Substring(i, 1));
        //            asc_value = Convert.ToInt32(c);
        //            if (asc_value > 123 && asc_value < 155)
        //                c = Convert.ToChar(asc_value - 90);
        //            else if (asc_value >= 157 && asc_value < 167)
        //                c = Convert.ToChar(asc_value - 92);
        //            else if (asc_value >= 169 && asc_value < 179)
        //                c = Convert.ToChar(asc_value - 94);
        //            else if (asc_value >= 181 && asc_value < 193)
        //                c = Convert.ToChar(asc_value - 96);
        //            else if (asc_value >= 195 && asc_value < 205)
        //                c = Convert.ToChar(asc_value - 98);
        //            else if (asc_value >= 207 && asc_value < 217)
        //                c = Convert.ToChar(asc_value - 100);
        //            else if (asc_value >= 219 && asc_value < 228)
        //                c = Convert.ToChar(asc_value - 102);
        //            else if (asc_value == 228)
        //                c = Convert.ToChar(32);
        //            decoded += Convert.ToString(c);
        //        }
        //    }
        //       return decoded;
        //}

        private void load_nessasary_variables()
        {
            header_position = 60;
            header_top_location = 20;
            footer_position = 210;
            footer_bottom_location = 40;
            si_party_help.Location = new System.Drawing.Point(12, 100);
            si_party_help.Size = new System.Drawing.Size(690, 180);
            so_party_help.Location = new System.Drawing.Point(12, 100);
            so_party_help.Size = new System.Drawing.Size(690, 180);
            pdf_invoice.Location = new System.Drawing.Point(12, 100);
            pdf_invoice.Size = new System.Drawing.Size(775, 340);
            pdf_viewer1.Location = new System.Drawing.Point(12, 100);
            pdf_viewer1.Size = new System.Drawing.Size(960, 370);
            pdf_viewer2.Location = new System.Drawing.Point(6, 59);
            pdf_viewer2.Size = new System.Drawing.Size(1162, 418);
            pdf_viewer3.Location = new System.Drawing.Point(20, 50);
            pdf_viewer3.Size = new System.Drawing.Size(1320, 450);
            pdf_viewer_report_outstanding.Location = new System.Drawing.Point(20, 50);
            pdf_viewer_report_outstanding.Size = new System.Drawing.Size(1320, 450);
            sale_invoice_dgv.Location = new System.Drawing.Point(12, 290);
            sale_invoice_dgv.Size = new System.Drawing.Size(775, 150);
            sale_order_dgv.Location = new System.Drawing.Point(12, 290);
            sale_order_dgv.Size = new System.Drawing.Size(775, 150);
            //dataGridView2.Location = new System.Drawing.Point(12, 100);
            //dataGridView2.Size = new System.Drawing.Size(775, 180);
            piitemlist.Size = new System.Drawing.Size(775, 180);
            sitaxlist.Location = new System.Drawing.Point(12, 250);
            sitaxlist.Size = new System.Drawing.Size(775, 180);
            si_item_help.Location = new Point(12, 250);
            si_item_help.Size = new System.Drawing.Size(775, 180);
            dgv_soitemhelp.Location = new Point(12, 250);
            dgv_soitemhelp.Size = new Size(775, 180);
            dgv_user_list.Location = new Point(12, 250);
            dgv_user_list.Size = new Size(775, 180);
            pi_party_help.Location = new Point(12, 250);
            pi_party_help.Size = new Size(775, 180);
            pi_item_help.Location = new Point(12, 250);
            pi_item_help.Size = new Size(775, 180);
            pitaxlist_dgv.Location = new System.Drawing.Point(12, 250);
            pitaxlist_dgv.Size = new System.Drawing.Size(775, 180);
            cr_datagridview.Location = new System.Drawing.Point(12, 250);
            cr_datagridview.Size = new System.Drawing.Size(775, 180);
            cp_datagridview.Location = new System.Drawing.Point(12, 250);
            cp_datagridview.Size = new System.Drawing.Size(775, 180);
            braccountdg.Location = new System.Drawing.Point(12, 250);
            braccountdg.Size = new System.Drawing.Size(775, 180);
            bp_datagridview.Location = new System.Drawing.Point(12, 250);
            bp_datagridview.Size = new System.Drawing.Size(775, 180);
            dgvBankExcelAccName.Size = new System.Drawing.Size(775, 180);
            jour_datagridview.Location = new System.Drawing.Point(12, 250);
            jour_datagridview.Size = new System.Drawing.Size(775, 180);
            pb_common.Location = new System.Drawing.Point(20, 175);
            pb_common.Size = new System.Drawing.Size(790, 180);
            pb_visiting_card.Location = new System.Drawing.Point(30, 50);
            pb_visiting_card.Size = new System.Drawing.Size(170, 200);
            pb_invoice.Location = new System.Drawing.Point(230, 50);
            pb_invoice.Size = new System.Drawing.Size(170, 200);
            pb_receipt.Location = new System.Drawing.Point(430, 50);
            pb_receipt.Size = new System.Drawing.Size(170, 200);
            pb_personal_photo.Location = new System.Drawing.Point(630, 50);
            pb_personal_photo.Size = new System.Drawing.Size(170, 200);
            pb_product.Location = new System.Drawing.Point(888, 132);
            pb_product.Size = new System.Drawing.Size(450, 255);
            master_item_help.Location = new System.Drawing.Point(20, 175);
            master_item_help.Size = new System.Drawing.Size(790, 180);
            BalShDGV.Location = new System.Drawing.Point(20, 50);
            BalShDGV.Size = new System.Drawing.Size(1320, 450);
            dgv_period.Location = new System.Drawing.Point(475, 130);
            dgv_period.Size = new System.Drawing.Size(252, 480);
            sr_item_help.Location = new Point(12, 250);
            sr_item_help.Size = new Size(775, 180);
            lbl_master_master_account_name.Location = new System.Drawing.Point(390, 3);
            ConnectionWithAccess.query = "select prd from " + ConnectionWithAccess.tablename[50] + " order by prd";
            ConnectionCommand.retrieval(cbBalShPer);
            temporary_array = new string[0];
            load_bank_names();
            cbParent.Items.Clear();
            //cbParent.Items.AddRange(new object[] { "BANK ACCOUNT", "BANK OVERDRAFT", "CAPITAL ACCOUNT", "OLD CAPITAL ACCOUNT", "CASH IN HAND", "DEPOSITS", "DIRECT EXPENSES(TRADING)", "DIRECT INCOMES(TRADING)", "FIXED ASSETS", "INDIRECT EXPENSES(P&L)", "INDIRECT INCOMES(P&L)", "INVESTMENTS", "LOAN GIVEN", "LOAN RECEIVED", "PROVISIONS", "SUNDRY CREDITORS", "SUNDRY DEBTORS", "TAXES & DUTIES", "Unknown" });
            cbParent.Items.AddRange(new object[] { "SUNDRY DEBTORS", "SUNDRY CREDITORS", "BANK ACCOUNT", "CASH IN HAND", "DIRECT EXPENSES(TRADING)", "DIRECT INCOMES(TRADING)", "INDIRECT EXPENSES(P&L)", "INDIRECT INCOMES(P&L)", "BANK OVERDRAFT", "OLD CAPITAL ACCOUNT", "CAPITAL ACCOUNT", "DEPOSITS", "FIXED ASSETS", "INVESTMENTS", "LOAN GIVEN", "LOAN RECEIVED", "PROVISIONS", "TAXES & DUTIES", "Unknown" });
            additional_account.Items.Clear();
            additional_account.Items.AddRange(new object[] { "BANK ACCOUNT", "BANK OVERDRAFT", "CAPITAL ACCOUNT", "OLD CAPITAL ACCOUNT", "CASH IN HAND", "DEPOSITS", "DIRECT EXPENSES(TRADING)", "DIRECT INCOMES(TRADING)", "FIXED ASSETS", "INDIRECT EXPENSES(P&L)", "INDIRECT INCOMES(P&L)", "INVESTMENTS", "LOAN GIVEN", "LOAN RECEIVED", "PROVISIONS", "SUNDRY CREDITORS", "SUNDRY DEBTORS", "TAXES & DUTIES", "Unknown" });
            cbParent.SelectedIndex = 0;
            cbAction.SelectedIndex = 0;
            cbBalShAc.SelectedIndex = 0;
            mix_reports_combo_box.SelectedIndex = 0;
            cb_rg_report_type.SelectedIndex = 3;
        }

        private void load_necessary_values()
        {
            brcurbankbal.Text = Convert.ToString(get_bank_balance("2011", "@@@", DateTime.Today.ToShortDateString()));
            bpcurbankbal.Text = brcurbankbal.Text;
            bdcurbankbal.Text = brcurbankbal.Text;
            bwcurbankbal.Text = brcurbankbal.Text;
            bdcurcashbal.Text = Convert.ToString(get_cash_balance("2010", "@@@", DateTime.Today.ToShortDateString()));
            bwcurcashbal.Text = bdcurcashbal.Text;
            crcurcashbal.Text = bdcurcashbal.Text;
            cpcurcashbal.Text = bdcurcashbal.Text;
            //sidbc.Text = null;
            //srdbc.Text = null;
            //pidbc.Text = null;
            //prdbc.Text = null;
            //brdbc.Text = null;
            //bpdbc.Text = null;
            //bddbc.Text = null;
            //bwdbc.Text = null;
            //crdbc.Text = null;
            //cpdbc.Text = null;
            //jjdbc.Text = null;
        }

        public void show_ip_address()
        {
            IPHostEntry host;
            host = Dns.GetHostEntry(Dns.GetHostName());
            foreach (IPAddress ip in host.AddressList)
            {
                if (ip.AddressFamily.ToString() == "InterNetwork")
                {
                    localipaddress.Text = ip.ToString();
                    //MessageBox.Show(localipaddress);
                }
            }
            temp_word = System.IO.Path.GetDirectoryName(Application.ExecutablePath);
            exe_filename = temp_word + "\\sharp accounting.exe";
            exe_file_creation_date_time = File.GetCreationTime(exe_filename);
            exe_file_modification_date_time = File.GetLastWriteTime(exe_filename);
            localipaddress.Text += "   " + exe_file_modification_date_time;
        }
        //test 2 tfs
        public void update_null()
        {
            int i;
            for (i = 0; i < 10; i++)
            {
                if (i < 10)
                    mtbname = ConnectionWithAccess.mNIK + "_000" + i;
                else
                    mtbname = ConnectionWithAccess.mNIK + "_00" + i;

            }
        }

        private void fill_period_array()
        {
            period_array.Clear();
            ConnectionWithAccess.query = "select prd,[start],[end],gp,[lock] from " + ConnectionWithAccess.tablename[50] + " order by prd";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();

            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                int mcolumncount = dtData1.Columns.Count;
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temp_word = "";
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        temp_word = temp_word + dtData1.Rows[iRowCount][i].ToString() + " ,";
                        //temp_word = dtData1.Rows[iRowCount][i].ToString();
                        account_detail_from_01.Add(temp_word);
                    }
                    temp_word = temp_word.Substring(0, temp_word.Length - 1);
                    period_array.Add(temp_word);
                }
            }
        }

        private void sidbc_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (sidbc.Text != "")
            {
                ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[21] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + Convert.ToInt32(sidbc.Text);
                ConnectionCommand.ExportToText(sidbc, sidocno);
                ConnectionWithAccess.md_n = sidocno.Text;
                sia_n.Text = get_a_n_from_d_c("S", Convert.ToInt32(sidbc.Text));
                set_invoice_date(21, sidocno.Text, Convert.ToInt32(sidbc.Text));
                lbl_sale_account_name.Text = get_account_name_from_d_c("S", Convert.ToInt32(sidbc.Text));
                dtp_sisale_lr_date.Value = sidatetime.Value;
                fillsisalelist();
            }
        }

        //private void dateCheckForSaleInvoice()
        //{
        //    ConnectionWithAccess.query = "select top 1 d_d from " + ConnectionWithAccess.tablename[21] + " where d_n = (SELECT max(d_n) from " + ConnectionWithAccess.tablename[21] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + sidbc.Text + " ) order by d_d desc";
        //    ConnectionCommand.ExportToDateTimePicker(sidatetime);
        //}

        //private void dateCheckForSalereplacement()
        //{
        //    ConnectionWithAccess.query = "select top 1 d_d from " + ConnectionWithAccess.tablename[30] + " where d_n = (SELECT max(d_n) from " + ConnectionWithAccess.tablename[30] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + srdbc.Text + " ) order by d_d desc";
        //    ConnectionCommand.ExportToDateTimePicker(srdatetime);
        //}

        //private void dateCheckForcashInvoice()
        //{
        //    ConnectionWithAccess.query = "select top 1 d_d from " + ConnectionWithAccess.tablename[21] + " where d_n = (SELECT max(d_n) from " + ConnectionWithAccess.tablename[21] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + crdbc.Text + " ) order by d_d desc";
        //    ConnectionCommand.ExportToDateTimePicker(sidatetime);
        //}

        private void getdaybookcode()
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Loading Data");
            objPleaseWait.Show();
            Application.DoEvents();
            if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
            {
                ConnectionWithAccess.data_entry_working = "Sale Party";
                current_working_tab = "100";
                if (ConnectionWithAccess.mUserFeatures.Substring(15, 1) == "Y")
                {
                    if (sidbc.Text == "")
                    {
                        sidbc.Visible = true;
                        ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[21] + " where d_n = 999999";
                        ConnectionCommand.retrieval(sidbc);
                    }
                    sipartycode.Focus();
                }
                else
                    subtabDataEntry.TabPages[0].Hide();
            }
            else if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 1)
            {
                ConnectionWithAccess.data_entry_working = "Sale Replacement";
                current_working_tab = "101";
                if (ConnectionWithAccess.mUserFeatures.Substring(15, 1) == "Y")
                {
                    if (srdbc.Text == "")
                    {
                        srdbc.Visible = true;
                        ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[30] + " where d_n = 999999";
                        ConnectionCommand.retrieval(srdbc);
                    }
                    srpartycode.Focus();
                }
                else
                    subtabDataEntry.TabPages[0].Hide();
            }
            else if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 2)
            {
                ConnectionWithAccess.data_entry_working = "Sale Order";
                current_working_tab = "102";
                if (ConnectionWithAccess.mUserFeatures.Substring(15, 1) == "Y")
                {
                    if (sodbc.Text == "")
                    {
                        sodbc.Visible = true;
                        ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[7] + " where d_n = 999999";
                        ConnectionCommand.retrieval(sodbc);
                    }
                    sopartycode.Focus();
                }
                else
                    subtabDataEntry.TabPages[0].Hide();
            }
            else if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 3)
            {
                ConnectionWithAccess.data_entry_working = "Simple Sale Party";
                current_working_tab = "100";
                if (ConnectionWithAccess.mUserFeatures.Substring(15, 1) == "Y")
                {
                    ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[21] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + Convert.ToInt32(sidbc.Text);
                    ConnectionCommand.ExportToText(sidbc, simple_docno);
                    ConnectionWithAccess.md_n = simple_docno.Text;
                    simple_a_n.Text = get_a_n_from_d_c("S", 1);
                    set_invoice_date(21, sidocno.Text, 1);
                    fillsisalelist();
                    //if (sidbc.Text == "")
                    //{
                    //    sidbc.Visible = true;
                    //    ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[21] + " where d_n = 999999";
                    //    ConnectionCommand.retrieval(sidbc);
                    //}
                    simple_docno.Focus();
                }
                else
                    subtabDataEntry.TabPages[0].Hide();
            }
            else if (subtabDataEntry.SelectedIndex == 1 && subtabpurchase.SelectedIndex == 0)
            {
                ConnectionWithAccess.data_entry_working = "Purchase Party";
                current_working_tab = "110";
                if (ConnectionWithAccess.mUserFeatures.Substring(17, 1) == "Y")
                {
                    current_working_tab = "110";
                    if (pidbc.Text == "")
                    {
                        pidbc.Visible = true;
                        ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[22] + " where d_n = 999999";
                        ConnectionCommand.retrieval(pidbc);
                    }
                    set_period_of_gst();
                    if (periodofgst == true)
                        pitx_code.Visible = false;
                    else
                        pitx_code.Visible = true;
                    pipartycode.Focus();
                }
            }
            else if (subtabDataEntry.SelectedIndex == 1 && subtabpurchase.SelectedIndex == 1)
            {
                current_working_tab = "110";
                if (ConnectionWithAccess.mUserFeatures.Substring(17, 1) == "Y")
                {
                    if (prdbc.Text == "")
                    {
                        prdbc.Visible = true;
                        ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[22] + " where d_n = 999999";
                        ConnectionCommand.retrieval(prdbc);
                    }
                    prpartycode.Focus();
                }
                else
                    subtabpurchase.TabPages[1].Hide();

            }
            else if (subtabDataEntry.SelectedIndex == 2)
            {
                if (ConnectionWithAccess.mUserFeatures.Substring(19, 1) == "Y")
                {
                    if (subtabbank.SelectedIndex == 0)
                    {
                        current_working_tab = "120";
                        if (brdbc.Text == "")
                        {
                            brdbc.Visible = true;
                            ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[23] + " where d_n = 999999 order by d_c";
                            ConnectionCommand.retrieval(brdbc);
                            brdbc.Enabled = false;
                            ConnectionWithAccess.query = "select distinct d_c,[desc] from " + ConnectionWithAccess.tablename[23] + " f23 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f23.a_n = f1.a_n and f23.s_a = f1.s_a where f23.d_n = 999999";
                            ConnectionCommand.retrieval(braccname);
                        }
                        brpartycode.Focus();
                    }
                    else if (subtabbank.SelectedIndex == 1)
                    {
                        current_working_tab = "121";
                        if (bpdbc.Text == "")
                        {
                            bpdbc.Visible = true;
                            ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[23] + " where d_n = 999999";
                            ConnectionCommand.retrieval(bpdbc);
                            bpdbc.Enabled = false;
                            ConnectionWithAccess.query = "select distinct d_c,[desc] from " + ConnectionWithAccess.tablename[23] + " f23 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f23.a_n = f1.a_n and f23.s_a = f1.s_a where f23.d_n = 999999";
                            ConnectionCommand.retrieval(bpaccname);
                        }
                        bppartycode.Focus();
                    }
                    else if (subtabbank.SelectedIndex == 2)
                    {
                        current_working_tab = "122";
                        if (bddbc.Text == "")
                        {
                            bddbc.Visible = true;
                            ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[23] + " where d_n = 999999";
                            ConnectionCommand.retrieval(bddbc);
                            bwa_n.Text = get_a_n_from_d_c("B", Convert.ToInt32(bddbc.Text));
                            ConnectionWithAccess.query = "select distinct d_c,[desc] from " + ConnectionWithAccess.tablename[23] + " f23 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f23.a_n = f1.a_n and f23.s_a = f1.s_a where f23.d_n = 999999";
                            ConnectionCommand.retrieval(bdbankname);
                        }
                        bdamt.Focus();
                    }
                    else if (subtabbank.SelectedIndex == 3)
                    {
                        current_working_tab = "123";
                        if (bwdbc.Text == "")
                        {
                            bwdbc.Visible = true;
                            ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[23] + " where d_n = 999999";
                            ConnectionCommand.retrieval(bwdbc);
                            bwa_n.Text = get_a_n_from_d_c("B", Convert.ToInt32(bwdbc.Text));
                            ConnectionWithAccess.query = "select distinct d_c,[desc] from " + ConnectionWithAccess.tablename[23] + " f23 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f23.a_n = f1.a_n and f23.s_a = f1.s_a where f23.d_n = 999999";
                            ConnectionCommand.retrieval(bwbankname);
                        }
                        bwamt.Focus();
                    }
                    else if (subtabbank.SelectedIndex == 4)
                    {
                        current_working_tab = "124";
                        //if (cb_tr_from_dc.Text == "")
                        //{
                        cb_tr_from_dc.Visible = true;
                        ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[23] + " where d_n = 999999";
                        ConnectionCommand.retrieval(cb_tr_from_dc);
                        //}
                        if (cb_tr_to_dc.Text == "")
                        {
                            cb_tr_to_dc.Visible = true;
                            ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[23] + " where d_n = 999999";
                            ConnectionCommand.retrieval(cb_tr_to_dc);
                        }
                        fill_bank_trans_list();
                    }
                }
                else
                    subtabDataEntry.TabPages[2].Hide();
            }
            else if (subtabDataEntry.SelectedIndex == 3)
            {
                current_working_tab = "13";
                if (ConnectionWithAccess.mUserFeatures.Substring(21, 1) == "Y")
                {
                    if (subtabcash.SelectedIndex == 0)
                    {
                        current_working_tab = "130";
                        if (crdbc.Text == "")
                        {
                            crdbc.Visible = true;
                            ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[24] + " where d_n = 999999";
                            ConnectionCommand.retrieval(crdbc);
                        }
                        crcurcashbal.Text = Convert.ToString(get_cash_balance("2010", "@@@", crdatetime.Value.ToString()));

                    }
                    else if (subtabcash.SelectedIndex == 1)
                    {
                        current_working_tab = "131";
                        if (cpdbc.Text == "")
                        {
                            cpdbc.Visible = true;
                            ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[24] + " where d_n = 999999";
                            ConnectionCommand.retrieval(cpdbc);
                        }
                        cpcurcashbal.Text = Convert.ToString(get_cash_balance("2010", "@@@", cpdatetime.Value.ToString()));
                    }
                }
                else
                    subtabDataEntry.TabPages[3].Hide();
            }
            else if (subtabDataEntry.SelectedIndex == 4)
            {
                current_working_tab = "140";
                if (ConnectionWithAccess.mUserFeatures.Substring(23, 1) == "Y")
                {
                    if (jjdbc.Text == "")
                    {
                        jjdbc.Visible = true;
                        ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[25] + " where d_n = 999999";
                        ConnectionCommand.retrieval(jjdbc);
                        filljrtranlist();
                    }
                }
                else
                    subtabDataEntry.TabPages[4].Hide();
            }
            else if (subtabDataEntry.SelectedIndex == 5)
            {
                current_working_tab = "150";
                if (ConnectionWithAccess.mUserFeatures.Substring(25, 1) == "Y")
                    tb_dataentry_stock_item_date.Value = DateTime.Now;
                else
                    subtabDataEntry.TabPages[4].Hide();
            }
            else if (subtabDataEntry.SelectedIndex == 6)
            {
                fFillAreaList(cb_DE_arealist);
            }
            objPleaseWait.Close();
        }

        #region filldatabase
        private void fill_transport(string ma_n, string mcity, ComboBox mcombobox)
        {
            mcombobox.Items.Clear();
            if (ma_n != null && ma_n != "" && mcity != null && mcity != "")
            {
                ConnectionWithAccess.query = "select distinct tpt from " + ConnectionWithAccess.tablename[04] + " f4 where f4.a_n = '" + ma_n + "' and f4.city = '" + mcity + "'";
                ConnectionCommand.retrieval(mcombobox);
            }
        }

        private void fillsisalelist()
        {
            if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
            {
                sisalelistdg.DataSource = null;
                ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f21.bamt, f21.tamt, f21.gamt, f21.a_n, f21.s_a, f21.d_y,f21.lr_num,f21.lr_date from " + ConnectionWithAccess.tablename[21] + " f21 inner join " + ConnectionWithAccess.tablename[1] + " f1 on f21.a_n = f1.a_n and f21.s_a = f1.s_a and f21.d_y = f1.d_y where f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_c = " + sidbc.Text + " and f21.a_n = '" + sia_n.Text + "'and f21.d_n <> 999999 order by f21.d_n desc";
                ConnectionCommand.accountHelp_datatable_Seperate(sisalelistdg, "sisalelistdg");
            }
            else if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 3)
            {
                simple_salelist.DataSource = null;
                ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f21.bamt, f21.tamt, f21.gamt, f21.a_n, f21.s_a, f21.d_y,f21.lr_num,f21.lr_date from " + ConnectionWithAccess.tablename[21] + " f21 inner join " + ConnectionWithAccess.tablename[1] + " f1 on f21.a_n = f1.a_n and f21.s_a = f1.s_a and f21.d_y = f1.d_y where f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_c = " + sidbc.Text + " and f21.a_n = '" + sia_n.Text + "'and f21.d_n <> 999999 order by f21.d_n desc";
                ConnectionCommand.accountHelp_datatable_Seperate(simple_salelist, "sisalelistdg");
            }
        }

        private void fillsrreplamentlist()
        {
            srsalelistdg.DataSource = null;
            ConnectionWithAccess.query = "select distinct f30.D_D, f30.D_N, f1.[desc] as [Desc], f1.city, f30.bamt, f30.tamt, f30.gamt, f30.a_n, f30.s_a, f30.d_y,f30.lr_num,f30.lr_date from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[30] + " f30 where f30.a_n = '" + sra_n.Text + "'and f1.a_n = f30.a_n and f1.s_a = f30.s_a  and f30.prd = '" + ConnectionWithAccess.mprd + "' and f30.d_c = " + srdbc.Text + " and f30.d_n <> 999999 order by f30.d_n desc";
            ConnectionCommand.accountHelp_datatable_Seperate(srsalelistdg, "srsalelistdg");
        }

        private void fillsosalelist()
        {
            if (sosalelistdg.Rows.Count == 0)
            {
                sosalelistdg.DataSource = null;
                ConnectionWithAccess.query = "select distinct f7.D_D, f7.D_N, f1.[desc] as [Desc], f1.city, f7.bamt, f7.tamt, f7.gamt, f7.a_n, f7.s_a, f7.d_y,f7.lr_num,f7.lr_date from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[7] + " f7 where f7.a_n = '" + soa_n.Text + "'and f1.a_n = f7.a_n and f1.s_a = f7.s_a and f7.prd = '" + ConnectionWithAccess.mprd + "' and f7.d_c = " + sodbc.Text + " and f7.d_n <> 999999 order by f7.d_n desc";
                ConnectionCommand.accountHelp_datatable_Seperate(sosalelistdg, "sosalelistdg");
            }
        }

        private void fillpipurclist()
        {
            //ConnectionWithAccess.query = "select distinct '', f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f22.bamt, f22.tamt, f22.gamt, f22.a_n, f22.s_a, f22.d_y from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f6.tx_code = f22.tx_code and f22.prd = '" + ConnectionWithAccess.mprd + "' order by f22.d_d desc";
            ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f22.bamt, f22.tamt, f22.gamt, f22.a_n, f22.s_a, f22.d_y,f22.lr_num,f22.lr_date from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f22.a_n = '" + pia_n.Text + "'and f1.a_n = f22.a_n and f1.s_a = f22.s_a  and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_c = " + pidbc.Text + " and f22.d_n <> 999999 order by f22.d_d desc";
            ConnectionCommand.accountHelp_datatable_GridColumns(pipurchaselist, "pipurchaselist");
        }

        private void fillprreplamentlist()
        {
            srsalelistdg.Rows.Clear();
            ConnectionWithAccess.query = "select distinct f30.D_D, f30.D_N, f1.[desc] as [Desc], f1.city, f30.bamt, f30.tamt, f30.gamt, f30.a_n, f30.s_a, f30.d_y,f30.lr_num,f30.lr_date from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[30] + " f30 where f30.a_n = '" + pra_n.Text + "'and f1.a_n = f30.a_n and f1.s_a = f30.s_a  and f30.prd = '" + ConnectionWithAccess.mprd + "' and f30.d_c = " + prdbc.Text + " and f30.d_n <> 999999 order by f30.d_n desc";
            ConnectionCommand.accountHelp_datatable_Seperate(prpurchaselistdg, "prsalelistdg");
            srsalelistdg.Columns[0].HeaderText = "Date";
            srsalelistdg.Columns[1].HeaderText = "Inv.num";
            srsalelistdg.Columns[2].HeaderText = "Name";
            srsalelistdg.Columns[3].HeaderText = "City";
            srsalelistdg.Columns[4].HeaderText = "Basic Amt";
            srsalelistdg.Columns[5].HeaderText = "Tax Amt";
            srsalelistdg.Columns[6].HeaderText = "Gross Amt";
            srsalelistdg.Columns[7].HeaderText = "A_n";
            srsalelistdg.Columns[8].HeaderText = "S_a";
            if (srsalelistdg.Rows.Count <= 1)
            {
                ConnectionWithAccess.mDateTime = Convert.ToDateTime(ConnectionWithAccess.msdate);
            }
        }

        private void fill_bank_trans_list()
        {
            //r_p = 2 Receipt
            // r_p = 4 payment
            // r_p - 1 "Cash Deposit"
            //r_p = 3 cash withdrawal
            if (subtabbank.SelectedIndex == 0)
            {
                ConnectionWithAccess.query = "select distinct f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt, f23.ck_no,f23.ck_dt,f23.bank,f23.pass_date,f23.mess, f23.a_n, f23.s_a, f23.b_t, f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + brdbc.Text + " and F23.d_n <> 999999 and f23.r_p = '2' order by f23.d_d desc, f23.d_n desc";
                ConnectionCommand.accountHelp_datatable_Seperate(brtranlist, "brtranlist");
                if (brtranlist.Rows.Count >= 1)
                    brdatetime.Value = Convert.ToDateTime(brtranlist.Rows[0].Cells[0].Value.ToString());
                else
                    brdatetime.Value = Convert.ToDateTime(ConnectionWithAccess.msdate);
            }
            else if (subtabbank.SelectedIndex == 1)
            {
                ConnectionWithAccess.query = "select distinct f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, (f23.bamt * -1), f23.ck_no,f23.ck_dt,f23.bank,f23.pass_date,f23.mess, f23.a_n, f23.s_a, f23.b_t, f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + bpdbc.Text + " and F23.d_n <> 999999 and f23.r_p = '4' order by f23.d_d desc, f23.d_n desc";
                ConnectionCommand.accountHelp_datatable_Seperate(bptranlist, "bptranlist");
                if (bptranlist.Rows.Count >= 1)
                    bpdatetime.Value = Convert.ToDateTime(bptranlist.Rows[0].Cells[1].Value.ToString());
                else
                    bpdatetime.Value = Convert.ToDateTime(ConnectionWithAccess.msdate);
            }
            else if (subtabbank.SelectedIndex == 2)
            {
                ConnectionWithAccess.query = "select f23.D_D, f23.D_N, f23.bamt, f23.mess from " + ConnectionWithAccess.tablename[23] + " f23 where f23.prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + bddbc.Text + " and F23.d_n <> 999999 and f23.r_p = '1' order by f23.d_d desc, f23.d_n desc";
                ConnectionCommand.accountHelp_datatable_Seperate(bdtranlist, "bdtranlist");
                if (bdtranlist.Rows.Count >= 1)
                    bddatetime.Value = Convert.ToDateTime(bdtranlist.Rows[0].Cells[0].Value.ToString());
                else
                    bddatetime.Value = Convert.ToDateTime(ConnectionWithAccess.msdate);
            }
            else if (subtabbank.SelectedIndex == 3)
            {
                ConnectionWithAccess.query = "select f23.D_D, f23.D_N, f23.bamt, f23.mess from " + ConnectionWithAccess.tablename[23] + " f23 where f23.prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + bwdbc.Text + " and F23.d_n <> 999999 and f23.r_p = '3' order by f23.d_d desc, f23.d_n desc";
                ConnectionCommand.accountHelp_datatable_Seperate(bwtranlist, "bwtranlist");
                if (bwtranlist.Rows.Count >= 1)
                    bwdatetime.Value = Convert.ToDateTime(bwtranlist.Rows[0].Cells[0].Value.ToString());
                else
                    bwdatetime.Value = Convert.ToDateTime(ConnectionWithAccess.msdate);
            }
            else if (subtabbank.SelectedIndex == 4)
            {
                //ConnectionWithAccess.query = "select f23.D_D,f23.d_n, f1.[desc] as [tr_bank_name_1], '' as [tr_bank_name_2], (f23.bamt * -1),f23.mess,f23.d_c, f23.tran_d_c from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and F23.d_n <> 999999 and f23.r_p = '5' order by f23.d_d desc";
                //ConnectionWithAccess.query = "select f23.D_D,f23.d_n, '' as [desc], '' as [desc2], (f23.bamt * -1),f23.mess,f23.d_c, f23.tran_d_c from " + ConnectionWithAccess.tablename[23] + " f23 where f23.prd = '" + ConnectionWithAccess.mprd + "' and F23.d_n <> 999999 and f23.r_p = '5' order by f23.d_d desc";
                //ConnectionWithAccess.query = "select f23.D_D,f23.d_n, '' as [desc], '' as [desc2], (f23.bamt * -1),f23.mess,f23.d_c, f23.tran_d_c from " + ConnectionWithAccess.tablename[23] + " f23 where f23.prd = '" + ConnectionWithAccess.mprd + "' and F23.d_n <> 999999 and f23.tran_d_c <> 0 order by f23.d_d desc";
                ConnectionWithAccess.query = "select f23.D_D,f23.d_n, " + //'' as [desc], '' as [desc2], 
                    "(select distinct [a.desc] from " + ConnectionWithAccess.tablename[01] + " a inner join " + ConnectionWithAccess.tablename[23] + " b on b.a_n  = a.a_n " +
                        "where b.d_c = f23.d_c and d_n = 999999  and a.s_a ='@@@') as [desc], " +
                    "(select distinct [a.desc] from " + ConnectionWithAccess.tablename[01] + " a inner join " + ConnectionWithAccess.tablename[23] + " b on b.a_n  = a.a_n " +
                        "where b.d_c = f23.tran_d_c and d_n = 999999  and a.s_a ='@@@') as [desc2], " +
                    " (f23.bamt * -1),f23.mess, f23.d_c, f23.tran_d_c " +
                " from " + ConnectionWithAccess.tablename[23] + " f23 where f23.prd = '" + ConnectionWithAccess.mprd + "' and F23.d_n <> 999999 and f23.tran_d_c <> 0 order by f23.d_d desc, f23.d_n desc";

                ConnectionCommand.accountHelp_datatable_Seperate(tr_datagridview, "tr_datagridview");
            }
        }

        private void fillcrtranlist()
        {
            //r_p = 2 Receipt
            // r_p = 4 payment
            // r_p - 1 "Cash Deposit"
            //r_p = 3 cash withdrawal
            ConnectionWithAccess.query = "select distinct f24.d_d, f24.d_n, f1.[desc] as [Desc], f1.city, f24.camt, f24.mess, f24.a_n, f24.s_a from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[24] + " f24 where f1.a_n = f24.a_n and f1.s_a = f24.s_a and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + crdbc.Text + " and d_n <> 999999 and r_p = '2' and b_t ='3' order by f24.d_d desc , f24.d_n desc";
            ConnectionCommand.accountHelp_datatable_Seperate(crtranlist, "crtranlist");
        }

        private void fillcptranlist()
        {
            //r_p = 2 Receipt
            // r_p = 4 payment
            // r_p - 1 "Cash Deposit"
            //r_p = 3 cash withdrawal
            ConnectionWithAccess.query = "select distinct f24.d_d, f24.d_n, f1.[desc] as [Desc], f1.city, f24.camt, f24.mess, f24.a_n, f24.s_a from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[24] + " f24 where f1.a_n = f24.a_n and f1.s_a = f24.s_a and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + cpdbc.Text + " and d_n <> 999999 and r_p = '4' and b_t ='3' order by f24.d_d desc , f24.d_n desc";
            ConnectionCommand.accountHelp_datatable_Seperate(cptranlist, "cptranlist");
        }

        private void filljrtranlist()
        {
            if (jjdbc.Text != "")
            {
                ConnectionWithAccess.query = "select f25.d_d, f25.d_n, '', '', f25.jamt, '', '', f25.mess, f25.a_n, f25.s_a, f25.na_n, f25.ns_a, f25.basic_amt, f25.igst_per, f25.igst_amt from " + ConnectionWithAccess.tablename[25] + " f25 where prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + jjdbc.Text + " and d_n <> 999999 order by f25.d_d desc, f25.d_n desc";
                ConnectionCommand.accountHelp_datatable_Seperate(jjtranlist, "jjtranlist");
            }
        }
        #endregion

        #region click
        private void atbnew_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait opening New Data File....");
            objPleaseWait.Show();
            Application.DoEvents();
            function_working = "New";
            dgvStdCodeHelp.Visible = false;
            if (maintab.SelectedIndex == 1)
            {
                // data entry
                if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
                {
                    new_sale_invoice = true;
                    refresh_data_entry_sale_for_new_record();
                }
                else if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 1)
                    refresh_data_entry_sale_replacement_for_new_record();
                else if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 2)
                        refresh_data_entry_sale_order_for_new_record();
                else if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 3)
                {
                    new_sale_invoice = true;
                    refresh_data_entry_simple_sale_for_new_record();
                }
                else if (subtabDataEntry.SelectedIndex == 1)
                    refresh_data_entry_purc_for_new_record();
                else if (subtabDataEntry.SelectedIndex == 2)
                {
                    if (subtabbank.SelectedIndex == 0)
                        refresh_data_entry_bank_for_new_record();
                    else if (subtabbank.SelectedIndex == 1)
                        refresh_data_entry_bank_for_new_record();
                    else if (subtabbank.SelectedIndex == 2)
                        refresh_data_entry_bank_for_new_record();
                    else if (subtabbank.SelectedIndex == 3)
                        refresh_data_entry_bank_for_new_record();
                    else if (subtabbank.SelectedIndex == 4)
                        refresh_data_entry_bank_for_new_record();
                }
                else if (subtabDataEntry.SelectedIndex == 3)
                    refresh_data_entry_cash_for_new_record();
                else if (subtabDataEntry.SelectedIndex == 4)
                    refresh_data_entry_journal_for_new_record();
            }
            else if (maintab.SelectedIndex == 2)
            {
                if (subtabMasters.SelectedIndex == 0)
                {
                    tbDesc.Text = "";
                    refresh_master_account();
                    if (cbParent.SelectedItem.Equals("INVESTMENTS"))
                    {
                        check_data_type(tbA_N.Text.Trim());
                        if (data_type == "Numeric")
                        {
                            tbA_N.Text = (Convert.ToInt32(tbA_N.Text) + 1).ToString();
                            tbDesc.Text = "";
                        }
                    }
                }
                else if (subtabMasters.SelectedIndex == 1)
                {
                    refresh_item_master();
                }
                else if (subtabMasters.SelectedIndex == 2)
                {
                    refresh_tax_master();
                }
                else if (subtabMasters.SelectedIndex == 3)
                {
                    daybooklistmastertab();
                }
                else if (subtabMasters.SelectedIndex == 4)
                {
                    create_new_period();
                }
                else if (subtabMasters.SelectedIndex == 5)
                {
                    create_new_additional();
                }
            }
            else if (maintab.SelectedIndex == 3)
            {
                tb_ledger_account_name.Text = "";
                btn_gen_ledg.Visible = false;
                LedDGV.Visible = false;
                tb_ledger_account_name.Focus();
            }
            else if (maintab.SelectedIndex == 4)
            {
                if (subtabsettings.SelectedIndex == 0)
                {
                    refresh_user_settings();
                }
                else if (subtabsettings.SelectedIndex == 2)
                {
                    comattach new_company_creation_form = new comattach();
                    new_company_creation_form.Show();
                    this.Hide();
                }
            }
            show_images();
            if (maintab.SelectedIndex != 2 && subtabMasters.SelectedIndex != 1)
                atbcancel_Click(sender, e);
            objPleaseWait.Close();
        }

        private void atbsave_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait saving data...");
            objPleaseWait.Show();
            Application.DoEvents();
            qr_image_details = null;
            if (access_line2 != null && access_line2.Length <= 2)
            {
                if (maintab.SelectedIndex == 1)
                {
                    //DATA ENTRY
                    save_data_entry();
                }
                else if (maintab.SelectedIndex == 2)
                {
                    //maintain
                    if (subtabMasters.SelectedIndex == 0)
                    {
                        save_master_account();
                    }
                    else if (subtabMasters.SelectedIndex == 1)
                    {
                        save_master_item();
                        itemlistmastertab();
                        refresh_item_master();
                    }
                    else if (subtabMasters.SelectedIndex == 2)
                    {
                        insert_master_tax();
                        taxlistmatertab();
                        refresh_tax_master();
                    }
                    else if (subtabMasters.SelectedIndex == 3)
                    {
                        insert_master_daybook_code();
                    }
                    else if (subtabMasters.SelectedIndex == 4)
                    {
                        ConnectionWithAccess.query = "select prd, [start], [end] from " + ConnectionWithAccess.tablename[50] + " where prd = '" + tbPrd.Text + "'";
                        DataTable dtData1 = ConnectionCommand.fGetDataTable();
                        if (dtData1 != null && dtData1.Rows.Count > 0)
                        {

                            if (cbprdlock.Checked == true)
                                ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[50] + " set [start] = '" + dtPrdSD.Value + "', [End] = '" + dtPrdED.Value + "', [lock] = 'Y'" + " , gp = '" + tbGP.Text + "', vat = '" + tb_vat_tax_required.Text + "', s_form = '" + tb_print_form.Text + "' where prd = '" + tbPrd.Text + "'";
                            else
                                ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[50] + " set [start] = '" + dtPrdSD.Value + "', [End] = '" + dtPrdED.Value + "', [lock] = 'N'" + " , gp = '" + tbGP.Text + "', vat = '" + tb_vat_tax_required.Text + "', s_form = '" + tb_print_form.Text + "' where prd = '" + tbPrd.Text + "'";
                            ConnectionCommand.fUpdateInsertDeleteData();
                        }
                        else
                        {

                            ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[50] + " (prd, [start], [end],  [lock], gp, vat,s_form) values('" + tbPrd.Text + "', '" + dtPrdSD.Text + "','" + dtPrdED.Text + "', '" + "N" + "', " + tbGP.Text.Trim() + " , '" + tb_vat_tax_required.Text.Trim() + "', " + tb_print_form.Text.Trim() + " )";
                            ConnectionCommand.fUpdateInsertDeleteData();
                            mtbname = ConnectionWithAccess.mNIK + "_0021";
                            ConnectionWithAccess.query = "insert into " + mtbname + " (prd,d_c,b_t,d_n,d_d,a_n) values ('" + tbPrd.Text + "', 1, '1',999999, '" + Convert.ToDateTime("01/01/1901") + "' ,'2002')";
                            ConnectionCommand.fUpdateInsertDeleteData();
                            mtbname = ConnectionWithAccess.mNIK + "_0022";
                            ConnectionWithAccess.query = "insert into " + mtbname + " (prd,d_c,b_t,d_n,d_d,a_n) values ('" + tbPrd.Text + "', 2, '1',999999, '" + Convert.ToDateTime("01/01/1901") + "' ,'4002')";
                            ConnectionCommand.fUpdateInsertDeleteData();
                            mtbname = ConnectionWithAccess.mNIK + "_0023";
                            ConnectionWithAccess.query = "insert into " + mtbname + " (prd,d_c,b_t,d_n,d_d,a_n) values ('" + tbPrd.Text + "', 3, '1',999999, '" + Convert.ToDateTime("01/01/1901") + "' ,'2011')";
                            ConnectionCommand.fUpdateInsertDeleteData();
                            mtbname = ConnectionWithAccess.mNIK + "_0024";
                            ConnectionWithAccess.query = "insert into " + mtbname + " (prd,d_c,b_t,d_n,d_d,a_n,mess) values ('" + tbPrd.Text + "', 4, '1',999999, '" + Convert.ToDateTime("01/01/1901") + "' ,'2010','2002')";
                            ConnectionCommand.fUpdateInsertDeleteData();
                            ConnectionWithAccess.query = "insert into " + mtbname + " (prd,d_c,b_t,d_n,d_d,a_n,mess) values ('" + tbPrd.Text + "', 20, '1',999999, '" + Convert.ToDateTime("01/01/1901") + "' ,'2010','2002')";
                            ConnectionCommand.fUpdateInsertDeleteData();
                            mtbname = ConnectionWithAccess.mNIK + "_0025";
                            ConnectionWithAccess.query = "insert into " + mtbname + " (prd,d_c,b_t,d_n,d_d) values ('" + tbPrd.Text + "', 5, '1',999999, '" + Convert.ToDateTime("01/01/1901") + "')";
                            ConnectionCommand.fUpdateInsertDeleteData();
                            mtbname = ConnectionWithAccess.mNIK + "_0030";
                            ConnectionWithAccess.query = "insert into " + mtbname + " (prd,d_c,b_t,d_n,d_d,a_n) values ('" + tbPrd.Text + "', 30, '1',999999, '" + Convert.ToDateTime("01/01/1901") + "' ,'2002')";
                            ConnectionCommand.fUpdateInsertDeleteData();
                        }
                        periodlistmastertab();
                    }
                    else if (subtabMasters.SelectedIndex == 5)
                    {
                        save_additional_account();
                    }
                }
                else if (maintab.SelectedIndex == 3)
                {
                    if (subtabreports.SelectedIndex == 0)
                    {
                    }
                    else if (subtabreports.SelectedIndex == 1)
                    {
                    }
                    else if (subtabreports.SelectedIndex == 2)
                    {
                        if (cbBalShPer.Text != "@")
                        {
                            save_balance_sheet_gp_values(cbBalShPer.Text);
                            calculate_closing_capital_balance_and_add_in_new_period(cbBalShPer.Text, ConnectionWithAccess.get_old_prd_name(cbBalShPer.Text));
                        }
                    }
                    else if (subtabreports.SelectedIndex == 3)
                    {
                        if (cmbDateRangeGST.Text != "Custom Range")
                        {
                            temp_word = cmbDateRangeGST.Text + " " + Convert.ToDateTime(dtp_rg_from_date.Text).Year;
                            insert_update_gst_amount_in_file(temp_word);
                        }
                    }
                }
                else if (maintab.SelectedIndex == 4 && subtabsettings.SelectedIndex == 0)
                {
                    add_update_user();
                    changestatusaspermemory();
                }
                else if (maintab.SelectedIndex == 4 && subtabsettings.SelectedIndex == 2)
                {
                    save_company_text_file();
                }
            }
            objPleaseWait.Close();
        }

        private void insert_update_gst_amount_in_file(string mperiod)
        {
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[12] + " where prd = '" + ConnectionWithAccess.mprd + "' and [month] = '" + mperiod + "'";
            ConnectionCommand.fUpdateInsertDeleteData();
            if (gst_amount_list.Count > 1)
            {
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[12] + " (PRD,[month],tax_type,sale_amt,purc_amt,bank_amt,cash_amt,jour_amt,credit_amt,debit_amt,balance_amt,[USER],insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , '" + mperiod + "' , 'IGST'," + Convert.ToDouble(gst_amount_list[10]) + " , " + Convert.ToDouble(gst_amount_list[11]) + " , " + Convert.ToDouble(gst_amount_list[12]) + " , " + Convert.ToDouble(gst_amount_list[13]) + " , " + Convert.ToDouble(gst_amount_list[14]) + " , " + Convert.ToDouble(gst_amount_list[15]) + " , " + Convert.ToDouble(gst_amount_list[16]) + " , " + Convert.ToDouble(gst_amount_list[17]) + " , '" + ConnectionWithAccess.muser + "', @currDate )";
                add_user_date_time_function_compulsory_program();
                ConnectionCommand.fUpdateInsertDeleteData();
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[12] + " (PRD,[month],tax_type,sale_amt,purc_amt,bank_amt,cash_amt,jour_amt,credit_amt,debit_amt,balance_amt,[USER],insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , '" + mperiod + "' , 'CGST'," + Convert.ToDouble(gst_amount_list[0]) + " , " + Convert.ToDouble(gst_amount_list[1]) + " , " + Convert.ToDouble(gst_amount_list[2]) + " , " + Convert.ToDouble(gst_amount_list[3]) + " , " + Convert.ToDouble(gst_amount_list[4]) + " , " + Convert.ToDouble(gst_amount_list[18]) + " , " + Convert.ToDouble(gst_amount_list[19]) + " , " + Convert.ToDouble(gst_amount_list[20]) + " , '" + ConnectionWithAccess.muser + "', @currDate )";
                add_user_date_time_function_compulsory_program();
                ConnectionCommand.fUpdateInsertDeleteData();
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[12] + " (PRD,[month],tax_type,sale_amt,purc_amt,bank_amt,cash_amt,jour_amt,credit_amt,debit_amt,balance_amt,[USER],insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , '" + mperiod + "' , 'SGST'," + Convert.ToDouble(gst_amount_list[5]) + " , " + Convert.ToDouble(gst_amount_list[6]) + " , " + Convert.ToDouble(gst_amount_list[7]) + " , " + Convert.ToDouble(gst_amount_list[8]) + " , " + Convert.ToDouble(gst_amount_list[9]) + " , " + Convert.ToDouble(gst_amount_list[21]) + " , " + Convert.ToDouble(gst_amount_list[22]) + " , " + Convert.ToDouble(gst_amount_list[23]) + " , '" + ConnectionWithAccess.muser + "', @currDate )";
                add_user_date_time_function_compulsory_program();
                ConnectionCommand.fUpdateInsertDeleteData();
            }
        }

        private void subtabDataEntry_Click(object sender, EventArgs e)
        {
            getdaybookcode();
        }

        private void subtabpurchase_Click(object sender, EventArgs e)
        {

            getdaybookcode();
        }

        private void subtabbank_Click(object sender, EventArgs e)
        {
            if (maintab.SelectedIndex == 1)
            {
                getdaybookcode();
                refresh_bank_document_number();
            }
        }

        private void PopulateSaleDetails()
        {
            if (subtabsale.SelectedIndex == 0)
            {
                sale_invoice_saved = true;
                new_sale_invoice = false;
                msalepdf = null;
                if (ConnectionWithAccess.company_details[31] == "1")
                {
                    cb_print_Tpt_copy.Visible = true;
                    cb_print_chit_copy.Visible = true;
                }
                pdf_invoice.Visible = false;
                sidocno.Text = Convert.ToString(sisalelistdg.SelectedCells[1].Value);
            }
            else if (subtabsale.SelectedIndex == 2)
            {
                sodocno.Text = Convert.ToString(sosalelistdg.SelectedCells[1].Value);
            }
            else if (subtabsale.SelectedIndex == 3)
            {
                msalepdf = null;
                if (ConnectionWithAccess.company_details[31] == "1")
                {
                    cb_print_Tpt_copy.Visible = true;
                    cb_print_chit_copy.Visible = true;
                }
                pdf_invoice.Visible = false;
                simple_docno.Text = Convert.ToString(simple_salelist.SelectedCells[1].Value);
            }
        }

        private void PopulateSale_replacement_Details()
        {
            msalepdf = null;
            if (ConnectionWithAccess.company_details[31] == "1")
            {
                cb_print_Tpt_copy.Visible = true;
                cb_print_chit_copy.Visible = true;
            }
            pdf_invoice.Visible = false;
            //srdocno.Text = Convert.ToString(sisalelistdg.SelectedCells[1].Value);
        }

        private void PopulatepurchaseDetails()
        {
            new_purc_invoice = false;
            pdf_invoice.Visible = false;
            pidatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            pidatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            pidatetime.Value = Convert.ToDateTime(pipurchaselist.SelectedCells[0].Value);
            pipartycode.Text = Convert.ToString(pipurchaselist.SelectedCells[2].Value);
            picity.Text = Convert.ToString(pipurchaselist.SelectedCells[3].Value);
            pia_n.Text = Convert.ToString(pipurchaselist.SelectedCells[7].Value);
            pis_a.Text = Convert.ToString(pipurchaselist.SelectedCells[8].Value);
            pidocno.Text = Convert.ToString(pipurchaselist.SelectedCells[1].Value);
            old_purchase_invoice_number = pidocno.Text;
            if (periodofgst == true)
                pitx_code.Visible = false;
            else
                pitx_code.Visible = true;
            //populate_screen();
            //oldpurcinvoicedetails();
            //purchase_invoice_item_filling();
        }

        private void check_for_permission_and_sale_invoice_printed()
        {
            string temp_print;
            temp_print = "N";
            ConnectionWithAccess.query = "select print from " + ConnectionWithAccess.tablename[21] + " f21 where d_n  " + (sidocno.Text.Trim() == string.Empty ? "is null" : "= " + sidocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + sidbc.Text;
            DataTable dtData1 = ConnectionCommand.fGetDataTable();

            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                    temp_print = dtData1.Rows[0][0].ToString();
            }
            if (temp_print == "Y" && !chbPriveditaccount.Checked)
            {
                sipartycode.Enabled = false;
                sidatetime.Enabled = false;
                sitransport.Enabled = false;
                sicity.Enabled = false;
                sibasicamt.Enabled = false;
                siitemlist.Enabled = false;
                sitaxcode.Enabled = false;
            }
            else
            {
                if (sid_y.Text == "")
                    sipartycode.Enabled = true;
                sidatetime.Enabled = true;
                sitransport.Enabled = true;
                sicity.Enabled = true;
                sibasicamt.Enabled = true;
                siitemlist.Enabled = true;
                sitaxcode.Enabled = true;
            }
        }

        public void invisible_all_image()
        {
            pb_common.Visible = false;
            pb_visiting_card.Visible = false;
            pb_invoice.Visible = false;
            pb_receipt.Visible = false;
            pb_personal_photo.Visible = false;
            pb_product.Visible = false;
        }

        public void clear_all_images()
        {
            if (pb_common.Image != null)
                pb_common.Image.Dispose();
            pb_common.Image = null;
            if (pb_visiting_card.Image != null)
                pb_visiting_card.Image.Dispose();
            pb_visiting_card.Image = null;
            if (pb_invoice.Image != null)
                pb_invoice.Image.Dispose();
            pb_invoice.Image = null;
            if (pb_receipt.Image != null)
                pb_receipt.Image.Dispose();
            pb_receipt.Image = null;
            if (pb_personal_photo.Image != null)
                pb_personal_photo.Image.Dispose();
            pb_personal_photo.Image = null;
            if (pb_product.Image != null)
                pb_product.Image.Dispose();
            pb_product.Image = null;

        }

        private void set_period_of_gst()
        {
            if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
            {
                if (Convert.ToDateTime(sidatetime.Text) <= Convert.ToDateTime("30/06/2017"))
                {
                    periodofgst = false;
                    sitaxcode.Enabled = true;
                    sitaxrate.Visible = true;
                    sitaxdesc.Visible = true;
                    sitaxamt.Visible = true;
                }
                else
                {
                    periodofgst = true;
                    sitaxcode.Enabled = false;
                    sitaxrate.Visible = false;
                    sitaxdesc.Visible = false;
                    sitaxamt.Visible = false;
                }
            }
            else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 1 && subtabsale.SelectedIndex == 0)
            {
                if (Convert.ToDateTime(pidatetime.Text) <= Convert.ToDateTime("30/06/2017"))
                {
                    lbl_pi_gst_tax.Visible = false;
                    tb_pi_igst_tax_amount.Visible = false;
                    periodofgst = false;
                    pitx_code.Visible = true;
                    pitaxcode.Visible = true;
                    pitaxdesc.Visible = true;
                    pitaxamt.Visible = true;
                }
                else
                {
                    lbl_pi_gst_tax.Visible = true;
                    tb_pi_igst_tax_amount.Visible = true;
                    periodofgst = true;
                    pitx_code.Visible = false;
                    pitaxcode.Visible = false;
                    pitaxdesc.Visible = false;
                    pitaxamt.Visible = false;
                }
            }
        }

        private void maintab_Click(object sender, EventArgs e)
        {
            set_period_of_gst();
            invisible_all_image();
            //btnchangeperiod.Visible = false;
            if (maintab.SelectedIndex == 0)
            {
                btnchangeperiod.Visible = true;
                current_working_tab = "0";
            }
            else if (maintab.SelectedIndex == 1)
            {
                current_working_tab = "1" + subtabsale.SelectedIndex;
                if (subtabsale.SelectedIndex == 0)
                {
                    current_working_tab = "100";
                    ConnectionWithAccess.md_y = "@@@";
                    if (chbPrivDataEntAllE.Checked)
                    {
                        ConnectionWithAccess.data_entry_working = "Sale Party";
                        sisalelistdg.Visible = true;
                        //TempAccountNameCollection();
                        getdaybookcode();

                        cb_print_Tpt_copy.Visible = false;
                        cb_print_chit_copy.Visible = false;
                    }
                    else
                    {
                        maintab.TabPages[1].Hide();
                        sisalelistdg.Visible = false;
                        sisalelistdg.Visible = false;
                    }
                }
            }
            else if (maintab.SelectedIndex == 2)
            {
                current_working_tab = "20";
                mastertab();
            }
            else if (maintab.SelectedIndex == 3)
            {
                current_working_tab = "3";
                if (chbPrivReportsE.Checked)
                {
                    current_working_tab += subtabreports.SelectedIndex;
                    //report_analysis_check_box_selected_changed();
                    //cbRepType.SelectedIndex = 0;
                    //cbRepSubType.SelectedIndex = 0;
                    if (subtabreports.SelectedIndex == 0)
                    {
                        gdvreport.Visible = true;
                        //cbRepType.SelectedIndex = 0;
                        cbrep_ana_d_c.Visible = true;
                        label253.Visible = true;
                        if (cbrep_ana_d_c.Items.Count > 0)
                            cbrep_ana_d_c.SelectedIndex = 0;
                        fPopulatecmbDateRange(cmbDateRangeANALYSIS);
                    }
                    else if (subtabreports.SelectedIndex == 1)
                        fPopulatecmbDateRange(cmbDateRangeLedger);
                    else if (subtabreports.SelectedIndex == 2)
                        cbBalShPer.Text = ConnectionWithAccess.mprd;
                    else if (subtabreports.SelectedIndex == 3)
                        fPopulatecmbDateRange(cmbDateRangeGST);
                    else if (subtabreports.SelectedIndex == 3)
                        fPopulatecmbDateRange(cmbDateRangeGST);
                    else if (subtabreports.SelectedIndex == 6)
                        fPopulatecmbDateRange(cmbDateRangeMIX);
                    else if (subtabreports.SelectedIndex == 7)
                        fPopulatecmbDateRange(cmbDateRangeOut);
                }
                else
                    maintab.TabPages[3].Hide();
            }
            else if (maintab.SelectedIndex == 4)
            {
                if (subtabsettings.SelectedIndex == 0)
                {
                    current_working_tab = "40";
                    if (chbPrivUSetngE.Checked || ConnectionWithAccess.muser == "admin")
                    {
                        refresh_UserListDG();
                        subtabsettings.TabPages[0].Visible = true;
                        if (ConnectionWithAccess.muser != "MASTER USER")
                        {
                            tbUserName.Text = ConnectionWithAccess.muser;
                            tbPassword.Text = ConnectionWithAccess.mpassword;
                            changestatusaspermemory();
                        }
                    }
                    else
                        subtabsettings.TabPages[0].Hide();
                }
                else if (subtabsettings.SelectedIndex == 1)
                {
                    if (chbPrivGSetngE.Checked || ConnectionWithAccess.muser == "admin")
                        subtabsettings.TabPages[1].Visible = true;
                    else
                        subtabsettings.TabPages[1].Hide();
                }
                else if (subtabsettings.SelectedIndex == 2)
                {
                    if (chbPrivCompInE.Checked || ConnectionWithAccess.muser == "admin")
                        subtabsettings.TabPages[2].Visible = true;
                    else
                        subtabsettings.TabPages[2].Hide();
                }
            }
            else if (maintab.SelectedIndex == 5)
            {
                current_working_tab = "50";
                if (ConnectionWithAccess.mUserFeatures.Substring(35, 1) == "Y" || ConnectionWithAccess.muser == "admin")
                {
                    maintab.TabPages[5].Visible = true;
                    sisalelistdg.Visible = false;
                    refresh_UserListDG();
                }
                else
                    maintab.TabPages[5].Hide();
            }
            //LoadImageType();
        }

        private void subtabsettings_Click(object sender, EventArgs e)
        {
            if (subtabsettings.SelectedIndex == 0 && ConnectionWithAccess.mUserFeatures.Substring(27, 1) == "Y")
            {
                bLoadUserSettingsInitial = true;
                refresh_UserListDG();
                readusersettingsfromfiletoMemory(ConnectionWithAccess.muser, ConnectionWithAccess.mpassword);
                bLoadUserSettingsInitial = false;
            }
            else if (subtabsettings.SelectedIndex == 0 && ConnectionWithAccess.mUserFeatures.Substring(28, 1) == "N")
                subtabsettings.TabPages[0].Hide();
            else if (subtabsettings.SelectedIndex == 1 && ConnectionWithAccess.mUserFeatures.Substring(29, 1) == "Y")
            {
                //    read_company_text_file();
            }
            else if (subtabsettings.SelectedIndex == 1 && ConnectionWithAccess.mUserFeatures.Substring(30, 1) == "N")
                subtabsettings.TabPages[1].Hide();
            else if (subtabsettings.SelectedIndex == 2 && ConnectionWithAccess.mUserFeatures.Substring(31, 1) == "Y")
            {
                //if (File.Exists(ConnectionWithAccess.mDataFile))
                //    read_company_text_file();
            }
            else if (subtabsettings.SelectedIndex == 2 && ConnectionWithAccess.mUserFeatures.Substring(32, 1) == "N")
                subtabsettings.TabPages[2].Hide();
        }

        private void subtabMasters_click(object sender, EventArgs e)
        {
            if (subtabMasters.SelectedIndex == 0)
                ConnectionWithAccess.data_entry_working = null;
            mastertab();
        }

        private void TabControl2_Click(object sender, EventArgs e)
        {
            mastertab();
        }
        #endregion

        #region add_dele_records
        private void add_sale_invoice_record()
        {
            if (si_frieght_amt.Text == "")
                si_frieght_amt.Text = "0.00";
            if (si_packing_amt.Text == "")
                si_packing_amt.Text = "0.00";
            if (si_insurance_amt.Text == "")
                si_insurance_amt.Text = "0.00";
            if (si_other_amt.Text == "")
                si_other_amt.Text = "0.00";
            get_account_details_from_01(sia_n.Text, sis_a.Text);
            sale_invoice_saved = true;
            if (subtabsale.SelectedIndex == 0)
            {
                if (periodofgst)
                {
                    if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[21] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt,rund_amt,gamt, tx_code, tq_cs,woodcase,tpt,billx2,lr_num,lr_date,igst_amt,freight_AMT,packing_AMT,insurance_AMT,other_AMT, [user]) values('" + ConnectionWithAccess.mprd + "' , " + sidbc.Text + " , '" + sia_n.Text + "', '" + sis_a.Text + "', '" + sid_y.Text + "', " + sidocno.Text + " , '" + sidatetime.Value.ToShortDateString() + "', " + sibasicamt.Text + " , " + siroundoffamt.Text + " , " + sigrossamt.Text + " , " + sitaxcode.Text + " , " + ConnectionWithAccess.mtq_cs + " , " + ConnectionWithAccess.mwoodcase + " , '" + sitransport.Text + "', '" + ConnectionWithAccess.mbillx2 + "', '" + sisale_lr_no.Text + "', " + dtp_sisale_lr_date.Value.ToShortDateString() + " ," + Convert.ToDouble(tb_si_igst_tax_amount.Text) + " ," + Convert.ToDouble(si_frieght_amt.Text) + " ," + Convert.ToDouble(si_packing_amt.Text) + " ," + Convert.ToDouble(si_insurance_amt.Text) + " ," + Convert.ToDouble(si_other_amt.Text) + " , '" + ConnectionWithAccess.muser + "')";
                    else
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[21] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt,rund_amt,gamt, tx_code, tq_cs,woodcase,tpt,billx2,lr_num,lr_date,CGST_AMT,SGST_AMT,freight_AMT,packing_AMT,insurance_AMT,other_AMT,mess, [user]) values('" + ConnectionWithAccess.mprd + "' , " + sidbc.Text + " , '" + sia_n.Text + "', '" + sis_a.Text + "', '" + sid_y.Text + "', " + sidocno.Text + " , '" + sidatetime.Value.ToShortDateString() + "', " + sibasicamt.Text + " , " + siroundoffamt.Text + " , " + sigrossamt.Text + " , " + sitaxcode.Text + " , " + ConnectionWithAccess.mtq_cs + " , " + ConnectionWithAccess.mwoodcase + " , '" + sitransport.Text + "', '" + ConnectionWithAccess.mbillx2 + "', '" + sisale_lr_no.Text + "', '" + dtp_sisale_lr_date.Value.ToShortDateString() + "' ," + (Convert.ToDouble(tb_si_igst_tax_amount.Text) / 2) + " ," + (Convert.ToDouble(tb_si_igst_tax_amount.Text) / 2) + " ," + Convert.ToDouble(si_frieght_amt.Text) + " ," + Convert.ToDouble(si_packing_amt.Text) + " ," + Convert.ToDouble(si_insurance_amt.Text) + " ," + Convert.ToDouble(si_other_amt.Text) + " , '" + sicomments.Text + "', '" + ConnectionWithAccess.muser + "')";
                }
                else
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[21] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt,tamt,rund_amt,gamt, tx_code, tq_cs,woodcase,tpt,billx2,lr_num,lr_date,freight_AMT,packing_AMT,insurance_AMT,other_AMT, [user]) values('" + ConnectionWithAccess.mprd + "' , " + sidbc.Text + " , '" + sia_n.Text + "', '" + sis_a.Text + "', '" + sid_y.Text + "', " + sidocno.Text + " , '" + sidatetime.Value.ToShortDateString() + "', " + sibasicamt.Text + " , " + sitaxamt.Text + " , " + siroundoffamt.Text + " , " + sigrossamt.Text + " , " + sitaxcode.Text + " , " + ConnectionWithAccess.mtq_cs + " , " + ConnectionWithAccess.mwoodcase + " , '" + sitransport.Text + "', '" + ConnectionWithAccess.mbillx2 + "', '" + sisale_lr_no.Text + "', '" + dtp_sisale_lr_date.Value.ToShortDateString() + "'," + Convert.ToDouble(si_frieght_amt.Text) + " ," + Convert.ToDouble(si_packing_amt.Text) + " ," + Convert.ToDouble(si_insurance_amt.Text) + " ," + Convert.ToDouble(si_other_amt.Text) + " ,'" + ConnectionWithAccess.muser + "')";
                add_user_date_time_function_compulsory_program();
                ConnectionCommand.fUpdateInsertDeleteData();
                for (row_pointer = 0; row_pointer < siitemlist.Rows.Count - 1; row_pointer++)
                {
                    if (siitemlist.Rows[row_pointer].Cells[7].Value != null && !string.IsNullOrEmpty(siitemlist.Rows[row_pointer].Cells[7].Value.ToString()))
                    {
                        if (siitemlist.Rows[row_pointer].Cells[3].Value == null || siitemlist.Rows[row_pointer].Cells[3].Value == System.DBNull.Value)
                            siitemlist.Rows[row_pointer].Cells[3].Value = "0";
                        if (siitemlist.Rows[row_pointer].Cells[4].Value == null || siitemlist.Rows[row_pointer].Cells[4].Value == System.DBNull.Value)
                            siitemlist.Rows[row_pointer].Cells[4].Value = "0";

                        if (periodofgst)
                        {
                            if (siitemlist.Rows[row_pointer].Cells[9].Value != null && !string.IsNullOrEmpty(siitemlist.Rows[row_pointer].Cells[9].Value.ToString()))
                            {
                                si_igst_tax_per = Convert.ToDouble(siitemlist.Rows[row_pointer].Cells[9].Value.ToString());
                                si_cgst_tax_per = si_igst_tax_per / 2;
                                si_sgst_tax_per = si_igst_tax_per / 2;
                            }
                            if (siitemlist.Rows[row_pointer].Cells[7].Value != null && !string.IsNullOrEmpty(siitemlist.Rows[row_pointer].Cells[7].Value.ToString()))
                            {
                                si_cgst_tax_amount = Convert.ToDouble(siitemlist.Rows[row_pointer].Cells[7].Value.ToString()) * si_cgst_tax_per / 100;
                                si_sgst_tax_amount = Convert.ToDouble(siitemlist.Rows[row_pointer].Cells[7].Value.ToString()) * si_sgst_tax_per / 100;
                                si_igst_tax_amount = Convert.ToDouble(siitemlist.Rows[row_pointer].Cells[7].Value.ToString()) * si_igst_tax_per / 100;
                            }
                            int hsnCode = 0;
                            int.TryParse(siitemlist.Rows[row_pointer].Cells[10].Value.ToString(), out hsnCode);
                            ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[3] + " (prd, d_c, a_n, s_a, d_n,d_d, [type], item_code,title,q_cs,box,qty,price, amount,cat,cgst_per,cgst_amt,sgst_per,sgst_amt,igst_per,igst_amt,hsn_code, [user]) values('" + ConnectionWithAccess.mprd + "' , " + sidbc.Text + " , '" + sia_n.Text + "', '" + sis_a.Text + "', " + sidocno.Text + " , '" + sidatetime.Text + "', '" + siitemlist.Rows[row_pointer].Cells[0].Value.ToString() + "', '" + siitemlist.Rows[row_pointer].Cells[1].Value.ToString() + "', '" + siitemlist.Rows[row_pointer].Cells[2].Value.ToString() + "', " + siitemlist.Rows[row_pointer].Cells[3].Value.ToString() + " , " + siitemlist.Rows[row_pointer].Cells[4].Value.ToString() + " , " + siitemlist.Rows[row_pointer].Cells[5].Value.ToString() + " , " + siitemlist.Rows[row_pointer].Cells[6].Value.ToString() + " , " + Convert.ToDouble(siitemlist.Rows[row_pointer].Cells[7].Value.ToString()) + " , '" + siitemlist.Rows[row_pointer].Cells[8].Value.ToString() + "', " + si_cgst_tax_per + " , " + si_cgst_tax_amount + " , " + si_sgst_tax_per + " , " + si_sgst_tax_amount + " , " + si_igst_tax_per + " , " + si_igst_tax_amount + " , " + hsnCode + " , '" + ConnectionWithAccess.muser + "')";
                        }
                        else
                        {
                            ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[3] + " (prd, d_c, a_n, s_a, d_n,d_d, [type], item_code,title,q_cs,box,qty,price, amount,cat, [user]) values('" + ConnectionWithAccess.mprd + "' , " + sidbc.Text + " , '" + sia_n.Text + "', '" + sis_a.Text + "', " + sidocno.Text + " , '" + sidatetime.Text + "', '" + siitemlist.Rows[row_pointer].Cells[0].Value.ToString() + "', '" + siitemlist.Rows[row_pointer].Cells[1].Value.ToString() + "', '" + siitemlist.Rows[row_pointer].Cells[2].Value.ToString() + "', " + siitemlist.Rows[row_pointer].Cells[3].Value.ToString() + " , " + siitemlist.Rows[row_pointer].Cells[4].Value.ToString() + " , " + siitemlist.Rows[row_pointer].Cells[5].Value.ToString() + " , " + siitemlist.Rows[row_pointer].Cells[6].Value.ToString() + " , " + siitemlist.Rows[row_pointer].Cells[7].Value.ToString() + " , '" + siitemlist.Rows[row_pointer].Cells[8].Value.ToString() + "', '" + ConnectionWithAccess.muser + "')";
                        }
                        add_user_date_time_function_compulsory_program();
                        ConnectionCommand.fUpdateInsertDeleteData();

                        add_item_stock_in_05_using_type_item_code(siitemlist.Rows[row_pointer].Cells[0].Value.ToString(), siitemlist.Rows[row_pointer].Cells[1].Value.ToString(), Convert.ToDouble(siitemlist.Rows[row_pointer].Cells[5].Value) * -1);
                    }
                }
            }
            else if (subtabsale.SelectedIndex == 3)
            {
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[21] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt,tamt,rund_amt,gamt, tx_code, tq_cs,woodcase,tpt,billx2,lr_num,lr_date,freight_AMT,packing_AMT,insurance_AMT,other_AMT, [user]) values('" + ConnectionWithAccess.mprd + "' , 1 , '" + simple_a_n.Text + "', '" + simple_s_a.Text + "', '@@@', " + simple_docno.Text + " , '" + simple_date.Value.ToShortDateString() + "', " + simple_grossamt.Text + " , 0 , 0 , " + simple_grossamt.Text + " , 0 , " + ConnectionWithAccess.mtq_cs + " , " + ConnectionWithAccess.mwoodcase + " , '" + sitransport.Text + "', 'N', '" + sisale_lr_no.Text + "', '" + dtp_sisale_lr_date.Value.ToShortDateString() + "'," + Convert.ToDouble(si_frieght_amt.Text) + " ," + Convert.ToDouble(si_packing_amt.Text) + " ," + Convert.ToDouble(si_insurance_amt.Text) + " ," + Convert.ToDouble(si_other_amt.Text) + " ,'" + ConnectionWithAccess.muser + "')";
                add_user_date_time_function_compulsory_program();
                ConnectionCommand.fUpdateInsertDeleteData();
                for (row_pointer = 0; row_pointer < simple_itemsalelist.Rows.Count - 1; row_pointer++)
                {
                    if (simple_itemsalelist.Rows[row_pointer].Cells[7].Value != null && !string.IsNullOrEmpty(simple_itemsalelist.Rows[row_pointer].Cells[7].Value.ToString()))
                    {
                        if (simple_itemsalelist.Rows[row_pointer].Cells[3].Value == null || simple_itemsalelist.Rows[row_pointer].Cells[3].Value == System.DBNull.Value)
                            simple_itemsalelist.Rows[row_pointer].Cells[3].Value = "0";
                        if (simple_itemsalelist.Rows[row_pointer].Cells[4].Value == null || simple_itemsalelist.Rows[row_pointer].Cells[4].Value == System.DBNull.Value)
                            simple_itemsalelist.Rows[row_pointer].Cells[4].Value = "0";
                            ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[3] + " (prd, d_c, a_n, s_a, d_n,d_d, [type], item_code,title,q_cs,box,qty,price, amount, [user]) values('" + ConnectionWithAccess.mprd + "' , 1 , '" + simple_a_n.Text + "', '" + simple_s_a.Text + "', " + simple_docno.Text + " , '" + sidatetime.Text + "', '" + simple_itemsalelist.Rows[row_pointer].Cells[0].Value.ToString() + "', '" + simple_itemsalelist.Rows[row_pointer].Cells[1].Value.ToString() + "', '" + simple_itemsalelist.Rows[row_pointer].Cells[2].Value.ToString() + "', " + simple_itemsalelist.Rows[row_pointer].Cells[3].Value.ToString() + " , " + simple_itemsalelist.Rows[row_pointer].Cells[4].Value.ToString() + " , " + simple_itemsalelist.Rows[row_pointer].Cells[5].Value.ToString() + " , " + simple_itemsalelist.Rows[row_pointer].Cells[6].Value.ToString() + " , " + simple_itemsalelist.Rows[row_pointer].Cells[7].Value.ToString() + " , '" + ConnectionWithAccess.muser + "')";
                        add_user_date_time_function_compulsory_program();
                        ConnectionCommand.fUpdateInsertDeleteData();
                    }
                }
            }

            add_amount_in_51(ConnectionWithAccess.mprd, sia_n.Text, sis_a.Text, (Convert.ToDouble(sigrossamt.Text)));
            add_amount_in_51(ConnectionWithAccess.mprd, sia_n.Text, "@@@", (Convert.ToDouble(sigrossamt.Text)));
            get_a_n_from_d_c("S", Convert.ToInt32(sidbc.Text));
            if (periodofgst)
                add_amount_in_51(ConnectionWithAccess.mprd, "6000", "@@@", (Convert.ToDouble(sigrossamt.Text)));
            else
            {
                if (sitaxamt.Text != "" || si_igst_tax_amount != 0)
                    add_amount_in_51(ConnectionWithAccess.mprd, "6000", "@@@", (Convert.ToDouble(sigrossamt.Text)));
                else
                    add_amount_in_51(ConnectionWithAccess.mprd, "6000R1", "@@@", (Convert.ToDouble(sigrossamt.Text)));
            }
            add_amount_in_51(ConnectionWithAccess.mprd, "5000", "@@@", Convert.ToDouble(sigrossamt.Text));
            add_cash_payment_in_sale_invoice();
        }

        private void delete_old_sale_invoice_record()
        {
            if (subtabsale.SelectedIndex == 0)
            {
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[21] + " where d_n  " + (sidocno.Text.Trim() == string.Empty ? "is null" : "= " + sidocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + sidbc.Text;
                ConnectionCommand.fUpdateInsertDeleteData();
                isRecord = 0;
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[3] + " where d_n " + (sidocno.Text.Trim() == string.Empty ? "is null" : "= " + sidocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + sidbc.Text;
                ConnectionCommand.fUpdateInsertDeleteData();
            }
            else if (subtabsale.SelectedIndex == 3)
            {
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[21] + " where d_n  " + (simple_docno.Text.Trim() == string.Empty ? "is null" : "= " + simple_docno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = 1";
                ConnectionCommand.fUpdateInsertDeleteData();
                isRecord = 0;
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[3] + " where d_n " + (simple_docno.Text.Trim() == string.Empty ? "is null" : "= " + simple_docno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = 1";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
            add_amount_in_51(ConnectionWithAccess.mprd, sia_n.Text, sis_a.Text, old_sale_invoice_amount * -1);
            add_amount_in_51(ConnectionWithAccess.mprd, sia_n.Text, "@@@", old_sale_invoice_amount * -1);
            //get_a_n_from_d_c("S", Convert.ToInt32(sidbc.Text));
            if (sitaxamt.Text != "")
                add_amount_in_51(ConnectionWithAccess.mprd, "6000", "@@@", (old_sale_invoice_amount * -1));
            else
                add_amount_in_51(ConnectionWithAccess.mprd, "6000R1", "@@@", (old_sale_invoice_amount * -1));
        }

        private void add_cash_payment_in_sale_invoice()
        {
            ConnectionWithAccess.cash_a_n = get_a_n_from_d_c("C", 4);
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[24] + " where d_n = " + sidocno.Text + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = 4 and r_p = '2' and d_d = @d_d_date";
            search_on_particular_date_in_select_query("@d_d_date", sidatetime.Value);
            ConnectionCommand.fUpdateInsertDeleteData();
            if (old_cash_received_against_sale_invoice > 0)
            {
                add_amount_in_51(ConnectionWithAccess.mprd, ConnectionWithAccess.cash_a_n, "@@@", Convert.ToDouble(old_cash_received_against_sale_invoice * -1));
                add_amount_in_51(ConnectionWithAccess.mprd, sia_n.Text, sis_a.Text, Convert.ToDouble(old_cash_received_against_sale_invoice * 1));
                add_amount_in_51(ConnectionWithAccess.mprd, sia_n.Text, "@@@", Convert.ToDouble(old_cash_received_against_sale_invoice * 1));
            }
            if (si_cash_received.Text != "0.00")
            {
                temp_double = Convert.ToDouble(si_cash_received.Text);
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[24] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, camt, r_p, mess, b_t) values('" + ConnectionWithAccess.mprd + "' , 4 , '" + sia_n.Text + "', '" + sis_a.Text + "', '@@@', " + sidocno.Text + " , '" + sidatetime.Value.ToShortDateString() + "', " + si_cash_received.Text + " , '2', '', '3')";
                ConnectionCommand.fUpdateInsertDeleteData();
                add_amount_in_51(ConnectionWithAccess.mprd, ConnectionWithAccess.cash_a_n, "@@@", (temp_double * 1));
                add_amount_in_51(ConnectionWithAccess.mprd, sia_n.Text, sis_a.Text, (temp_double * -1));
                add_amount_in_51(ConnectionWithAccess.mprd, sia_n.Text, "@@@", (temp_double * -1));
            }
        }

        private double get_cash_received_amount_in_sale_invoice()
        {
            temp_double = 0;
            ConnectionWithAccess.cash_a_n = get_a_n_from_d_c("C", 4);
            ConnectionWithAccess.query = "select camt from " + ConnectionWithAccess.tablename[24] + " where d_n = " + sidocno.Text + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = 4 and r_p = '2' and d_d = @d_d_date";
            search_on_particular_date_in_select_query("@d_d_date", sidatetime.Value);
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                temp_double = Convert.ToDouble(dtData1.Rows[0][0]);
            }
            return temp_double;
        }

        private void add_sale_replacement_record()
        {

            ConnectionWithAccess.query = "select d_n from " + ConnectionWithAccess.tablename[30] + " f30 where d_n  " + (srdocno.Text.Trim() == string.Empty ? "is null" : "= " + srdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + srdbc.Text;
            DataTable dtData1 = ConnectionCommand.fGetDataTable();

            if (dtData1 != null && dtData1.Rows.Count > 0)
                ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[30] + " set a_n = '" + sra_n.Text + "', s_a = '" + srs_a.Text + "', d_y = '" + srd_y.Text + "', d_d = " + srdatetime.Text + " , bamt = " + srbasicamt.Text + " ,tamt = " + srtaxamt.Text + " , gamt = " + srgrossamt.Text + " , tx_code = " + srtaxcode.Text + " , q_cs = " + ConnectionWithAccess.mtq_cs + " ,woodcase = " + ConnectionWithAccess.mwoodcase + " ,tpt = '" + srtransport.Text + "',billx2 = 0 where d_n  " + (srdocno.Text.Trim() == string.Empty ? "is null" : "= " + srdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + srdbc.Text;
            else
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[30] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt,tamt,gamt, tx_code, tq_cs,woodcase,tpt,billx2) values('" + ConnectionWithAccess.mprd + "' , " + srdbc.Text + " , '" + sra_n.Text + "', '" + srs_a.Text + "', '" + srd_y.Text + "', " + srdocno.Text + " , '" + srdatetime.Text + "', " + srbasicamt.Text + " , " + srtaxamt.Text + " , " + srgrossamt.Text + " , " + srtaxcode.Text + " , " + ConnectionWithAccess.mtq_cs + " , " + ConnectionWithAccess.mwoodcase + " , '" + srtransport.Text + "', '" + ConnectionWithAccess.mbillx2 + "')";
            ConnectionCommand.fUpdateInsertDeleteData();
            isRecord = 0;
            ConnectionWithAccess.query = "select d_n from " + ConnectionWithAccess.tablename[3] + " f3 where d_n  " + (srdocno.Text.Trim() == string.Empty ? "is null" : "= " + srdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + srdbc.Text;
            dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                isRecord = 1;
            }
            if (isRecord == 0)
            {

                for (row_pointer = 0; row_pointer < sritemlist.Rows.Count - 1; row_pointer++)
                {
                    if (sritemlist.Rows[row_pointer].Cells[3].Value == null || sritemlist.Rows[row_pointer].Cells[3].Value == System.DBNull.Value)
                        sritemlist.Rows[row_pointer].Cells[3].Value = "0";
                    if (sritemlist.Rows[row_pointer].Cells[4].Value == null || sritemlist.Rows[row_pointer].Cells[4].Value == System.DBNull.Value)
                        sritemlist.Rows[row_pointer].Cells[4].Value = "0";
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[3] + " (prd, d_c, a_n, s_a, d_n,d_d, [type], item_code,title,q_cs,box,qty,price, amount) values('" + ConnectionWithAccess.mprd + "' , " + srdbc.Text + " , '" + sra_n.Text + "', '" + srs_a.Text + "', " + srdocno.Text + " , '" + srdatetime.Text + "', '" + sritemlist.Rows[row_pointer].Cells[0].Value.ToString() + "', '" + sritemlist.Rows[row_pointer].Cells[1].Value.ToString() + "', '" + sritemlist.Rows[row_pointer].Cells[2].Value.ToString() + "', " + sritemlist.Rows[row_pointer].Cells[3].Value.ToString() + " , " + sritemlist.Rows[row_pointer].Cells[4].Value.ToString() + " , " + sritemlist.Rows[row_pointer].Cells[5].Value.ToString() + " , " + sritemlist.Rows[row_pointer].Cells[6].Value.ToString() + " , " + sritemlist.Rows[row_pointer].Cells[7].Value.ToString() + ")";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }
            add_amount_in_51(ConnectionWithAccess.mprd, sra_n.Text, srs_a.Text, (Convert.ToDouble(srgrossamt.Text) * -1));
            add_amount_in_51(ConnectionWithAccess.mprd, sra_n.Text, "@@@", (Convert.ToDouble(srgrossamt.Text) * -1));
            get_a_n_from_d_c("R", Convert.ToInt32(srdbc.Text));
            if (Convert.ToDouble(srtaxamt.Text) != 0)
                add_amount_in_51(ConnectionWithAccess.mprd, "6000", "@@@", (Convert.ToDouble(srgrossamt.Text) * -1));
            else
                add_amount_in_51(ConnectionWithAccess.mprd, "6000R1", "@@@", (Convert.ToDouble(srgrossamt.Text) * -1));
        }

        private void delete_old_sale_replacement_record()
        {

            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[30] + " where d_n  " + (srdocno.Text.Trim() == string.Empty ? "is null" : "= " + srdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + srdbc.Text;
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[3] + " where d_n " + (srdocno.Text.Trim() == string.Empty ? "is null" : "= " + srdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + srdbc.Text;
            ConnectionCommand.fUpdateInsertDeleteData();
            add_amount_in_51(ConnectionWithAccess.mprd, sra_n.Text, srs_a.Text, old_sale_invoice_amount * -1);
            add_amount_in_51(ConnectionWithAccess.mprd, sra_n.Text, "@@@", old_sale_invoice_amount * -1);
            get_a_n_from_d_c("R", Convert.ToInt32(srdbc.Text));
            if (Convert.ToDouble(srtaxamt.Text) != 0)
                add_amount_in_51(ConnectionWithAccess.mprd, "6000", "@@@", (Convert.ToDouble(srgrossamt.Text) * -1));
            else
                add_amount_in_51(ConnectionWithAccess.mprd, "6000R1", "@@@", (Convert.ToDouble(srgrossamt.Text) * -1));
        }

        private void add_sale_order_record()
        {
            isRecord = 0;
            ConnectionWithAccess.query = "select d_n from " + ConnectionWithAccess.tablename[7] + " f7 where d_n " + (sodocno.Text.Trim() == string.Empty ? "is null" : "= " + sodocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + sodbc.Text;
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                isRecord = 0;
            }

            if (isRecord == 0)
            {
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[7] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, gamt,tq_cs,tpt, [user]) values('" + ConnectionWithAccess.mprd + "' , " + sodbc.Text + " , '" + soa_n.Text + "', '" + sos_a.Text + "', '" + sod_y.Text + "', " + sodocno.Text + " , '" + sodatetime.Value.ToShortDateString() + "' , " + sogrossamt.Text + " , " + ConnectionWithAccess.mtq_cs + " , '" + sotransport.Text + "', '" + ConnectionWithAccess.muser + "')";
                add_user_date_time_function_compulsory_program();
                ConnectionCommand.fUpdateInsertDeleteData();
                for (row_pointer = 0; row_pointer < soitemlist.Rows.Count - 1; row_pointer++)
                {
                    if (soitemlist.Rows[row_pointer].Cells[7].Value != null && !string.IsNullOrEmpty(soitemlist.Rows[row_pointer].Cells[7].Value.ToString()))
                    {
                        if (soitemlist.Rows[row_pointer].Cells[3].Value == null || soitemlist.Rows[row_pointer].Cells[3].Value == System.DBNull.Value)
                            soitemlist.Rows[row_pointer].Cells[3].Value = "0";
                        if (soitemlist.Rows[row_pointer].Cells[4].Value == null || soitemlist.Rows[row_pointer].Cells[4].Value == System.DBNull.Value)
                            soitemlist.Rows[row_pointer].Cells[4].Value = "0";

                        //if (periodofgst)
                        //{
                        //    if (soitemlist.Rows[row_pointer].Cells[9].Value != null && !string.IsNullOrEmpty(soitemlist.Rows[row_pointer].Cells[9].Value.ToString()))
                        //    {
                        //        si_igst_tax_per = Convert.ToDouble(soitemlist.Rows[row_pointer].Cells[9].Value.ToString());
                        //        si_cgst_tax_per = si_igst_tax_per / 2;
                        //        si_sgst_tax_per = si_igst_tax_per / 2;
                        //    }
                        //    if (soitemlist.Rows[row_pointer].Cells[7].Value != null && !string.IsNullOrEmpty(soitemlist.Rows[row_pointer].Cells[7].Value.ToString()))
                        //    {
                        //        si_cgst_tax_amount = Convert.ToDouble(soitemlist.Rows[row_pointer].Cells[7].Value.ToString()) * si_cgst_tax_per / 100;
                        //        si_sgst_tax_amount = Convert.ToDouble(soitemlist.Rows[row_pointer].Cells[7].Value.ToString()) * si_sgst_tax_per / 100;
                        //        si_igst_tax_amount = Convert.ToDouble(soitemlist.Rows[row_pointer].Cells[7].Value.ToString()) * si_igst_tax_per / 100;
                        //    }
                        //    int hsnCode = 0;
                        //    int.TryParse(soitemlist.Rows[row_pointer].Cells[10].Value.ToString(), out hsnCode);
                        //    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[3] + " (prd, d_c, a_n, s_a, d_n,d_d, [type], item_code,title,q_cs,box,qty,price, amount,cat,cgst_per,cgst_amt,sgst_per,sgst_amt,igst_per,igst_amt,hsn_code, [user]) values('" + ConnectionWithAccess.mprd + "' , " + sidbc.Text + " , '" + sia_n.Text + "', '" + sis_a.Text + "', " + sidocno.Text + " , '" + sidatetime.Text + "', '" + soitemlist.Rows[row_pointer].Cells[0].Value.ToString() + "', '" + soitemlist.Rows[row_pointer].Cells[1].Value.ToString() + "', '" + soitemlist.Rows[row_pointer].Cells[2].Value.ToString() + "', " + soitemlist.Rows[row_pointer].Cells[3].Value.ToString() + " , " + soitemlist.Rows[row_pointer].Cells[4].Value.ToString() + " , " + soitemlist.Rows[row_pointer].Cells[5].Value.ToString() + " , " + soitemlist.Rows[row_pointer].Cells[6].Value.ToString() + " , " + Convert.ToDouble(soitemlist.Rows[row_pointer].Cells[7].Value.ToString()) + " , '" + soitemlist.Rows[row_pointer].Cells[8].Value.ToString() + "', " + si_cgst_tax_per + " , " + si_cgst_tax_amount + " , " + si_sgst_tax_per + " , " + si_sgst_tax_amount + " , " + si_igst_tax_per + " , " + si_igst_tax_amount + " , " + hsnCode + " , '" + ConnectionWithAccess.muser + "')";
                        //}
                        //else
                        //{
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[3] + " (prd, d_c, a_n, s_a, d_n,d_d, [type], item_code,title,q_cs,box,qty,price, amount,cat, [user]) values('" + ConnectionWithAccess.mprd + "' , " + sodbc.Text + " , '" + soa_n.Text + "', '" + sos_a.Text + "', " + sodocno.Text + " , '" + sodatetime.Text + "', '" + soitemlist.Rows[row_pointer].Cells[0].Value.ToString() + "', '" + soitemlist.Rows[row_pointer].Cells[1].Value.ToString() + "', '" + soitemlist.Rows[row_pointer].Cells[2].Value.ToString() + "', " + soitemlist.Rows[row_pointer].Cells[3].Value.ToString() + " , " + soitemlist.Rows[row_pointer].Cells[4].Value.ToString() + " , " + soitemlist.Rows[row_pointer].Cells[5].Value.ToString() + " , " + soitemlist.Rows[row_pointer].Cells[6].Value.ToString() + " , " + soitemlist.Rows[row_pointer].Cells[7].Value.ToString() + " , '" + soitemlist.Rows[row_pointer].Cells[8].Value.ToString() + "', '" + ConnectionWithAccess.muser + "')";
                        //}
                        add_user_date_time_function_compulsory_program();
                        ConnectionCommand.fUpdateInsertDeleteData();

                        //add_item_stock_in_05_using_type_item_code(soitemlist.Rows[row_pointer].Cells[0].Value.ToString(), soitemlist.Rows[row_pointer].Cells[1].Value.ToString(), Convert.ToDouble(soitemlist.Rows[row_pointer].Cells[5].Value) * -1);
                    }
                }
            }
        }

        private void delete_old_sale_order_record()
        {

            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[7] + " where d_n  " + (sodocno.Text.Trim() == string.Empty ? "is null" : "= " + sodocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + sodbc.Text;
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void delete_old_purc_record()
        {
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[22] + " where d_n " + (old_purchase_invoice_number.Trim() == string.Empty ? "is null" : "= " + old_purchase_invoice_number.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(pidbc.Text) + " and a_n = '" + pia_n.Text + "' and s_a = '" + pis_a.Text + "'";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[3] + " where d_n " + (old_purchase_invoice_number.Trim() == string.Empty ? "is null" : "= " + old_purchase_invoice_number.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(pidbc.Text) + " and a_n = '" + pia_n.Text + "' and s_a = '" + pis_a.Text + "'";
            ConnectionCommand.fUpdateInsertDeleteData();
            add_amount_in_51(ConnectionWithAccess.mprd, pia_n.Text, pis_a.Text, old_purchase_invoice_amount);
            add_amount_in_51(ConnectionWithAccess.mprd, pia_n.Text, "@@@", old_purchase_invoice_amount);
            add_amount_in_51(ConnectionWithAccess.mprd, "7000", "@@@", old_purchase_invoice_amount * -1);
            add_amount_in_51(ConnectionWithAccess.mprd, "5000", "@@@", old_purchase_invoice_amount);
        }

        private void add_purc_record()
        {
            if (pi_frieght_amt.Text == "")
                pi_frieght_amt.Text = "0.00";
            if (pi_packing_amt.Text == "")
                pi_packing_amt.Text = "0.00";
            if (pi_insurance_amt.Text == "")
                pi_insurance_amt.Text = "0.00";
            if (pi_other_amt.Text == "")
                pi_other_amt.Text = "0.00";
            if (pitx_code.Text == "")
                pitx_code.Text = "0";
            get_account_details_from_01(pia_n.Text, pis_a.Text);
            ConnectionWithAccess.query = "select d_n from " + ConnectionWithAccess.tablename[22] + " f22 where d_n " + (pidocno.Text.Trim() == string.Empty ? "is null" : "= " + pidocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(pidbc.Text) + " and a_n = '" + pia_n.Text + "' and s_a = '" + pis_a.Text + "'";
            DataTable dtdata1 = ConnectionCommand.fGetDataTable();

            if (dtdata1 != null && dtdata1.Rows.Count > 0)
            {
                if (periodofgst)
                {
                    if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                        ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[22] + " set a_n = '" + pia_n.Text + "', s_a = '" + pis_a.Text + "', d_d = " + pidatetime.Value.ToShortDateString() + " , bamt = " + pibasicamt.Text + " , gamt = " + pigrossamt.Text + " , tx_code = " + pitaxcode.Text + " , q_cs = " + ConnectionWithAccess.mtq_cs + " , tpt = '" + pitransport.Text + "', igst_amt = " + (Convert.ToInt32(tb_pi_igst_tax_amount.Text)) + " where d_n " + (pidocno.Text.Trim() == string.Empty ? "is null" : "= " + pidocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(pidbc.Text) + " and a_n = '" + pia_n.Text + "' and s_a = '" + pis_a.Text + "'";
                    else
                        ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[22] + " set a_n = '" + pia_n.Text + "', s_a = '" + pis_a.Text + "', d_d = " + pidatetime.Value.ToShortDateString() + " , bamt = " + pibasicamt.Text + " , gamt = " + pigrossamt.Text + " , tx_code = " + pitaxcode.Text + " , q_cs = " + ConnectionWithAccess.mtq_cs + " , tpt = '" + pitransport.Text + "', CGST_AMT = " + (Convert.ToInt32(tb_pi_igst_tax_amount.Text) / 2) + " , SGST_AMT = " + (Convert.ToInt32(tb_pi_igst_tax_amount.Text) / 2) + " where d_n " + (pidocno.Text.Trim() == string.Empty ? "is null" : "= " + pidocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(pidbc.Text) + " and a_n = '" + pia_n.Text + "' and s_a = '" + pis_a.Text + "'";
                }
                else
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[22] + " set a_n = '" + pia_n.Text + "', s_a = '" + pis_a.Text + "', d_d = " + pidatetime.Value.ToShortDateString() + " , bamt = " + pibasicamt.Text + " ,tamt = " + pitaxamt.Text + " , gamt = " + pigrossamt.Text + " , tx_code = " + pitaxcode.Text + " , q_cs = " + ConnectionWithAccess.mtq_cs + " ,woodcase = " + ConnectionWithAccess.mwoodcase + " ,tpt = '" + pitransport.Text + "',billx2 = '0' where where d_n " + (pidocno.Text.Trim() == string.Empty ? "is null" : "= " + pidocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(pidbc.Text) + " and a_n = '" + pia_n.Text + "' and s_a = '" + pis_a.Text + "'";
            }
            else
            {
                if (periodofgst)
                {
                    if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[22] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt,tamt,rund_amt,gamt, tx_code, tq_cs,woodcase,tpt,b_t,igst_amt,freight_AMT,packing_AMT,insurance_AMT,other_AMT) values('" + ConnectionWithAccess.mprd + "' , " + pidbc.Text + " , '" + pia_n.Text + "', '" + pis_a.Text + "', '" + ConnectionWithAccess.md_y + "', " + pidocno.Text + " , '" + pidatetime.Value.ToShortDateString() + "', " + pibasicamt.Text + " , " + pitaxamt.Text + " , " + piroundoffamt.Text + " , " + pigrossamt.Text + " , " + pitx_code.Text + " , " + ConnectionWithAccess.mtq_cs + " , " + ConnectionWithAccess.mwoodcase + " , '" + pitransport.Text + "','1'," + Convert.ToDouble(tb_pi_igst_tax_amount.Text) + " ," + Convert.ToDouble(pi_frieght_amt.Text) + " ," + Convert.ToDouble(pi_packing_amt.Text) + " ," + Convert.ToDouble(pi_insurance_amt.Text) + " ," + Convert.ToDouble(pi_other_amt.Text) + ")";
                    else
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[22] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt,tamt,rund_amt,gamt, tx_code, tq_cs,woodcase,tpt,b_t,CGST_AMT,SGST_AMT,freight_AMT,packing_AMT,insurance_AMT,other_AMT) values('" + ConnectionWithAccess.mprd + "' , " + pidbc.Text + " , '" + pia_n.Text + "', '" + pis_a.Text + "', '" + ConnectionWithAccess.md_y + "', " + pidocno.Text + " , '" + pidatetime.Value.ToShortDateString() + "', " + pibasicamt.Text + " , " + pitaxamt.Text + " , " + piroundoffamt.Text + " , " + pigrossamt.Text + " , " + pitx_code.Text + " , " + ConnectionWithAccess.mtq_cs + " , " + ConnectionWithAccess.mwoodcase + " , '" + pitransport.Text + "','1'," + (Convert.ToDouble(tb_pi_igst_tax_amount.Text) / 2) + " ," + (Convert.ToDouble(tb_pi_igst_tax_amount.Text) / 2) + " ," + Convert.ToDouble(pi_frieght_amt.Text) + " ," + Convert.ToDouble(pi_packing_amt.Text) + " ," + Convert.ToDouble(pi_insurance_amt.Text) + " ," + Convert.ToDouble(pi_other_amt.Text) + ")";
                }
                else
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[22] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt,tamt,rund_amt,gamt, tx_code, tq_cs,woodcase,tpt,b_t,freight_AMT,packing_AMT,insurance_AMT,other_AMT) values('" + ConnectionWithAccess.mprd + "' , " + pidbc.Text + " , '" + pia_n.Text + "', '" + pis_a.Text + "', '" + ConnectionWithAccess.md_y + "', " + pidocno.Text + " , '" + pidatetime.Value.ToShortDateString() + "', " + pibasicamt.Text + " , " + pitaxamt.Text + " , " + piroundoffamt.Text + " , " + pigrossamt.Text + " , " + pitx_code.Text + " , " + ConnectionWithAccess.mtq_cs + " , " + ConnectionWithAccess.mwoodcase + " , '" + pitransport.Text + "','1'" + " ," + Convert.ToDouble(pi_frieght_amt.Text) + " ," + Convert.ToDouble(pi_packing_amt.Text) + " ," + Convert.ToDouble(pi_insurance_amt.Text) + " ," + Convert.ToDouble(pi_other_amt.Text) + ")";
            }
            ConnectionCommand.fUpdateInsertDeleteData();

            for (row_pointer = 0; row_pointer < piitemlist.Rows.Count - 1; row_pointer++)
            {
                if (piitemlist.Rows[row_pointer].Cells[7].Value != null && !string.IsNullOrEmpty(piitemlist.Rows[row_pointer].Cells[7].Value.ToString()))
                {
                    if (Convert.ToDouble(piitemlist.Rows[row_pointer].Cells[7].Value.ToString()) > 0)
                    {
                        if (piitemlist.Rows[row_pointer].Cells[3].Value == null || piitemlist.Rows[row_pointer].Cells[3].Value == System.DBNull.Value)
                            piitemlist.Rows[row_pointer].Cells[3].Value = "0";
                        if (piitemlist.Rows[row_pointer].Cells[4].Value == null || piitemlist.Rows[row_pointer].Cells[4].Value == System.DBNull.Value)
                            piitemlist.Rows[row_pointer].Cells[4].Value = "0";
                        if (periodofgst)
                        {
                            pi_igst_tax_per = Convert.ToDouble(piitemlist.Rows[row_pointer].Cells[9].Value.ToString());
                            pi_cgst_tax_per = pi_igst_tax_per / 2;
                            pi_sgst_tax_per = pi_igst_tax_per / 2;
                            pi_cgst_tax_amount = Convert.ToDouble(piitemlist.Rows[row_pointer].Cells[7].Value.ToString()) * pi_cgst_tax_per / 100;
                            pi_sgst_tax_amount = Convert.ToDouble(piitemlist.Rows[row_pointer].Cells[7].Value.ToString()) * pi_sgst_tax_per / 100;
                            pi_igst_tax_amount = Convert.ToDouble(piitemlist.Rows[row_pointer].Cells[7].Value.ToString()) * pi_igst_tax_per / 100;
                            ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[3] + " (prd, d_c, a_n, s_a, d_n,d_d, [type], item_code,title,q_cs,box,qty,price, amount,cat,cgst_per,cgst_amt,sgst_per,sgst_amt,igst_per,igst_amt,hsn_code) values('" + ConnectionWithAccess.mprd + "' , " + pidbc.Text + " , '" + pia_n.Text + "', '" + pis_a.Text + "', " + pidocno.Text + " , '" + pidatetime.Text + "', '" + piitemlist.Rows[row_pointer].Cells[0].Value.ToString() + "', '" + piitemlist.Rows[row_pointer].Cells[1].Value.ToString() + "', '" + piitemlist.Rows[row_pointer].Cells[2].Value.ToString() + "', " + piitemlist.Rows[row_pointer].Cells[3].Value.ToString() + " , " + piitemlist.Rows[row_pointer].Cells[4].Value.ToString() + " , " + piitemlist.Rows[row_pointer].Cells[5].Value.ToString() + " , " + piitemlist.Rows[row_pointer].Cells[6].Value.ToString() + " , " + Convert.ToDouble(piitemlist.Rows[row_pointer].Cells[7].Value.ToString()) + " , '" + piitemlist.Rows[row_pointer].Cells[8].Value.ToString() + "', " + pi_cgst_tax_per + " , " + pi_cgst_tax_amount + " , " + pi_sgst_tax_per + " , " + pi_sgst_tax_amount + " , " + pi_igst_tax_per + " , " + pi_igst_tax_amount + " , " + piitemlist.Rows[row_pointer].Cells[10].Value.ToString() + ")";
                        }
                        else
                            ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[3] + " (prd, d_c, a_n, s_a, d_n,d_d, [type], item_code,title,q_cs,box,qty,price, amount,cat) values('" + ConnectionWithAccess.mprd + "' , " + pidbc.Text + " , '" + pia_n.Text + "', '" + pis_a.Text + "', " + pidocno.Text + " , '" + pidatetime.Text + "', '" + piitemlist.Rows[row_pointer].Cells[0].Value.ToString() + "', '" + piitemlist.Rows[row_pointer].Cells[1].Value.ToString() + "', '" + piitemlist.Rows[row_pointer].Cells[2].Value.ToString() + "', " + piitemlist.Rows[row_pointer].Cells[3].Value.ToString() + " , " + piitemlist.Rows[row_pointer].Cells[4].Value.ToString() + " , " + piitemlist.Rows[row_pointer].Cells[5].Value.ToString() + " , " + piitemlist.Rows[row_pointer].Cells[6].Value.ToString() + " , " + piitemlist.Rows[row_pointer].Cells[7].Value.ToString() + " , '" + piitemlist.Rows[row_pointer].Cells[8].Value.ToString() + "')";
                        ConnectionCommand.fUpdateInsertDeleteData();
                        add_item_stock_in_05_using_type_item_code(piitemlist.Rows[row_pointer].Cells[0].Value.ToString(), piitemlist.Rows[row_pointer].Cells[1].Value.ToString(), Convert.ToDouble(piitemlist.Rows[row_pointer].Cells[5].Value));
                    }
                }
            }
            add_amount_in_51(ConnectionWithAccess.mprd, pia_n.Text, pis_a.Text, Convert.ToDouble(pigrossamt.Text) * -1);
            add_amount_in_51(ConnectionWithAccess.mprd, pia_n.Text, "@@@", Convert.ToDouble(pigrossamt.Text) * -1);
            add_amount_in_51(ConnectionWithAccess.mprd, "7000", "@@@", Convert.ToDouble(pigrossamt.Text));
            add_amount_in_51(ConnectionWithAccess.mprd, "5000", "@@@", (Convert.ToDouble(pigrossamt.Text) * -1));
        }

        private void add_user_date_time_function_compulsory_program()
        {
            List<ConnectionWithAccess.QueryParams> objParams = new List<ConnectionWithAccess.QueryParams>();
            ConnectionWithAccess.QueryParams ParamFrom = new ConnectionWithAccess.QueryParams();
            ParamFrom.paramName = "@currDate";
            ParamFrom.paramValue = DateTime.Today;
            objParams.Add(ParamFrom);

            ConnectionWithAccess.QueryParamList = objParams;
        }

        private void add_bank_record()
        {
            // r_p - 1 "Cash Deposit"
            //r_p = 2 Receipt
            //r_p = 3 cash withdrawal
            // r_p = 4 payment
            // b_t = 2 for balance, b_t = 3 for passed, b_t = 4 for failed.
            //temp_word = bddatetime.Value.Year.ToString();
            //temp_word += bddatetime.Value.Month.ToString();
            //temp_word += bddatetime.Value.Date.ToString();
            //temp_word += bddocno.Text.Trim();
            //bddocno.Text = temp_word;
            isRecord = 0;
            if (isRecord == 0)
            {
                if (subtabbank.SelectedIndex == 0)
                {
                    if (cbchqbank.Text != "")
                        update_bank_name(bra_n.Text, brs_a.Text, cbchqbank.Text);
                    if (brchkstatus.SelectedIndex == 1)
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[23] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt, r_p, mess, bank, ck_no, ck_dt, b_T, pass_date,tran_d_c, [user], insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , " + Convert.ToInt32(brdbc.Text) + " , '" + bra_n.Text + "', '" + brs_a.Text + "', '@@@', " + brdocno.Text + " , '" + brdatetime.Text + "', " + bramt.Text + " , '2', '" + brcomm.Text + "', '" + cbchqbank.Text + "', " + brchkno.Text + " , " + brchkdate.Text + " , '3', '" + brpassdate.Text + "',0, '" + ConnectionWithAccess.muser + "', @currDate )";
                    else if (brchkstatus.SelectedIndex == 0)
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[23] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt, r_p, mess, bank, ck_no, ck_dt, b_t,tran_d_c, [user], insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , " + Convert.ToInt32(brdbc.Text) + " , '" + bra_n.Text + "', '" + brs_a.Text + "', '@@@', " + brdocno.Text + " , '" + brdatetime.Text + "', " + bramt.Text + " , '2', '" + brcomm.Text + "', '" + cbchqbank.Text + "', " + brchkno.Text + " , '" + brchkdate.Text + "', '2',0, '" + ConnectionWithAccess.muser + "', @currDate )";
                    else if (brchkstatus.SelectedIndex == 2)
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[23] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt, r_p, mess, bank, ck_no, ck_dt, b_t,tran_d_c, [user], insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , " + Convert.ToInt32(brdbc.Text) + " , '" + bra_n.Text + "', '" + brs_a.Text + "', '@@@', " + brdocno.Text + " , '" + brdatetime.Text + "', " + bramt.Text + " , '2', '" + brcomm.Text + "', '" + cbchqbank.Text + "', " + brchkno.Text + " , '" + brchkdate.Text + "', '4',0, '" + ConnectionWithAccess.muser + "', @currDate )";
                }
                else if (subtabbank.SelectedIndex == 1)
                {
                    if (cbchqbank.Text != "")
                        update_bank_name(bpa_n.Text, bps_a.Text, cbchqbank.Text);
                    add_bank_gst_taxes();
                    if (bpchkstatus.SelectedIndex == 1)
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[23] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt, r_p, mess, bank, ck_no, ck_dt, b_T, pass_date,igst_amt,tran_d_c, [user], insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , " + Convert.ToInt32(bpdbc.Text) + " , '" + bpa_n.Text + "', '" + bps_a.Text + "', '@@@', " + bpdocno.Text + " , '" + bpdatetime.Text + "', " + (Convert.ToDouble(bpamt.Text) * -1) + " , '4', '" + bpcomm.Text + "', '" + cbchqbank.Text + "', " + bpchkno.Text + " , '" + bpchkdate.Text + "', '3', '" + bppassdate.Text + "', " + (Convert.ToDouble(bpamt.Text) * 1) + " ,0, '" + ConnectionWithAccess.muser + "', @currDate )";
                    else if (bpchkstatus.SelectedIndex == 0)
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[23] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt, r_p, mess, bank, ck_no, ck_dt, b_t, pass_date,igst_per,igst_amt,basic_amt,tran_d_c, [user], insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , " + Convert.ToInt32(bpdbc.Text) + " , '" + bpa_n.Text + "', '" + bps_a.Text + "', '@@@', " + bpdocno.Text + " , '" + bpdatetime.Text + "', " + (Convert.ToDouble(bpamt.Text) * -1) + " , '4', '" + bpcomm.Text + "', '" + cbchqbank.Text + "', " + bpchkno.Text + " , '" + bpchkdate.Text + "', '2', '" + bppassdate.Text + "', " + bp_igst_per.Text + " , " + bp_igstamt.Text + " , " + bp_basicamt.Text + " ,0, '" + ConnectionWithAccess.muser + "', @currDate )";
                    else if (bpchkstatus.SelectedIndex == 2)
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[23] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt, r_p, mess, bank, ck_no, ck_dt, b_t, pass_date,igst_per,igst_amt,basic_amt,tran_d_c, [user], insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , " + Convert.ToInt32(bpdbc.Text) + " , '" + bpa_n.Text + "', '" + bps_a.Text + "', '@@@', " + bpdocno.Text + " , '" + bpdatetime.Text + "', " + (Convert.ToDouble(bpamt.Text) * -1) + " , '4', '" + bpcomm.Text + "', '" + cbchqbank.Text + "', " + bpchkno.Text + " , '" + bpchkdate.Text + "', '4', '" + bppassdate.Text + "', " + bp_igst_per.Text + " , " + bp_igstamt.Text + " , " + bp_basicamt.Text + " ,0, '" + ConnectionWithAccess.muser + "', @currDate )";
                }
                else if (subtabbank.SelectedIndex == 2)
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[23] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt, r_p, mess, b_T, pass_date,tran_d_c, [user], insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , " + Convert.ToInt32(bddbc.Text) + " , '7999', 'DEP', '', " + bddocno.Text + " , '" + bddatetime.Text + "', " + bdamt.Text + " , '1', '" + bdcomm.Text + "', '3', '" + bddatetime.Text + "',0, '" + ConnectionWithAccess.muser + "', @currDate )";
                else if (subtabbank.SelectedIndex == 3)
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[23] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, bamt, r_p, mess, b_T, pass_date,tran_d_c, [user], insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , " + Convert.ToInt32(bwdbc.Text) + " , '7999', 'WIT', '', " + bwdocno.Text + " , '" + bwdatetime.Text + "', " + (Convert.ToDouble(bwamt.Text) * -1) + " , '3', '" + bwcomm.Text + "', '3', '" + bwdatetime.Text + "',0, '" + ConnectionWithAccess.muser + "', @currDate )";
                else if (subtabbank.SelectedIndex == 4)
                {
                    tb_tr_to_bank.Text = get_account_name_from_d_c("B", Convert.ToInt32(cb_tr_to_dc.Text));
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[23] + " (prd, d_c, a_n, s_a, d_y,d_n,d_d, bamt, r_p, mess, b_T, pass_date, tran_d_c, [user], insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , " + cb_tr_from_dc.SelectedItem.ToString() + " , '" + btfroma_n.Text + "', '@@@', '', " + tr_docno.Text + " , '" + tr_datetime.Text + "', " + (Convert.ToDouble(tr_amt.Text) * -1) + " , '4', '" + tr_comm.Text + "', '3', '" + tr_datetime.Text + "', " + cb_tr_to_dc.SelectedItem.ToString() + " , '" + ConnectionWithAccess.muser + "', @currDate )";
                }
                add_user_date_time_function_compulsory_program();
                ConnectionCommand.fUpdateInsertDeleteData();
            }
            if (subtabbank.SelectedIndex == 2 || subtabbank.SelectedIndex == 3)
            {
                isRecord = 0;
                if (subtabbank.SelectedIndex == 2)
                    ConnectionWithAccess.query = "select d_n from " + ConnectionWithAccess.tablename[24] + " where d_n " + (bddocno.Text.Trim() == string.Empty ? "is null" : "= " + bddocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(bddbc.Text) + " and r_p = '1' and a_n = '7999' and s_a = 'DEP'";
                else if (subtabbank.SelectedIndex == 3)
                    ConnectionWithAccess.query = "select d_n from " + ConnectionWithAccess.tablename[24] + " where d_n " + (bwdocno.Text.Trim() == string.Empty ? "is null" : "= " + bwdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(bwdbc.Text) + " and r_p = '3' and a_n = '7999' and s_a = 'WIT'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    isRecord = 1;
                }
                if (isRecord == 0)
                {
                    if (subtabbank.SelectedIndex == 2)
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[24] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, camt, r_p, mess, b_T, [user], insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , 4, '7999', 'WIT', '', " + bddocno.Text + " , '" + bddatetime.Text + "', " + (Convert.ToDouble(bdamt.Text) * -1) + " , '3', '" + bdcomm.Text + "', '3', '" + ConnectionWithAccess.muser + "', @currDate )";
                    else if (subtabbank.SelectedIndex == 3)
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[24] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, camt, r_p, mess, b_T, [user], insert_dt_tm) values('" + ConnectionWithAccess.mprd + "' , 4, '7999', 'DEP', '', " + bwdocno.Text + " , '" + bwdatetime.Text + "', " + bwamt.Text + " , '1', '" + bwcomm.Text + "', '3', '" + ConnectionWithAccess.muser + "', @currDate )";

                    //List<ConnectionWithAccess.QueryParams> objParams = new List<ConnectionWithAccess.QueryParams>();
                    //ConnectionWithAccess.QueryParams ParamFrom = new ConnectionWithAccess.QueryParams();
                    //ParamFrom.paramName = "@currDate";
                    //ParamFrom.paramValue = DateTime.Today;
                    //objParams.Add(ParamFrom);
                    //ConnectionWithAccess.QueryParamList = objParams;
                    add_user_date_time_function_compulsory_program();
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
                if (subtabbank.SelectedIndex == 0)
                    add_amount_in_51(ConnectionWithAccess.mprd, get_a_n_from_d_c("B", Convert.ToInt32(brdbc.Text)), "@@@", (Convert.ToDouble(bramt.Text) * 1));
                else if (subtabbank.SelectedIndex == 1)
                    add_amount_in_51(ConnectionWithAccess.mprd, get_a_n_from_d_c("B", Convert.ToInt32(bpdbc.Text)), "@@@", (Convert.ToDouble(bpamt.Text) * -1));
                else if (subtabbank.SelectedIndex == 2)
                {
                    add_amount_in_51(ConnectionWithAccess.mprd, get_a_n_from_d_c("B", Convert.ToInt32(bddbc.Text)), "@@@", (Convert.ToDouble(bdamt.Text) * 1));
                    add_amount_in_51(ConnectionWithAccess.mprd, "2010", "@@@", (Convert.ToDouble(bdamt.Text) * -1));
                    bdcurbankbal.Text = Convert.ToString(get_cash_balance(ConnectionWithAccess.cash_a_n, "@@@", DateTime.Today.ToShortDateString()));
                    bdcurcashbal.Text = Convert.ToString(get_cash_balance("2010", "@@@", DateTime.Today.ToShortDateString()));
                }
                else if (subtabbank.SelectedIndex == 3)
                {
                    add_amount_in_51(ConnectionWithAccess.mprd, bwa_n.Text, "@@@", (Convert.ToDouble(bwamt.Text) * -1));
                    add_amount_in_51(ConnectionWithAccess.mprd, "2010", "@@@", (Convert.ToDouble(bwamt.Text) * 1));
                    bwcurbankbal.Text = Convert.ToString(get_bank_balance(bwa_n.Text, "@@@", DateTime.Today.ToShortDateString()));
                    bwcurcashbal.Text = Convert.ToString(get_cash_balance("2010", "@@@", DateTime.Today.ToShortDateString()));
                }
            }
        }

        private void add_bank_gst_taxes()
        {
            for (row_counter = 0; row_counter < bp_dgv_gst_tax_brief.Rows.Count - 1; row_counter++)
            {
                if (bp_dgv_gst_tax_brief.Rows[row_counter].Cells[3].Value != null && bp_dgv_gst_tax_brief.Rows[row_counter].Cells[3].Value.ToString() != "0.00")
                {
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[08] + " (book,prd,d_c,d_n,d_d,a_n,s_a,r_p,bamt,IGST_PER,IGST_AMT,GAMT,[user],insert_dt_tm) values('B','" + ConnectionWithAccess.mprd + "'," + bpdbc.Text + " ,'" + bpdocno.Text + "'," + bpdatetime.Value.ToShortDateString() + " ,'" + bpa_n.Text + "', '" + bps_a.Text + "','4', " + bp_dgv_gst_tax_brief.Rows[row_counter].Cells[0].Value + " ," + bp_dgv_gst_tax_brief.Rows[row_counter].Cells[1].Value + " ," + bp_dgv_gst_tax_brief.Rows[row_counter].Cells[2].Value + " ," + bp_dgv_gst_tax_brief.Rows[row_counter].Cells[3].Value + " ,'" + ConnectionWithAccess.muser + "', @currDate )";
                    add_user_date_time_function_compulsory_program();
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }
        }

        private void update_bank_name(string ma_n, string ms_a, string mbankname)
        {
            get_account_details_from_04(ma_n, ms_a);
            if (account_detail_from_04[9] == "")
            {
                ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[04] + " set BANK_NAM = '" + mbankname + "' where a_n = '" + ma_n + "' and s_a = '" + ms_a + "'";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
        }

        private void delete_old_bank_record()
        {
            //r_p = 1 "Cash Deposit"
            //r_p = 2 Receipt
            //r_p = 3 cash withdrawal
            //r_p = 4 payment
            if (subtabbank.SelectedIndex == 0 && old_bank_receipt_amount != 0)
            {
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[23] + " where d_n  " + (brdocno.Text.Trim() == string.Empty ? "is null" : "= " + brdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(brdbc.Text) + " and r_p = '2'";
                ConnectionCommand.fUpdateInsertDeleteData();
                get_account_name_from_d_c("B", Convert.ToInt32(brdbc.Text));
                add_amount_in_51(ConnectionWithAccess.mprd, ConnectionWithAccess.bank_a_n, "@@@", Convert.ToDouble(old_bank_receipt_amount * -1));
                brcurbankbal.Text = Convert.ToString(get_cash_balance(ConnectionWithAccess.cash_a_n, "@@@", DateTime.Today.ToShortDateString()));
            }
            else if (subtabbank.SelectedIndex == 1 && old_bank_payment_amount != 0)
            {
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[23] + " where d_n  " + (bpdocno.Text.Trim() == string.Empty ? "is null" : "= " + bpdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(bpdbc.Text) + " and r_p = '4'";
                ConnectionCommand.fUpdateInsertDeleteData();
                get_account_name_from_d_c("B", Convert.ToInt32(bpdbc.Text));
                add_amount_in_51(ConnectionWithAccess.mprd, ConnectionWithAccess.bank_a_n, "@@@", (Convert.ToDouble(old_bank_payment_amount) * -1));
                bpcurbankbal.Text = Convert.ToString(get_bank_balance(ConnectionWithAccess.bank_a_n, "@@@", DateTime.Today.ToShortDateString()));
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[08] + " where book = 'B' and prd = '" + ConnectionWithAccess.mprd + "' and d_n  " + (bpdocno.Text.Trim() == string.Empty ? "is null" : "= " + bpdocno.Text.Trim()) + " and d_c = " + Convert.ToInt32(bpdbc.Text) + " and r_p = '4'";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
            else if (subtabbank.SelectedIndex == 2 && old_bank_deposit_amount != 0)
            {
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[23] + " where d_n  " + (bddocno.Text.Trim() == string.Empty ? "is null" : "= " + bddocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(bddbc.Text) + " and r_p = '1'";
                ConnectionCommand.fUpdateInsertDeleteData();
                get_account_name_from_d_c("B", Convert.ToInt32(bddbc.Text));
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[24] + " where d_n  " + (ConnectionWithAccess.md_n.Trim() == string.Empty ? "is null" : "= " + ConnectionWithAccess.md_n.Trim()) + " and d_d = #" + bddatetime.Text + "# and prd = '" + ConnectionWithAccess.mprd + "' and d_c = 4 and r_p = '3' and a_n = '7999' and s_a = 'WIT'";
                get_account_name_from_d_c("B", Convert.ToInt32(bddbc.Text));
                add_amount_in_51(ConnectionWithAccess.mprd, ConnectionWithAccess.bank_a_n, "@@@", (Convert.ToDouble(old_bank_deposit_amount) * -1));
                add_amount_in_51(ConnectionWithAccess.mprd, ConnectionWithAccess.cash_a_n, "@@@", (Convert.ToDouble(old_bank_deposit_amount) * 1));
                bdcurbankbal.Text = Convert.ToString(get_bank_balance(ConnectionWithAccess.bank_a_n, "@@@", DateTime.Today.ToShortDateString()));
                bdcurcashbal.Text = Convert.ToString(get_cash_balance(ConnectionWithAccess.cash_a_n, "@@@", DateTime.Today.ToShortDateString()));
            }
            else if (subtabbank.SelectedIndex == 3 && old_bank_withdrawal_amount != 0)
            {
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[23] + " where d_n  " + (bwdocno.Text.Trim() == string.Empty ? "is null" : "= " + bwdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(bwdbc.Text) + " and r_p = '3'";
                ConnectionCommand.fUpdateInsertDeleteData();
                get_account_name_from_d_c("B", Convert.ToInt32(bwdbc.Text));
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[24] + " where d_n  " + (ConnectionWithAccess.md_n.Trim() == string.Empty ? "is null" : "= " + ConnectionWithAccess.md_n.Trim()) + " and d_d = #" + bwdatetime.Text + "# and prd = '" + ConnectionWithAccess.mprd + "' and d_c = 4 and r_p = '1' and a_n = '7999' and s_a = 'DEP'";
                ConnectionCommand.fUpdateInsertDeleteData();
                get_account_name_from_d_c("B", Convert.ToInt32(bwdbc.Text));
                add_amount_in_51(ConnectionWithAccess.mprd, ConnectionWithAccess.bank_a_n, "@@@", (Convert.ToDouble(old_bank_withdrawal_amount) * 1));
                add_amount_in_51(ConnectionWithAccess.mprd, ConnectionWithAccess.cash_a_n, "@@@", (Convert.ToDouble(old_bank_withdrawal_amount) * -1));
                bwcurbankbal.Text = Convert.ToString(get_bank_balance(ConnectionWithAccess.bank_a_n, "@@@", DateTime.Today.ToShortDateString()));
                bwcurcashbal.Text = Convert.ToString(get_cash_balance(ConnectionWithAccess.cash_a_n, "@@@", DateTime.Today.ToShortDateString()));
            }
            else if (subtabbank.SelectedIndex == 4 && old_bank_transfer_amount != 0)
            {
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[23] + " where d_n  " + (tr_docno.Text.Trim() == string.Empty ? "is null" : "= " + tr_docno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + cb_tr_from_dc.Text + " and tran_d_c = " + cb_tr_to_dc.Text;
                ConnectionCommand.fUpdateInsertDeleteData();
            }
        }

        private void add_cash_record()
        {
            // r_p - 1 "Cash Deposit"
            //r_p = 2 Receipt
            //r_p = 3 cash withdrawal
            // r_p = 4 payment
            // b_t = 2 for balance, b_t = 3 for passed, b_t = 4 for failed.
            if (subtabcash.SelectedIndex == 0 && cramt.Text != "")
            {
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[24] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, camt, r_p, mess, b_t) values('" + ConnectionWithAccess.mprd + "' , " + crdbc.Text + " , '" + cra_n.Text + "', '" + crs_a.Text + "', '@@@', " + crdocno.Text + " , '" + crdatetime.Text + "', " + cramt.Text + " , '2', '" + crcomm.Text + "', '3')";
                ConnectionCommand.fUpdateInsertDeleteData();
                add_amount_in_51(ConnectionWithAccess.mprd, ConnectionWithAccess.cash_a_n, "@@@", (Convert.ToDouble(cramt.Text) * 1));
                if (crs_a.Text != null)
                    add_amount_in_51(ConnectionWithAccess.mprd, cra_n.Text, crs_a.Text, (Convert.ToDouble(cramt.Text) * -1));
                add_amount_in_51(ConnectionWithAccess.mprd, cra_n.Text, "@@@", (Convert.ToDouble(cramt.Text) * -1));
                crcurcashbal.Text = Convert.ToString(get_cash_balance(ConnectionWithAccess.cash_a_n, "@@@", DateTime.Today.ToShortDateString()));
            }
            else if (subtabcash.SelectedIndex == 1 && cpamt.Text != "")
            {
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[24] + " (prd, d_c, a_n, s_a, d_y, d_n,d_d, camt, r_p, mess, b_t,BASIC_AMT,IGST_PER,IGST_AMT) values('" + ConnectionWithAccess.mprd + "' , " + cpdbc.Text + " , '" + cpa_n.Text + "', '" + cps_a.Text + "', '@@@', " + cpdocno.Text + " , '" + cpdatetime.Text + "', " + (Convert.ToDouble(cpamt.Text) * -1) + " , '4', '" + cpcomm.Text + "', '3'," + cp_basicamt.Text + " , " + cp_igst_per.Text + " , " + cp_igstamt.Text + " )";
                ConnectionCommand.fUpdateInsertDeleteData();
                add_amount_in_51(ConnectionWithAccess.mprd, ConnectionWithAccess.cash_a_n, "@@@", (Convert.ToDouble(cpamt.Text) * -1));
                if (cps_a.Text != null)
                    add_amount_in_51(ConnectionWithAccess.mprd, cpa_n.Text, cps_a.Text, (Convert.ToDouble(cpamt.Text) * 1));
                add_amount_in_51(ConnectionWithAccess.mprd, cpa_n.Text, "@@@", (Convert.ToDouble(cpamt.Text) * 1));
                cpcurcashbal.Text = Convert.ToString(get_cash_balance(ConnectionWithAccess.cash_a_n, "@@@", DateTime.Today.ToShortDateString()));
            }
        }

        private void delete_old_cash_record()
        {
            // r_p = 1 "Cash Deposit"
            //r_p = 2 Receipt
            //r_p = 3 cash withdrawal
            // r_p = 4 payment
            if (subtabcash.SelectedIndex == 0)
            {
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[24] + " where d_n  " + (crdocno.Text.Trim() == string.Empty ? "is null" : "= " + crdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + crdbc.Text + " and r_p = '2' and d_d = @d_d_date";
                search_on_particular_date_in_select_query("@d_d_date", crdatetime.Value);
                ConnectionCommand.fUpdateInsertDeleteData();
                add_amount_in_51(ConnectionWithAccess.mprd, ConnectionWithAccess.cash_a_n, "@@@", Convert.ToDouble(old_cash_receipt_amount * -1));
                if (crs_a.Text != null)
                    add_amount_in_51(ConnectionWithAccess.mprd, cra_n.Text, crs_a.Text, Convert.ToDouble(old_cash_receipt_amount * 1));
                add_amount_in_51(ConnectionWithAccess.mprd, cra_n.Text, "@@@", Convert.ToDouble(old_cash_receipt_amount * 1));
            }
            else if (subtabcash.SelectedIndex == 1)
            {
                ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[24] + " F24 where f24.d_n " + (cpdocno.Text.Trim() == string.Empty ? "is null" : "= " + cpdocno.Text.Trim()) + " and f24.prd = '" + ConnectionWithAccess.mprd + "' and f24.d_c = " + cpdbc.Text + " and f24.r_p = '4' and F24.d_d = @d_d_date";
                search_on_particular_date_in_select_query("@d_d_date", cpdatetime.Value);
                ConnectionCommand.fUpdateInsertDeleteData();
                add_amount_in_51(ConnectionWithAccess.mprd, ConnectionWithAccess.cash_a_n, "@@@", (Convert.ToDouble(old_cash_payment_amount)));
                if (cpa_n.Text != null)
                    add_amount_in_51(ConnectionWithAccess.mprd, cpa_n.Text, cps_a.Text, Convert.ToDouble(old_cash_payment_amount * -1));
                add_amount_in_51(ConnectionWithAccess.mprd, cpa_n.Text, "@@@", Convert.ToDouble(old_cash_payment_amount * -1));
            }
            //r_p = '1' and a_n = '7999' and s_a = 'DEP'";
        }

        private double get_bank_balance_old(string prd, string a_n)
        {
            old_bank_balance = 0;
            ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + prd + "' and a_n = '" + a_n + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    old_bank_balance = Convert.ToDouble(dtData1.Rows[0][0].ToString());
                }
            }
            return old_bank_balance;
        }

        private double get_bank_balance(string ma_n, string ms_a, string menddateitme)
        {
            temp_double = 0;
            if (ma_n != "" && ms_a != "" && menddateitme != "")
            {
                temp_word = "";
                ConnectionWithAccess.query = query_contains_for_bank_balance_union(ma_n, ms_a, menddateitme);
                DataTable dtNewTable = ConnectionCommand.fGetDataTable();

                if (dtNewTable != null)
                {
                    if (dtNewTable.Rows.Count == 1)
                    {
                        if (dtNewTable.Rows[0][6].ToString() != "0.00")
                            temp_double = Convert.ToDouble(dtNewTable.Rows[0][6].ToString());
                        else if (dtNewTable.Rows[0][7].ToString() != "0.00")
                            temp_double = Convert.ToDouble(dtNewTable.Rows[0][7].ToString());
                        else if (dtNewTable.Rows[0][8].ToString() != "0.00")
                            temp_double = Convert.ToDouble(dtNewTable.Rows[0][8].ToString());
                    }
                    else if (dtNewTable.Rows.Count > 1)
                    {
                        DataView view = new DataView(dtNewTable);
                        view.Sort = "[d_d] asc";
                        DataTable dtNewTable1 = view.ToTable();

                        DataTable sortedTable = update_datatable_balances(dtNewTable1, 4, 5, 6);

                        string strTotalCol1 = getTotal_Datatable(sortedTable, 4);
                        string strTotalCol2 = getTotal_Datatable(sortedTable, 5);

                        if (!string.IsNullOrEmpty(strTotalCol1) && !string.IsNullOrEmpty(strTotalCol2))
                        {
                            DataRow drTotalRow = sortedTable.NewRow();
                            drTotalRow[4] = strTotalCol1;
                            drTotalRow[5] = strTotalCol2;
                            sortedTable.Rows.Add(drTotalRow);
                        }

                        if (sortedTable.Rows.Count > 2)
                        {
                            temp_double = Convert.ToDouble(sortedTable.Rows[sortedTable.Rows.Count - 2][6].ToString());
                        }
                    }
                }
            }
            return temp_double;
        }

        private string query_contains_for_bank_balance_union(string ma_n, string ms_a, string end_date)
        {
            ConnectionWithAccess.md_c = get_d_c_from_a_n("B", ma_n);
            StringBuilder strQuery = new StringBuilder();
            strQuery.Append(" select #" + ConnectionWithAccess.msdate + "# as [d_d],0 as [d_n], 'Opening Balance' as [desc], '' as [city], f51.amt as [bamt], 0 as [bamt * -1], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[51] + " f51 where f51.prd = '" + ConnectionWithAccess.moprd + "' and f51.a_n = '" + ma_n + "' and d_d = #01-01-1901# and f51.s_a = '@@@' union all ");
            strQuery.Append("select f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt, '', 0 as [balance_amt]  from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt > 0 and f23.d_c = " + ConnectionWithAccess.md_c + " and f23.a_n <> '7999' union all ");
            strQuery.Append("select f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city,  '', (f23.bamt * -1), 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt < 0 and f23.d_c = " + ConnectionWithAccess.md_c + " and f23.a_n <> '7999' union all ");
            strQuery.Append("select f23.D_D, f23.D_N, 'CASH WITHDRAWN FROM BANK' as [Desc], f1.city,'', (f23.bamt * -1), 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt < 0 and f23.d_c = " + ConnectionWithAccess.md_c + " and f23.a_n = '7999' and f23.s_a = 'WIT' union all ");
            strQuery.Append("select f23.D_D, f23.D_N, 'CASH DEPOSITED IN BANK' as [Desc], f1.city, f23.bamt,'', 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt > 0 and f23.d_c = " + ConnectionWithAccess.md_c + " and f23.a_n = '7999' and f23.s_a = 'DEP'");
            parameters_for_date_range(ConnectionWithAccess.msdate, end_date);
            //add_user_date_time_function_compulsory_program();
            return strQuery.ToString();
        }

        private double get_cash_balance_old(string prd, string a_n)
        {
            old_cash_balance = 0;
            if (a_n != "" && a_n != null)
            {
                ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + prd + "' and a_n = '" + a_n + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        old_cash_balance = Convert.ToDouble(dtData1.Rows[0][0].ToString());
                    }
                }
            }
            return old_cash_balance;
        }

        private double get_cash_balance(string ma_n, string ms_a, string menddateitme)
        {
            if (ma_n != "" && ms_a != "" && menddateitme != "")
            {
                temp_word = "";
                ConnectionWithAccess.query = query_contains_for_cash_balance_union(ma_n, ms_a, menddateitme);
                DataTable dtNewTable = ConnectionCommand.fGetDataTable();

                if (dtNewTable != null)
                {
                    if (dtNewTable.Rows.Count == 1)
                    {
                        if (dtNewTable.Rows[0][6].ToString() != "0.00")
                            temp_double = Convert.ToDouble(dtNewTable.Rows[0][6].ToString());
                        else if (dtNewTable.Rows[0][7].ToString() != "0.00")
                            temp_double = Convert.ToDouble(dtNewTable.Rows[0][7].ToString());
                        else if (dtNewTable.Rows[0][8].ToString() != "0.00")
                            temp_double = Convert.ToDouble(dtNewTable.Rows[0][8].ToString());
                    }
                    else if (dtNewTable.Rows.Count > 1)
                    {
                        DataView view = new DataView(dtNewTable);
                        view.Sort = "[d_d] asc";
                        DataTable dtNewTable1 = view.ToTable();

                        DataTable sortedTable = update_datatable_balances(dtNewTable1, 4, 5, 6);

                        string strTotalCol1 = getTotal_Datatable(sortedTable, 4);
                        string strTotalCol2 = getTotal_Datatable(sortedTable, 5);

                        if (!string.IsNullOrEmpty(strTotalCol1) && !string.IsNullOrEmpty(strTotalCol2))
                        {
                            DataRow drTotalRow = sortedTable.NewRow();
                            drTotalRow[4] = strTotalCol1;
                            drTotalRow[5] = strTotalCol2;
                            sortedTable.Rows.Add(drTotalRow);
                        }

                        if (sortedTable.Rows.Count > 2)
                        {
                            temp_double = Convert.ToDouble(sortedTable.Rows[sortedTable.Rows.Count - 2][6].ToString());
                        }
                    }
                }
            }
            return temp_double;
        }

        private string query_contains_for_cash_balance_union(string ma_n, string ms_a, string end_date)
        {
            ConnectionWithAccess.md_c = 4;
            StringBuilder strQuery = new StringBuilder();
            //strQuery.Append(" select #" + ConnectionWithAccess.msdate + "# as [d_d],0 as [d_n], 'Opening Balance' as [desc], '' as [city], f51.amt as [camt], 0 as [camt * -1], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[51] + " f51 where f51.prd = '" + ConnectionWithAccess.moprd + "' and f51.a_n = '" + raa_n.Text + "' and d_d = #01-01-1901# and f51.s_a = '@@@' ");
            strQuery.Append(" select #" + ConnectionWithAccess.msdate + "# as [d_d],0 as [d_n], 'Opening Balance' as [desc], '' as [city], f51.amt as [camt], 0 as [camt * -1], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[51] + " f51 where f51.prd = '" + ConnectionWithAccess.moprd + "' and f51.a_n = '" + ma_n + "' and d_d = #01-01-1901# and f51.s_a = '@@@' union all ");
            strQuery.Append("select f24.D_D, f24.D_N, f1.[desc] as [Desc], f1.city, f24.camt, '', 0 as [balance_amt]  from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[24] + " f24 where f1.a_n = f24.a_n and f1.s_a = f24.s_a and f24.prd = '" + ConnectionWithAccess.mprd + "' and f24.d_d >= @From and f24.d_d <= @To and f24.camt > 0 and f24.d_c = " + ConnectionWithAccess.md_c + " and f24.a_n <> '7999' union all ");
            strQuery.Append("select f24.D_D, f24.D_N, f1.[desc] as [Desc], f1.city,  '', (f24.camt * -1), 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[24] + " f24 where f1.a_n = f24.a_n and f1.s_a = f24.s_a and f24.prd = '" + ConnectionWithAccess.mprd + "' and f24.d_d >= @From and f24.d_d <= @To and f24.camt < 0 and f24.d_c = " + ConnectionWithAccess.md_c + " and f24.a_n <> '7999' union all ");
            strQuery.Append("select f23.D_D, f23.D_N, 'CASH WITHDRAWN FROM BANK' as [Desc], f1.city, (f23.bamt * -1), '', 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt < 0 and f23.a_n = '7999' and f23.s_a = 'WIT' union all ");
            strQuery.Append("select f23.D_D, f23.D_N, 'CASH DEPOSITED IN BANK' as [Desc], f1.city, '', f23.bamt, 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt > 0 and f23.a_n = '7999' and f23.s_a = 'DEP'");
            parameters_for_date_range(ConnectionWithAccess.msdate, end_date);
            //add_user_date_time_function_compulsory_program();
            return strQuery.ToString();
        }

        private void add_journal_record()
        {
            ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[25] + " (prd,d_c,d_n,d_d,a_n,s_a,na_n,ns_a,jamt,mess,igst_amt) values('" + ConnectionWithAccess.mprd + "', " + jjdbc.Text + " , " + jjdocno.Text + " , '" + jjdatetime.Value + "', '" + ja_n.Text + "', '" + js_a.Text + "', '" + jna_n.Text + "', '" + jns_a.Text + "', " + jjamt.Text + " , '" + jjcomm.Text + "', " + jjamt.Text + ")";
            ConnectionCommand.fUpdateInsertDeleteData();
            add_amount_in_51(ConnectionWithAccess.mprd, ja_n.Text, js_a.Text, (Convert.ToDouble(jjamt.Text) * 1));
            add_jour_gst_taxes();
            if (js_a.Text != "@@@")
                add_amount_in_51(ConnectionWithAccess.mprd, ja_n.Text, "@@@", (Convert.ToDouble(jjamt.Text) * 1));
            add_amount_in_51(ConnectionWithAccess.mprd, jna_n.Text, jns_a.Text, (Convert.ToDouble(jjamt.Text) * -1));
            if (jns_a.Text != "@@@")
                add_amount_in_51(ConnectionWithAccess.mprd, jna_n.Text, "@@@", (Convert.ToDouble(jjamt.Text) * -1));
            if (ja_n.Text != "")
            {
                temp_word = ja_n.Text.Substring(0, 2);
                check_data_type(temp_word);
                if (data_type == "Numeric")
                {
                    if (Convert.ToInt32(temp_word) >= 60 && Convert.ToInt32(temp_word) <= 70)
                    {
                        add_amount_in_51(ConnectionWithAccess.mprd, "719999", "@@@", (Convert.ToDouble(jjamt.Text) * -1));
                        add_amount_in_51(ConnectionWithAccess.mprd, "7998", "@@@", (Convert.ToDouble(jjamt.Text) * -1));
                        add_amount_in_51(ConnectionWithAccess.mprd, "3001", "@@@", (Convert.ToDouble(jjamt.Text) * -1));
                    }
                    else if (Convert.ToInt32(temp_word) > 70 && Convert.ToInt32(temp_word) <= 77)
                    {
                        add_amount_in_51(ConnectionWithAccess.mprd, "7998", "@@@", (Convert.ToDouble(jjamt.Text) * -1));
                        add_amount_in_51(ConnectionWithAccess.mprd, "3001", "@@@", (Convert.ToDouble(jjamt.Text) * -1));
                    }
                }
            }
            if (jna_n.Text != "")
            {
                temp_word = jna_n.Text.Substring(0, 2);
                check_data_type(temp_word);
                if (data_type == "Numeric")
                {
                    if (Convert.ToInt32(temp_word) >= 60 && Convert.ToInt32(temp_word) <= 70)
                    {
                        add_amount_in_51(ConnectionWithAccess.mprd, "719999", "@@@", (Convert.ToDouble(jjamt.Text) * 1));
                        add_amount_in_51(ConnectionWithAccess.mprd, "7998", "@@@", (Convert.ToDouble(jjamt.Text) * 1));
                        add_amount_in_51(ConnectionWithAccess.mprd, "3001", "@@@", (Convert.ToDouble(jjamt.Text) * 1));
                    }
                    else if (Convert.ToInt32(temp_word) > 70 && Convert.ToInt32(temp_word) <= 77)
                    {
                        add_amount_in_51(ConnectionWithAccess.mprd, "7998", "@@@", (Convert.ToDouble(jjamt.Text) * 1));
                        add_amount_in_51(ConnectionWithAccess.mprd, "3001", "@@@", (Convert.ToDouble(jjamt.Text) * 1));
                    }
                }
            }
        }

        private void add_jour_gst_taxes()
        {
            for (row_counter = 0; row_counter < jj_dgv_gst_tax_brief.Rows.Count - 1; row_counter++)
            {
                if (jj_dgv_gst_tax_brief.Rows[row_counter].Cells[3].Value != null && jj_dgv_gst_tax_brief.Rows[row_counter].Cells[3].Value.ToString() != "0.00")
                {
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[08] + " (book,prd,d_c,d_n,d_d,a_n,s_a,r_p,bamt,IGST_PER,IGST_AMT,GAMT,[user],insert_dt_tm) values('J','" + ConnectionWithAccess.mprd + "'," + jjdbc.Text + " ,'" + jjdocno.Text + "'," + jjdatetime.Value.ToShortDateString() + " ,'" + ja_n.Text + "', '" + js_a.Text + "','4', " + jj_dgv_gst_tax_brief.Rows[row_counter].Cells[0].Value + " ," + jj_dgv_gst_tax_brief.Rows[row_counter].Cells[1].Value + " ," + jj_dgv_gst_tax_brief.Rows[row_counter].Cells[2].Value + " ," + jj_dgv_gst_tax_brief.Rows[row_counter].Cells[3].Value + " ,'" + ConnectionWithAccess.muser + "', @currDate )";
                    add_user_date_time_function_compulsory_program();
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }
        }

        private void delete_old_journal_record()
        {
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[25] + " where d_n  " + (jjdocno.Text.Trim() == string.Empty ? "is null" : "= " + jjdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + jjdbc.Text;
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[08] + " where book = 'J' and prd = '" + ConnectionWithAccess.mprd + "' and d_n  " + (jjdocno.Text.Trim() == string.Empty ? "is null" : "= " + jjdocno.Text.Trim()) + " and d_c = " + Convert.ToInt32(jjdbc.Text) + " and r_p = '4'";
            ConnectionCommand.fUpdateInsertDeleteData();
            add_amount_in_51(ConnectionWithAccess.mprd, ja_n.Text, js_a.Text, (old_journal_amount * -1));
            if (js_a.Text != "@@@")
                add_amount_in_51(ConnectionWithAccess.mprd, ja_n.Text, "@@@", (old_journal_amount * -1));
            add_amount_in_51(ConnectionWithAccess.mprd, jna_n.Text, jns_a.Text, (old_journal_amount * 1));
            if (jns_a.Text != "@@@")
                add_amount_in_51(ConnectionWithAccess.mprd, jna_n.Text, "@@@", (old_journal_amount * 1));
            if (ja_n.Text != "")
            {
                temp_word = ja_n.Text.Substring(0, 2);
                check_data_type(temp_word);
                if (data_type == "Numeric")
                {
                    if (Convert.ToInt32(temp_word) >= 60 && Convert.ToInt32(temp_word) <= 70)
                    {
                        add_amount_in_51(ConnectionWithAccess.mprd, "719999", "@@@", (old_journal_amount * 1));
                        add_amount_in_51(ConnectionWithAccess.mprd, "7998", "@@@", (old_journal_amount * 1));
                        add_amount_in_51(ConnectionWithAccess.mprd, "3001", "@@@", (old_journal_amount * 1));
                    }
                    else if (Convert.ToInt32(temp_word) > 70 && Convert.ToInt32(temp_word) <= 77)
                    {
                        add_amount_in_51(ConnectionWithAccess.mprd, "7998", "@@@", (old_journal_amount * 1));
                        add_amount_in_51(ConnectionWithAccess.mprd, "3001", "@@@", (old_journal_amount * 1));
                    }
                }
            }
            if (jna_n.Text != "")
            {
                temp_word = jna_n.Text.Substring(0, 2);
                check_data_type(temp_word);
                if (data_type == "Numeric")
                {
                    if (Convert.ToInt32(temp_word) >= 60 && Convert.ToInt32(temp_word) <= 70)
                    {
                        add_amount_in_51(ConnectionWithAccess.mprd, "719999", "@@@", (old_journal_amount * -1));
                        add_amount_in_51(ConnectionWithAccess.mprd, "7998", "@@@", (old_journal_amount * -1));
                        add_amount_in_51(ConnectionWithAccess.mprd, "3001", "@@@", (old_journal_amount * -1));
                    }
                    else if (Convert.ToInt32(temp_word) > 70 && Convert.ToInt32(temp_word) <= 77)
                    {
                        add_amount_in_51(ConnectionWithAccess.mprd, "7998", "@@@", (old_journal_amount * -1));
                        add_amount_in_51(ConnectionWithAccess.mprd, "3001", "@@@", (old_journal_amount * -1));
                    }
                }
            }
        }

        private void add_item_stock_in_05_using_type_item_code(string mtype, string mitem_code, double mqty)
        {
            temp_double = 0;
            if (mtype != "" && mitem_code != "" && mqty != 0.0)
            {
                temp_double = 0.0;
                isRecord = 0;
                ConnectionWithAccess.query = "select CLO_STK from " + ConnectionWithAccess.tablename[05] + " where [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    isRecord = 1;
                    temp_double = Convert.ToDouble(dtData1.Rows[0][0]);
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[05] + " set clo_stk = " + Math.Round((mqty + temp_double), 2) + " where [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
                    //add_user_date_time_function_compulsory_program();
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }
        }

        private void save_qr_code(string qr_image_details)
        {
            if (qr_image_details.Length > 120)
                qr_image_details = qr_image_details.Substring(0, 120);
            qr_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\images\\temp_qr.jpg";
            CodeQrBarcodeDraw qrCode = BarcodeDrawFactory.CodeQr;
            pb_barcode.Size = new System.Drawing.Size(188, 188);
            pb_barcode.Image = qrCode.Draw(qr_image_details, 80);
            Bitmap bmp = new Bitmap(188, 188);
            pb_barcode.DrawToBitmap(bmp, new System.Drawing.Rectangle(0, 0, 188, 188));
            bmp.Save(qr_filename);
        }

        private void save_data_entry()
        {
            if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
            {
                delete_old_sale_invoice_record();
                for (row_pointer = 0; row_pointer < item_sale_list.Count(); row_pointer++)
                {
                    var cellArray = item_sale_list[row_pointer].Split(new[] { ',' });
                    add_item_stock_in_05_using_type_item_code(cellArray[0], cellArray[1], (Convert.ToDouble(cellArray[2])));
                }
                if (Convert.ToSingle(sigrossamt.Text) > 0)
                    add_sale_invoice_record();
                sisalelistdg.DataSource = null;
                fillsisalelist();
                itemlistmastertab();
                //if (Convert.ToSingle(sigrossamt.Text) <= 0)
                    refresh_data_entry_sale_for_new_record();
                fill_sale_list_array_for_items_list_stock_adding();
                ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[21] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + Convert.ToInt32(sidbc.Text);
                ConnectionCommand.ExportToText(sidbc, sidocno);
            }
            else if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 1)
            {
                delete_old_sale_replacement_record();
                if (Convert.ToSingle(srgrossamt.Text) > 0)
                    add_sale_replacement_record();
                fillsrreplamentlist();
                refresh_data_entry_sale_replacement_for_new_record();
            }
            else if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 2)
            {
                delete_old_sale_order_record();
                if (Convert.ToSingle(sogrossamt.Text) > 0)
                    add_sale_order_record();
                fillsosalelist();
                refresh_data_entry_sale_order_for_new_record();
            }
            else if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 3)
            {
                delete_old_sale_invoice_record();
                if (Convert.ToSingle(simple_grossamt.Text) > 0)
                    add_sale_invoice_record();
                sisalelistdg.DataSource = null;
                fillsisalelist();
                itemlistmastertab();
                //if (Convert.ToSingle(sigrossamt.Text) <= 0)
                refresh_data_entry_sale_for_new_record();
                fill_sale_list_array_for_items_list_stock_adding();
                ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[21] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + Convert.ToInt32(sidbc.Text);
                ConnectionCommand.ExportToText(sidbc, sidocno);
            }
            else if (subtabDataEntry.SelectedIndex == 1 && subtabpurchase.SelectedIndex == 0)
            {
                delete_old_purc_record();
                // deduct old item invoice purchase from item stock
                //for (row_pointer = 0; row_pointer < item_purchase_list.Count(); row_pointer++)
                //{
                //    var cellArray = item_purchase_list[row_pointer].Split(new[] { ',' });
                //    add_item_stock_in_05_using_type_item_code(cellArray[0], cellArray[1], (Convert.ToDouble(cellArray[2]) * -1));
                //}
                if (Convert.ToSingle(pigrossamt.Text) > 0)
                    add_purc_record();
                pipurchaselist.DataSource = null;
                fillpipurclist();
                itemlistmastertab();
                refresh_data_entry_purc_for_new_record();
            }
            else if (subtabDataEntry.SelectedIndex == 2)
            {
                // BANK
                // r_p = 1 "Cash Deposit"
                //r_p = 2 Receipt
                //r_p = 3 cash withdrawal
                // r_p = 4 payment
                // b_t = 2 for balance, b_t = 3 for passed, b_t = 4 for failed.
                if (subtabbank.SelectedIndex == 0)
                {
                    //r_p = 2 Receipt
                    ConnectionWithAccess.md_n = brdocno.Text;
                    delete_old_bank_record();
                    if (bramt.Text != "0" && bramt.Text != null)
                    {
                        if (Convert.ToSingle(bramt.Text) > 0)
                            add_bank_record();
                    }
                    refresh_data_entry_bank_for_new_record();
                }
                else if (subtabbank.SelectedIndex == 1)
                {
                    // r_p = 4 payment
                    ConnectionWithAccess.md_n = brdocno.Text;
                    delete_old_bank_record();
                    if (bpamt.Text != "0" && bpamt.Text != null)
                    {
                        if (Convert.ToSingle(bpamt.Text) > 0)
                            add_bank_record();
                    }
                    refresh_data_entry_bank_for_new_record();
                }
                else if (subtabbank.SelectedIndex == 2)
                {
                    // r_p = 1 "Cash Deposit"
                    //temp_word = bddatetime.Value.Year.ToString();
                    //temp_word += bddatetime.Value.Month.ToString();
                    //temp_word += bddatetime.Value.Date.ToString();
                    //temp_word += bddocno.Text.Trim();
                    //bddocno.Text = temp_word;
                    ConnectionWithAccess.md_n = bddocno.Text;
                    delete_old_bank_record();
                    if (bdamt.Text != "0" && bdamt.Text != null)
                    {
                        if (Convert.ToSingle(bdamt.Text) > 0)
                            add_bank_record();
                    }
                    refresh_data_entry_bank_for_new_record();
                }
                else if (subtabbank.SelectedIndex == 3)
                {
                    //r_p = 3 cash withdrawal
                    ConnectionWithAccess.md_n = bwdocno.Text;
                    delete_old_bank_record();
                    if (bwamt.Text != "0" && bwamt.Text != null)
                    {
                        if (Convert.ToSingle(bwamt.Text) > 0)
                            add_bank_record();
                    }
                    refresh_data_entry_bank_for_new_record();
                }
                else if (subtabbank.SelectedIndex == 4)
                {
                    //r_p = 3 cash withdrawal
                    ConnectionWithAccess.md_n = tr_docno.Text;
                    delete_old_bank_record();
                    if (tr_amt.Text != "0" && tr_amt.Text != null)
                    {
                        if (Convert.ToSingle(tr_amt.Text) > 0)
                            add_bank_record();
                    }
                    refresh_data_entry_bank_for_new_record();
                }
            }
            else if (subtabDataEntry.SelectedIndex == 3)
            {
                // CASH
                // r_p = 1 "Cash Deposit"
                //r_p = 2 Receipt
                //r_p = 3 cash withdrawal
                // r_p = 4 payment
                // b_t = 2 for balance, b_t = 3 for passed, b_t = 4 for failed.
                if (subtabcash.SelectedIndex == 0)
                {
                    //r_p = 2 Receipt
                    //temp_word = crdatetime.Value.Year.ToString();
                    //temp_word += crdatetime.Value.Month.ToString();
                    //temp_word += Convert.ToString(crdatetime.Value.Date.ToString().Substring(0, crdatetime.Value.ToString().IndexOf("/")));
                    //temp_word += crdocno.Text.Trim();
                    //crdocno.Text = temp_word;
                    ConnectionWithAccess.md_n = crdocno.Text;
                    if (old_cash_receipt_amount != 0)
                        delete_old_cash_record();
                    if (cramt.Text != "0" && cramt.Text != null)
                        add_cash_record();
                    crtranlist.DataSource = null;
                    refresh_data_entry_cash_for_new_record();
                }
                else if (subtabcash.SelectedIndex == 1)
                {
                    // r_p = 4 payment
                    //temp_word = cpdatetime.Value.Year.ToString();
                    //temp_word += cpdatetime.Value.Month.ToString();
                    //temp_word += cpdatetime.Value.Date.ToString();
                    //temp_word += cpdocno.Text.Trim();
                    //cpdocno.Text = temp_word;
                    ConnectionWithAccess.md_n = cpdocno.Text;
                    if (old_cash_payment_amount != 0)
                        delete_old_cash_record();
                    if (cpamt.Text != "0" && cpamt.Text != null)
                    {
                        //if (Convert.ToSingle(cpamt.Text) > 0)
                        add_cash_record();
                    }
                    //fill_cash_trans_list();
                    refresh_data_entry_cash_for_new_record();
                }
            }
            else if (subtabDataEntry.SelectedIndex == 4)
            {
                ConnectionWithAccess.md_n = jjdocno.Text;
                delete_old_journal_record();
                if (jjamt.Text != "" && jjamt.Text != null)
                {
                    if (Convert.ToSingle(jjamt.Text) > 0)
                        add_journal_record();
                }
                refresh_data_entry_journal_for_new_record();
            }
        }
        #endregion

        private void sipartycode_TextChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Party";
            if (!bsiPartyChangeIgnore && si_party_help.Visible == true)
            {
                ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + Convert.ToInt32(sidbc.Text) + " and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + Convert.ToInt32(sidbc.Text) + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='' or d_y = '@@@') and [desc] like '%" + sipartycode.Text + "%'";
                ConnectionCommand.accountHelp_datatable(si_party_help, "si_party_help");
                if (si_party_help.Rows.Count == 1)
                {
                    ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + Convert.ToInt32(sidbc.Text) + " and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + Convert.ToInt32(sidbc.Text) + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='' or d_y = '@@@') and [city] like '%" + sipartycode.Text + "%'";
                    ConnectionCommand.accountHelp_datatable(si_party_help, "si_party_help");
                    if (si_party_help.Rows.Count == 1)
                    {
                        sipartycode.Text = sipartycode.Text.Substring(0, sipartycode.Text.Length - 1);
                        sipartycode.SelectionStart = sipartycode.Text.Length;
                    }
                }
            }
            //generate_barcode(sipartycode.Text);
        }

        private void sisalelistdg_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Down)
                rowIndex = sisalelistdg.CurrentRow.Index + 1;
            else if (e.KeyCode == Keys.Up)
                rowIndex = sisalelistdg.CurrentRow.Index - 1;
            if (rowIndex != -1 && rowIndex < sisalelistdg.Rows.Count)
                sidocno.Text = Convert.ToString(sisalelistdg.Rows[rowIndex].Cells[1].Value);
            msalepdf = null;
        }

        private void sidocno_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                ConnectionWithAccess.md_n = sidocno.Text.Trim();
                if (!new_sale_invoice)
                {
                    oldsaleinvoicedetails();
                    sale_invoice_item_filling();
                    //sipartybalance.Text = Convert.ToString(calculate_account_balance(sia_n.Text, sis_a.Text, Convert.ToString(sidatetime.Text)));
                    sipartycode.Enabled = false;
                    sicity.Enabled = false;
                }
            }
        }

        private void set_invoice_date(int table_number, string docno, int md_c)
        {
            DataTable dtDateData = null;
            if (subtabsale.SelectedIndex == 0)
            {
                sidatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
                sidatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.medate);
                if (docno == "1")
                {
                    ConnectionWithAccess.query = "select min(d_d) from " + ConnectionWithAccess.tablename[table_number] + " f21 where d_n " + (docno.Trim() == string.Empty ? "is null" : " > " + docno.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + md_c + " and d_n <> 999999";
                    dtDateData = ConnectionCommand.fGetDataTable();

                    if (dtDateData != null && dtDateData.Rows.Count > 0)
                    {
                        if (dtDateData.Rows[0][0] != null && !string.IsNullOrEmpty(dtDateData.Rows[0][0].ToString()))
                            temp_datetime = Convert.ToDateTime(dtDateData.Rows[0][0].ToString());
                        if (temp_datetime >= sidatetime.MinDate)
                            sidatetime.MaxDate = temp_datetime;
                    }
                }
                else
                {
                    ConnectionWithAccess.query = "select max(d_d) from " + ConnectionWithAccess.tablename[table_number] + " f21 where d_n " + (docno.Trim() == string.Empty ? "is not null" : "< " + docno.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + md_c;
                    dtDateData = ConnectionCommand.fGetDataTable();
                    if (dtDateData != null && dtDateData.Rows.Count > 0)
                    {
                        if (dtDateData.Rows[0][0] != null && !string.IsNullOrEmpty(dtDateData.Rows[0][0].ToString()))
                            sidatetime.MinDate = Convert.ToDateTime(dtDateData.Rows[0][0]);
                    }
                    ConnectionWithAccess.query = "select max(d_n) from " + ConnectionWithAccess.tablename[table_number] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + md_c + " and d_n <> 999999";
                    DataTable dtDateData1 = ConnectionCommand.fGetDataTable();
                    if (dtDateData1 != null && dtDateData1.Rows.Count > 0)
                    {
                        if (dtDateData1.Rows[0][0] != null && !string.IsNullOrEmpty(dtDateData1.Rows[0][0].ToString()))
                            temp_int = Convert.ToInt32(dtDateData1.Rows[0][0].ToString());
                    }
                    if (Convert.ToInt32(docno) >= temp_int)
                    {
                        sidatetime.MaxDate = DateTime.Now;
                    }
                    else
                    {
                        ConnectionWithAccess.query = "select min(d_n) from " + ConnectionWithAccess.tablename[table_number] + " where d_n " + (docno.Trim() == string.Empty ? "is not null" : "> " + docno.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + md_c + " and d_n <> 999999";
                        DataTable dtDateData2 = ConnectionCommand.fGetDataTable();
                        if (dtDateData2 != null && dtDateData2.Rows.Count > 0)
                        {
                            if (dtDateData2.Rows[0][0] != null && !string.IsNullOrEmpty(dtDateData2.Rows[0][0].ToString()))
                                temp_int = Convert.ToInt32(dtDateData2.Rows[0][0].ToString());
                        }
                        ConnectionWithAccess.query = "select d_d from " + ConnectionWithAccess.tablename[table_number] + " where d_n = " + temp_int + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + md_c + "and d_n <> 999999";
                        DataTable dtDateData3 = ConnectionCommand.fGetDataTable();
                        if (dtDateData3 != null && dtDateData3.Rows.Count > 0)
                        {
                            sidatetime.MaxDate = DateTime.Now;
                            if (dtDateData3.Rows[0][0] != null && !string.IsNullOrEmpty(dtDateData3.Rows[0][0].ToString()))
                                temp_datetime = Convert.ToDateTime(dtDateData3.Rows[0][0].ToString());
                            if (temp_datetime >= sidatetime.MinDate)
                                sidatetime.MaxDate = temp_datetime;
                        }
                    }
                }
            }
            else if (subtabsale.SelectedIndex == 3)
            {
                simple_date.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
                simple_date.MaxDate = Convert.ToDateTime(ConnectionWithAccess.medate);
                if (docno == "1")
                {
                    ConnectionWithAccess.query = "select min(d_d) from " + ConnectionWithAccess.tablename[table_number] + " f21 where d_n " + (docno.Trim() == string.Empty ? "is null" : " > " + docno.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + md_c + " and d_n <> 999999";
                    dtDateData = ConnectionCommand.fGetDataTable();

                    if (dtDateData != null && dtDateData.Rows.Count > 0)
                    {
                        if (dtDateData.Rows[0][0] != null && !string.IsNullOrEmpty(dtDateData.Rows[0][0].ToString()))
                            temp_datetime = Convert.ToDateTime(dtDateData.Rows[0][0].ToString());
                        if (temp_datetime >= simple_date.MinDate)
                            simple_date.MaxDate = temp_datetime;
                    }
                }
                else
                {
                    ConnectionWithAccess.query = "select max(d_d) from " + ConnectionWithAccess.tablename[table_number] + " f21 where d_n " + (docno.Trim() == string.Empty ? "is not null" : "< " + docno.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + md_c;
                    dtDateData = ConnectionCommand.fGetDataTable();
                    if (dtDateData != null && dtDateData.Rows.Count > 0)
                    {
                        if (dtDateData.Rows[0][0] != null && !string.IsNullOrEmpty(dtDateData.Rows[0][0].ToString()))
                            simple_date.MinDate = Convert.ToDateTime(dtDateData.Rows[0][0]);
                    }
                    ConnectionWithAccess.query = "select max(d_n) from " + ConnectionWithAccess.tablename[table_number] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + md_c + " and d_n <> 999999";
                    DataTable dtDateData1 = ConnectionCommand.fGetDataTable();
                    if (dtDateData1 != null && dtDateData1.Rows.Count > 0)
                    {
                        if (dtDateData1.Rows[0][0] != null && !string.IsNullOrEmpty(dtDateData1.Rows[0][0].ToString()))
                            temp_int = Convert.ToInt32(dtDateData1.Rows[0][0].ToString());
                    }
                    if (Convert.ToInt32(docno) >= temp_int)
                    {
                        simple_date.MaxDate = DateTime.Now;
                    }
                    else
                    {
                        ConnectionWithAccess.query = "select min(d_n) from " + ConnectionWithAccess.tablename[table_number] + " where d_n " + (docno.Trim() == string.Empty ? "is not null" : "> " + docno.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + md_c + " and d_n <> 999999";
                        DataTable dtDateData2 = ConnectionCommand.fGetDataTable();
                        if (dtDateData2 != null && dtDateData2.Rows.Count > 0)
                        {
                            if (dtDateData2.Rows[0][0] != null && !string.IsNullOrEmpty(dtDateData2.Rows[0][0].ToString()))
                                temp_int = Convert.ToInt32(dtDateData2.Rows[0][0].ToString());
                        }
                        ConnectionWithAccess.query = "select d_d from " + ConnectionWithAccess.tablename[table_number] + " where d_n = " + temp_int + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + md_c + "and d_n <> 999999";
                        DataTable dtDateData3 = ConnectionCommand.fGetDataTable();
                        if (dtDateData3 != null && dtDateData3.Rows.Count > 0)
                        {
                            simple_date.MaxDate = DateTime.Now;
                            if (dtDateData3.Rows[0][0] != null && !string.IsNullOrEmpty(dtDateData3.Rows[0][0].ToString()))
                                temp_datetime = Convert.ToDateTime(dtDateData3.Rows[0][0].ToString());
                            if (temp_datetime >= simple_date.MinDate)
                                simple_date.MaxDate = temp_datetime;
                        }
                    }
                }
            }
        }

        private void oldsaleinvoicedetails()
        {
            if (maintab.SelectedIndex == 1)
            {
                if (subtabsale.SelectedIndex == 0)
                {
                    ConnectionWithAccess.query = "select a_n, s_a, d_y, tpt, bamt, tamt, rund_amt, gamt, tx_code,d_d,freight_AMT,packing_AMT,insurance_AMT,other_AMT,lr_num,lr_date,mess from " + ConnectionWithAccess.tablename[21] + " f21 where d_n " + (sidocno.Text.Trim() == string.Empty ? "is null" : "= " + sidocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(sidbc.Text);
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        if (dtData1.Rows[0][0] != null)
                        {
                            fill_transport(sia_n.Text, sicity.Text, sitransport);
                            tb_si_igst_tax_amount.Text = "0.00";
                            new_sale_invoice = false;
                            sidatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
                            sidatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.medate);
                            sidatetime.Value = Convert.ToDateTime(dtData1.Rows[0][9].ToString());
                            sia_n.Text = dtData1.Rows[0][0].ToString();
                            sis_a.Text = dtData1.Rows[0][1].ToString();
                            sid_y.Text = dtData1.Rows[0][2].ToString();
                            sitransport.Text = dtData1.Rows[0][3].ToString();
                            //sibasicamt.Text = dtData1.Rows[0][4].ToString();
                            sitaxamt.Text = dtData1.Rows[0][5].ToString();
                            siroundoffamt.Text = dtData1.Rows[0][6].ToString();
                            sigrossamt.Text = dtData1.Rows[0][7].ToString();
                            old_sale_invoice_amount = Convert.ToDouble(dtData1.Rows[0][7].ToString());
                            sitaxcode.Text = dtData1.Rows[0][8].ToString();
                            si_frieght_amt.Text = dtData1.Rows[0][10].ToString();
                            si_packing_amt.Text = dtData1.Rows[0][11].ToString();
                            si_insurance_amt.Text = dtData1.Rows[0][12].ToString();
                            si_other_amt.Text = dtData1.Rows[0][13].ToString();
                            sisale_lr_no.Text = dtData1.Rows[0][14].ToString();
                            dtp_sisale_lr_date.Text = dtData1.Rows[0][15].ToString();
                            sicomments.Text = dtData1.Rows[0][16].ToString();
                            if (si_frieght_amt.Text == "")
                                si_frieght_amt.Text = "0.00";
                            if (si_packing_amt.Text == "")
                                si_packing_amt.Text = "0.00";
                            if (si_insurance_amt.Text == "")
                                si_insurance_amt.Text = "0.00";
                            if (si_other_amt.Text == "")
                                si_other_amt.Text = "0.00";
                            if (siroundoffamt.Text == "")
                                siroundoffamt.Text = "0.00";
                            ConnectionWithAccess.query = "select [desc], tax_rate from " + ConnectionWithAccess.tablename[6] + " f6 where d_c = " + Convert.ToInt32(sidbc.Text) + " and tx_code = " + sitaxcode.Text;
                            DataTable dtSaleData = ConnectionCommand.fGetDataTable();
                            if (dtSaleData != null && dtSaleData.Rows.Count > 0)
                            {
                                sitaxdesc.Text = Convert.ToString(dtSaleData.Rows[0][0]);
                                sitaxrate.Text = Convert.ToString(dtSaleData.Rows[0][1]);
                            }
                            old_cash_received_against_sale_invoice = get_cash_received_amount_in_sale_invoice();
                            si_cash_received.Text = string.Format("{0:0.00}", old_cash_received_against_sale_invoice);
                            sicity.Enabled = false;
                            populate_screen();
                            fill_sale_invoice_dg();
                            if (sid_y.Text != "@@@")
                            {
                                sipartycode.Enabled = false;
                                sideliverycode.Visible = true;
                                sideliverycity.Visible = true;
                                lbl_sideliver.Visible = true;
                                get_account_details_with_d_y_from_01(sia_n.Text, sis_a.Text, sid_y.Text);
                                sideliverycode.Text = account_detail_from_01[4];
                                sideliverycity.Text = account_detail_from_01[8];
                                get_account_details_from_01(sia_n.Text, sis_a.Text);
                            }
                            else
                            {
                                sideliverycode.Visible = false;
                                sideliverycity.Visible = false;
                                lbl_sideliver.Visible = false;
                            }
                        }

                        check_for_permission_and_sale_invoice_printed();
                    }
                    else
                    {
                        siitemlist.DataSource = null;
                        //siitemlist.Rows.Clear();
                        old_sale_invoice_amount = 0;
                        //cb_print_Tpt_copy.Visible = false;
                        //cb_print_chit_copy.Visible = false;
                        sisalelistdg.Visible = true;
                        sitaxlist.Visible = false;
                        DispEmail.Clear();
                        sipartyname.Clear();
                        sipartyaddress.Clear();
                        sicontactdetails.Clear();
                        sitransport.Text = null;
                        sibasicamt.Text = "0.00";
                        si_frieght_amt.Text = "0.00";
                        si_packing_amt.Text = "0.00";
                        si_insurance_amt.Text = "0.00";
                        sitaxamt.Text = "0.00";
                        siroundoffamt.Text = "0.00";
                        sigrossamt.Text = "0.00";
                        sitaxcode.Text = "0";
                        sitaxdesc.Text = "";
                        sitaxrate.Text = "0.00";
                        sipartybalance.Text = "0.00";
                        sipartycode.Enabled = true;
                        sicity.Enabled = true;
                        ConnectionWithAccess.ms_a = null;
                        sipartycode.Text = "";
                        sicity.Text = "";
                    }
                }
                else if (subtabsale.SelectedIndex == 2)
                {
                    ConnectionWithAccess.query = "select a_n, s_a, d_y, tpt, bamt, tamt, rund_amt, gamt, tx_code,d_d,freight_AMT,packing_AMT,insurance_AMT,other_AMT from " + ConnectionWithAccess.tablename[7] + " f7 where d_n " + (sodocno.Text.Trim() == string.Empty ? "is null" : "= " + sodocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(sodbc.Text);
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        if (dtData1.Rows[0][0] != null)
                        {
                            sodatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
                            sodatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.medate);
                            sodatetime.Value = Convert.ToDateTime(dtData1.Rows[0][9].ToString());
                            soa_n.Text = dtData1.Rows[0][0].ToString();
                            sos_a.Text = dtData1.Rows[0][1].ToString();
                            sod_y.Text = dtData1.Rows[0][2].ToString();
                            sotransport.Text = dtData1.Rows[0][3].ToString();
                            //sobasocamt.Text = dtData1.Rows[0][4].ToString();
                            sotaxamt.Text = dtData1.Rows[0][5].ToString();
                            soroundoffamt.Text = dtData1.Rows[0][6].ToString();
                            sogrossamt.Text = dtData1.Rows[0][7].ToString();
                            sotaxcode.Text = dtData1.Rows[0][8].ToString();
                            //ConnectionWithAccess.query = "select [desc], tax_rate from " + ConnectionWithAccess.tablename[6] + " f6 where d_c = " + Convert.ToInt32(sodbc.Text) + " and tx_code = " + sotaxcode.Text;
                            //DataTable dtSaleData = ConnectionCommand.fGetDataTable();
                            //if (dtSaleData != null && dtSaleData.Rows.Count > 0)
                            //{
                            //    sotaxdesc.Text = Convert.ToString(dtSaleData.Rows[0][0]);
                            //    sotaxrate.Text = Convert.ToString(dtSaleData.Rows[0][1]);
                            //}
                            socity.Enabled = false;
                            populate_screen();
                            fill_sale_invoice_dg();
                        }
                    }
                    else
                    {
                        soitemlist.DataSource = null;
                        soitemlist.Rows.Clear();
                        sotransport.Text = null;
                        sotaxamt.Text = "0.00";
                        soroundoffamt.Text = "0.00";
                        sogrossamt.Text = "0.00";
                        sotaxcode.Text = "0";
                        sotaxdesc.Text = "";
                        sotaxrate.Text = "0.00";
                        sopartybalance.Text = "0.00";
                        sopartycode.Enabled = true;
                        socity.Enabled = true;
                        sopartycode.Text = "";
                        socity.Text = "";
                    }
                }
                else if (subtabsale.SelectedIndex == 3)
                {
                    ConnectionWithAccess.query = "select a_n, s_a, d_y, tpt, bamt, tamt, rund_amt, gamt, tx_code,d_d,freight_AMT,packing_AMT,insurance_AMT,other_AMT,lr_num,lr_date,mess from " + ConnectionWithAccess.tablename[21] + " f21 where d_n " + (simple_docno.Text.Trim() == string.Empty ? "is null" : "= " + simple_docno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(sidbc.Text);
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        if (dtData1.Rows[0][0] != null)
                        {
                            //fill_transport(sia_n.Text, sicity.Text, sitransport);
                            //tb_si_igst_tax_amount.Text = "0.00";
                            new_sale_invoice = false;
                            simple_date.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
                            simple_date.MaxDate = Convert.ToDateTime(ConnectionWithAccess.medate);
                            simple_date.Value = Convert.ToDateTime(dtData1.Rows[0][9].ToString());
                            simple_a_n.Text = dtData1.Rows[0][0].ToString();
                            simple_s_a.Text = dtData1.Rows[0][1].ToString();
                            //sid_y.Text = dtData1.Rows[0][2].ToString();
                            //sitransport.Text = dtData1.Rows[0][3].ToString();
                            ////sibasicamt.Text = dtData1.Rows[0][4].ToString();
                            //sitaxamt.Text = dtData1.Rows[0][5].ToString();
                            //siroundoffamt.Text = dtData1.Rows[0][6].ToString();
                            simple_salelist.Text = dtData1.Rows[0][7].ToString();
                            old_sale_invoice_amount = Convert.ToDouble(dtData1.Rows[0][7].ToString());
                            //sitaxcode.Text = dtData1.Rows[0][8].ToString();
                            //si_frieght_amt.Text = dtData1.Rows[0][10].ToString();
                            //si_packing_amt.Text = dtData1.Rows[0][11].ToString();
                            //si_insurance_amt.Text = dtData1.Rows[0][12].ToString();
                            //si_other_amt.Text = dtData1.Rows[0][13].ToString();
                            //sisale_lr_no.Text = dtData1.Rows[0][14].ToString();
                            //dtp_sisale_lr_date.Text = dtData1.Rows[0][15].ToString();
                            simple_comments.Text = dtData1.Rows[0][16].ToString();
                            //if (si_frieght_amt.Text == "")
                            //    si_frieght_amt.Text = "0.00";
                            //if (si_packing_amt.Text == "")
                            //    si_packing_amt.Text = "0.00";
                            //if (si_insurance_amt.Text == "")
                            //    si_insurance_amt.Text = "0.00";
                            //if (si_other_amt.Text == "")
                            //    si_other_amt.Text = "0.00";
                            //if (siroundoffamt.Text == "")
                            //    siroundoffamt.Text = "0.00";
                            //ConnectionWithAccess.query = "select [desc], tax_rate from " + ConnectionWithAccess.tablename[6] + " f6 where d_c = " + Convert.ToInt32(sidbc.Text) + " and tx_code = " + sitaxcode.Text;
                            //DataTable dtSaleData = ConnectionCommand.fGetDataTable();
                            //if (dtSaleData != null && dtSaleData.Rows.Count > 0)
                            //{
                            //    sitaxdesc.Text = Convert.ToString(dtSaleData.Rows[0][0]);
                            //    sitaxrate.Text = Convert.ToString(dtSaleData.Rows[0][1]);
                            //}
                            old_cash_received_against_sale_invoice = get_cash_received_amount_in_sale_invoice();
                            si_cash_received.Text = string.Format("{0:0.00}", old_cash_received_against_sale_invoice);
                            simple_partycity.Enabled = false;
                            populate_screen();
                            //fill_sale_invoice_dg();
                            //if (sid_y.Text != "@@@")
                            //{
                            //    sipartycode.Enabled = false;
                            //    sideliverycode.Visible = true;
                            //    sideliverycity.Visible = true;
                            //    lbl_sideliver.Visible = true;
                            //    get_account_details_with_d_y_from_01(sia_n.Text, sis_a.Text, sid_y.Text);
                            //    sideliverycode.Text = account_detail_from_01[4];
                            //    sideliverycity.Text = account_detail_from_01[8];
                            //    get_account_details_from_01(sia_n.Text, sis_a.Text);
                            //}
                            //else
                            //{
                            //    sideliverycode.Visible = false;
                            //    sideliverycity.Visible = false;
                            //    lbl_sideliver.Visible = false;
                            //}
                        }
                        //check_for_permission_and_sale_invoice_printed();
                    }
                    else
                    {
                        simple_itemsalelist.DataSource = null;
                        old_sale_invoice_amount = 0;
                        sisalelistdg.Visible = true;
                        simple_detail_partyname.Clear();
                        simple_detail_party_address.Clear();
                        simple_detail_party_contact.Clear();
                        simple_salelist.Text = "0.00";
                        sipartybalance.Text = "0.00";
                        simple_partyname.Enabled = true;
                        simple_partycity.Enabled = true;
                    }
                }
            }
        }

        private void oldsalereplacementdetails()
        {
            if (srdocno.Text != null && srdocno.Text != "")
            {
                ConnectionWithAccess.query = "select a_n, s_a, d_y, tpt, bamt, tamt, rund_amt, gamt, tx_code, d_d from " + ConnectionWithAccess.tablename[30] + " f30 where d_n  " + (srdocno.Text.Trim() == string.Empty ? "is null" : "= " + srdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + srdbc.Text;
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        sra_n.Text = dtData1.Rows[0][0].ToString();
                        srs_a.Text = dtData1.Rows[0][1].ToString();
                        srd_y.Text = dtData1.Rows[0][2].ToString();
                        srtransport.Text = dtData1.Rows[0][3].ToString();
                        srbasicamt.Text = dtData1.Rows[0][4].ToString();
                        srtaxamt.Text = dtData1.Rows[0][5].ToString();
                        srgrossamt.Text = dtData1.Rows[0][7].ToString();
                        old_sale_replace_amount = Convert.ToDouble(dtData1.Rows[0][7].ToString());
                        srtaxcode.Text = dtData1.Rows[0][8].ToString();
                        srpartycode.Enabled = false;
                        sritemlist.Enabled = true;
                        sritemlist.ReadOnly = false;
                    }
                }
                if (srs_a.Text != null && srs_a.Text != "")
                {
                    get_account_details_from_01(sra_n.Text, srs_a.Text);
                    get_account_details_from_04(sra_n.Text, srs_a.Text);
                    srpartycode.Text = account_detail_from_01[4];
                    srpartyname.Text = srpartycode.Text;
                    srpartyaddress.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[6] + " ," + account_detail_from_04[7];
                    srcontactdetails.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20];
                    srpartybalance.Text = Convert.ToString(calculate_account_balance(sra_n.Text, srs_a.Text, Convert.ToString(srdatetime.Text)));
                }
            }
        }

        private void oldpurcreplacementdetails()
        {
            if (prdocno.Text != null && prdocno.Text != "")
            {
                ConnectionWithAccess.command.CommandText = "select a_n, s_a, tpt, bamt, tamt, gamt, tx_code, d_d from " + ConnectionWithAccess.tablename[30] + " f30 where d_n  " + (prdocno.Text.Trim() == string.Empty ? "is null" : "= " + prdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + prdbc.Text;
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        pra_n.Text = dtData1.Rows[0][0].ToString();
                        prs_a.Text = dtData1.Rows[0][1].ToString();
                        prtransport.Text = dtData1.Rows[0][2].ToString();
                        prbasicamt.Text = dtData1.Rows[0][3].ToString();
                        prtaxamt.Text = dtData1.Rows[0][4].ToString();
                        prgrossamt.Text = dtData1.Rows[0][5].ToString();
                        old_sale_replace_amount = Convert.ToDouble(dtData1.Rows[0][5].ToString());
                        prtaxcode.Text = dtData1.Rows[0][6].ToString();
                        prpartycode.Enabled = false;
                    }
                }
                if (prs_a.Text != null && prs_a.Text != "")
                {
                    get_account_details_from_01(pra_n.Text, prs_a.Text);
                    get_account_details_from_04(pra_n.Text, prs_a.Text);
                    prpartycode.Text = account_detail_from_01[4];
                }
            }
        }

        public void sale_invoice_item_filling()
        {
            if (subtabsale.SelectedIndex == 0)
            {
                if (!new_sale_invoice && sidocno.Text != "")
                {
                    ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd= '" + ConnectionWithAccess.mprd + "' and d_c = " + sidbc.Text + " and d_n " + (sidocno.Text.Trim() == string.Empty ? "is not null" : "= " + sidocno.Text.Trim()) + " and amount > 0";
                    ConnectionCommand.accountHelp_datatable_Seperate(siitemlist, "siitemlist");
                    if (siitemlist.Rows.Count <= 1)
                    {
                        sibasicamt.ReadOnly = false;
                        sibasicamt.Enabled = true;
                    }
                    else
                    {
                        sibasicamt.ReadOnly = true;
                        sale_invoice_amount = 0;
                        calculateSaleItemTotal();
                    }
                    fill_sale_list_array_for_items_list_stock_adding();
                }
            }
            else if (subtabsale.SelectedIndex == 3)
            {
                if (!new_sale_invoice && simple_docno.Text != "")
                {
                    ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd= '" + ConnectionWithAccess.mprd + "' and d_c = 1 and d_n " + (simple_docno.Text.Trim() == string.Empty ? "is not null" : "= " + simple_docno.Text.Trim()) + " and amount > 0";
                    ConnectionCommand.accountHelp_datatable_Seperate(simple_itemsalelist, "siitemlist");
                    if (simple_itemsalelist.Rows.Count <= 1)
                    {
                        sibasicamt.ReadOnly = false;
                        sibasicamt.Enabled = true;
                    }
                    else
                    {
                        sibasicamt.ReadOnly = true;
                        sale_invoice_amount = 0;
                        calculateSaleItemTotal();
                    }
                    fill_sale_list_array_for_items_list_stock_adding();
                    calculate_simple_SaleItemTotal();
                }
                simple_itemsalelist.Enabled = true;
            }
        }

        private void fill_sale_list_array_for_items_list_stock_adding()
        {
            item_sale_list.Clear();

            ConnectionWithAccess.query = "select [type], item_code, qty from " + ConnectionWithAccess.tablename[03] + " where prd= '" + ConnectionWithAccess.mprd + "' and d_c = " + sidbc.Text + " and d_n " + (sidocno.Text.Trim() == string.Empty ? "is not null" : "= " + sidocno.Text.Trim()) + " and amount > 0";
            DataTable dtSaleListData = ConnectionCommand.fGetDataTable();

            if (dtSaleListData != null && dtSaleListData.Rows.Count > 0)
            {
                int mcolumncount = dtSaleListData.Columns.Count;
                for (int irowCount = 0; irowCount < dtSaleListData.Rows.Count; irowCount++)
                {
                    temp_word = "";
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        temp_word += (dtSaleListData.Rows[irowCount][i].ToString().Trim()) + " ,";
                    }
                    temp_word = temp_word.Substring(0, temp_word.Length - 1);
                    item_sale_list.Add(temp_word);
                }
            }
        }

        public void purchase_invoice_item_filling()
        {
            piitemlist.DataSource = null;
            piitemlist.Rows.Clear();
            ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " f3 where d_n " + (pidocno.Text.Trim() == string.Empty ? "is null" : "= " + pidocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(pidbc.Text) + " and s_a = '" + pis_a.Text + "'";
            ConnectionCommand.accountHelp_datatable_Seperate(piitemlist, "piitemlist");
            if (piitemlist.Rows.Count <= 1)
            {
                pibasicamt.ReadOnly = false;
                pibasicamt.Enabled = true;
            }
            else
            {
                piitemlist.Enabled = true;
                pibasicamt.ReadOnly = true;
                calculatepurcItemTotal();
            }
            fill_purchase_list_array_for_items_list_stock_deleting();
        }

        private void fill_purchase_list_array_for_items_list_stock_deleting()
        {
            item_purchase_list.Clear();
            ConnectionWithAccess.query = "select [type], item_code, qty from " + ConnectionWithAccess.tablename[03] + " f3 where d_n " + (pidocno.Text.Trim() == string.Empty ? "is null" : "= " + pidocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(pidbc.Text) + " and s_a = '" + pis_a.Text + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();

            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                int mcolumncount = dtData1.Columns.Count;
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temp_word = "";
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        temp_word += dtData1.Rows[iRowCount][i].ToString();
                        account_detail_from_01.Add(temp_word);
                    }
                    temp_word = temp_word.Substring(0, temp_word.Length - 1);
                    item_purchase_list.Add(temp_word);
                }
            }
        }

        public void sale_replacement_item_filling()
        {
            sritemlist.DataSource = null;
            ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat from " + ConnectionWithAccess.tablename[03] + " where prd= '" + ConnectionWithAccess.mprd + "' and d_c = " + srdbc.Text + " and d_n  " + (srdocno.Text.Trim() == string.Empty ? "is null" : "= " + srdocno.Text.Trim());
            ConnectionCommand.accountHelp_datatable_Seperate(sritemlist, "sritemlist");
            if (sritemlist.Rows.Count <= 1)
            {
                srbasicamt.ReadOnly = false;
                srbasicamt.Enabled = true;
            }
            else
            {
                sritemlist.Enabled = true;
                srbasicamt.ReadOnly = true;
                sale_replacement_amount = 0;
                for (int i = 0; i < sritemlist.Rows.Count; i++)
                {
                    sale_replacement_amount = sale_replacement_amount + Convert.ToDouble(sritemlist.Rows[i].Cells[7].Value);
                }
                srbasicamt.Text = Convert.ToString(sale_replacement_amount);
            }
        }

        private void load_all_period_values()
        {
            //DateTime start_date, last_date;
            sidatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            srdatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            pidatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            brdatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            bpdatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            bddatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            bwdatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            crdatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            cpdatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            jjdatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            tr_datetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            mix_dt_from.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            mix_dt_to.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            RepFrom.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            RepTo.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            Ledfrom.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            LedTo.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            tr_datetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            dtp_rg_from_date.MinDate = Convert.ToDateTime("01/07/2017");
            dtp_rg_to_date.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            temp_word = DateTime.Today.ToShortDateString();
            if (Convert.ToDateTime(ConnectionWithAccess.com_end_date) > Convert.ToDateTime(temp_word))
                ConnectionWithAccess.com_end_date = temp_word;

            sidatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            srdatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            pidatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            brdatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            bpdatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            bddatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            bwdatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            crdatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            cpdatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            jjdatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            tr_datetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            mix_dt_from.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            mix_dt_to.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            RepFrom.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            RepTo.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            Ledfrom.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            LedTo.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            dtp_rg_from_date.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            dtp_rg_to_date.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            tr_datetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            if (Convert.ToDateTime(ConnectionWithAccess.medate) >= DateTime.Today)
            {
                last_date = DateTime.Today;
                first_date = Convert.ToDateTime(ConnectionWithAccess.msdate);
            }
            else
            {
                if (Convert.ToDateTime(ConnectionWithAccess.medate) >= DateTime.Today)
                    last_date = Convert.ToDateTime(ConnectionWithAccess.medate);
                else
                    last_date = DateTime.Today;

                first_date = Convert.ToDateTime(ConnectionWithAccess.msdate);
            }
            sidatetime.Value = last_date;
            srdatetime.Value = last_date;
            pidatetime.Value = last_date;
            brdatetime.Value = last_date;
            bpdatetime.Value = last_date;
            bddatetime.Value = last_date;
            bwdatetime.Value = last_date;
            crdatetime.Value = last_date;
            cpdatetime.Value = last_date;
            jjdatetime.Value = last_date;
            tr_datetime.Value = last_date;
            mix_dt_to.Value = last_date;
            RepTo.Value = last_date;
            LedTo.Value = last_date;
            dtp_rg_to_date.Value = last_date;
            RepFrom.Value = Convert.ToDateTime(first_date);
            Ledfrom.Value = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            mix_dt_from.Value = Convert.ToDateTime(first_date);
            dtp_rg_from_date.Value = Convert.ToDateTime("01/07/2017");

            sidatetime.MinDate = Convert.ToDateTime(first_date);
            srdatetime.MinDate = Convert.ToDateTime(first_date);
            pidatetime.MinDate = Convert.ToDateTime(first_date);
            brdatetime.MinDate = Convert.ToDateTime(first_date);
            bpdatetime.MinDate = Convert.ToDateTime(first_date);
            bddatetime.MinDate = Convert.ToDateTime(first_date);
            bwdatetime.MinDate = Convert.ToDateTime(first_date);
            crdatetime.MinDate = Convert.ToDateTime(first_date);
            cpdatetime.MinDate = Convert.ToDateTime(first_date);
            jjdatetime.MinDate = Convert.ToDateTime(first_date);
            tr_datetime.MinDate = Convert.ToDateTime(first_date);
            RepFrom.MinDate = Convert.ToDateTime(first_date);
            RepTo.MinDate = Convert.ToDateTime(first_date);
            Ledfrom.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            LedTo.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            tr_datetime.MinDate = Convert.ToDateTime(first_date);
            dtp_rg_from_date.MinDate = Convert.ToDateTime("01/07/2017");
            dtp_rg_to_date.MinDate = Convert.ToDateTime(first_date);

            sidatetime.MaxDate = Convert.ToDateTime(last_date);
            srdatetime.MaxDate = Convert.ToDateTime(last_date);
            pidatetime.MaxDate = Convert.ToDateTime(last_date);
            brdatetime.MaxDate = Convert.ToDateTime(last_date);
            bpdatetime.MaxDate = Convert.ToDateTime(last_date);
            bddatetime.MaxDate = Convert.ToDateTime(last_date);
            bwdatetime.MaxDate = Convert.ToDateTime(last_date);
            crdatetime.MaxDate = Convert.ToDateTime(last_date);
            cpdatetime.MaxDate = Convert.ToDateTime(last_date);
            jjdatetime.MaxDate = Convert.ToDateTime(last_date);
            tr_datetime.MaxDate = Convert.ToDateTime(last_date);
            RepFrom.MaxDate = Convert.ToDateTime(last_date);
            RepTo.MaxDate = Convert.ToDateTime(last_date);
            Ledfrom.MaxDate = Convert.ToDateTime(last_date);
            LedTo.MaxDate = Convert.ToDateTime(last_date);
            tr_datetime.MaxDate = Convert.ToDateTime(last_date);
            dtp_rg_from_date.MaxDate = Convert.ToDateTime(last_date);
            dtp_rg_to_date.MaxDate = Convert.ToDateTime(last_date);
        }

        private void fill_chkpartylist()
        {
            cbRepType.SelectedIndex = 0;
            cbRepSubType.SelectedIndex = 0;
            ConnectionWithAccess.query = "select [desc],city,a_n,s_a from " + ConnectionWithAccess.tablename[01] + " f1 where f1.a_n = '2002' and f1.s_a <> '@@@'";
            ConnectionWithAccess.fillCheckListBox(chkpartyList);
            ConnectionWithAccess.query = "select distinct [city] from " + ConnectionWithAccess.tablename[01] + " f1 where f1.a_n = '2002' and f1.s_a <> '@@@'";
            ConnectionWithAccess.fillCheckListBox(chkcityList);
        }

        private void refresh_UserListDG()
        {
            //UserListDG.Rows.Clear();
            UserListDG.DataSource = null;
            ConnectionWithAccess.query = "select f1, f2, f3, f4, f5, f6, f7, f8, f9 from " + ConnectionWithAccess.tablename[52];
            ConnectionCommand.accountHelp_datatable_Seperate(UserListDG, "UserListDG");
        }

        #region find_data
        private void find_new_name_a_n(string ma_n, string mdesc)
        {
            isRecord = 0;
            temporary_list_array.Clear();
            if (cbParent.SelectedItem.Equals("SUNDRY CREDITORS") || cbParent.SelectedItem.Equals("SUNDRY DEBTORS"))
                ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[01] + " f1 where a_n like '" + tbA_N.Text + "%' and s_a = '" + tbS_A.Text + "'";
            else
                ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[01] + " f1 where a_n like '" + tbA_N.Text + "%' and s_a = '" + tbS_A.Text + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temporary_list_array.Add(dtData1.Rows[iRowCount][0].ToString());
                }
            }
            if (temporary_list_array.Count() >= 1)
            {
                temporary_list_array.Sort();
                temp_count = temporary_list_array.Count() - 1;
                temp_word = temporary_list_array[temp_count];
                if (temp_word.Length > 4)
                    temp_word2 = temp_word.Substring(4, temp_word.Length - 4);
                temp_word = temp_word.Substring(0, 4);
                //temp_word2 = temporary_array[temp_count].Substring(temp_word.Length, (temporary_array[temp_count].Length - temp_word.Length));
                temp_word2 = Convert.ToString(Convert.ToInt32(temp_word2) + 1);
                if (temp_word2.Length == 1)
                    temp_word2 = "0" + temp_word2;
                tbA_N.Text = temp_word + temp_word2;
            }
            else
                tbA_N.Text = tbA_N.Text + "01";
        }

        private void find_new_name_s_a(string ma_n, string mdesc)
        {
            if (mdesc.Contains(" "))
            {
                int aaa = mdesc.IndexOf(" ");
                tbS_A.Text = (mdesc.Substring(0, 1) + mdesc.Substring(aaa - 1, 1)).ToUpper();
            }
            else
                tbS_A.Text = (mdesc.Substring(0, 1) + mdesc.Substring(mdesc.Length - 1, 1)).ToUpper();
            isRecord = 0;
            temporary_list_array.Clear();
            ConnectionWithAccess.query = "select s_a from " + ConnectionWithAccess.tablename[01] + " f1 where a_n = '" + tbA_N.Text + "' and s_a like '" + tbS_A.Text + "%'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temporary_list_array.Add(dtData1.Rows[iRowCount][0].ToString());
                }
            }
            if (temporary_list_array.Count() >= 1)
            {
                temporary_list_array.Sort();
                temp_count = temporary_list_array.Count() - 1;
                temp_word = temporary_list_array[temp_count];
                temp_word = temp_word.Substring(0, temp_word.Length - 1);
                temp_word2 = temporary_list_array[temp_count].Substring(temp_word.Length, (temporary_list_array[temp_count].Length - temp_word.Length));
                if (temp_word2 == "9")
                    temp_word2 = "@";
                char c = Convert.ToChar(temp_word2);
                asc_value = Convert.ToInt32(c);
                c = Convert.ToChar(asc_value + 1);
                temp_word2 = c.ToString();
                tbS_A.Text = temp_word + temp_word2;
            }
            else
                tbS_A.Text = tbS_A.Text + "1";
        }

        private void find_new_delivery_s_a(string ma_n, string ms_a, string tbdelivery)
        {
            if (tbdelivery.Contains(" "))
            {
                int aaa = tbdelivery.IndexOf(" ");
                tbd_y.Text = (tbdelivery.Substring(0, 1) + tbdelivery.Substring(aaa - 1, 1)).ToUpper();
            }
            else
                tbd_y.Text = (tbdelivery.Substring(0, 1) + tbdelivery.Substring(tbdelivery.Length - 1, 1)).ToUpper();
            isRecord = 0;
            ConnectionWithAccess.query = "select d_y from " + ConnectionWithAccess.tablename[01] + " f1 where a_n = '" + tbA_N.Text + "' and s_a = '" + tbS_A.Text + "' and d_y like '" + tbd_y.Text + "%'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temporary_list_array.Add(dtData1.Rows[iRowCount][0].ToString());
                }
            }
            if (temporary_list_array.Count() >= 1)
            {
                temporary_list_array.Sort();
                temp_count = temporary_list_array.Count() - 1;
                temp_word = temporary_list_array[temp_count];
                temp_word = temp_word.Substring(0, temp_word.Length - 1);
                temp_word2 = temporary_list_array[temp_count].Substring(temp_word.Length, (temporary_list_array[temp_count].Length - temp_word.Length));
                if (temp_word2 == "9")
                    temp_word2 = "@";
                char c = Convert.ToChar(temp_word2);
                asc_value = Convert.ToInt32(c);
                c = Convert.ToChar(asc_value + 1);
                temp_word2 = c.ToString();
                tbd_y.Text = temp_word + temp_word2;
            }
            else
                tbd_y.Text = tbd_y.Text + "1";
        }

        private void find_new_item_code()
        {
            master_item_help.Visible = false;
            temporary_list_array.Clear();
            ConnectionWithAccess.query = "select item_code from " + ConnectionWithAccess.tablename[05];
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temporary_list_array.Add(dtData1.Rows[iRowCount][0].ToString());
                }
                for (int i = 0; i < temporary_list_array.Count; i++)
                {
                    check_data_type(temporary_list_array[i].Trim());
                    if (data_type == "Numeric")
                    {
                        if (Convert.ToInt32(temporary_list_array[i].Trim()) > temp_int)
                            temp_int = Convert.ToInt32(temporary_list_array[i].Trim());
                    }
                }
                tbItemCode.Text = Convert.ToString(temp_int + 1);
            }
            else
                tbItemCode.Text = "1";
        }

        private void find_new_additional_a_n(string ma_n)
        {
            isRecord = 0;
            temporary_list_array.Clear();
            ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[01] + " where a_n like '" + ConnectionWithAccess.fix_account_a_n + "%' and s_a ='@@@'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
                isRecord = 1;
            if (isRecord == 1)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temporary_list_array.Add(dtData1.Rows[iRowCount][0].ToString());
                }
                for (int i = 0; i < temporary_list_array.Count; i++)
                {
                    check_data_type(temporary_list_array[i].Trim());
                    if (data_type == "Numeric")
                    {
                        if (Convert.ToInt32(temporary_list_array[i].Trim()) > temp_int)
                            temp_int = Convert.ToInt32(temporary_list_array[i].Trim());
                    }
                }
                ConnectionWithAccess.new_additional_a_n = ConnectionWithAccess.fix_account_a_n + Convert.ToString(temp_int + 1);
            }
            else
                ConnectionWithAccess.new_additional_a_n = ConnectionWithAccess.fix_account_a_n + "1";
        }

        private void find_new_tax_code()
        {
            master_item_help.Visible = false;
            temporary_list_array.Clear();
            ConnectionWithAccess.query = "select tx_code from " + ConnectionWithAccess.tablename[06] + " where d_c = " + cb_tax_d_c.Text;
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
                isRecord = 1;
            temp_int = 0;
            if (isRecord == 1)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temporary_list_array.Add(dtData1.Rows[iRowCount][0].ToString());
                }
                for (int i = 0; i < temporary_list_array.Count; i++)
                {
                    check_data_type(temporary_list_array[i].Trim());
                    if (data_type == "Numeric")
                    {
                        if (Convert.ToInt32(temporary_list_array[i].Trim()) > temp_int)
                            temp_int = Convert.ToInt32(temporary_list_array[i].Trim());
                    }
                }
                tbTaxCode.Text = Convert.ToString(temp_int + 1);
            }
            else
                tbTaxCode.Text = "1";
        }

        private int find_new_d_c(string book)
        {
            isRecord = 0;
            temporary_list_array.Clear();
            if (book == "S")
                ConnectionWithAccess.query = "select d_c from " + ConnectionWithAccess.tablename[21] + " f1 where d_n = 999999";
            else if (book == "P")
                ConnectionWithAccess.query = "select d_c from " + ConnectionWithAccess.tablename[22] + " f1 where d_n = 999999";
            else if (book == "B")
                ConnectionWithAccess.query = "select d_c from " + ConnectionWithAccess.tablename[23] + " f1 where d_n = 999999";
            else if (book == "C")
                ConnectionWithAccess.query = "select d_c from " + ConnectionWithAccess.tablename[24] + " f1 where d_n = 999999";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temporary_list_array.Add(dtData1.Rows[iRowCount][0].ToString());
                }
            }
            if (temporary_list_array.Count() >= 1)
            {
                temporary_list_array.Sort();
                temp_count = temporary_list_array.Count() - 1;
                temp_int = Convert.ToInt32(temporary_list_array[temp_count]);
                if (book == "S")
                {
                    if (temp_int < 10)
                        temp_int += 10;
                    else
                        temp_int++;
                }
                else if (book == "P")
                {
                    if (temp_int < 20)
                        temp_int += 20;
                    else
                        temp_int++;
                }
                else if (book == "B")
                {
                    if (temp_int < 30)
                        temp_int += 30;
                    else
                        temp_int++;
                }
                else if (book == "C")
                {
                    if (temp_int < 40)
                        temp_int += 40;
                    else
                        temp_int++;
                }
            }
            return temp_int;
        }
        #endregion

        # region insert_data
        private void add_update_user()
        {
            if (tbUserName != null)
            {
                isRecord = 0;
                ConnectionWithAccess.query = "select f1 from " + ConnectionWithAccess.tablename[52] + " f52 where f1 = '" + tbUserName.Text + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                    isRecord = 1;

                if (isRecord == 1)
                {
                    readusersettingsfromscreen();
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[52] + " set f2 = '" + tbPassword.Text + "', f3 = '" + ConnectionWithAccess.mUserFeatures + "' where f1 = '" + tbUserName.Text + "'";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
                else
                {
                    readusersettingsfromscreen();
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[52] + " (f1,f2,f3) values ('" + tbUserName.Text + "', '" + tbPassword.Text + "','" + ConnectionWithAccess.mUserFeatures + "')";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
                ClearAllUserSettings();
                refresh_UserListDG();
                tbUserName.Text = "";
                tbPassword.Text = "";
            }
        }

        private void save_master_item()
        {
            if (tbItemCode.Text != null && tbTitle.Text != "")
            {
                if (tbItemType.Text == "")
                    tbItemType.Text = "F";
                if (tb_igst_tax_rate.Text == "")
                    tb_igst_tax_rate.Text = "0.00";
                if (tb_hsn_code.Text == "")
                    tb_hsn_code.Text = "0";
                if (tb_item_open_stock.Text == "")
                    tb_item_open_stock.Text = "0";
                if (tb_purc_price.Text == "")
                    tb_purc_price.Text = "0";
                if (tbCB.Text == "0")
                    tbCB.Text = "1";
                if (tbBQ.Text == "0")
                    tbBQ.Text = "1";
                if (!cb_change_item_name.Checked)
                {
                    isRecord = 0;
                    ConnectionWithAccess.query = "select [type],item_code from " + ConnectionWithAccess.tablename[05] + " where [title] = '" + tbTitle.Text + "'";
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                        isRecord = 1;

                    if (isRecord == 0)
                    {
                        find_new_item_code();
                        ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[05] + " ([type],item_code,[title],p_price,price,packing,box,cat,opn_stk,clo_stk,igst_per,hsn_code) values('" + tbItemType.Text + "','" + tbItemCode.Text + "','" + tbTitle.Text + "', " + tb_purc_price.Text + " , " + tbItemRate.Text + " , " + tbCB.Text + " , " + tbBQ.Text + " , '" + cbItemUnit.Text + "', " + tb_item_open_stock.Text + " , " + tbCurStock.Text + " , " + tb_igst_tax_rate.Text + " , " + tb_hsn_code.Text + ")";
                        ConnectionCommand.fUpdateInsertDeleteData();
                    }
                    else
                    {
                        ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[05] + " set [type] = '" + tbItemType.Text + "', item_code = '" + tbItemCode.Text + "', price = " + tbItemRate.Text + " , packing = " + tbCB.Text + " , box = " + tbBQ.Text + " , cat = '" + cbItemUnit.Text + "' , opn_stk = " + tb_item_open_stock.Text + " , clo_stk = " + (Convert.ToDouble(tbCurStock.Text) - temp_double + Convert.ToDouble(tb_item_open_stock.Text)).ToString() + " , igst_per = " + tb_igst_tax_rate.Text + " , hsn_code = " + tb_hsn_code.Text + " , p_price = " + tb_purc_price.Text + " where [title] = '" + tbTitle.Text + "'";
                        ConnectionCommand.fUpdateInsertDeleteData();
                    }
                }
                else
                {
                    isRecord = 0;
                    ConnectionWithAccess.query = "select 1 from " + ConnectionWithAccess.tablename[05] + " where [title] = '" + tbTitle.Text + "'";
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                        isRecord = 1;

                    if (isRecord == 0)
                    {
                        ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[05] + " set [title] = '" + tbTitle.Text + "' where [type] = '" + tbItemType.Text + "' and [item_code] = '" + tbItemCode.Text + "'";
                        ConnectionCommand.fUpdateInsertDeleteData();
                    }
                    else
                        MessageBox.Show("Sorry, Item Name already Exists");
                }
            }
            cb_change_item_name.Checked = false;
        }

        private void insert_master_tax()
        {
            isRecord = 0;
            ConnectionWithAccess.query = "select tax_rate,[desc] from " + ConnectionWithAccess.tablename[06] + " where d_c = " + cb_tax_d_c.Text + " and tx_code = " + tbTaxCode.Text;
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
                isRecord = 1;

            if (isRecord == 0)
            {
                find_new_tax_code();
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[06] + " (d_c,tx_code,[desc],tax_rate) values(" + cb_tax_d_c.Text + " , " + tbTaxCode.Text + " ,'" + tbTaxDesc.Text + "'," + tbTaxRate.Text + ")";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
            else
            {
                ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[06] + " set [desc] = '" + tbTaxDesc.Text + "', tax_rate = " + tbTaxRate.Text + " , a_n = '" + cb_tax_transfer_account.Text + "' where d_c = " + cb_tax_d_c.Text + " and tx_code = " + tbTaxCode.Text;
                ConnectionCommand.fUpdateInsertDeleteData();
            }
        }

        private void insert_master_daybook_code()
        {
            if (cbAction.SelectedIndex == 0)
            {
                isRecord = 0;
                ConnectionWithAccess.query = "select d_c,a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + tbDBC.Text + " and d_n = 999999";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                    isRecord = 1;

                if (isRecord == 0)
                {
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[21] + " (d_c,a_n,s_a,d_y,d_n,d_d,b_t) values(" + tbDBC.Text + " , '" + cb_transfer_account.Text + "', '@@@','@@@', 999999, '01/01/1901', '1')";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
                else
                {
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[21] + " set a_n = '" + cb_transfer_account.Text + "', s_a = '@@@', d_y = '@@@', d_d = '01/01/1901',  b_t = '1' where d_c = " + tbDBC.Text + " and d_n = 999999";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }
            else if (cbAction.SelectedIndex == 1)
            {
                isRecord = 0;
                ConnectionWithAccess.query = "select d_c,a_n from " + ConnectionWithAccess.tablename[22] + " where d_c = " + tbDBC.Text + " and d_n = 999999";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                    isRecord = 1;

                if (isRecord == 0)
                {
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[22] + " (d_c,a_n,s_a,d_n,d_d,b_t) values(" + tbDBC.Text + " , '" + cb_transfer_account.Text + "', '@@@', 999999, '01/01/1901', '1')";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
                else
                {
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[22] + " set a_n = '" + cb_transfer_account.Text + "', s_a = '@@@', d_y = '@@@', d_d = '01/01/1901',  b_t = '1' where d_c = " + tbDBC.Text + " and d_n = 999999";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }
            else if (cbAction.SelectedIndex == 2)
            {
                isRecord = 0;
                ConnectionWithAccess.query = "select d_c,a_n from " + ConnectionWithAccess.tablename[23] + " where d_c = " + tbDBC.Text + " and d_n = 999999";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                    isRecord = 1;

                if (isRecord == 0)
                {
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[23] + " (d_c,a_n,s_a,d_n,d_d,b_t) values(" + tbDBC.Text + " , '" + cb_transfer_account.Text + "', '@@@', 999999, '01/01/1901', '1')";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
                else
                {
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[23] + " set a_n = '" + cb_transfer_account.Text + "', s_a = '@@@', d_y = '@@@', d_d = '01/01/1901',  b_t = '1' where d_c = " + tbDBC.Text + " and d_n = 999999";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }
            else if (cbAction.SelectedIndex == 3)
            {
                isRecord = 0;
                ConnectionWithAccess.query = "select d_c,a_n from " + ConnectionWithAccess.tablename[24] + " where d_c = " + tbDBC.Text + " and d_n = 999999";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                    isRecord = 1;
                if (isRecord == 0)
                {
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[24] + " (d_c,a_n,s_a,d_n,d_d,b_t) values(" + tbDBC.Text + " , '" + cb_transfer_account.Text + "', '@@@', 999999, '01/01/1901', '1')";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
                else
                {
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[24] + " set a_n = '" + cb_transfer_account.Text + "', s_a = '@@@', d_y = '@@@', d_d = '01/01/1901',  b_t = '1' where d_c = " + tbDBC.Text + " and d_n = 999999";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }
            else if (cbAction.SelectedIndex == 5)
            {
                isRecord = 0;
                ConnectionWithAccess.query = "select d_c,a_n from " + ConnectionWithAccess.tablename[30] + " where d_c = " + tbDBC.Text + " and d_n = 999999";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                    isRecord = 1;
                if (isRecord == 0)
                {
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[30] + " (d_c,a_n,s_a,d_n,d_d,b_t) values(" + tbDBC.Text + " , '" + cb_transfer_account.Text + "', '@@@', 999999, '01/01/1901', '1')";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
                else
                {
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[30] + " set a_n = '" + cb_transfer_account.Text + "', s_a = '@@@', d_d = '01/01/1901',  b_t = '1' where d_c = " + tbDBC.Text + " and d_n = 999999";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }
            else if (cbAction.SelectedIndex == 6)
            {
                isRecord = 0;
                ConnectionWithAccess.query = "select d_c,a_n from " + ConnectionWithAccess.tablename[7] + " where d_c = " + tbDBC.Text + " and d_n = 999999";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                    isRecord = 1;

                if (isRecord == 0)
                {
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[7] + " (d_c,a_n,s_a,d_n,d_d,b_t) values(" + tbDBC.Text + " , '" + cb_transfer_account.Text + "', '', 999999, '01/01/1901', '1')";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
                else
                {
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[7] + " set a_n = '" + cb_transfer_account.Text + "', d_d = '01/01/1901',  b_t = '1' where d_c = " + tbDBC.Text + " and d_n = 999999";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }
        }

        # endregion

        private void save_master_account()
        {
            if (tbPincode.Text == "")
                tbPincode.Text = "0";
            if (!cbParent.SelectedItem.Equals("Unknown"))
            {
                if (cbParent.SelectedItem.Equals("BANK ACCOUNT") || cbParent.SelectedItem.Equals("CASH IN HAND") || cbParent.SelectedItem.Equals("SUNDRY CREDITORS") || cbParent.SelectedItem.Equals("SUNDRY DEBTORS"))
                {
                    if (cbParent.SelectedItem.Equals("SUNDRY DEBTORS"))
                    {
                        mtx_desc = cbMtaxDesc.Text;
                        get_tx_code_from_tax_name("S", mtx_desc, cb_master_d_c.Text);
                    }
                    else if (cbParent.SelectedItem.Equals("SUNDRY CREDITORS"))
                    {
                        mtx_desc = cbMtaxDesc.Text;
                        get_tx_code_from_tax_name("P", mtx_desc, cb_master_d_c.Text);
                    }
                    if (tbdelivery.Text != "")
                    {
                        isRecord = 0;
                        ConnectionWithAccess.query = "select d_y from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + tbA_N.Text + "' and s_a = '" + tbS_A.Text + "' and d_y = '" + tbd_y.Text + "'  and [DESC] = '" + tbdelivery.Text + "' and city = '" + tbdelivery_city.Text + "'";
                        DataTable dtData1 = ConnectionCommand.fGetDataTable();

                        if (dtData1 != null && dtData1.Rows.Count > 0)
                        {
                            if (dtData1.Rows[0][0] != null)
                            {
                                isRecord = 1;
                                tbd_y.Text = dtData1.Rows[0][0].ToString();
                            }
                        }
                        if (isRecord == 0)
                        {
                            find_new_delivery_s_a(tbA_N.Text, tbS_A.Text, tbdelivery.Text);
                            add_update_record_in_01_and_04(tbA_N.Text, tbS_A.Text, tbd_y.Text, tbDesc.Text, tbCity.Text);
                        }
                        else
                            add_update_record_in_01_and_04(tbA_N.Text, tbS_A.Text, tbd_y.Text, tbDesc.Text, tbCity.Text);
                    }
                    else
                    {
                        if (tbd_y.Text == "")
                            tbd_y.Text = "@@@";
                        if (cb_change_master_account_name.Checked)
                        {
                            if (tbDesc.Text.Length > 0)
                                tbDesc.Text = tbDesc.Text.Trim();
                            if (tbDesc.Text != "")
                                add_update_record_in_01_and_04(tbA_N.Text, tbS_A.Text, tbd_y.Text, tbDesc.Text, tbCity.Text);
                        }
                        else
                        {
                            // for changing name or city of account
                            //check_for_duplicate_name_city_a_n_exist_for_account();
                            if (cb_add_new_account.Checked == true)
                            {
                                if (cbParent.SelectedItem.Equals("BANK ACCOUNT"))
                                    mbook = "B";
                                else if (cbParent.SelectedItem.Equals("CASH IN HAND"))
                                    mbook = "C";
                                else if (cbParent.SelectedItem.Equals("SUNDRY CREDITORS"))
                                    mbook = "P";
                                else if (cbParent.SelectedItem.Equals("SUNDRY DEBTORS"))
                                    mbook = "S";
                                find_new_name_a_n(tbA_N.Text, tbDesc.Text);
                                tbS_A.Text = "@@@";
                                tbd_y.Text = "@@@";
                                add_new_book(mbook, tbA_N.Text, tbS_A.Text, tbDesc.Text, tbCity.Text);
                            }
                            else
                                if (tbDesc.Text != "")
                                    add_update_record_in_01_and_04(tbA_N.Text, tbS_A.Text, tbd_y.Text, tbDesc.Text, tbCity.Text);
                        }
                    }
                }
                else
                {
                    if (cb_add_new_account.Checked == true)
                    {
                        find_new_name_a_n(tbA_N.Text, tbDesc.Text);
                        tbS_A.Text = "@@@";
                        tbd_y.Text = "@@@";
                        add_update_record_in_01_and_04(tbA_N.Text, tbS_A.Text, tbd_y.Text, tbDesc.Text, tbCity.Text);
                    }
                    else
                        add_update_record_in_01_and_04(tbA_N.Text, tbS_A.Text, tbd_y.Text, tbDesc.Text, tbCity.Text);
                }
                save_bank_details();
                update_amount_in_51("@", tbA_N.Text, tbS_A.Text, Convert.ToDouble(tbopenbalance.Text));
            }
            else
                MessageBox.Show("Account Cannot be saved with Unknown Parent Account");
            refresh_master_account();
        }

        private void add_new_book(string book, string ma_n, string ms_a, string mdesc, string mcity)
        {
            ConnectionWithAccess.md_c = 0;
            ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[01] + " (a_n, s_a,d_y, [desc], city,country,pin,bst,aadhar_card,dist,gst_number,state) values('" + tbA_N.Text + "', '" + tbS_A.Text + "' , '" + tbd_y.Text + "' , '" + tbDesc.Text + "', '" + tbCity.Text + "', '" + tbcountry.Text + "', '" + tbPincode.Text + "' ,'','" + tbadharcard.Text + "','" + tbdistrict.Text + "', '" + tbgst_number.Text + "', '" + tbstate.Text + "')";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.md_c = find_new_d_c(book);
            if (book == "S")
            {
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[21] + " (d_c,a_n,s_a,d_n,d_d,b_t) values(" + ConnectionWithAccess.md_c + " , '" + ma_n + "', '" + ms_a + "', 999999, '01/01/1901', '1')";
            }
            else if (book == "P")
            {
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[22] + " (d_c,a_n,s_a,d_n,d_d,b_t) values(" + ConnectionWithAccess.md_c + " , '" + ma_n + "', '" + ms_a + "', 999999, '01/01/1901', '1')";
            }
            else if (book == "B")
            {
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[23] + " (d_c,a_n,s_a,d_n,d_d,b_t) values(" + ConnectionWithAccess.md_c + " , '" + ma_n + "', '" + ms_a + "', 999999, '01/01/1901', '1')";
            }
            else if (book == "C")
            {
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[24] + " (d_c,a_n,s_a,d_n,d_d,b_t) values(" + ConnectionWithAccess.md_c + " , '" + ma_n + "', '" + ms_a + "', 999999, '01/01/1901', '1')";
            }
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void add_update_record_in_01_and_04(string ma_n, string ms_a, string md_y, string mdesc, string mcity)
        {
            if (md_y == null || md_y == "")
                md_y = "@@@";
            if (md_y == "@@@")
            {
                isRecord = 0;
                if (cb_change_master_account_name.Checked)
                {
                    ConnectionWithAccess.query = "select s_a from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + ma_n + "' and s_a = '" + ms_a + "'";
                }
                else
                {
                    if (mcity == "")
                        ConnectionWithAccess.query = "select s_a from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + ma_n + "' and [DESC] = '" + mdesc + "' and s_a = '" + ms_a + "'";
                    else
                        ConnectionWithAccess.query = "select s_a from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + tbA_N.Text + "' and [desc] = '" + tbDesc.Text + "' and city = '" + tbCity.Text + "'";
                }
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                        isRecord = 1;
                }
                if (isRecord == 0)
                {
                    find_new_name_s_a(tbA_N.Text, tbDesc.Text);
                    ms_a = tbS_A.Text;
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[01] + " (a_n, s_a,d_y, [desc], city,country,pin,bst,aadhar_card,dist,gst_number,state) values('" + tbA_N.Text + "', '" + tbS_A.Text + "' , '" + tbd_y.Text + "' , '" + tbDesc.Text + "', '" + tbCity.Text + "', '" + tbcountry.Text + "', '" + tbPincode.Text + "' ,'','" + tbadharcard.Text + "','" + tbdistrict.Text + "', '" + tbgst_number.Text + "', '" + tbstate.Text + "')";
                }
                else
                {
                    if (cb_change_master_account_name.Checked == true)
                    {
                        ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[01] + " set [desc] = '" + tbDesc.Text + "', city = '" + mcity + "', country = '" + tbcountry.Text + "', pin = '" + tbPincode.Text + "' , aadhar_card = '" + tbadharcard.Text + "' , dist = '" + tbdistrict.Text + "' , gst_number = '" + tbgst_number.Text + "', pan = '" + tbpan.Text + "', state = '" + tbstate.Text + "' where a_n = '" + ma_n + "' and s_a = '" + ms_a + "'";
                    }
                    else
                    {
                        if (cb_add_new_account.Checked == false)
                            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[01] + " set city = '" + mcity + "', country = '" + tbcountry.Text + "', pin = '" + tbPincode.Text + "' , aadhar_card = '" + tbadharcard.Text + "' , dist = '" + tbdistrict.Text + "' , gst_number = '" + tbgst_number.Text + "', pan = '" + tbpan.Text + "', state = '" + tbstate.Text + "' where a_n = '" + ma_n + "' and s_a = '" + ms_a + "'";
                        else
                            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[01] + " set city = '" + mcity + "', country = '" + tbcountry.Text + "', pin = '" + tbPincode.Text + "' , aadhar_card = '" + tbadharcard.Text + "' , dist = '" + tbdistrict.Text + "' , gst_number = '" + tbgst_number.Text + "', pan = '" + tbpan.Text + "', state = '" + tbstate.Text + "' where a_n = '" + ma_n + "' and [DESC] = '" + tbDesc.Text + "' and city = '" + mcity + "'";
                    }
                }
                ConnectionCommand.fUpdateInsertDeleteData();
                isRecord = 0;
                ConnectionWithAccess.query = "select 1 from " + ConnectionWithAccess.tablename[04] + " where a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and d_y = '@@@'";
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        isRecord = 1;
                    }
                }
                if (isRecord == 0)
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[4] + " (A_n, s_a,d_y,city,add1,add2,add3,tin_num,tpt,std,o_mob,r_mob,phone1,phone12,phone2,fax,email,web,tx_code) values('" + tbA_N.Text + "', '" + tbS_A.Text + "', '" + tbd_y.Text + "', '" + mcity + "', '" + tbAdd1.Text + "' , '" + tbAdd2.Text + "' , '" + tbAdd3.Text + "' , '" + tbTINNo.Text + "' , '" + tbTPT.Text + "' , '" + tbStd.Text + "','" + tbMNo1.Text + "', '" + tbMNo2.Text + "' , '" + tbOPh1.Text + "' , '" + tbOPh2.Text + "' , '" + tbRPh2.Text + "' , '" + tbFax.Text + "' , '" + tbEmail.Text + "' , '" + tbWebsite.Text + "'," + tbTaxCode.Text + ")";
                else
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[4] + " set city  = '" + mcity + "', o_mob = '" + tbMNo1.Text + "', r_mob = '" + tbMNo2.Text + "', phone1 = '" + tbOPh1.Text + "', phone12 = '" + tbOPh2.Text + "', phone2 = '" + tbRPh2.Text + "', add1 = '" + tbAdd1.Text + "', add2 = '" + tbAdd2.Text + "', add3 = '" + tbAdd3.Text + "', tin_num = '" + tbTINNo.Text + "', tpt = '" + tbTPT.Text + "', std = '" + tbStd.Text + "', fax = '" + tbFax.Text + "', email = '" + tbEmail.Text + "', web = '" + tbWebsite.Text + "', tx_code = " + tbTaxCode.Text + " where a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and d_y = '@@@'";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
            else
            {
                isRecord = 0;
                if (cb_change_master_account_name.Checked)
                {
                    ConnectionWithAccess.query = "select s_a from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and d_y = '" + md_y + "'";
                }
                else
                {
                    if (mcity == "")
                        ConnectionWithAccess.query = "select s_a from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + tbA_N.Text + "' and [DESC] = '" + tbdelivery.Text + "' and s_a = '" + ms_a + "' and d_y = '" + md_y + "'";
                    else
                        ConnectionWithAccess.query = "select s_a from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + tbA_N.Text + "' and s_a = '" + ms_a + "' and d_y = '" + md_y + "'";
                }
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                        isRecord = 1;
                }
                if (isRecord == 0)
                {
                    find_new_delivery_s_a(tbA_N.Text, tbS_A.Text, tbdelivery.Text);
                    md_y = tbd_y.Text;
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[01] + " (a_n, s_a,d_y, [desc], city,country,pin,bst,aadhar_card,dist,gst_number,state) values('" + tbA_N.Text + "', '" + tbS_A.Text + "' , '" + tbd_y.Text + "' , '" + tbdelivery.Text + "', '" + tbdelivery_city.Text + "', '" + tbcountry.Text + "', '" + tbPincode.Text + "' ,'','" + tbadharcard.Text + "','" + tbdistrict.Text + "', '" + tbgst_number.Text + "', '" + tbstate.Text + "')";
                }
                else
                {
                    if (cb_change_master_account_name.Checked == true)
                    {
                        ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[01] + " set [desc] = '" + tbdelivery.Text + "', city = '" + tbdelivery_city.Text + "', country = '" + tbcountry.Text + "', pin = '" + tbPincode.Text + "' , aadhar_card = '" + tbadharcard.Text + "' , dist = '" + tbdistrict.Text + "' , gst_number = '" + tbgst_number.Text + "', pan = '" + tbpan.Text + "', state = '" + tbstate.Text + "' where a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and d_y = '" + md_y + "'";
                    }
                    else
                    {
                        if (cb_add_new_account.Checked == false)
                            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[01] + " set [desc] = '" + tbdelivery.Text + "', city = '" + tbdelivery_city.Text + "', country = '" + tbcountry.Text + "', pin = '" + tbPincode.Text + "' , aadhar_card = '" + tbadharcard.Text + "' , dist = '" + tbdistrict.Text + "' , gst_number = '" + tbgst_number.Text + "', pan = '" + tbpan.Text + "', state = '" + tbstate.Text + "' where a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and d_y = '" + md_y + "'";
                        else
                            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[01] + " set country = '" + tbcountry.Text + "', pin = '" + tbPincode.Text + "' , aadhar_card = '" + tbadharcard.Text + "' , dist = '" + tbdistrict.Text + "' , gst_number = '" + tbgst_number.Text + "', pan = '" + tbpan.Text + "', state = '" + tbstate.Text + "' where a_n = '" + ma_n + "' and [DESC] = '" + tbdelivery.Text + "' and city = '" + tbdelivery_city + "' and s_a = '" + ms_a + "'";
                    }
                }
                ConnectionCommand.fUpdateInsertDeleteData();
                isRecord = 0;
                ConnectionWithAccess.query = "select 1 from " + ConnectionWithAccess.tablename[04] + " where a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and d_y = '" + md_y + "'";
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        isRecord = 1;
                    }
                }
                if (isRecord == 0)
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[4] + " (A_n, s_a,d_y,city,add1,add2,add3,tin_num,tpt,std,o_mob,r_mob,phone1,phone12,phone2,fax,email,web,tx_code) values('" + tbA_N.Text + "', '" + tbS_A.Text + "', '" + tbd_y.Text + "', '" + tbdelivery_city.Text + "', '" + tbAdd1.Text + "' , '" + tbAdd2.Text + "' , '" + tbAdd3.Text + "' , '" + tbTINNo.Text + "' , '" + tbTPT.Text + "' , '" + tbStd.Text + "','" + tbMNo1.Text + "', '" + tbMNo2.Text + "' , '" + tbOPh1.Text + "' , '" + tbOPh2.Text + "' , '" + tbRPh2.Text + "' , '" + tbFax.Text + "' , '" + tbEmail.Text + "' , '" + tbWebsite.Text + "'," + tbTaxCode.Text + ")";
                else
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[4] + " set city  = '" + mcity + "', o_mob = '" + tbMNo1.Text + "', r_mob = '" + tbMNo2.Text + "', phone1 = '" + tbOPh1.Text + "', phone12 = '" + tbOPh2.Text + "', phone2 = '" + tbRPh2.Text + "', add1 = '" + tbAdd1.Text + "', add2 = '" + tbAdd2.Text + "', add3 = '" + tbAdd3.Text + "', tin_num = '" + tbTINNo.Text + "', tpt = '" + tbTPT.Text + "', std = '" + tbStd.Text + "', fax = '" + tbFax.Text + "', email = '" + tbEmail.Text + "', web = '" + tbWebsite.Text + "', tx_code = " + tbTaxCode.Text + " where a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and d_y = '" + md_y + "'";
                    //ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[4] + " set o_mob = '" + tbMNo1.Text + "', r_mob = '" + tbMNo2.Text + "', phone1 = '" + tbOPh1.Text + "', phone12 = '" + tbOPh2.Text + "', phone2 = '" + tbRPh2.Text + "', add1 = '" + tbAdd1.Text + "', add2 = '" + tbAdd2.Text + "', add3 = '" + tbAdd3.Text + "', tin_num = '" + tbTINNo.Text + "', tpt = '" + tbTPT.Text + "', std = '" + tbStd.Text + "', fax = '" + tbFax.Text + "', email = '" + tbEmail.Text + "', web = '" + tbWebsite.Text + "', tx_code = " + tbTaxCode.Text + " where a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and d_y = '" + md_y + "'";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
        }

        private void check_for_duplicate_name_city_a_n_exist_for_account()
        {
            isRecord = 0;
            ConnectionWithAccess.query = "select 1 from " + ConnectionWithAccess.tablename[1] + " where a_n = '" + temp_a_n + "' and [desc] = '" + tbDesc.Text + "' and CITY = '" + tbCity.Text + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();

            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    isRecord = 1;
                }
            }
            if (isRecord == 0)
            {
                ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[01] + " set [desc] = '" + tbDesc.Text + "', [city] = '" + tbCity.Text + "', country = '" + tbcountry.Text + "', [pin] = " + tbPincode.Text + " , aadhar_card = '" + tbadharcard.Text + "' , dist = '" + tbdistrict.Text + "' , gst_number = '" + tbgst_number.Text + "', pan = '" + tbpan.Text + "', state = '" + tbstate.Text + "' where a_n = '" + temp_a_n + "' and [s_a] = '" + temp_s_a + "'";
                ConnectionCommand.fUpdateInsertDeleteData();
                ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[04] + " set [city] = '" + tbCity.Text + "' where a_n = '" + temp_a_n + "' and [s_a] = '" + temp_s_a + "'";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
            else
            {
                MessageBox.Show("Sorry Account Name with Same Name Already Exist");
            }
        }

        private void save_company_text_file()
        {
            ConnectionWithAccess.mtextfilename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + ".txt";
            File.Delete(ConnectionWithAccess.mtextfilename);
            StringBuilder sb = new StringBuilder();
            sb.AppendLine(ConnectionWithAccess.encode(ConnectionWithAccess.mDataFile.ToUpper().ToString()));
            sb.AppendLine(ConnectionWithAccess.encode(comname.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comadd1.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comadd2.Text.Trim().ToUpper()));
            //sb.AppendLine(ConnectionWithAccess.encode(comadd3.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comcity.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comstate.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(compin.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comph1.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comph2.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(commob.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(commob2.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comemail.Text.Trim().ToLower() + " " + "[" + comemail_password.Text.Trim() + "]"));
            sb.AppendLine(ConnectionWithAccess.encode(comowner.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(compan.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comsrc1.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comsrc2.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comsrc3.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(combst.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comvat.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comlbt.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comitacc.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comaccno.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comcomments.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comdob.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comstatus.Text.Trim().ToUpper()));
            if (cb_add_company_logo_in_print.Checked == true)
                sb.AppendLine(ConnectionWithAccess.encode("Y"));
            else
                sb.AppendLine(ConnectionWithAccess.encode("N"));
            sb.AppendLine(ConnectionWithAccess.encode(comcst.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comcsttin.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comwebsite.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(comifc.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(combank.Text.Trim().ToUpper()));
            sb.AppendLine(ConnectionWithAccess.encode(Convert.ToString(comsform.SelectedIndex)));
            sb.AppendLine(ConnectionWithAccess.encode(comgst_number.Text.Trim().ToUpper()));
            if (cb_company_login_password.Checked == true)
                sb.AppendLine(ConnectionWithAccess.encode("Y"));
            else
                sb.AppendLine(ConnectionWithAccess.encode("N"));
            sb.AppendLine(ConnectionWithAccess.encode(comstd.Text));
            if (!string.IsNullOrEmpty(strSelectedFont))
                sb.AppendLine(strSelectedFont);
            else
                sb.AppendLine((ConnectionWithAccess.company_font));
            sb.AppendLine(ConnectionWithAccess.encode(tb_move_sale_print_distance.Text));
            sb.AppendLine(ConnectionWithAccess.encode(combackup_emailid.Text));
            TextWriter writer = new StreamWriter(ConnectionWithAccess.mtextfilename);
            writer.WriteLine(sb);
            writer.Flush();
            //MessageBox.Show("File Created Successfully");
            writer.Close();
            read_company_text_file();
        }

        private void read_company_text_file()
        {
            ConnectionWithAccess.mtextfilename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + ".txt";

            if (File.Exists(ConnectionWithAccess.mtextfilename))
            {
                ConnectionWithAccess.company_details = File.ReadAllLines(ConnectionWithAccess.mtextfilename);
                if (ConnectionWithAccess.company_details.Count() > 0)
                {
                    for (int i = 0; i < 5; i++)
                    {
                        Array.Resize(ref ConnectionWithAccess.company_details, ConnectionWithAccess.company_details.Length + 1);
                        ConnectionWithAccess.company_details[ConnectionWithAccess.company_details.Length - 1] = "Y";
                    }
                    for (row_counter = 0; row_counter < ConnectionWithAccess.company_details.Length; row_counter++)
                    {
                        ConnectionWithAccess.company_details[row_counter] = ConnectionWithAccess.decode(ConnectionWithAccess.company_details[row_counter]);
                        if (ConnectionWithAccess.company_details[row_counter] == null)
                            ConnectionWithAccess.company_details[row_counter] = "";
                        ConnectionWithAccess.company_details[row_counter] = ConnectionWithAccess.company_details[row_counter].Trim();
                    }
                    comdrive.Text = ConnectionWithAccess.company_details[0].Substring(1, 1);
                    comabb.Text = ConnectionWithAccess.company_details[0].Substring(11, 3);
                    comname.Text = ConnectionWithAccess.company_details[1];
                    comadd1.Text = ConnectionWithAccess.company_details[2];
                    comadd2.Text = ConnectionWithAccess.company_details[3];
                    comadd3.Text = ConnectionWithAccess.company_details[4];
                    comcity.Text = ConnectionWithAccess.company_details[4];
                    comstate.Text = ConnectionWithAccess.company_details[5];
                    compin.Text = ConnectionWithAccess.company_details[6];
                    comph1.Text = ConnectionWithAccess.company_details[7];
                    comph2.Text = ConnectionWithAccess.company_details[8];
                    commob.Text = ConnectionWithAccess.company_details[9];
                    commob2.Text = ConnectionWithAccess.company_details[10];
                    if (ConnectionWithAccess.company_details[11].Contains("["))
                    {
                        comemail.Text = ConnectionWithAccess.company_details[11].Substring(0, ConnectionWithAccess.company_details[11].IndexOf("["));
                        comemail_password.Text = ConnectionWithAccess.company_details[11].Substring(ConnectionWithAccess.company_details[11].IndexOf("[") + 1, ConnectionWithAccess.company_details[11].IndexOf("]") - ConnectionWithAccess.company_details[11].IndexOf("[") - 1);
                    }
                    else
                    {
                        comemail.Text = ConnectionWithAccess.company_details[11];
                    }
                    comowner.Text = ConnectionWithAccess.company_details[12];
                    compan.Text = ConnectionWithAccess.company_details[13];
                    comsrc1.Text = ConnectionWithAccess.company_details[14];
                    comsrc2.Text = ConnectionWithAccess.company_details[15];
                    comsrc3.Text = ConnectionWithAccess.company_details[16];
                    combst.Text = ConnectionWithAccess.company_details[17];
                    comvat.Text = ConnectionWithAccess.company_details[18];
                    comlbt.Text = ConnectionWithAccess.company_details[19];
                    comitacc.Text = ConnectionWithAccess.company_details[20];
                    comaccno.Text = ConnectionWithAccess.company_details[21];
                    comcomments.Text = ConnectionWithAccess.company_details[22];
                    //comdob.Text = ConnectionWithAccess.company_details[23];
                    comstatus.Text = ConnectionWithAccess.company_details[24];
                    //combacc.Text = ConnectionWithAccess.company_details[25];
                    comcst.Text = ConnectionWithAccess.company_details[26];
                    comcsttin.Text = ConnectionWithAccess.company_details[27];
                    comwebsite.Text = ConnectionWithAccess.company_details[28];
                    comifc.Text = ConnectionWithAccess.company_details[29];
                    combank.Text = ConnectionWithAccess.company_details[30];
                    if (ConnectionWithAccess.company_details[31].Trim() == "301")
                        ConnectionWithAccess.company_details[31] = "3";
                    else if (ConnectionWithAccess.company_details[31].Trim() == "302")
                        ConnectionWithAccess.company_details[31] = "4";
                    else if (ConnectionWithAccess.company_details[31].Trim() == "303")
                        ConnectionWithAccess.company_details[31] = "5";
                    comsform.SelectedIndex = Convert.ToInt32(ConnectionWithAccess.company_details[31].Trim());
                    comgst_number.Text = ConnectionWithAccess.company_details[32];
                    if (ConnectionWithAccess.company_details[33] != "Y")
                        cb_company_login_password.Checked = false;
                    else
                        cb_company_login_password.Checked = true;
                    comstd.Text = ConnectionWithAccess.company_details[34];
                    ConnectionWithAccess.company_font = ConnectionWithAccess.company_details[35];
                    tb_move_sale_print_distance.Text = ConnectionWithAccess.company_details[36];
                    if (ConnectionWithAccess.company_details[37].Length > 10)
                    {
                        if (ConnectionWithAccess.company_details[37].Contains("["))
                            combackup_emailid.Text = ConnectionWithAccess.company_details[37].Substring(0, ConnectionWithAccess.company_details[37].IndexOf("["));
                        else
                            combackup_emailid.Text = ConnectionWithAccess.company_details[37];
                    }
                    //Font font1 = new Font("Arial", 12, FontStyle.Italic);
                    //TypeConverter converter = TypeDescriptor.GetConverter(typeof(Font));
                    //// Saving Font object as a string
                    //string fontString = converter.ConvertToString(font1);
                    //// Load an instance of Font from a string
                    //Font font = (Font)converter.ConvertFromString(fontString);
                }
            }
        }

        private void save_company_text_file_from_memory()
        {
            ConnectionWithAccess.mtextfilename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + ".txt";
            File.Delete(ConnectionWithAccess.mtextfilename);
            StringBuilder sb = new StringBuilder();
            for (row_counter = 0; row_counter < ConnectionWithAccess.company_details.Length; row_counter++)
            {
                sb.AppendLine(ConnectionWithAccess.encode(ConnectionWithAccess.company_details[row_counter]));
            }
            TextWriter writer = new StreamWriter(ConnectionWithAccess.mtextfilename);
            writer.WriteLine(sb);
            writer.Flush();
            //MessageBox.Show("File Created Successfully");
            writer.Close();
        }

        private void find_empty_coloum_in_masters()
        {
            if (tbMNo1.Text != "")
                momobile = Convert.ToInt64(tbMNo1.Text);
            else
                momobile = 0;
            if (tbTINNo.Text != "")
                mtin = tbTINNo.Text;
            else
                mtin = "";
            if (tbAdd1.Text != "")
                madd1 = tbAdd1.Text;
            else
                madd1 = "";
            if (tbAdd2.Text != "")
                madd2 = tbAdd2.Text;
            else
                madd2 = "";
            if (tbAdd3.Text != "")
                madd3 = tbAdd3.Text;
            else
                madd3 = "";
            if (tbCity.Text != "")
                mcity = tbCity.Text;
            else
                mcity = "";
            if (tbPincode.Text != "")
                mpincode = tbPincode.Text;
            else
                mpincode = "";
            if (tbTPT.Text != "")
                mtpt = tbTPT.Text;
            else
                mtpt = "";
            if (tbStd.Text != "")
                mstd = tbStd.Text;
            else
                mstd = "";
            if (tbOPh1.Text != "")
                mphone1 = Convert.ToInt64(tbOPh1.Text);
            else
                mphone1 = 0;
            if (tbRPh2.Text != "")
                mphone12 = Convert.ToInt64(tbRPh2.Text);
            else
                mphone12 = 0;
            if (tbMNo2.Text != "")
                mphone2 = Convert.ToInt64(tbMNo2.Text);
            else
                mphone2 = 0;
            if (tbOPh2.Text != "")
                mphone22 = Convert.ToInt64(tbOPh2.Text);
            else
                mphone22 = 0;
            if (tbFax.Text != "")
                mfax = Convert.ToInt64(tbFax.Text);
            else
                mfax = 0;
            if (tbEmail.Text != "")
                memail = tbEmail.Text;
            else
                memail = "";
            if (tbWebsite.Text != "")
                mwebsite = tbWebsite.Text;
            else
                mwebsite = "";
            if (tbgst_number.Text != "")
                mgst_number = tbgst_number.Text;
            else
                mgst_number = "";
        }

        private void MainForm_FormClosing(object sender, FormClosingEventArgs e)
        {
            if (!isEscKeyPressed)
            {
                const string message = "Do you want to close application?";
                const string caption = "Close Sharp";
                var result = MessageBox.Show(message, caption,
                                             MessageBoxButtons.YesNo,
                                             MessageBoxIcon.Question);
                if (result == DialogResult.Yes)
                {
                    login_user_time_out();
                    //if (ConnectionWithAccess.detach_exit == "Y")
                    //{
                    //    detachandcloseapplication();
                    //}
                    //this.ParentForm.Dispose();
                    System.Environment.Exit(1);
                    System.Windows.Forms.Application.Exit();
                    Application.Exit();
                    this.Close();
                }
                else
                {
                    e.Cancel = true;
                }

            }
        }

        private void login_user_time_out()
        {
            ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[53] + " (name,IDT,[out]) values ('" + ConnectionWithAccess.muser + "','" + DateTime.Now + "','" + DateTime.Now + "')";
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void play_sound()
        {
            SystemSounds.Beep.Play();
            SystemSounds.Question.Play();
            //startSoundPlayer.Play();
            //Point startingPoint = panel1.Location;
            //startingPoint.Offset(10, 10);
            //Cursor.Position = PointToScreen(startingPoint);
        }

        public void detachandcloseapplication()
        {
            //ConnectionWithAccess.mNIK = ConnectionWithAccess.databasename;
            //ConnectionWithAccess.mDataFile = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\" + ConnectionWithAccess.mNIK + ".mdf";
            //if (ConnectionWithAccess.detach_exit == "Y")
            //{
            //    if (File.Exists(ConnectionWithAccess.mDataFile))
            //    {
            //        ConnectionWithAccess.query = "use master";
            //        ConnectionWithAccess.connectAndUseQuery();

            //        ConnectionWithAccess.connection.ConnectionString = "data source = .;initial catalog = master; integrated security = true";
            //        ConnectionWithAccess.command.Connection = ConnectionWithAccess.connection;

            //        ConnectionWithAccess.query = "exec sp_detach_db @dbname = '" + ConnectionWithAccess.mNIK + "'";
            //        ConnectionWithAccess.connectAndUseQuery();
            //    }
            //    ConnectionWithAccess.detach_exit = "Y";
            //}
        }

        private void crdbc_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (crdbc.Text != "")
            {
                PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data");
                objPleaseWait.Show();
                Application.DoEvents();
                refresh_cash_document_number();
                //ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[24] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + crdbc.Text;
                //ConnectionCommand.ExportToText(crdbc, crdocno);
                //dateCheckForcashInvoice();
                get_account_name_from_d_c("C", Convert.ToInt32(crdbc.Text));
                fillcrtranlist();
                objPleaseWait.Close();
            }
        }

        # region tab_control
        private void mastertab()
        {
            if (ConnectionWithAccess.data_entry_working != null)
            {
                if (ConnectionWithAccess.data_entry_working == "Sale Party")
                {
                    change_cbparent_master_account_type(sia_n.Text);
                    if (sipartycode.Text != "")
                    {
                        tbDesc.Text = sipartycode.Text;
                        update_master_account_screen_details(sia_n.Text, sis_a.Text, sid_y.Text);
                        tbA_N.Text = sia_n.Text;
                        tbS_A.Text = sis_a.Text;
                    }
                }
                else if (ConnectionWithAccess.data_entry_working == "Sale Item")
                {
                    subtabMasters.SelectedIndex = 1;
                }
                else if (ConnectionWithAccess.data_entry_working == "Sale Tax")
                {
                    subtabMasters.SelectedIndex = 2;
                }
                else if (ConnectionWithAccess.data_entry_working == "Purchase Party")
                {
                    change_cbparent_master_account_type(pia_n.Text);
                    if (pipartycode.Text != "")
                    {
                        tbDesc.Text = pipartycode.Text;
                        update_master_account_screen_details(pia_n.Text, pis_a.Text, "@@@");
                        tbA_N.Text = pia_n.Text;
                        tbS_A.Text = pis_a.Text;
                    }
                }
                else if (ConnectionWithAccess.data_entry_working == "Bank Receipt")
                {
                    change_cbparent_master_account_type(bra_n.Text);
                    if (brpartycode.Text != "")
                    {
                        tbDesc.Text = brpartycode.Text;
                        update_master_account_screen_details(bra_n.Text, brs_a.Text, "@@@");
                        tbA_N.Text = bra_n.Text;
                        tbS_A.Text = brs_a.Text;
                    }
                }
                else if (ConnectionWithAccess.data_entry_working == "Bank Payment")
                {
                    change_cbparent_master_account_type(bpa_n.Text);
                    if (bppartycode.Text != "")
                    {
                        tbDesc.Text = bppartycode.Text;
                        update_master_account_screen_details(bpa_n.Text, bps_a.Text, "@@@");
                        tbA_N.Text = bpa_n.Text;
                        tbS_A.Text = bps_a.Text;
                    }
                }
                else if (ConnectionWithAccess.data_entry_working == "Cash Receipt")
                {
                    change_cbparent_master_account_type(cra_n.Text);
                    if (crpartycode.Text != "")
                    {
                        tbDesc.Text = crpartycode.Text;
                        update_master_account_screen_details(cra_n.Text, crs_a.Text, "@@@");
                        tbA_N.Text = cra_n.Text;
                        tbS_A.Text = crs_a.Text;
                    }
                }
                else if (ConnectionWithAccess.data_entry_working == "Cash Payment")
                {
                    change_cbparent_master_account_type(cpa_n.Text);
                    if (cppartycode.Text != "")
                    {
                        tbDesc.Text = cppartycode.Text;
                        update_master_account_screen_details(cpa_n.Text, cps_a.Text,"@@@");
                        tbA_N.Text = cpa_n.Text;
                        tbS_A.Text = cps_a.Text;
                    }
                }
                else if (ConnectionWithAccess.data_entry_working == "Ledger")
                {
                    change_cbparent_master_account_type(rla_n.Text);
                    tbDesc.Text = tb_ledger_account_name.Text;
                    update_master_account_screen_details(rla_n.Text, rls_a.Text, "@@@");
                    tbA_N.Text = rla_n.Text;
                    tbS_A.Text = rls_a.Text;
                }
            }
            if (subtabMasters.SelectedIndex == 0)
            {
                current_working_tab = "20";
                if (chbPrivAccountE.Checked)
                {
                    tbDesc.Text = null;
                    refresh_master_account();
                    master_accounts_process();
                    lbl_master_d_c.Visible = false;
                    update_master_account_screen_details(tbA_N.Text, tbS_A.Text, tbd_y.Text);
                }
                else
                    subtabMasters.TabPages[0].Hide();
            }
            else if (subtabMasters.SelectedIndex == 1)
            {
                if (chbPrivItemE.Checked)
                    itemlistmastertab();
                else
                    subtabMasters.TabPages[1].Hide();
            }
            else if (subtabMasters.SelectedIndex == 2)
                if (chbPrivTaxE.Checked)
                    taxlistmatertab();
                else
                    subtabMasters.TabPages[2].Hide();
            else if (subtabMasters.SelectedIndex == 3)
                if (chbPrivDbcE.Checked)
                    daybooklistmastertab();
                else
                    subtabMasters.TabPages[3].Hide();
            else if (subtabMasters.SelectedIndex == 4)
                if (chbPrivPeriodE.Checked)
                    periodlistmastertab();
                else
                    subtabMasters.TabPages[4].Hide();
            else if (subtabMasters.SelectedIndex == 6)
            {
                fFillAreaList(cmbArea);
                fFillAreaGrid();
            }
        }

        private void change_cbparent_master_account_type(string ma_n)
        {
            if (ma_n != "")
            {
                if (ma_n == "2002")
                    cbParent.Text = "SUNDRY DEBTORS";
                else if (ma_n == "4002")
                    cbParent.Text = "SUNDRY CREDITORS";
                else if (ma_n == "2011")
                    cbParent.Text = "BANK ACCOUNT";
                else if (ma_n == "3000")
                    cbParent.Text = "OLD CAPITAL ACCOUNT";
                else if (ma_n == "3001")
                    cbParent.Text = "CAPITAL ACCOUNT";
                else if (ma_n == "2010")
                    cbParent.Text = "CASH IN HAND";
                else if (ma_n.Substring(0, 2) == "70")
                    cbParent.Text = "DIRECT INCOMES(TRADING)";
                else if (ma_n.Substring(0, 1) == "1")
                    cbParent.Text = "FIXED ASSETS";
                else if (ma_n.Substring(0, 2) == "75")
                    cbParent.Text = "INDIRECT EXPENSES(P&L)";
                else if (ma_n == "3501")
                    cbParent.Text = "LOAN GIVEN";
                else if (ma_n == "3500")
                    cbParent.Text = "LOAN RECEIVED";
            }
        }

        private void itemlistmastertab()
        {
            current_working_tab = "21";
            ItemListDG.DataSource = null;
            ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,p_price,price,clo_stk,cat,OPN_STK,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " order by TITLE";
            ConnectionCommand.accountHelp_datatable_Seperate(ItemListDG, "ItemListDG");
            tbTitle.Text = mtitle;
            update_masters_items_screen_details(tbTitle.Text);
        }

        private void taxlistmatertab()
        {
            current_working_tab = "22";
            fill_tax_d_c();
            if (rb_sale_tax.Checked)
                ConnectionWithAccess.fix_account_a_n = "2002";
            else
                ConnectionWithAccess.fix_account_a_n = "4002";
            ConnectionWithAccess.query = "select distinct a_n from " + ConnectionWithAccess.tablename[01] + " where a_n like '" + ConnectionWithAccess.fix_account_a_n + "%' and s_a ='@@@'";
            ConnectionCommand.retrieval(cb_tax_transfer_account);
        }

        private void daybooklistmastertab()
        {
            if (maintab.SelectedIndex == 2)
            {
                cb_auto_cash_sale_entry.Visible = false;
                current_working_tab = "23" + cbAction.SelectedIndex;
                //cbAction.SelectedIndex = 0;
                DBCListDG.Rows.Clear();
                if (cbAction.SelectedIndex == 0)
                {
                    ConnectionWithAccess.query = "select distinct d_c,a_n from " + ConnectionWithAccess.tablename[21] + " where d_n = 999999";
                    ConnectionCommand.accountHelp(DBCListDG, "DayBookMaster");
                    ConnectionWithAccess.query = "select distinct a_n from " + ConnectionWithAccess.tablename[01] + " where a_n like '2002%' and s_a ='@@@'";
                    ConnectionCommand.retrieval(cb_transfer_account);
                    if (cb_transfer_account.Items.Count == 1)
                        cb_transfer_account.Enabled = false;
                    cb_auto_cash_sale_entry.Visible = true;
                }
                else if (cbAction.SelectedIndex == 1)
                {
                    ConnectionWithAccess.query = "select distinct d_c,a_n from " + ConnectionWithAccess.tablename[22] + " where d_n = 999999";
                    ConnectionCommand.accountHelp(DBCListDG, "DayBookMaster");
                    ConnectionWithAccess.query = "select distinct a_n from " + ConnectionWithAccess.tablename[01] + " where a_n like '4002%' and s_a ='@@@'";
                    ConnectionCommand.retrieval(cb_transfer_account);
                    if (cb_transfer_account.Items.Count == 1)
                        cb_transfer_account.Enabled = false;
                }
                else if (cbAction.SelectedIndex == 2)
                {
                    ConnectionWithAccess.query = "select distinct d_c,a_n from " + ConnectionWithAccess.tablename[23] + " where d_n = 999999";
                    ConnectionCommand.accountHelp(DBCListDG, "DayBookMaster");
                    ConnectionWithAccess.query = "select distinct a_n from " + ConnectionWithAccess.tablename[01] + " where a_n like '2011%' and s_a ='@@@'";
                    ConnectionCommand.retrieval(cb_transfer_account);
                    if (cb_transfer_account.Items.Count == 1)
                        cb_transfer_account.Enabled = false;
                }
                else if (cbAction.SelectedIndex == 3)
                {
                    ConnectionWithAccess.query = "select distinct d_c,a_n from " + ConnectionWithAccess.tablename[24] + " where d_n = 999999";
                    ConnectionCommand.accountHelp(DBCListDG, "DayBookMaster");
                    ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[01] + " where a_n like '2010%' and s_a ='@@@'";
                    ConnectionCommand.retrieval(cb_transfer_account);
                    if (cb_transfer_account.Items.Count == 1)
                        cb_transfer_account.Enabled = false;
                }
                else if (cbAction.SelectedIndex == 4)
                {
                    ConnectionWithAccess.query = "select distinct d_c,a_n from " + ConnectionWithAccess.tablename[25] + " where d_n = 999999";
                    ConnectionCommand.accountHelp(DBCListDG, "DayBookMaster");
                }
                else if (cbAction.SelectedIndex == 5)
                {
                    ConnectionWithAccess.query = "select distinct d_c,a_n from " + ConnectionWithAccess.tablename[30] + " where d_n = 999999";
                    ConnectionCommand.accountHelp(DBCListDG, "DayBookMaster");
                    ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[01] + " where a_n like '2002%' and s_a ='@@@'";
                    ConnectionCommand.retrieval(cb_transfer_account);
                    ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[01] + " where a_n like '4002%' and s_a ='@@@'";
                    ConnectionCommand.add_retrieval(cb_transfer_account);
                    if (cb_transfer_account.Items.Count == 1)
                        cb_transfer_account.Enabled = false;
                }
                else if (cbAction.SelectedIndex == 6)
                {
                    ConnectionWithAccess.query = "select distinct d_c,a_n from " + ConnectionWithAccess.tablename[7] + " where d_n = 999999";
                    ConnectionCommand.accountHelp(DBCListDG, "DayBookMaster");
                    ConnectionWithAccess.query = "select distinct a_n from " + ConnectionWithAccess.tablename[01] + " where a_n like '2002%' and s_a ='@@@'";
                    ConnectionCommand.retrieval(cb_transfer_account);
                    if (cb_transfer_account.Items.Count == 1)
                        cb_transfer_account.Enabled = false;
                    cb_auto_cash_sale_entry.Visible = true;
                }
            }
        }

        private void periodlistmastertab()
        {
            current_working_tab = "24";
            PeriodListDG.Rows.Clear();
            ConnectionWithAccess.query = "select prd, [start], [end], [lock], gp, vat, data_tran, s_form from " + ConnectionWithAccess.tablename[50];
            ConnectionCommand.accountHelp(PeriodListDG, "PeriodListDG");
            PeriodListDG.Sort(PeriodListDG.Columns[0], ListSortDirection.Ascending);
        }
        # endregion

        public void readusersettingsfromfiletoMemory(string muser, string mpassword)
        {
            ConnectionWithAccess.query = "select f3 from " + ConnectionWithAccess.tablename[52] + " where f1 = '" + muser + "' and f2 = '" + mpassword + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    ConnectionWithAccess.mUserFeatures = dtData1.Rows[0][0].ToString();
                    ConnectionWithAccess.mUserFeatures += "NNNNNNNNNN";
                }
            }
            changestatusaspermemory();
        }

        public void changestatusaspermemory()
        {
            if (ConnectionWithAccess.mUserFeatures.Length < 60)
            {
                for (int i = ConnectionWithAccess.mUserFeatures.Length; i < 60; i++)
                {
                    ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures + "Y";
                }
            }
            tbUserName.Text = ConnectionWithAccess.muser;
            tbPassword.Text = ConnectionWithAccess.mpassword;
            if (ConnectionWithAccess.mUserFeatures.Substring(0, 1) == "Y")
                chbPrivMastersAllV.Checked = true;
            else
                chbPrivMastersAllV.Checked = false;

            if (ConnectionWithAccess.mUserFeatures.Substring(1, 1) == "Y")
                chbPrivMastersAllE.Checked = true;
            else
                chbPrivMastersAllE.Checked = false;

            if (ConnectionWithAccess.mUserFeatures.Substring(2, 1) == "Y")
                chbPrivAccountV.Checked = true;
            else
                chbPrivAccountV.Checked = false;

            if (ConnectionWithAccess.mUserFeatures.Substring(3, 1) == "Y")
                chbPrivAccountE.Checked = true;
            else
                chbPrivAccountE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(4, 1) == "Y")
                chbPrivItemV.Checked = true;
            else
                chbPrivItemV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(5, 1) == "Y")
                chbPrivItemE.Checked = true;
            else
                chbPrivItemE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(6, 1) == "Y")
                chbPrivTaxV.Checked = true;
            else
                chbPrivTaxV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(7, 1) == "Y")
                chbPrivTaxE.Checked = true;
            else
                chbPrivTaxE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(8, 1) == "Y")
                chbPrivDbcV.Checked = true;
            else
                chbPrivDbcV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(09, 1) == "Y")
                chbPrivDbcE.Checked = true;
            else
                chbPrivDbcE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(10, 1) == "Y")
                chbPrivPeriodV.Checked = true;
            else
                chbPrivPeriodV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(11, 1) == "Y")
                chbPrivPeriodE.Checked = true;
            else
                chbPrivPeriodE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(12, 1) == "Y")
                chbPrivDataEntAllV.Checked = true;
            else
                chbPrivDataEntAllV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(13, 1) == "Y")
                chbPrivDataEntAllE.Checked = true;
            else
                chbPrivDataEntAllE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(14, 1) == "Y")
                chbPrivSaleV.Checked = true;
            else
                chbPrivSaleV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(15, 1) == "Y")
                chbPrivSaleE.Checked = true;
            else
                chbPrivSaleE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(16, 1) == "Y")
                chbPrivPurchaseV.Checked = true;
            else
                chbPrivPurchaseV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(17, 1) == "Y")
                chbPrivPurchaseE.Checked = true;
            else
                chbPrivPurchaseE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(18, 1) == "Y")
                chbPrivBankV.Checked = true;
            else
                chbPrivBankV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(19, 1) == "Y")
                chbPrivBankE.Checked = true;
            else
                chbPrivBankE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(20, 1) == "Y")
                chbPrivCashV.Checked = true;
            else
                chbPrivCashV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(21, 1) == "Y")
                chbPrivCashE.Checked = true;
            else
                chbPrivCashE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(22, 1) == "Y")
                chbPrivJournalV.Checked = true;
            else
                chbPrivJournalV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(23, 1) == "Y")
                chbPrivJournalE.Checked = true;
            else
                chbPrivJournalE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(24, 1) == "Y")
                chbPrivOthersAllV.Checked = true;
            else
                chbPrivOthersAllV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(25, 1) == "Y")
                chbPrivOthersAllE.Checked = true;
            else
                chbPrivOthersAllE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(26, 1) == "Y")
                chbPrivUSetngV.Checked = true;
            else
                chbPrivUSetngV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(27, 1) == "Y")
                chbPrivUSetngE.Checked = true;
            else
                chbPrivUSetngE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(28, 1) == "Y")
                chbPrivGSetngV.Checked = true;
            else
                chbPrivGSetngV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(29, 1) == "Y")
                chbPrivGSetngE.Checked = true;
            else
                chbPrivGSetngE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(30, 1) == "Y")
                chbPrivCompInV.Checked = true;
            else
                chbPrivCompInV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(31, 1) == "Y")
                chbPrivCompInE.Checked = true;
            else
                chbPrivCompInE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(32, 1) == "Y")
                chbPrivReportsV.Checked = true;
            else
                chbPrivReportsV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(33, 1) == "Y")
                chbPrivReportsE.Checked = true;
            else
                chbPrivReportsE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(34, 1) == "Y")
                chbPrivUtilitiesV.Checked = true;
            else
                chbPrivUtilitiesV.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(35, 1) == "Y")
                chbPrivUtilitiesE.Checked = true;
            else
                chbPrivUtilitiesE.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(36, 1) == "Y")
                chbPrivsendsms.Checked = true;
            else
                chbPrivsendsms.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(37, 1) == "Y")
                chbPrivsendemail.Checked = true;
            else
                chbPrivsendemail.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(38, 1) == "Y")
                chbPriveditaccount.Checked = true;
            else
                chbPriveditaccount.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(39, 1) == "Y")
                chbPriveditinvoice.Checked = true;
            else
                chbPriveditinvoice.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(40, 1) == "Y")
                chbPrivprintinvoice.Checked = true;
            else
                chbPrivprintinvoice.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(41, 1) == "Y")
                chbcompanydetail.Checked = true;
            else
                chbcompanydetail.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(42, 1) == "Y")
                chb_export_to_excel.Checked = true;
            else
                chb_export_to_excel.Checked = false;
            if (chb_add_datetime_in_output.Checked)
                chb_add_datetime_in_output.Checked = true;
            else
                chb_add_datetime_in_output.Checked = false;
            if (ConnectionWithAccess.mUserFeatures.Substring(44, 1) == "Y")
                chb_allow_stock_check_bypass.Checked = true;
            else
                chb_allow_stock_check_bypass.Checked = false;
        }

        public void readusersettingsfromscreen()
        {
            if (chbPrivMastersAllV.Checked == true)
                ConnectionWithAccess.mUserFeatures = "Y";
            else
                ConnectionWithAccess.mUserFeatures = "N";
            if (chbPrivMastersAllE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 1) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 1) + "N";
            if (chbPrivAccountV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 2) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 2) + "N";
            if (chbPrivAccountE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 3) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 3) + "N";
            if (chbPrivItemV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 4) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 4) + "N";
            if (chbPrivItemE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 5) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 5) + "N";
            if (chbPrivTaxV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 6) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 6) + "N";
            if (chbPrivTaxE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 7) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 7) + "N";
            if (chbPrivDbcV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 8) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 8) + "N";
            if (chbPrivDbcE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 9) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 9) + "N";
            if (chbPrivPeriodV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 10) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 10) + "N";
            if (chbPrivPeriodE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 11) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 11) + "N";
            if (chbPrivDataEntAllV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 12) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 12) + "N";
            if (chbPrivDataEntAllE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 13) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 13) + "N";
            if (chbPrivSaleV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 14) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 14) + "N";
            if (chbPrivSaleE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 15) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 15) + "N";
            if (chbPrivPurchaseV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 16) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 16) + "N";
            if (chbPrivPurchaseE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 17) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 17) + "N";
            if (chbPrivBankV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 18) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 18) + "N";
            if (chbPrivBankE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 19) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 19) + "N";
            if (chbPrivCashV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 20) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 20) + "N";
            if (chbPrivCashE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 21) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 21) + "N";
            if (chbPrivJournalV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 22) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 22) + "N";
            if (chbPrivJournalE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 23) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 23) + "N";
            if (chbPrivOthersAllV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 24) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 24) + "N";
            if (chbPrivOthersAllE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 25) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 25) + "N";
            if (chbPrivUSetngV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 26) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 26) + "N";
            if (chbPrivUSetngE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 27) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 27) + "N";
            if (chbPrivGSetngV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 28) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 28) + "N";
            if (chbPrivGSetngE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 29) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 29) + "N";
            if (chbPrivCompInV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 30) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 30) + "N";
            if (chbPrivCompInE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 31) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 31) + "N";
            if (chbPrivReportsV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 32) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 32) + "N";
            if (chbPrivReportsE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 33) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 33) + "N";
            if (chbPrivUtilitiesV.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 34) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 34) + "N";
            if (chbPrivUtilitiesE.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 35) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 35) + "N";
            if (chbPrivsendsms.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 36) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 36) + "N";
            if (chbPrivsendemail.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 37) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 37) + "N";
            if (chbPriveditaccount.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 38) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 38) + "N";
            if (chbPriveditinvoice.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 39) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 39) + "N";
            if (chbPrivprintinvoice.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 40) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 40) + "N";
            if (chbcompanydetail.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 41) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 41) + "N";
            if (chb_export_to_excel.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 42) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 42) + "N";
            if (chb_add_datetime_in_output.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 43) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 43) + "N";
            if (chb_allow_stock_check_bypass.Checked == true)
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 44) + "Y";
            else
                ConnectionWithAccess.mUserFeatures = ConnectionWithAccess.mUserFeatures.Substring(0, 44) + "N";
        }

        private void ClearAllUserSettings()
        {
            chbPrivMastersAllV.Checked = false;
            chbPrivMastersAllE.Checked = false;
            chbPrivAccountV.Checked = false;
            chbPrivAccountE.Checked = false;
            chbPrivItemV.Checked = false;
            chbPrivItemE.Checked = false;
            chbPrivTaxV.Checked = false;
            chbPrivTaxE.Checked = false;
            chbPrivDbcV.Checked = false;
            chbPrivDbcE.Checked = false;
            chbPrivPeriodV.Checked = false;
            chbPrivPeriodE.Checked = false;
            chbPrivDataEntAllV.Checked = false;
            chbPrivDataEntAllE.Checked = false;
            chbPrivSaleV.Checked = false;
            chbPrivSaleE.Checked = false;
            chbPrivPurchaseV.Checked = false;
            chbPrivPurchaseE.Checked = false;
            chbPrivBankV.Checked = false;
            chbPrivBankE.Checked = false;
            chbPrivCashE.Checked = false;
            chbPrivCashV.Checked = false;
            chbPrivJournalV.Checked = false;
            chbPrivJournalE.Checked = false;
            chbPrivOthersAllV.Checked = false;
            chbPrivOthersAllE.Checked = false;
            chbPrivUSetngV.Checked = false;
            chbPrivUSetngE.Checked = false;
            chbPrivGSetngV.Checked = false;
            chbPrivGSetngE.Checked = false;
            chbPrivCompInV.Checked = false;
            chbPrivCompInE.Checked = false;
            chbPrivReportsV.Checked = false;
            chbPrivReportsE.Checked = false;
            chbPrivUtilitiesV.Checked = false;
            chbPrivUtilitiesE.Checked = false;
            chbPrivUSetngV.Checked = false;
            chbPrivUSetngE.Checked = false;
            chbPrivsendsms.Checked = false;
            chbPrivsendemail.Checked = false;
            chbPriveditaccount.Checked = false;
            chbPriveditinvoice.Checked = false;
            chbPrivprintinvoice.Checked = false;
            chbcompanydetail.Checked = false;
            chb_export_to_excel.Checked = false;
            chb_add_datetime_in_output.Checked = false;
            chb_allow_stock_check_bypass.Checked = false;
        }

        private void PeriodListDG_Click(object sender, EventArgs e)
        {
            try
            {
                tbPrd.Text = Convert.ToString(PeriodListDG.SelectedCells[0].Value);
                dtPrdSD.Text = Convert.ToString(PeriodListDG.SelectedCells[1].Value);
                dtPrdED.Text = Convert.ToString(PeriodListDG.SelectedCells[2].Value);
                //cbprdlock.Text = Convert.ToString(PeriodListDG.SelectedCells[3].Value);
                tbGP.Text = Convert.ToString(PeriodListDG.SelectedCells[4].Value);
                if (Convert.ToString(PeriodListDG.SelectedCells[3].Value) == "Y")
                {
                    cbprdlock.Checked = true;
                    tbGP.ReadOnly = true;
                }
                else
                {
                    cbprdlock.Checked = false;
                    tbGP.ReadOnly = false;
                }
                tb_vat_tax_required.Text = PeriodListDG.SelectedCells[5].Value.ToString();
                tb_print_form.Text = PeriodListDG.SelectedCells[7].Value.ToString();
                //tbclosingstock.Text = Convert.ToString(PeriodListDG.SelectedCells[5].Value);
                //tbopeningstock.Text = Convert.ToString(PeriodListDG.SelectedCells[6].Value);
            }
            catch (Exception ex)
            {
                //message_box.Text = Convert.ToString(ex);
            }
        }

        #region refresh_data

        private void refresh_date_range()
        {
            if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
            {
                if (sidatetime.Value <= Convert.ToDateTime(ConnectionWithAccess.medate))
                {
                    if (sidatetime.Value <= DateTime.Now)
                    {
                        if (sidatetime.MinDate <= DateTime.Now)
                        {
                            sidatetime.MaxDate = DateTime.Today;
                            sidatetime.Value = DateTime.Today;
                            dtp_sisale_lr_date.Value = sidatetime.Value;
                        }
                    }
                }
            }
        }

        private void refresh_data_entry_simple_sale_for_new_record()
        {
            simple_s_a.Text = "@@@";
            simple_partyname.Text = "";
            simple_partycity.Text = "";
            simple_itemsalelist.DataSource = null;
            simple_itemsalelist.Rows.Clear();
            ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[21] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + sidbc.Text;
            ConnectionCommand.ExportToText(sidbc, simple_docno);
            ConnectionWithAccess.md_n = simple_docno.Text;
            refresh_date_range();
            simple_party_help.Visible = false;
            simple_item_help.Visible = false;
        }

        private void refresh_data_entry_sale_for_new_record()
        {
            sideliverycode.Visible = false;
            sideliverycity.Visible = false;
            lbl_sideliver.Visible = false;
            lbl_si_message.Visible = false;
            pdf_invoice.Visible = false;
            new_sale_invoice = true;
            tb_si_mobilenumber.Visible = false;
            tb_si_mobilenumber.Text = "";
            DispEmail.Text = "";
            pb_si_sendsms.Visible = false;
            sale_invoice_saved = false;
            ConnectionWithAccess.data_entry_working = null;
            sis_a.Clear();
            sid_y.Clear();
            //siitemlist.DataSource = null;
            //siitemlist.Rows.Clear();
            old_sale_invoice_amount = 0;
            cb_print_Tpt_copy.Visible = false;
            cb_print_chit_copy.Visible = false;
            sisalelistdg.Visible = true;
            DispEmail.Clear();
            sipartyname.Clear();
            sipartyaddress.Clear();
            sicontactdetails.Clear();
            sitransport.Items.Clear();
            sideliverycode.Clear();
            sideliverycity.Clear();
            sibasicamt.Text = "0.00";
            si_frieght_amt.Text = "0.00";
            si_packing_amt.Text = "0.00";
            si_insurance_amt.Text = "0.00";
            sitaxamt.Text = "0.00";
            siroundoffamt.Text = "0.00";
            sigrossamt.Text = "0.00";
            sitaxcode.Text = "0";
            sitaxdesc.Text = "";
            sitaxrate.Text = "0.00";
            sitransport.Text = "";
            sitransport.Enabled = false;
            sipartybalance.Text = "0.00";
            si_cash_received.Text = "0.00";
            old_cash_received_against_sale_invoice = 0;
            sisale_lr_no.Text = "";
            sicomments.Text = "";
            sipartycode.Enabled = true;
            sicity.Enabled = true;
            ConnectionWithAccess.ms_a = null;
            sipartycode.Text = "";
            sicity.Text = "";
            ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[21] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + sidbc.Text;
            ConnectionCommand.ExportToText(sidbc, sidocno);
            ConnectionWithAccess.md_n = sidocno.Text;
            refresh_date_range();
            si_party_help.Visible = false;
            si_item_help.Visible = false;
            siitemlist.Enabled = false;
            sitaxlist.Visible = false;
        }

        private void refresh_data_entry_sale_replacement_for_new_record()
        {
            ConnectionWithAccess.data_entry_working = null;
            srs_a.Clear();
            srd_y.Clear();
            srpartycode.Clear();
            srpartyname.Clear();
            srcity.Clear();
            srpartyaddress.Clear();
            srcontactdetails.Clear();
            srlastinvoice.Clear();
            srpartybalance.Text = "0.00";
            sritemlist.DataSource = null;
            sritemlist.Enabled = false;
            old_sale_invoice_amount = 0;
            cb_print_Tpt_copy.Visible = false;
            cb_print_chit_copy.Visible = false;
            srsalelistdg.Visible = true;
            srtaxcode.Visible = false;
            DispEmail.Clear();
            srtransport.Clear();
            srbasicamt.Text = "0.00";
            srtaxamt.Text = "0.00";
            srgrossamt.Text = "0.00";
            srtaxcode.Text = "0";
            srtaxdesc.Text = "";
            srpartycode.Enabled = true;
            ConnectionWithAccess.ms_a = null;
            srpartycode.Text = "";
            ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[30] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + srdbc.Text;
            ConnectionCommand.ExportToText(srdbc, srdocno);
            ConnectionWithAccess.md_n = srdocno.Text;
            //dateCheckForSaleInvoice();
            si_party_help.Visible = false;
            ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount, cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '0'";
            ConnectionCommand.accountHelp_datatable_Seperate(sritemlist, "sritemlist");
            fillsrreplamentlist();
        }

        private void refresh_data_entry_sale_order_for_new_record()
        {
            pdf_invoice.Visible = false;
            new_sale_invoice = true;
            DispEmail.Text = "";
            sale_invoice_saved = false;
            ConnectionWithAccess.data_entry_working = null;
            sos_a.Clear();
            sod_y.Clear();
            soitemlist.DataSource = null;
            soitemlist.Rows.Clear();
            old_sale_invoice_amount = 0;
            cb_print_Tpt_copy.Visible = false;
            cb_print_chit_copy.Visible = false;
            sosalelistdg.Visible = true;
            DispEmail.Clear();
            sipartyname.Clear();
            sipartyaddress.Clear();
            sicontactdetails.Clear();
            sotaxamt.Text = "0.00";
            soroundoffamt.Text = "0.00";
            sogrossamt.Text = "0.00";
            sotaxcode.Text = "0";
            sotaxdesc.Text = "";
            sotaxrate.Text = "0.00";
            sotransport.Text = "";
            sotransport.Enabled = false;
            sopartybalance.Text = "0.00";
            sopartycode.Enabled = true;
            socity.Enabled = true;
            ConnectionWithAccess.ms_a = null;
            sopartycode.Text = "";
            socity.Text = "";
            ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[7] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + sodbc.Text;
            ConnectionCommand.ExportToText(sodbc, sodocno);
            ConnectionWithAccess.md_n = sodocno.Text;
            refresh_date_range();
            so_party_help.Visible = false;
            so_party_help.Visible = false;
            soitemlist.Enabled = false;
        }

        private void refresh_data_entry_purc_for_new_record()
        {
            piitemlist.DataSource = null;
            piitemlist.Rows.Clear();
            piitemlist.Enabled = false;
            old_purchase_invoice_number = "";
            tb_pi_igst_tax_amount.Text = "0.00";
            pi_frieght_amt.Text = "0.00";
            pi_packing_amt.Text = "0.00";
            pi_insurance_amt.Text = "0.00";
            pi_other_amt.Text = "0.00";
            pi_frieght_amt.ReadOnly = true;
            pi_packing_amt.ReadOnly = true;
            pi_insurance_amt.ReadOnly = true;
            pi_other_amt.ReadOnly = true;
            lbl_pi_message.Visible = false;
            tb_pi_mobilenumber.Text = "";
            tb_pi_mobilenumber.Visible = false;
            pb_pi_sendsms.Visible = false;
            item_purchase_list.Clear();
            ConnectionWithAccess.data_entry_working = null;
            pia_n.Clear();
            pis_a.Clear();
            old_purchase_invoice_amount = 0;
            pitx_code.Enabled = true;
            pidocno.Clear();
            picity.Clear();
            pitransport.Enabled = false;
            cb_print_Tpt_copy.Visible = false;
            cb_print_chit_copy.Visible = false;
            pipurchaselist.Visible = true;
            pitaxcode.Enabled = false;
            sitaxlist.Visible = false;
            DispEmail.Clear();
            sipartyname.Clear();
            sipartyaddress.Clear();
            sicontactdetails.Clear();
            pitransport.Items.Clear();
            pibasicamt.Text = "0.00";
            pitaxamt.Text = "0.00";
            piroundoffamt.Text = "0.00";
            pigrossamt.Text = "0.00";
            pitaxcode.Text = "0";
            pipartycode.Enabled = true;
            pipartycode.Clear();
            pisuppliername.Clear();
            pisupplieraddress.Clear();
            pipartybalance.Clear();
            pia_n.Clear();
            pis_a.Clear();
            pitaxcode.Clear();
            pitaxdesc.Clear();
            pitransport.Text = "";
            pitx_code.Clear();
            pitaxrate.Clear();
        }

        private void refresh_data_entry_purc_replacement_for_new_record()
        {
            ConnectionWithAccess.data_entry_working = null;
            prs_a.Clear();
            prpartycode.Clear();
            pritemlist.Rows.Clear();
            old_sale_invoice_amount = 0;
            cb_print_Tpt_copy.Visible = false;
            cb_print_chit_copy.Visible = false;
            prtaxcode.Visible = false;
            DispEmail.Clear();
            prtransport.Clear();
            prbasicamt.Text = "0.00";
            prtaxamt.Text = "0.00";
            prgrossamt.Text = "0.00";
            prtaxcode.Text = "0";
            prtaxdesc.Text = "";
            prpartycode.Enabled = true;
            ConnectionWithAccess.ms_a = null;
            prpartycode.Text = "";
            ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[30] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + prdbc.Text;
            ConnectionCommand.ExportToText(prdbc, prdocno);
            ConnectionWithAccess.md_n = prdocno.Text;
            si_party_help.Visible = false;
            ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount, cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '0'";
            ConnectionCommand.accountHelp_datatable_Seperate(pritemlist, "pritemlist");
            fillprreplamentlist();
        }

        private void refresh_bank_document_number()
        {
            if (subtabbank.SelectedIndex == 0)
            {
                brchkstatus.SelectedIndex = 1;
                ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[23] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + brdbc.Text + " and r_p = '2'";
                ConnectionCommand.ExportToText(brdbc, brdocno);
                bra_n.Text = null;
                brs_a.Text = null;
            }
            else if (subtabbank.SelectedIndex == 1)
            {
                bpchkstatus.SelectedIndex = 1;
                ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[23] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + bpdbc.Text + " and r_P = '4'";
                ConnectionCommand.ExportToText(bpdbc, bpdocno);
                bpa_n.Text = null;
                bps_a.Text = null;
            }
            else if (subtabbank.SelectedIndex == 2)
            {
                ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[23] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + bddbc.Text + " and b_t = '3' and r_p = '1'";
                ConnectionCommand.ExportToText(bddbc, bddocno);
            }
            else if (subtabbank.SelectedIndex == 3)
            {
                ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[23] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + bwdbc.Text + " and b_t = '3' and r_p = '3'";
                ConnectionCommand.ExportToText(bwdbc, bwdocno);
            }
            else if (subtabbank.SelectedIndex == 4)
            {
                ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[23] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and r_p = '5' and b_t = '3'";
                ConnectionCommand.ExportToText(cb_tr_from_dc, tr_docno);
                //get_account_name_from_d_c("B",Convert.ToInt32(cb_tr_from_dc.Text));
                //get_bank_balance(ConnectionWithAccess.mprd, ConnectionWithAccess.bank_a_n);
                //tr_from_bank_curr_bal.Text = Convert.ToString(old_bank_balance);
                //get_account_name_from_d_c("B", Convert.ToInt32(cb_tr_to_dc.Text));
                //get_bank_balance(ConnectionWithAccess.mprd, ConnectionWithAccess.bank_a_n);;
                //tr_to_bank_curr_bal.Text = Convert.ToString(old_bank_balance);
            }
        }

        private void refresh_cash_document_number()
        {
            if (crdbc.Text != "")
            {
                if (subtabcash.SelectedIndex == 0)
                {
                    ConnectionWithAccess.query = "SELECT d_n from " + ConnectionWithAccess.tablename[24] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + crdbc.Text + " and d_d = @d_d_date";
                    List<ConnectionWithAccess.QueryParams> objParams = new List<ConnectionWithAccess.QueryParams>();
                    ConnectionWithAccess.QueryParams ParamFrom = new ConnectionWithAccess.QueryParams();
                    ParamFrom.paramName = "@D_D_Date";
                    ParamFrom.paramValue = Convert.ToDateTime(crdatetime.Value.ToShortDateString());
                    objParams.Add(ParamFrom);
                    ConnectionWithAccess.QueryParamList = objParams;
                    //add_user_date_time_function_compulsory_program();
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        int mcolumncount = dtData1.Columns.Count;
                        for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                        {
                            for (int i = 0; i <= mcolumncount - 1; i++)
                            {
                                crdocno.Text = (Convert.ToInt32(dtData1.Rows[iRowCount][0].ToString()) + 1).ToString();
                            }
                        }
                    }
                    else
                        crdocno.Text = "1";

                    //ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[24] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + crdbc.Text;
                    //ConnectionCommand.ExportToText(crdbc, crdocno);
                    cra_n.Clear();
                    crs_a.Clear();
                }
                else if (subtabcash.SelectedIndex == 1)
                {
                    ConnectionWithAccess.query = "SELECT d_n from " + ConnectionWithAccess.tablename[24] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + cpdbc.Text + " and d_d = @d_d_date";
                    List<ConnectionWithAccess.QueryParams> objParams = new List<ConnectionWithAccess.QueryParams>();
                    ConnectionWithAccess.QueryParams ParamFrom = new ConnectionWithAccess.QueryParams();
                    ParamFrom.paramName = "@D_D_Date";
                    ParamFrom.paramValue = Convert.ToDateTime(cpdatetime.Value.ToShortDateString());
                    objParams.Add(ParamFrom);
                    ConnectionWithAccess.QueryParamList = objParams;
                    //add_user_date_time_function_compulsory_program();
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        temp_int = 0;
                        int mcolumncount = dtData1.Columns.Count;
                        for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                        {
                            temp_int = Convert.ToInt32(dtData1.Rows[iRowCount][0].ToString());

                        }
                        cpdocno.Text = (temp_int + 1).ToString();
                    }
                    else
                        cpdocno.Text = "1";
                    //ConnectionCommand.ExportToText(cpdbc, cpdocno);
                    //temp_word = Convert.ToString(cpdatetime.Value.Year) + Convert.ToString(cpdatetime.Value.Month);
                    //cpdocno.Text = cpdocno.Text.Replace(temp_word, "");
                    cpa_n.Clear();
                    cps_a.Clear();
                }
            }
        }

        private void refresh_data_entry_bank_for_new_record()
        {
            DispEmail.Clear();
            if (subtabbank.SelectedIndex == 0)
            {
                tb_br_mobilenumber.Text = "";
                old_bank_receipt_amount = 0;
                if (DateTime.Today > Convert.ToDateTime(ConnectionWithAccess.medate))
                    brdatetime.Value = Convert.ToDateTime(ConnectionWithAccess.medate);
                else
                    brdatetime.Value = DateTime.Today;
                brdid.Clear();
                brformid.Clear();
                brpartyaddress.Clear();
                brpartycontact.Clear();
                brpartyname.Clear();
                brpid.Clear();
                bramt.Clear();
                brchkdate.Text = null;
                brchkno.Text = "0";
                brchkstatus.SelectedIndex = 1;
                brcomm.Text = null;
                brcurbankbal.Text = null;
                brdocno.Text = null;
                brpartycode.Text = null;
                brpartycity.Text = null;
                brpartyoverallbalance.Text = "0.00";
                refresh_bank_document_number();
                fill_bank_trans_list();
                get_account_name_from_d_c("B", Convert.ToInt32(brdbc.Text));
                brcurbankbal.Text = Convert.ToString(get_bank_balance(ConnectionWithAccess.bank_a_n, "@@@", DateTime.Today.ToShortDateString()));
                brpartycode.Focus();
            }
            else if (subtabbank.SelectedIndex == 1)
            {
                bp_basicamt.ReadOnly = true;
                bp_igst_per.ReadOnly = true;
                bpamt.ReadOnly = true;
                tb_bp_mobilenumber.Text = "";
                old_bank_payment_amount = 0;
                if (DateTime.Today > Convert.ToDateTime(ConnectionWithAccess.medate))
                    bpdatetime.Value = Convert.ToDateTime(ConnectionWithAccess.medate);
                else
                    bpdatetime.Value = DateTime.Today;
                bpamt.Text = "0.00";
                bpchkdate.Text = null;
                bpchkno.Text = "0";
                bpchkstatus.SelectedIndex = 1;
                bpcomm.Text = null;
                bpcurbankbal.Text = null;
                bpdocno.Text = null;
                bppartycode.Text = null;
                bppartycity.Text = null;
                bp_basicamt.Text = "0.00";
                bp_igst_per.Text = "0.00";
                bp_igstamt.Text = "0.00";
                refresh_bank_document_number();
                fill_bank_trans_list();
                get_account_name_from_d_c("B", Convert.ToInt32(bpdbc.Text));
                bpcurbankbal.Text = Convert.ToString(get_bank_balance(ConnectionWithAccess.bank_a_n, "@@@", DateTime.Today.ToShortDateString()));
                bp_dgv_gst_tax_brief.Visible = false;
                btn_cheque_print.Visible = false;
                bppartycode.Focus();
            }
            else if (subtabbank.SelectedIndex == 2)
            {
                tb_bd_mobilenumber.Text = "";
                old_bank_deposit_amount = 0;
                if (DateTime.Today > Convert.ToDateTime(ConnectionWithAccess.medate))
                    bddatetime.Value = Convert.ToDateTime(ConnectionWithAccess.medate);
                else
                    bddatetime.Value = DateTime.Today;
                bdamt.Clear();
                //bdbankname.Text = null;
                bdcomm.Text = null;
                bdcurbankbal.Text = null;
                bddatetime.Text = null;
                bddocno.Text = null;
                bdpartycode.Text = null;
                refresh_bank_document_number();
                fill_bank_trans_list();
                get_account_name_from_d_c("B", Convert.ToInt32(bddbc.Text));
                bdcurbankbal.Text = Convert.ToString(get_bank_balance(ConnectionWithAccess.bank_a_n, "@@@", DateTime.Today.ToShortDateString()));
                bdcurcashbal.Text = Convert.ToString(get_cash_balance("2010", "@@@", DateTime.Today.ToShortDateString()));
                bdamt.Focus();
            }
            else if (subtabbank.SelectedIndex == 3)
            {
                tb_bw_mobilenumber.Text = "";
                old_bank_withdrawal_amount = 0;
                if (DateTime.Today > Convert.ToDateTime(ConnectionWithAccess.medate))
                    bwdatetime.Value = Convert.ToDateTime(ConnectionWithAccess.medate);
                else
                    bwdatetime.Value = DateTime.Today;
                bwamt.Clear();
                bwcomm.Text = null;
                bwdocno.Text = null;
                refresh_bank_document_number();
                fill_bank_trans_list();
                get_account_name_from_d_c("B", Convert.ToInt32(bwdbc.Text));
                bwcurbankbal.Text = Convert.ToString(get_bank_balance(ConnectionWithAccess.bank_a_n, "@@@", DateTime.Today.ToShortDateString()));
                bwcurcashbal.Text = Convert.ToString(get_cash_balance(ConnectionWithAccess.cash_a_n, "@@@", DateTime.Today.ToShortDateString()));
                bwamt.Focus();
            }
            else if (subtabbank.SelectedIndex == 4)
            {
                old_bank_transfer_amount = 0;
                if (DateTime.Today > Convert.ToDateTime(ConnectionWithAccess.medate))
                    tr_datetime.Value = Convert.ToDateTime(ConnectionWithAccess.medate);
                else
                    tr_datetime.Value = DateTime.Today;
                tr_docno.Text = null;
                ConnectionWithAccess.md_n = null;
                tr_amt.Text = null;
                tr_comm.Text = null;
                refresh_bank_document_number();
                fill_bank_trans_list();
                get_account_name_from_d_c("B", Convert.ToInt32(cb_tr_from_dc.Text));
                tr_from_bank_curr_bal.Text = Convert.ToString(get_bank_balance(ConnectionWithAccess.bank_a_n, "@@@", DateTime.Today.ToShortDateString()));
                get_account_name_from_d_c("B", Convert.ToInt32(cb_tr_to_dc.Text));
                tr_to_bank_curr_bal.Text = Convert.ToString(get_bank_balance(ConnectionWithAccess.bank_a_n, "@@@", DateTime.Today.ToShortDateString()));
                tr_amt.Focus();
            }
        }

        private void refresh_data_entry_cash_for_new_record()
        {
            if (subtabcash.SelectedIndex == 0)
            {
                tb_cr_mobilenumber.Text = "";
                cramt.ReadOnly = true;
                cra_n.Clear();
                crs_a.Clear();
                old_cash_receipt_amount = 0;
                crpartyname.Text = null;
                crpartyaddress.Text = null;
                crpartycontact.Text = null;
                crpartybalance.Text = null;
                cramt.Text = "0.00";
                crcomm.Text = null;
                crcurcashbal.Text = null;
                crdocno.Text = null;
                crpartycode.Text = null;
                crpartycity.Text = null;
                DispEmail.Clear();
                refresh_cash_document_number();
                fillcrtranlist();
                get_account_name_from_d_c("C", Convert.ToInt32(crdbc.Text));
                crcurcashbal.Text = Convert.ToString(get_cash_balance(ConnectionWithAccess.cash_a_n, "@@@", DateTime.Today.ToShortDateString()));
                if (crtranlist.Rows.Count > 0)
                {
                    crdatetime.Value = Convert.ToDateTime(crtranlist.Rows[0].Cells[0].Value.ToString());
                }
            }
            else if (subtabcash.SelectedIndex == 1)
            {
                cpdocno.Text = "";
                refresh_cash_document_number();
                tb_cp_mobilenumber.Text = "";
                cpamt.ReadOnly = true;
                cp_igst_per.ReadOnly = true;
                cp_igstamt.ReadOnly = true;
                cp_basicamt.ReadOnly = true;
                cp_igstamt.Text = "0.00";
                cp_igst_per.Text = "0.00";
                cp_basicamt.Text = "0.00";
                cpamt.Text = "0.00";
                cpa_n.Clear();
                cps_a.Clear();
                old_cash_payment_amount = 0;
                DispEmail.Clear();
                cppartyname.Text = null;
                cppartyaddress.Text = null;
                cppartycontact.Text = null;
                cppartyoverallbalance.Text = "0.00";
                cpcomm.Text = null;
                cpcurcashbal.Text = null;
                cppartycode.Text = null;
                cppartycity.Text = null;
                fillcptranlist();
                cpcurcashbal.Text = Convert.ToString(get_cash_balance(ConnectionWithAccess.cash_a_n, "@@@", DateTime.Today.ToShortDateString()));
                if (cptranlist.Rows.Count > 0)
                {
                    cpdatetime.Value = Convert.ToDateTime(cptranlist.Rows[0].Cells[0].Value.ToString());
                }

            }
        }

        private void refresh_data_entry_journal_for_new_record()
        {
            jj_dgv_gst_tax_brief.Visible = false;
            jj_dgv_gst_tax_brief.DataSource = null;
            gb_payee_details.Visible = false;
            gb_payer_details.Visible = false;
            cb_tr_to_dc.Enabled = false;
            ja_n.Clear();
            js_a.Clear();
            jna_n.Clear();
            jns_a.Clear();
            old_journal_amount = 0;
            DispEmail.Clear();
            jjdocno.Text = null;
            jjcomm.Text = null;
            jjamt.Text = "0.00";
            jjbamt.Text = "0.00";
            jjigst_per.Text = "0.00";
            jjigst_amt.Text = "0.00";
            jjpartycode1.Text = null;
            jjpartycode2.Text = null;
            lbl_jour_payer_acc_head.Visible = false;
            jjamt.ReadOnly = true;
            jjbamt.ReadOnly = true;
            jjigst_per.ReadOnly = true;
            ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[25] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + jjdbc.Text;
            ConnectionCommand.ExportToText(jjdbc, jjdocno);
            filljrtranlist();
        }

        private void refresh_item_master()
        {
            tbTitle.ReadOnly = false;
            cb_change_item_name.Visible = false;
            tbItemType.Clear();
            tbItemCode.Clear();
            tbTitle.Clear();
            tbItemRate.Text = "0.00";
            tb_purc_price.Text = "0.00";
            tblbt.Clear();
            tbMinStock.Clear();
            tbCB.Text = "0";
            tbBQ.Text = "0";
            tbCurStock.Text = "0";
            tb_hsn_code.Text = "0";
            tb_item_open_stock.Text = "0";
            find_new_item_code();
        }

        private void refresh_tax_master()
        {
            tbTaxCode.Clear();
            tbTaxDesc.Clear();
            tbTaxRate.Clear();
            find_new_tax_code();
        }

        private void refresh_user_settings()
        {
            tbUserName.Text = "";
            tbPassword.Text = "";
            chbPrivMastersAllV.Checked = false;
            chbPrivMastersAllE.Checked = false;
            chbPrivAccountV.Checked = false;
            chbPrivAccountE.Checked = false;
            chbPrivItemV.Checked = false;
            chbPrivItemE.Checked = false;
            chbPrivTaxV.Checked = false;
            chbPrivTaxE.Checked = false;
            chbPrivDbcV.Checked = false;
            chbPrivDbcE.Checked = false;
            chbPrivPeriodV.Checked = false;
            chbPrivPeriodE.Checked = false;
            chbPrivDataEntAllV.Checked = false;
            chbPrivDataEntAllE.Checked = false;
            chbPrivSaleV.Checked = false;
            chbPrivSaleE.Checked = false;
            chbPrivPurchaseV.Checked = false;
            chbPrivPurchaseE.Checked = false;
            chbPrivBankV.Checked = false;
            chbPrivBankE.Checked = false;
            chbPrivCashV.Checked = false;
            chbPrivCashE.Checked = false;
            chbPrivJournalV.Checked = false;
            chbPrivJournalE.Checked = false;

            chbPrivDataEntAllV.Checked = false;
            chbPrivSaleV.Checked = false;
            chbPrivPurchaseV.Checked = false;

            chbPrivOthersAllV.Checked = false;
            chbPrivUSetngV.Checked = false;
            chbPrivGSetngV.Checked = false;
            chbPrivCompInV.Checked = false;
            chbPrivReportsV.Checked = false;
            chbPrivUtilitiesV.Checked = false;

            chbPrivOthersAllE.Checked = false;
            chbPrivUSetngE.Checked = false;
            chbPrivGSetngE.Checked = false;
            chbPrivCompInE.Checked = false;
            chbPrivReportsE.Checked = false;
            chbPrivUtilitiesE.Checked = false;

            chbPrivsendsms.Checked = false;
            chbPrivsendemail.Checked = false;
            chbPriveditaccount.Checked = false;
            chbPriveditinvoice.Checked = false;
            chbPrivprintinvoice.Checked = false;
        }

        # endregion

        # region create_new
        private void create_new_period()
        {
            temp_int = PeriodListDG.Rows.Count - 1;
            char c = Convert.ToChar(PeriodListDG.Rows[temp_int].Cells[0].Value.ToString());
            tbPrd.Text = Convert.ToString(Convert.ToChar((Convert.ToInt32(c)) + 1));
            Int64 addedDays = Convert.ToInt64(10);
            dtPrdSD.Value = Convert.ToDateTime(PeriodListDG.Rows[temp_int].Cells[2].Value).AddDays(1);
            dtPrdSD.MinDate = Convert.ToDateTime(dtPrdSD.Value);
            if (rb_yearly.Checked == true)
                dtPrdED.Value = Convert.ToDateTime(PeriodListDG.Rows[temp_int].Cells[2].Value).AddDays(365);
            else
                dtPrdED.Value = Convert.ToDateTime(PeriodListDG.Rows[temp_int].Cells[2].Value).AddDays(30);
            tbGP.Text = PeriodListDG.Rows[temp_int].Cells[4].Value.ToString();
            tb_vat_tax_required.Text = PeriodListDG.Rows[temp_int].Cells[5].Value.ToString();
            tb_print_form.Text = PeriodListDG.Rows[temp_int].Cells[7].Value.ToString();
        }

        private void create_new_additional()
        {
            tb_additional_desc.Clear();
            tb_additional_add1.Clear();
            tb_additional_add2.Clear();
            tb_additional_add3.Clear();
            tb_additional_city.Clear();
            tb_additional_pincode.Text = "0";
            find_new_additional_a_n(cb_additional_a_n.Text);
            cb_additional_a_n.Items.Add(ConnectionWithAccess.new_additional_a_n);
            cb_additional_a_n.Text = ConnectionWithAccess.new_additional_a_n;
            cb_additional_a_n.Enabled = true;
        }
        # endregion

        private void siitemlist_KeyDown(object sender, KeyEventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Item";
            if (e.KeyCode == Keys.Enter)
            {
                ConnectionWithAccess.query = "select type, item_code, title from " + ConnectionWithAccess.tablename[05] + " where (type = '" + mtype + "' and item_code = '" + mitem_code + "') or title = '" + mtitle + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        siitemlist.CurrentRow.Cells[0].Value = dtData1.Rows[0][0].ToString();
                        siitemlist.CurrentRow.Cells[1].Value = dtData1.Rows[0][1].ToString();
                        siitemlist.CurrentRow.Cells[2].Value = dtData1.Rows[0][2].ToString();
                    }
                }
            }
        }

        private void sisalelistdg_SelectionChanged(object sender, EventArgs e)
        {
            msalepdf = null;
            if (Control.ModifierKeys == Keys.Down)
            {
                sia_n.Text = Convert.ToString(sisalelistdg.SelectedCells[2].Value);
                sis_a.Text = Convert.ToString(sisalelistdg.SelectedCells[3].Value);
                sid_y.Text = Convert.ToString(sisalelistdg.SelectedCells[4].Value);
                sidocno.Text = ConnectionWithAccess.md_n;
            }
        }

        # region calculate_data
        private void calculateSaleItemTotal()
        {
            int totalrowcount = siitemlist.Rows.Count;
            sale_invoice_amount = 0;
            for (int i = 0; i < totalrowcount; i++)
            {
                if (siitemlist.Rows[i].Cells[5].Value != System.DBNull.Value && siitemlist.Rows[i].Cells[6].Value != System.DBNull.Value)
                {
                    siitemlist.Rows[i].Cells[7].Value = Convert.ToDouble(siitemlist.Rows[i].Cells[5].Value) * Convert.ToDouble(siitemlist.Rows[i].Cells[6].Value);
                    if (siitemlist.Rows[i].Cells[7].Value != System.DBNull.Value)
                        sale_invoice_amount = sale_invoice_amount + Convert.ToDouble(siitemlist.Rows[i].Cells[7].Value);
                }
            }
            if (sale_invoice_amount == 0)
                sibasicamt.Enabled = true;
            sibasicamt.Text = Convert.ToString(sale_invoice_amount);
        }

        private void calculateSaleorderItemTotal()
        {
            int totalrowcount = soitemlist.Rows.Count;
            sale_order_amount = 0;
            for (int i = 0; i < totalrowcount; i++)
            {
                if (soitemlist.Rows[i].Cells[5].Value != System.DBNull.Value && soitemlist.Rows[i].Cells[6].Value != System.DBNull.Value)
                {
                    soitemlist.Rows[i].Cells[7].Value = Convert.ToDouble(soitemlist.Rows[i].Cells[5].Value) * Convert.ToDouble(soitemlist.Rows[i].Cells[6].Value);
                    if (soitemlist.Rows[i].Cells[7].Value != System.DBNull.Value)
                        sale_order_amount += Convert.ToDouble(soitemlist.Rows[i].Cells[7].Value);
                }
            }
            if (sale_order_amount == 0)
                sobasicamt.Enabled = true;
            sobasicamt.Text = Convert.ToString(sale_order_amount);
        }

        private void calculateSalereplaceItemTotal()
        {
            int totalrowcount = sritemlist.Rows.Count;
            sale_replace_amount = 0;
            for (int i = 0; i < totalrowcount; i++)
            {
                if (sritemlist.Rows[i].Cells[5].Value != System.DBNull.Value && sritemlist.Rows[i].Cells[6].Value != System.DBNull.Value)
                {
                    sritemlist.Rows[i].Cells[7].Value = Convert.ToDouble(sritemlist.Rows[i].Cells[5].Value) * Convert.ToDouble(sritemlist.Rows[i].Cells[6].Value);
                    if (sritemlist.Rows[i].Cells[7].Value != System.DBNull.Value)
                        sale_replace_amount += Convert.ToDouble(sritemlist.Rows[i].Cells[7].Value);
                }
            }
            if (sale_replace_amount == 0)
                srbasicamt.Enabled = true;
            srbasicamt.Text = Convert.ToString(sale_replace_amount);
        }

        private void calculate_simple_SaleItemTotal()
        {
            int totalrowcount = simple_itemsalelist.Rows.Count;
            sale_invoice_amount = 0;
            for (int i = 0; i < totalrowcount; i++)
            {
                if (simple_itemsalelist.Rows[i].Cells[5].Value != System.DBNull.Value && simple_itemsalelist.Rows[i].Cells[6].Value != System.DBNull.Value)
                {
                    simple_itemsalelist.Rows[i].Cells[7].Value = Convert.ToDouble(simple_itemsalelist.Rows[i].Cells[5].Value) * Convert.ToDouble(simple_itemsalelist.Rows[i].Cells[6].Value);
                    if (simple_itemsalelist.Rows[i].Cells[7].Value != System.DBNull.Value)
                        sale_invoice_amount = sale_invoice_amount + Convert.ToDouble(simple_itemsalelist.Rows[i].Cells[7].Value);
                }
            }
            if (sale_invoice_amount == 0)
                simple_salelist.Enabled = true;
            simple_grossamt.Text = Convert.ToString(sale_invoice_amount);
        }

        private void calculatepurcItemTotal()
        {
            purchase_invoice_amount = 0;
            pi_invoice_tax_amount = 0;
            int totalrowcount = piitemlist.Rows.Count;
            if (totalrowcount > 1)
            {
                for (int i = 0; i < totalrowcount; i++)
                {
                    if (piitemlist.Rows[i].Cells[7].Value != System.DBNull.Value)
                        purchase_invoice_amount += Convert.ToDouble(piitemlist.Rows[i].Cells[7].Value);
                    if (periodofgst == true)
                    {
                        if (piitemlist.Rows[i].Cells[9].Value != System.DBNull.Value)
                            pi_invoice_tax_amount += (Convert.ToDouble(piitemlist.Rows[i].Cells[7].Value) * Convert.ToDouble(piitemlist.Rows[i].Cells[9].Value) / 100);
                    }
                }

            }
            pibasicamt.Text = Convert.ToString(purchase_invoice_amount);
            tb_pi_igst_tax_amount.Text = Convert.ToString(pi_invoice_tax_amount);
            tb_pi_igst_tax_amount.Text = string.Format("{0:0.00}", Convert.ToDouble(tb_pi_igst_tax_amount.Text));
        }

        private void calculate_roundoff()
        {
            if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
            {
                temp_double = Math.Round(sale_invoice_amount, 0);
                temp_double2 = Math.Round((sale_invoice_amount - temp_double), 2);
                siroundoffamt.Text = (temp_double2 * -1).ToString();
            }
            else if (subtabDataEntry.SelectedIndex == 1 && subtabpurchase.SelectedIndex == 0)
            {
                temp_double = Math.Round(purchase_invoice_amount, 0);
                temp_double2 = Math.Round((purchase_invoice_amount - temp_double), 2);
                piroundoffamt.Text = (temp_double2 * -1).ToString();
            }
        }

        # endregion

        private void sipartycode_KeyPress(object sender, KeyPressEventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Party";
            si_party_help.Visible = true;
        }

        private void siitemlist_KeyPress(object sender, KeyPressEventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Item";
            if (e.KeyChar == 27)
            {
                siitemlist.BringToFront();
                si_item_help.Visible = false;
            }
            else if (e.KeyChar == 9)
            {
                siitemlist.BringToFront();
                si_item_help.Visible = false;
            }
            else if (e.KeyChar == 13)
            {
                siitemlist.BringToFront();
                si_item_help.Visible = false;
                get_item_details_from_05_using_type_item_code(mtype, mitem_code);
                siitemlist.CurrentRow.Cells[2].Value = item_details_from_05[2];
                siitemlist.CurrentRow.Cells[3].Value = 1;
                siitemlist.CurrentRow.Cells[4].Value = item_details_from_05[3];
            }
        }

        bool issrTxtChangedAssigned = false;
        bool issiTxtChangedAssigned = false;
        private void siitemlist_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
        {
            if (!issiTxtChangedAssigned)
            {
                ConnectionWithAccess.data_entry_working = "Sale Item";
                //e.Control.TextChanged += new EventHandler(textBox_TextChanged);
                cntObject = e.Control;
                cntObject.TextChanged += textBox_TextChanged;
                issiTxtChangedAssigned = true;
            }
        }

        private void textBox_TextChanged(object sender, EventArgs e)
        {
            if (subtabDataEntry.SelectedIndex == 0)
            {
                if (subtabsale.SelectedIndex == 0)
                {
                    if (cntObject.Text != string.Empty)
                    {
                        columnIndex = siitemlist.CurrentCell.ColumnIndex;
                        rowIndex = siitemlist.CurrentCell.RowIndex;
                        string tempword = cntObject.Text;
                        if (rowIndex > -1)
                        {
                            siitemlistrowindex = siitemlist.CurrentCell.RowIndex;
                            if (columnIndex == 1)
                            {
                                mitem_code = cntObject.Text;
                                si_item_help.BringToFront();
                                si_item_help.Visible = true;
                                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where item_code like '%" + mitem_code + "%'";
                                ConnectionCommand.accountHelp_datatable_Seperate(si_item_help, "si_item_help");
                                if (si_item_help.CurrentRow == null)
                                {
                                    si_item_help.Visible = false;
                                }
                            }
                            else if (columnIndex == 2)
                            {
                                mtitle = cntObject.Text;
                                si_item_help.BringToFront();
                                si_item_help.Visible = true;
                                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where title like '%" + mtitle + "%'";
                                ConnectionCommand.accountHelp_datatable_Seperate(si_item_help, "si_item_help");
                                if (si_item_help.CurrentRow == null)
                                {
                                    ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where item_code like '%" + mtitle + "%'";
                                    ConnectionCommand.accountHelp_datatable_Seperate(si_item_help, "si_item_help");
                                    if (si_item_help.CurrentRow == null)
                                        si_item_help.Visible = false;
                                }
                            }
                        }
                    }
                }
                else if (subtabsale.SelectedIndex == 1)
                {
                    if (cntObject.Text != string.Empty)
                    {
                        int sr_item_helprowindex;
                        columnIndex = sritemlist.CurrentCell.ColumnIndex;
                        rowIndex = sritemlist.CurrentCell.RowIndex;
                        string tempword = cntObject.Text;
                        if (rowIndex > -1)
                        {
                            sr_item_helprowindex = sritemlist.CurrentCell.RowIndex;
                            if (columnIndex == 1)
                            {
                                mitem_code = cntObject.Text;
                                sr_item_help.BringToFront();
                                sr_item_help.Visible = true;
                                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where item_code like '%" + mitem_code + "%'";
                                ConnectionCommand.accountHelp_datatable_Seperate(sr_item_help, "sr_item_help");
                                if (sr_item_help.CurrentRow == null)
                                {
                                    sr_item_help.Visible = false;
                                }
                            }
                            else if (columnIndex == 2)
                            {
                                mtitle = cntObject.Text;
                                sr_item_help.BringToFront();
                                sr_item_help.Visible = true;
                                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where title like '%" + mtitle + "%'";
                                ConnectionCommand.accountHelp_datatable_Seperate(sr_item_help, "sr_item_help");
                                if (sr_item_help.CurrentRow == null)
                                {
                                    ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where item_code like '%" + mtitle + "%'";
                                    ConnectionCommand.accountHelp_datatable_Seperate(sr_item_help, "sr_item_help");
                                    if (sr_item_help.CurrentRow == null)
                                        sr_item_help.Visible = false;
                                }
                            }
                        }
                    }
                }
                else if (subtabsale.SelectedIndex == 2)
                {
                    if (cntObject.Text != string.Empty)
                    {
                        columnIndex = soitemlist.CurrentCell.ColumnIndex;
                        rowIndex = soitemlist.CurrentCell.RowIndex;
                        string tempword = cntObject.Text;
                        if (rowIndex > -1)
                        {
                            soitemlistrowindex = soitemlist.CurrentCell.RowIndex;
                            if (columnIndex == 0)
                            {
                                mtype = cntObject.Text;
                                dgv_soitemhelp.BringToFront();
                                dgv_soitemhelp.Visible = true;
                                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where [type] =  '" + tempword + "'";
                                ConnectionCommand.accountHelp_datatable_Seperate(dgv_soitemhelp, "si_item_help");
                                dgv_soitemhelp.Sort(dgv_soitemhelp.Columns[2], ListSortDirection.Ascending);
                            }
                            else if (columnIndex == 1)
                            {
                                mitem_code = cntObject.Text;
                                dgv_soitemhelp.BringToFront();
                                dgv_soitemhelp.Visible = true;
                                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where [item_code] like '" + tempword + "%'";
                                ConnectionCommand.accountHelp_datatable_Seperate(dgv_soitemhelp, "si_item_help");
                                dgv_soitemhelp.Sort(dgv_soitemhelp.Columns[1], ListSortDirection.Ascending);
                            }
                            else if (columnIndex == 2)
                            {
                                mtitle = cntObject.Text;
                                dgv_soitemhelp.BringToFront();
                                dgv_soitemhelp.Visible = true;
                                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where title like '%" + mtitle + "%'";
                                ConnectionCommand.accountHelp_datatable_Seperate(dgv_soitemhelp, "so_item_help");
                                //dgv_soitemhelp.Sort(dgv_soitemhelp.Columns[2], ListSortDirection.Ascending);
                            }
                        }
                    }
                }
                else if (subtabsale.SelectedIndex == 3)
                {
                    if (cntObject.Text != string.Empty)
                    {
                        columnIndex = simple_itemsalelist.CurrentCell.ColumnIndex;
                        rowIndex = simple_itemsalelist.CurrentCell.RowIndex;
                        string tempword = cntObject.Text;
                        if (rowIndex > -1)
                        {
                            //siitemlistrowindex = siitemlist.CurrentCell.RowIndex;
                            if (columnIndex == 1)
                            {
                                mitem_code = cntObject.Text;
                                simple_item_help.BringToFront();
                                simple_item_help.Visible = true;
                                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where item_code like '%" + mitem_code + "%'";
                                ConnectionCommand.accountHelp_datatable_Seperate(simple_item_help, "simple_item_help");
                                if (simple_item_help.CurrentRow == null)
                                {
                                    simple_item_help.Visible = false;
                                }
                            }
                            else if (columnIndex == 2)
                            {
                                mtitle = cntObject.Text;
                                simple_item_help.BringToFront();
                                simple_item_help.Visible = true;
                                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where title like '%" + mtitle + "%'";
                                ConnectionCommand.accountHelp_datatable_Seperate(simple_item_help, "simple_item_help");
                                if (simple_item_help.CurrentRow == null)
                                {
                                    ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where item_code like '%" + mtitle + "%'";
                                    ConnectionCommand.accountHelp_datatable_Seperate(simple_item_help, "simple_item_help");
                                    if (simple_item_help.CurrentRow == null)
                                        simple_item_help.Visible = false;
                                }
                            }
                            else if (columnIndex == 7)
                            {
                                mamount = Convert.ToSingle(simple_itemsalelist.Rows[rowIndex].Cells[7].Value.ToString());
                                mbox = Convert.ToDouble(item_details_from_05[3]);
                                mqty = Convert.ToDouble(item_details_from_05[4]);
                                mprice = mamount / (mcase * mbox * mqty);
                                simple_itemsalelist.Rows[rowIndex].Cells[6].Value = mprice;
                                calculate_simple_SaleItemTotal();
                            }
                        }
                    }
                }
            }
            else if (subtabDataEntry.SelectedIndex == 1)
            {
                if (cntObject.Text != string.Empty)
                {
                    columnIndex = piitemlist.CurrentCell.ColumnIndex;
                    rowIndex = piitemlist.CurrentCell.RowIndex;
                    string tempword = cntObject.Text;
                    if (rowIndex > -1)
                    {
                        piitemlistrowindex = piitemlist.CurrentCell.RowIndex;
                        if (columnIndex == 2)
                        {
                            mtitle = cntObject.Text;
                            pi_item_help.Visible = true;
                            ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where title like '%" + mtitle + "%'";
                            ConnectionCommand.accountHelp_datatable_Seperate(pi_item_help, "pi_item_help");
                            if (pi_item_help.CurrentRow == null)
                            {
                                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where item_code like '%" + mtitle + "%'";
                                ConnectionCommand.accountHelp_datatable_Seperate(pi_item_help, "pi_item_help");
                                if (pi_item_help.CurrentRow == null)
                                    pi_item_help.Visible = false;
                            }
                        }
                    }
                }
            }
            else if (subtabDataEntry.SelectedIndex == 2)
            {
                if (cntObject.Text != string.Empty)
                {
                    rowIndex = bp_dgv_gst_tax_brief.CurrentCell.RowIndex;
                    columnIndex = bp_dgv_gst_tax_brief.CurrentCell.ColumnIndex;
                    if (bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[3].Value.ToString() != "0.00")
                    {
                        temp_word = bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[3].Value.ToString();
                        if (temp_word != "")
                            bpamt.Text = (Convert.ToDouble(bpamt.Text) - Convert.ToDouble(bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[2].Value.ToString())).ToString();
                    }
                    if (columnIndex == 0)
                    {
                        if (bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[1].Value != System.DBNull.Value)
                        {
                            bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[2].Value = Convert.ToDouble(cntObject.Text) * Convert.ToDouble(bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[1].Value) / 100;
                            bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[3].Value = Convert.ToDouble(cntObject.Text) + Convert.ToDouble(bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[2].Value);
                        }
                    }
                    else if (columnIndex == 1 && bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[0].Value != null)
                    {
                        bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[2].Value = Convert.ToDouble(bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[0].Value) * Convert.ToDouble(cntObject.Text) / 100;
                        bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[3].Value = (Convert.ToDouble(bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[0].Value) * Convert.ToDouble(cntObject.Text) / 100) + Convert.ToDouble(bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[0].Value);
                    }
                    if (bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[3].Value != null)
                    {
                        temp_word = bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[3].Value.ToString();
                        if (temp_word != "")
                            bpamt.Text = (Convert.ToDouble(bpamt.Text) + Convert.ToDouble(bp_dgv_gst_tax_brief.Rows[rowIndex].Cells[2].Value.ToString())).ToString();
                    }
                }
            }
            else if (subtabDataEntry.SelectedIndex == 4)
            {
                if (cntObject.Text != string.Empty)
                {
                    rowIndex = jj_dgv_gst_tax_brief.CurrentCell.RowIndex;
                    columnIndex = jj_dgv_gst_tax_brief.CurrentCell.ColumnIndex;
                    if (jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[3].Value != null)
                    {
                        temp_word = jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[3].Value.ToString();
                        if (temp_word != "")
                            jjamt.Text = (Convert.ToDouble(jjamt.Text) - Convert.ToDouble(jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[2].Value.ToString())).ToString();
                    }
                    if (columnIndex == 0)
                    {
                        if (jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[1].Value != System.DBNull.Value)
                        {
                            jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[2].Value = Convert.ToDouble(cntObject.Text) * Convert.ToDouble(jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[1].Value) / 100;
                            jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[3].Value = Convert.ToDouble(cntObject.Text) + Convert.ToDouble(jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[2].Value);
                        }
                    }
                    else if (columnIndex == 1 && jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[0].Value != null)
                    {
                        jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[2].Value = Convert.ToDouble(jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[0].Value) * Convert.ToDouble(cntObject.Text) / 100;
                        jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[3].Value = (Convert.ToDouble(jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[0].Value) * Convert.ToDouble(cntObject.Text) / 100) + Convert.ToDouble(jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[0].Value);
                    }
                    if (jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[3].Value != null)
                    {
                        temp_word = jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[2].Value.ToString();
                        if (temp_word != "")
                            jjamt.Text = (Convert.ToDouble(jjamt.Text) + Convert.ToDouble(jj_dgv_gst_tax_brief.Rows[rowIndex].Cells[2].Value.ToString())).ToString();
                    }
                }
            }
        }

        private void calculate_all_bank_payment_gst_rows()
        {
            bp_gross_amt = 0;
            for (row_pointer = 0; row_pointer < bp_dgv_gst_tax_brief.Rows.Count; row_pointer++)
            {
                bp_dgv_gst_tax_brief.Rows[row_pointer].Cells[2].Value = Convert.ToDouble(bp_dgv_gst_tax_brief.Rows[row_pointer].Cells[0].Value) * Convert.ToDouble(bp_dgv_gst_tax_brief.Rows[row_pointer].Cells[1].Value) / 100;
                bp_dgv_gst_tax_brief.Rows[row_pointer].Cells[3].Value = Convert.ToDouble(bp_dgv_gst_tax_brief.Rows[row_pointer].Cells[0].Value) + Convert.ToDouble(bp_dgv_gst_tax_brief.Rows[row_pointer].Cells[2].Value);
                bp_gross_amt += Convert.ToDouble(bp_dgv_gst_tax_brief.Rows[row_pointer].Cells[3].Value);
            }
            bpamt.Text = bp_gross_amt.ToString();
        }

        private void update_master_account_screen_details(string ma_n, string ms_a, string md_y)
        {
            ConnectionWithAccess.query = "select f1.[desc], f1.city, add1, add2,add3, tin_num, budget, f1.pin, tpt, tx_code, std, o_mob, r_mob, phone1, phone12, phone2, fax, email,web, f1.a_n, f1.s_a, f1.d_y,f1.aadhar_card,f1.dist,f1.gst_number,f1.state from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4 where f4.a_n = f1.a_n and f4.s_a = f1.s_a and f4.d_y = f1.d_y and f1.a_n = '" + ma_n + "' and f1.s_a = '" + ms_a + "' and f1.d_y = '" + md_y + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    ConnectionWithAccess.mdesc = dtData1.Rows[0][0].ToString();
                    tbStd.Text = dtData1.Rows[0][10].ToString();
                    tbstate.Text = dtData1.Rows[0][25].ToString();
                    tbAdd1.Text = dtData1.Rows[0][2].ToString();
                    tbAdd2.Text = dtData1.Rows[0][3].ToString();
                    tbAdd3.Text = dtData1.Rows[0][4].ToString();
                    tbTINNo.Text = dtData1.Rows[0][5].ToString();
                    tbMaxLim.Text = dtData1.Rows[0][6].ToString();
                    tbPincode.Text = dtData1.Rows[0][7].ToString();
                    tbTPT.Text = dtData1.Rows[0][8].ToString();
                    tbTaxCode.Text = dtData1.Rows[0][9].ToString();
                    tbMNo1.Text = dtData1.Rows[0][11].ToString();
                    tbMNo2.Text = dtData1.Rows[0][12].ToString();
                    tbOPh1.Text = dtData1.Rows[0][13].ToString();
                    tbOPh2.Text = dtData1.Rows[0][14].ToString();
                    tbRPh2.Text = dtData1.Rows[0][15].ToString();
                    tbFax.Text = dtData1.Rows[0][16].ToString();
                    tbEmail.Text = dtData1.Rows[0][17].ToString();
                    tbWebsite.Text = dtData1.Rows[0][18].ToString();
                    tbadharcard.Text = dtData1.Rows[0][22].ToString();
                    tbdistrict.Text = dtData1.Rows[0][23].ToString();
                    tbgst_number.Text = dtData1.Rows[0][24].ToString();
                    get_tax_desc_from_dc("P", pidbc.Text, Convert.ToInt32(tbTaxCode.Text));
                    if (md_y == "@@@")
                    {
                        tbDesc.Text = ConnectionWithAccess.mdesc;
                        tbCity.Text = dtData1.Rows[0][1].ToString();
                    }
                    else
                    {
                        tbdelivery.Text = ConnectionWithAccess.mdesc;
                        tbdelivery_city.Text = dtData1.Rows[0][1].ToString();
                    }
                    if (tbStd.Text != "")
                    {
                        if (tbStd.Text.Substring(0, 1) == "0")
                            tbStd.Text = tbStd.Text.Substring(1, tbStd.Text.Length - 1);
                    }
                }
            }
            tbopenbalance.Text = Convert.ToString(get_account_balance_from_51("@", tbA_N.Text, tbS_A.Text));
            cb_change_master_account_name.Visible = true;
            check_pincode_and_stdcode_and_update_state();
        }

        private void tbDesc_TextChanged(object sender, EventArgs e)
        {
            lbl_master_master_account_name.Visible = true;
            if (cbParent.SelectedItem != null)
            {
                if (cbParent.SelectedItem.Equals("Unknown"))
                {
                    ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where d_y = '@@@' and [desc] like '%" + tbDesc.Text + "%'";
                    ConnectionCommand.accountHelp_datatable_Seperate(master_account_help_dg, "master_account_help_dg");
                    if (master_account_help_dg.CurrentRow != null)
                    {
                        common_account_head(master_account_help_dg.CurrentRow.Cells[2].Value.ToString());
                        lbl_master_master_account_name.Text = ConnectionWithAccess.macc_desc;
                    }
                    else
                    {
                        MessageBox.Show("Account Cannot be saved with Unknown Parent Account");
                        lbl_master_master_account_name.Text = null;
                    }
                }
                else
                {
                    if (!cb_change_master_account_name.Checked)
                    {
                        if (cbParent.SelectedItem.Equals("SUNDRY CREDITORS") || cbParent.SelectedItem.Equals("SUNDRY DEBTORS"))
                            ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + tbA_N.Text.Trim() + "' and d_y = '@@@' and [desc] like '" + tbDesc.Text + "%'";
                        else
                            ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where s_a = '@@@' and a_n like '" + tbA_N.Text + "%' and [desc] like '" + tbDesc.Text + "%'";
                        ConnectionCommand.accountHelp_datatable_Seperate(master_account_help_dg, "master_account_help_dg");
                        if (master_account_help_dg.CurrentRow != null)
                        {
                            common_account_head(master_account_help_dg.CurrentRow.Cells[2].Value.ToString());
                            lbl_master_master_account_name.Text = ConnectionWithAccess.macc_desc;
                        }
                        else
                        {
                            ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where a_n like '" + tbA_N.Text + "%' and [city] like '" + tbDesc.Text + "%'";
                            ConnectionCommand.accountHelp_datatable_Seperate(master_account_help_dg, "master_account_help_dg");
                            if (master_account_help_dg.CurrentRow == null)
                            {
                                master_account_help_dg.Visible = false;
                                tbS_A.Text = "@@@";
                                tbd_y.Text = "@@@";
                            }
                        }
                    }
                    else
                    {
                        temp_a_n = tbA_N.Text;
                        temp_s_a = tbS_A.Text;
                    }
                }
            }
            else
            {
                ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where a_n like '" + tbA_N.Text + "%' and s_a <> '@@@' and [desc] like '%" + tbDesc.Text + "%'";
                ConnectionCommand.accountHelp_datatable_Seperate(master_account_help_dg, "master_account_help_dg");
                if (master_account_help_dg.CurrentRow != null)
                {
                    common_account_head(master_account_help_dg.CurrentRow.Cells[2].Value.ToString());
                    lbl_master_master_account_name.Text = ConnectionWithAccess.macc_desc;
                }
                else
                {
                    MessageBox.Show("Account Cannot be saved with Unknown Parent Account");
                    lbl_master_master_account_name.Text = null;
                }
            }
        }

        private void fill_tax_description()
        {
            cbMtaxDesc.Items.Clear();
            if (cbParent.SelectedItem.Equals("SUNDRY CREDITORS") || cbParent.SelectedItem.Equals("SUNDRY DEBTORS"))
            {
                cbMtaxDesc.Visible = true;
                ConnectionWithAccess.query = "select distinct [desc] from " + ConnectionWithAccess.tablename[06] + " where d_c = " + cb_master_d_c.Text;
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows.Count >= 1)
                    {
                        for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                        {
                            if (dtData1.Rows[iRowCount][0] != null)
                                cbMtaxDesc.Items.Add(dtData1.Rows[iRowCount][0].ToString());
                        }
                    }
                    else
                    {
                        if (dtData1.Rows[0][0] != null)
                            cbMtaxDesc.Items.Add(dtData1.Rows[0][0].ToString());
                    }
                }
                if (cbMtaxDesc.Items.Count > 1)
                    cbMtaxDesc.SelectedIndex = 0;
            }
            else
                cbMtaxDesc.Visible = false;
        }

        private void btnsendemail_Click(object sender, EventArgs e)
        {
            if (!string.IsNullOrEmpty(msalepdf) && File.Exists(msalepdf))
            {
                sendemail("Sale Invoice Details", emailto, msalepdf);
            }
            else
            {
                MessageBox.Show("Sale Invoice PDF print file not found. Please first print file");
            }
        }

        private static void SendEmailFromYahoo(string emailFrom, string password, string emailmessage, string subject, string toemail_id, string attach_filename)
        {
            //Link for steps to set account security in Yahoo
            //https://stackoverflow.com/questions/40583661/authentication-error-in-sending-mail-from-yahoo-in-c-sharp-windows-application
            string smtpAddress = "smtp.mail.yahoo.com";
            int portNumber = 587;
            bool enableSSL = true;

            using (MailMessage mail = new MailMessage())
            {
                try
                {
                    mail.From = new MailAddress(emailFrom);
                    mail.To.Add(toemail_id.Trim().ToString());
                    mail.Subject = subject;
                    mail.Body = emailmessage;
                    mail.IsBodyHtml = true;
                    // Can set to false, if you are sending pure text.

                    mail.Attachments.Add(new Attachment(attach_filename));

                    using (SmtpClient smtp = new SmtpClient(smtpAddress, portNumber))
                    {
                        smtp.Credentials = new NetworkCredential(emailFrom, password);
                        smtp.EnableSsl = enableSSL;
                        smtp.Send(mail);
                        MessageBox.Show("Email Sent");
                    }
                }
                catch (Exception ex)
                {
                    MessageBox.Show("Error sending email. Email not sent.");
                }
            }
        }

        public static void sendemail(string subject, string toemail_id, string attach_filename)
        {
            if (toemail_id != null)
            {
                PleaseWait objPleaseWait = new PleaseWait("Please wait Sending Email");
                objPleaseWait.Show();
                Application.DoEvents();

                //Link to provide access to send emails from code (set "Allow less secure apps" to ON)
                //https://myaccount.google.com/lesssecureapps?pli=1

                //string emailfrom = "anupeng.india@gmail.com";
                //string emailpassword = "sharp_anup2";
                string emailfrom = "";
                string emailpassword = "";

                if (ConnectionWithAccess.company_details[11].Contains("["))
                {
                    emailfrom = ConnectionWithAccess.company_details[11].Substring(0, ConnectionWithAccess.company_details[11].IndexOf("["));
                    emailpassword = ConnectionWithAccess.company_details[11].Substring(ConnectionWithAccess.company_details[11].IndexOf("[") + 1, ConnectionWithAccess.company_details[11].IndexOf("]") - ConnectionWithAccess.company_details[11].IndexOf("[") - 1);
                    emailfrom = emailfrom.Trim();
                }
                else
                {
                    emailfrom = ConnectionWithAccess.company_details[11];
                }
                if (emailfrom.Contains("@yahoo."))
                    SendEmailFromYahoo(emailfrom, emailpassword, emailmessage, subject, toemail_id, attach_filename);
                else
                {
                    //string emailsubject = "Sale Invoice Details";
                    MailMessage messagedata = new MailMessage();
                    messagedata.From = new MailAddress(emailfrom);
                    messagedata.Subject = subject;

                    //messagedata.ReplyTo = new MailAddress(emailfrom);
                    //emailmessage = "M/s " + " is sent to you. Invoice Number is" + ConnectionWithAccess.md_n;
                    emailmessage = "Please Find the folling Attachment(s):";
                    messagedata.Body = emailmessage;
                    messagedata.IsBodyHtml = true;
                    emailto = toemail_id.Trim().ToString();
                    messagedata.To.Add(emailto);
                    SmtpClient smtp = new SmtpClient();
                    try
                    {
                        //Your SMTP Server
                        smtp.Host = "smtp.gmail.com";
                        smtp.Timeout = int.MaxValue;
                        //SSL Settings depending on your Server
                        smtp.EnableSsl = true;

                        //Creadentials for the Server
                        NetworkCredential NetworkCred = new System.Net.NetworkCredential();

                        //Your Email
                        NetworkCred.UserName = emailfrom;

                        //Your Password
                        NetworkCred.Password = emailpassword;

                        smtp.UseDefaultCredentials = true;

                        smtp.Credentials = NetworkCred;

                        System.Net.Mail.Attachment attachment;
                        attachment = new System.Net.Mail.Attachment(attach_filename);
                        messagedata.Attachments.Add(attachment);

                        //Port No of the Server 
                        smtp.Port = 587;
                        smtp.Send(messagedata);
                        MessageBox.Show("Email Sent");
                        //return true;
                    }
                    catch (Exception ex)
                    {
                        MessageBox.Show("Error sending email. Email not sent.");
                        //MessageBox.Show(ex.Message);
                        //return false;
                    }
                }
                objPleaseWait.Close();
            }
        }

        private void pdfsyntexfile()
        {
            //string pdfFile = Server.MapPath(".") + "/Files/TestPDFfile.pdf";
            //string imageFile = Server.MapPath(".") + "/Files/TestImage.jpg";
            //string currentpath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop) + "pdfcode.pdf";
            //FileStream FS = File.Create(currentpath);
            //Document doc = new Document();

            Document doc = new Document(PageSize.A4, 40, 45, 40, 25);
            FileStream FS = File.Create(ConnectionWithAccess.mpdffile);
            writer = PdfWriter.GetInstance(doc, FS);
            //PdfWriter.GetInstance(doc, FS);
            doc.Open();
            //iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(ConnectionWithAccess.mpdffile);

            iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance("F:\\visual studio\\images\\ANUP ENGINEERING LETTER PAD.jpg");

            pdfimage.ScaleToFit(600f, 800f);
            pdfimage.SpacingBefore = 10f;
            pdfimage.SpacingAfter = 10f;
            pdfimage.Alignment = Element.ALIGN_CENTER;
            pdfimage.SetAbsolutePosition(20, 20);
            doc.Add(pdfimage);
            //iTextSharp.text.Paragraph pdfparagraph = iTextSharp.text.Paragraph.GetInstance();
            //iTextSharp.text.Phrase pdfParagraph= (Paragraph)iTextSharp.text.Paragraph.GetInstance("hello");
            //pdfParagraph.SpacingBefore = 30;
            Paragraph para = new Paragraph("");
            //Paragraph para = new Paragraph("Hi I am Sanjay");
            //para.SpacingBefore = 100;
            //doc.Add(para);

            //para = new Paragraph("Hi This is second Line");
            //para.SpacingBefore = 150;
            //doc.Add(para);

            //para = new Paragraph("Hi This is Third Line");
            //para.SpacingBefore = 175;
            //doc.Add(para);
            int rowindex = 0;
            for (int i = 0; i < 200; i++)
            {
                para = new Paragraph(Convert.ToString((rowindex * rowindex)));
                para.IndentationLeft = (rowindex * rowindex);
                para.SpacingBefore = rowindex;
                //para.SpacingAfter = rowindex;
                doc.Add(para);
                //para.Alignment = Element.ALIGN_JUSTIFIED;
                //para.SetLeading(0.0f, 2.0f);
                rowindex = rowindex + 2;
            }
            //doc.AddTitle("Hello World example");
            //doc.AddSubject("This is an Example 4 of Chapter 1 of Book 'iText in Action'");
            //doc.AddKeywords("Metadata, iTextSharp 5.4.4, Chapter 1, Tutorial");
            //doc.AddCreator("iTextSharp 5.4.4");
            //doc.AddAuthor("Debopam Pal");
            //doc.AddHeader("Nothing", "No Header");
            //doc.Add(para);
            //doc.NewPage();
            //doc.Add(new Paragraph(string.Format("This is a page {0}", i)));4
            //doc.Add(new Paragraph("File created in " + ConnectionWithAccess.mpdffile));

            doc.Close();
            //PdfWriter writer = PdfWriter.GetInstance(doc, new FileStream(ConnectionWithAccess.mpdffile, FileMode.Create);
            //doc.Open();
            //Paragraph para = new Paragraph("Let's write some text before inserting image.");
            //iTextSharp.text.Image pdfImage = iTextSharp.text.Image.GetInstance("F:\\visual studio\\images\\plus sign.jpg");
            //pdfImage.ScaleToFit(300f, 250f);
            //pdfImage.SpacingBefore = 50f;
            //pdfImage.SpacingAfter = 10f;
            //pdfImage.Alignment = Element.ALIGN_CENTER;
            //Doc.Add(para);
            //Doc.Add(pdfImage);
        }

        # region printing

        private void print_sale_invoice()
        {
            if (periodofgst)
            {
                if (Convert.ToDateTime(sidatetime.Text) <= Convert.ToDateTime("30/06/2017"))
                    sale_invoice_number_three();
                else
                {
                    if (ConnectionWithAccess.company_details[31] == "0")
                        sale_invoice_number_one();
                    else if (ConnectionWithAccess.company_details[31] == "1")
                        sale_invoice_number_two();
                    else if (ConnectionWithAccess.company_details[31] == "2")
                        sale_invoice_number_three();
                    else if (ConnectionWithAccess.company_details[31] == "3")
                        sale_invoice_with_top_free();
                    else if (ConnectionWithAccess.company_details[31] == "4")
                        sale_invoice_gst_letterpad();
                    else if (ConnectionWithAccess.company_details[31] == "5")
                        sale_invoice_gst_with_contant_and_top_address();
                    else if (ConnectionWithAccess.company_details[31] == "6")
                        sale_invoice_gst_with_contant_and_bottom_address();
                }
            }
            else
            {
                if (ConnectionWithAccess.company_details[31] == "0")
                    sale_invoice_number_one();
                else if (ConnectionWithAccess.company_details[31] == "1")
                    sale_invoice_number_two();
                else if (ConnectionWithAccess.company_details[31] == "2")
                    sale_invoice_number_three();
                else
                    sale_invoice_number_three();
            }
            report_filename = msalepdf;
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[21] + " set print ='Y' where d_n  " + (sidocno.Text.Trim() == string.Empty ? "is null" : "= " + sidocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + sidbc.Text;
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void PictureBox49_Click(object sender, EventArgs e)
        {
            cb_all_sale_item_list.Visible = false;
            cb_all_sale_invoice_list.Visible = false;
            cb_all_sale_invoice_ledger.Visible = false;
            if (ConnectionWithAccess.company_details[31] == "1")
                sale_invoice_number_one();
            else if (ConnectionWithAccess.company_details[31] == "2")
                sale_invoice_number_two();
            else if (ConnectionWithAccess.company_details[31] == "3")
                //sale_invoice_number_three_print();
                sale_invoice_number_three();
            report_filename = msalepdf;
        }

        private void sale_invoice_number_one()
        {
            //pdf_invoice.Location = new Point(20, 144);
            get_account_details_from_01(sia_n.Text, sis_a.Text);
            get_account_details_from_04(sia_n.Text, sis_a.Text);
            msalepdf = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\saleinvoice_" + sidocno.Text;
            if (chb_add_datetime_in_output.Checked)
                msalepdf += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            msalepdf += ".pdf";
            doc1 = new Document(PageSize.A4, 40, 45, 40, 25);
            FileStream FS1 = File.Create(msalepdf);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            invoice_jpg_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\" + "INVOICE.jpg";
            //iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance("F:\\visual studio\\images\\ANUP ENGINEERING LETTER PAD.jpg");
            if (File.Exists(invoice_jpg_filename))
            {
                iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(invoice_jpg_filename);
                pdfimage.ScaleToFit(600f, 800f);
                pdfimage.SpacingBefore = 10f;
                pdfimage.SpacingAfter = 10f;
                pdfimage.Alignment = Element.ALIGN_CENTER;
                pdfimage.SetAbsolutePosition(20, 20);
                doc1.Add(pdfimage);
            }
            Paragraph para = new Paragraph("");
            para.Font.Size = 25;
            temp_word = "Subject to Ulhasnagar Jurisdiction";
            print_pdf_line(cour_11_red, temp_word, 180, 135);
            temp_word = "Tax Invoice";
            print_pdf_line(cour_11, temp_word, 240, -5);
            temp_word = "Buyer's Name & Address";
            print_pdf_line(cour_11, temp_word, 30, 0);
            temp_word = "Invoice No.";
            print_pdf_line(cour_11, temp_word, 300, -18);
            temp_word = "Date";
            print_pdf_line(cour_11, temp_word, 440, -18);
            temp_word = sidocno.Text;
            print_pdf_line(cour_11, temp_word, 320, -2);
            temp_word = sidatetime.Text;
            print_pdf_line(cour_11, temp_word, 430, -16);
            temp_word = account_detail_from_01[4];
            print_pdf_line(cour_11, temp_word, 30, 0);
            temp_word = account_detail_from_04[4];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = account_detail_from_04[5];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = account_detail_from_01[8] + "-" + account_detail_from_01[10];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = account_detail_from_01[12];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = DispEmail.Text;
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "Buyer's";
            print_pdf_line(cour_11, temp_word, 30, 0);
            temp_word = "Tin";
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = account_detail_from_04[29];
            if (temp_word != null && temp_word != "")
            {
                print_pdf_line(cour_11, temp_word, 100, -18);
            }
            temp_word = "-----------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "Sr.                      Particular's                              Pac          Quantity         Rate        Amount";
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "-----------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            si_invoice_basic_amount = 0;
            sale_invoice_amount = 0;
            mpacking = 0;
            for (int i = 0; i < siitemlist.Rows.Count - 1; i++)
            {
                temp_word = Convert.ToString(i + 1);
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(-45, temp_word, "cour_11"), 0);
                temp_word = siitemlist.Rows[i].Cells[2].Value.ToString();
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(70, temp_word, "cour_11"), -16);
                temp_word = siitemlist.Rows[i].Cells[4].Value.ToString();
                mpacking += Convert.ToInt16(siitemlist.Rows[i].Cells[3].Value.ToString());
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(210, temp_word, "cour_11"), -16);
                temp_word = siitemlist.Rows[i].Cells[5].Value.ToString();
                if (temp_word.Contains(".00"))
                    temp_word = temp_word.Substring(0, temp_word.Length - 3);
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(280, temp_word, "cour_11"), -16);
                temp_word = siitemlist.Rows[i].Cells[6].Value.ToString();
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(350, temp_word, "cour_11"), -16);
                temp_word = siitemlist.Rows[i].Cells[7].Value.ToString();
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(425, temp_word, "cour_11"), -16);
                if (siitemlist.Rows[i].Cells[7].Value != System.DBNull.Value)
                    si_invoice_basic_amount = si_invoice_basic_amount + Convert.ToDouble(siitemlist.Rows[i].Cells[7].Value);
            }
            si_invoice_tax_amount = Convert.ToDouble(sitaxamt.Text);
            si_invoice_gross_amount = (si_invoice_basic_amount + si_invoice_tax_amount);
            temp_word = "------------";
            print_pdf_line(cour_11, temp_word, 455, 0);
            temp_word = "Total";
            print_pdf_line(cour_11, temp_word, 390, -5);
            temp_word = Convert.ToString(si_invoice_basic_amount);
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(425, temp_word, "cour_11"), -18);
            temp_word = "------------";
            print_pdf_line(cour_11, temp_word, 455, -10);
            temp_word = NumberToWords(mpacking) + " Packing Only";
            temp_word = temp_word.Replace("AND", "");
            if (siitemlist.Rows.Count > 2)
            {
                print_pdf_line(cour_11, temp_word, 30, (175 - ((siitemlist.Rows.Count - 2) * 16)));
            }
            else
                print_pdf_line(cour_11, temp_word, 30, 175);
            temp_word = sitaxdesc.Text;
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(240, temp_word, "cour_11"), 0);
            temp_word = sitaxamt.Text;
            if (!temp_word.Contains("."))
                temp_word = temp_word + ".00";
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(425, temp_word, "cour_11"), -18);
            temp_word = "Note # Cheque Fail Charges Rs. 350/- or 2%";
            print_pdf_line(cour_9, temp_word, 30, 0);
            temp_word = "---          --------                 ------------";
            print_pdf_line(cour_11, temp_word, 324, -18);
            temp_word = "of Bill Amount Which ever is Higher";
            print_pdf_line(cour_9, temp_word, 45, -5);
            temp_word = "Total";
            print_pdf_line(cour_11, temp_word, 270, -16);
            temp_word = Convert.ToString(si_invoice_gross_amount);
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(425, temp_word, "cour_11"), -18);
            temp_word = "---          --------                 ------------";
            print_pdf_line(cour_11, temp_word, 324, -5);
            temp_word = "L.B.T. Num : " + ConnectionWithAccess.company_details[19];
            print_pdf_line(cour_9_red, temp_word, 30, -5);
            temp_word = "-----------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "Rupees : " + (NumberToWords(Convert.ToInt32(si_invoice_gross_amount))) + " Only";
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "-----------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "V.A.T. TIN : " + ConnectionWithAccess.company_details[18];
            print_pdf_line(cour_9_red, temp_word, 30, -9);
            temp_word = "For " + ConnectionWithAccess.company_details[1];
            print_pdf_line(cour_9, temp_word, 500 - (temp_word.Length * 52 / 10), -18);
            temp_word = "C.S.T. TIN : " + ConnectionWithAccess.company_details[27];
            print_pdf_line(cour_9_red, temp_word, 30, -5);
            temp_word = "Added Tax Act 2002 is  in force on the date on  which the sale of  the goods specified in ";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "this Tax  Invoice is made  by us/me  & that the  transaction of  sales covered by this Tax ";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "Invoice has been effected by me/us and it shall be accounted for in the turnover of Sales ";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "while filing of return and the due tax, if any payable on the sale has been paid or shall be ";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "Prop.";
            print_pdf_line(cour_9, temp_word, 480, -18);
            temp_word = "paid.";
            print_pdf_line(cour_9, temp_word, 30, -5);
            if (ConnectionWithAccess.company_details[30].Length > 6)
                temp_word += "Bank Details : " + ConnectionWithAccess.company_details[30];
            if (ConnectionWithAccess.company_details[21].Length > 6)
                temp_word += " A/c. : " + ConnectionWithAccess.company_details[21];
            if (ConnectionWithAccess.company_details[29].Length > 6)
                temp_word += " Ifc Code : " + ConnectionWithAccess.company_details[29];
            print_pdf_line(cour_9, temp_word, 30, -5);
            doc1.Close();
            pdf_invoice.BringToFront();
            pdf_invoice.Visible = true;
            //sisalelistdg.Visible = false;
            //pbdataentry.Visible = false;
            //pdf_invoice.Size = new System.Drawing.Size(1200, 381);
            pdf_invoice.LoadFile(msalepdf);
        }

        private void sale_invoice_number_two()
        {
            //pdf_invoice.Location = new Point(20, 144);
            if (cb_print_Tpt_copy.Checked == true || cb_print_chit_copy.Checked == true)
            {
                get_account_details_from_01(sia_n.Text, sis_a.Text);
                get_account_details_from_04(sia_n.Text, sis_a.Text);
                msalepdf = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\" + ConnectionWithAccess.mNIK + "_si_" + ConnectionWithAccess.mprd + "_" + sidbc.Text + "_" + sidocno.Text + ".pdf";
                doc1 = new Document(PageSize.A4, 0, 0, 0, 0);
                FileStream FS1 = File.Create(msalepdf);
                writer = PdfWriter.GetInstance(doc1, FS1);
                doc1.Open();
                current_pdf_page_number = 1;
                Paragraph para = new Paragraph("");
                if (cb_print_Tpt_copy.Checked == true)
                    sale_invoice_two_transport_copy();
                if (cb_print_chit_copy.Checked == true)
                    sale_invoice_two_chit_copy();
                doc1.Close();
                pdf_invoice.BringToFront();
                pdf_invoice.Visible = true;
                pdf_invoice.LoadFile(msalepdf);
            }
        }

        private void sale_invoice_two_transport_copy()
        {
            get_account_details_from_01(sia_n.Text, "@@@");
            get_account_details_from_04(sia_n.Text, "@@@");
            string consigner_name, consigner_add1, consigner_add2, consigner_city;
            consigner_name = account_detail_from_01[4];
            consigner_add1 = account_detail_from_04[4];
            consigner_add2 = account_detail_from_04[5];
            consigner_city = account_detail_from_01[8] + "-" + account_detail_from_01[10];
            if (sid_y.Text == "@@@")
            {
                get_account_details_from_01(sia_n.Text, sis_a.Text);
                get_account_details_from_04(sia_n.Text, sis_a.Text);
                print_pdf_line(cour_11_red, temp_word, 200, 10);
            }
            else
            {
                get_account_details_with_d_y_from_01(sia_n.Text, sis_a.Text, sid_y.Text);
                get_account_details_with_d_y_from_04(sia_n.Text, sis_a.Text, sid_y.Text);
                print_pdf_line(cour_11_red, temp_word, 200, 10);
            }
            PdfContentByte cb = writer.DirectContent;
            cb.MoveTo(200, 760);
            cb.LineTo(200, 820);
            cb.LineTo(400, 820);
            cb.LineTo(400, 760);
            cb.Stroke();
            cb.MoveTo(30, 760);
            cb.LineTo(550, 760);
            cb.Stroke();
            cb.MoveTo(30, 740);
            cb.LineTo(550, 740);
            cb.Stroke();
            cb.MoveTo(30, 550);
            cb.LineTo(550, 550);
            cb.Stroke();
            cb.MoveTo(30, 530);
            cb.LineTo(550, 530);
            cb.Stroke();
            temp_word = "Subject to Ulhasnagar Jurisdiction";
            print_pdf_line(cour_9, temp_word, 220, -16);
            print_pdf_line(cour_9, consigner_name, 30, 0);
            temp_word = account_detail_from_01[4];
            print_pdf_line(cour_9, temp_word, 202, -16);
            temp_word = "Invoice : " + sidocno.Text;
            print_pdf_line(cour_9, temp_word, 420, -16);
            temp_word = ConnectionWithAccess.company_details[2];
            print_pdf_line(cour_9, consigner_add1, 30, -5);
            temp_word = account_detail_from_04[4].Trim();
            print_pdf_line(cour_9, temp_word, 202, -16);
            temp_word = "Date : " + sidatetime.Text;
            print_pdf_line(cour_9, temp_word, 420, -16);
            temp_word = ConnectionWithAccess.company_details[3];
            print_pdf_line(cour_9, consigner_add2, 30, -5);
            temp_word = account_detail_from_04[5].Trim();
            print_pdf_line(cour_9, temp_word, 202, -16);
            temp_word = ConnectionWithAccess.company_details[5];
            print_pdf_line(cour_9, consigner_city, 30, -5);
            temp_word = account_detail_from_01[8] + "-" + account_detail_from_01[10];
            print_pdf_line(cour_9, temp_word, 202, -16);
            if (sid_y.Text != "@@@")
            {
                get_account_details_from_01(sia_n.Text, sis_a.Text);
                print_pdf_line(cour_9, "By:" + sis_a.Text + "," + account_detail_from_01[8].Trim(), 405, 0);
                get_account_details_with_d_y_from_01(sia_n.Text, sis_a.Text, sid_y.Text);
                get_account_details_with_d_y_from_04(sia_n.Text, sis_a.Text, sid_y.Text);
                print_pdf_line(cour_11, "", 10, -7);
            }
            else
                print_pdf_line(cour_11, "", 10, 10);
            temp_word = "Sr.                      Particular's                                   Case      Box.          Qty            Rate          Amount";
            print_pdf_line(cour_11, temp_word, 50, -10);
            si_invoice_basic_amount = 0;
            sale_invoice_amount = 0;
            mpacking = 0;
            print_pdf_line(cour_11, "", 10, -10);
            for (int i = 0; i < siitemlist.Rows.Count - 1; i++)
            {
                mpacking += Convert.ToInt16(siitemlist.Rows[i].Cells[3].Value.ToString());
                temp_word = Convert.ToString(i + 1);
                print_pdf_line(cour_11, temp_word, 45, 0);
                temp_word = siitemlist.Rows[i].Cells[2].Value.ToString();
                print_pdf_line(cour_11, temp_word, 75, -16);
                temp_word = siitemlist.Rows[i].Cells[3].Value.ToString();
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(230, temp_word, "cour_11"), -16);
                temp_word = siitemlist.Rows[i].Cells[4].Value.ToString();
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(270, temp_word, "cour_11"), -16);
                temp_word = siitemlist.Rows[i].Cells[5].Value.ToString();
                temp_word = string.Format("{0:0.00}", Convert.ToDouble(temp_word));
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(320, temp_word, "cour_11"), -16);
                temp_word = siitemlist.Rows[i].Cells[6].Value.ToString();
                temp_word = string.Format("{0:0.00}", Convert.ToDouble(temp_word));
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(380, temp_word, "cour_11"), -16);
                if (siitemlist.Rows[i].Cells[7].Value != System.DBNull.Value)
                {
                    temp_word = siitemlist.Rows[i].Cells[7].Value.ToString();
                    temp_word = string.Format("{0:0.00}", Convert.ToDouble(temp_word));
                    print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(460, temp_word, "cour_11"), -16);
                    si_invoice_basic_amount = si_invoice_basic_amount + Convert.ToDouble(siitemlist.Rows[i].Cells[7].Value);
                }
            }
            temp_word = NumberToWords(mpacking) + " Packing Only";
            temp_word = temp_word.Replace("AND", "");
            if (siitemlist.Rows.Count > 2)
            {
                print_pdf_line(cour_11, temp_word, 50, (100 - ((siitemlist.Rows.Count - 2) * 16)));
            }
            else
                print_pdf_line(cour_11, temp_word, 50, 100);
            temp_word = "Transport : " + account_detail_from_04[30];
            print_pdf_line(cour_11, temp_word, 50, 0);
            temp_word = sitaxdesc.Text;
            print_pdf_line(cour_11, temp_word, 50, 0);
            temp_word = "Total";
            print_pdf_line(cour_11, temp_word, 250, 0);
            temp_word = Convert.ToString(mpacking);
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(230, temp_word, "cour_11"), -16);
            temp_word = Convert.ToString(si_invoice_basic_amount);
            temp_word = string.Format("{0:0.00}", Convert.ToDouble(temp_word));
            print_pdf_line(cour_11, temp_word, 490, -16);
            temp_word = "Rupees : " + (NumberToWords(Convert.ToInt32(si_invoice_basic_amount))) + " Only";
            print_pdf_line(cour_11, temp_word, 50, 10);
            temp_word = "For " + consigner_name;
            print_pdf_line(cour_11, temp_word, 520 - (temp_word.Length * 52 / 10), 0);
            temp_word = "Goods once sold will not be taken back ";
            print_pdf_line(cour_11, temp_word, 50, -16);
            temp_word = "This bill is good for Payment ";
            print_pdf_line(cour_11, temp_word, 50, -5);
            temp_word = "on time Demanded by us. ";
            print_pdf_line(cour_11, temp_word, 50, -5);
            temp_word = "Prop.";
            print_pdf_line(cour_11, temp_word, 500, 10);
        }

        private void sale_invoice_two_chit_copy()
        {
            int second_chit_left_margin;

            second_chit_left_margin = 290;
            print_pdf_line(cour_9, " ", 30, 25);
            temp_word = "Invoice : " + sidocno.Text;
            print_pdf_line(cour_9, temp_word, 30, 5);
            print_pdf_line(cour_9, temp_word, second_chit_left_margin + 30, -16);
            temp_word = "Date : " + sidatetime.Text;
            print_pdf_line(cour_9, temp_word, 182, -16);
            print_pdf_line(cour_9, temp_word, second_chit_left_margin + 182, -16);
            temp_word = account_detail_from_01[4];
            print_pdf_line(cour_9, temp_word, 30, 0);
            print_pdf_line(cour_9, temp_word, second_chit_left_margin + 30, -16);
            temp_word = account_detail_from_04[4];
            print_pdf_line(cour_9, temp_word, 30, -5);
            print_pdf_line(cour_9, temp_word, second_chit_left_margin + 30, -16);
            temp_word = account_detail_from_04[5];
            print_pdf_line(cour_9, temp_word, 30, -5);
            print_pdf_line(cour_9, temp_word, second_chit_left_margin + 30, -16);
            temp_word = account_detail_from_01[8] + "-" + account_detail_from_01[10];
            print_pdf_line(cour_9, temp_word, 30, -5);
            print_pdf_line(cour_9, temp_word, second_chit_left_margin + 30, -16);
            if (sid_y.Text != "@@@")
            {
                get_account_details_from_01(sia_n.Text, sis_a.Text);
                temp_word = "By:" + sis_a.Text + "," + account_detail_from_01[8].Trim();
                print_pdf_line(cour_9, temp_word, 105, 0);
                print_pdf_line(cour_9, temp_word, second_chit_left_margin + 105, -16);
                get_account_details_with_d_y_from_01(sia_n.Text, sis_a.Text, sid_y.Text);
                get_account_details_with_d_y_from_04(sia_n.Text, sis_a.Text, sid_y.Text);
            }
            //temp_word = account_detail_from_01[12];
            //if (temp_word != null && temp_word != "")
            //{
            //    print_pdf_line(cour_11, temp_word, 100, -16);
            //    print_pdf_line(cour_11, temp_word, second_chit_left_margin + 100, -16);
            //}
            temp_word = "------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            print_pdf_line(cour_11, temp_word, second_chit_left_margin + 30, -16);
            temp_word = "Particular's                           Case      Qty    Rate    Amount";
            print_pdf_line(cour_9, temp_word, 42, -5);
            print_pdf_line(cour_9, temp_word, second_chit_left_margin + 42, -16);
            temp_word = "------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            print_pdf_line(cour_11, temp_word, second_chit_left_margin + 30, -16);
            print_pdf_line(cour_11, " ", 0, -10);
            si_invoice_basic_amount = 0;
            sale_invoice_amount = 0;
            mpacking = 0;
            for (int i = 0; i < siitemlist.Rows.Count - 1; i++)
            {
                mpacking += Convert.ToInt16(siitemlist.Rows[i].Cells[3].Value.ToString());
                temp_word = siitemlist.Rows[i].Cells[2].Value.ToString();
                print_pdf_line(cour_7, temp_word, 30, 0);
                print_pdf_line(cour_7, temp_word, second_chit_left_margin + 30, -16);
                temp_word = siitemlist.Rows[i].Cells[3].Value.ToString();
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(110, temp_word, "cour_9"), -16);
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(second_chit_left_margin + 110, temp_word, "cour_9"), -16);
                temp_word = siitemlist.Rows[i].Cells[5].Value.ToString();
                temp_word = string.Format("{0:0.00}", Convert.ToDouble(temp_word));
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(130, temp_word, "cour_9"), -16);
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(second_chit_left_margin + 130, temp_word, "cour_9"), -16);
                temp_word = siitemlist.Rows[i].Cells[6].Value.ToString();
                temp_word = string.Format("{0:0.00}", Convert.ToDouble(temp_word));
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(175, temp_word, "cour_9"), -16);
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(second_chit_left_margin + 175, temp_word, "cour_9"), -16);
                temp_word = siitemlist.Rows[i].Cells[7].Value.ToString();
                temp_word = string.Format("{0:0.00}", Convert.ToDouble(temp_word));
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(220, temp_word, "cour_9"), -16);
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(second_chit_left_margin + 220, temp_word, "cour_9"), -16);
                //print_pdf_line(cour_9, temp_word, second_chit_left_margin + 240, -16);
                if (siitemlist.Rows[i].Cells[7].Value != System.DBNull.Value)
                    si_invoice_basic_amount = si_invoice_basic_amount + Convert.ToDouble(siitemlist.Rows[i].Cells[7].Value);
            }
            print_pdf_line(cour_11, "Lr. No. _______  Date ___________", 30, 10);
            temp_word = NumberToWords(mpacking) + " Packing Only";
            temp_word = temp_word.Replace("AND", "");
            if (siitemlist.Rows.Count > 2)
            {
                print_pdf_line(cour_11, temp_word, 30, (100 - ((siitemlist.Rows.Count - 2) * 16)));
                print_pdf_line(cour_11, temp_word, second_chit_left_margin + 30, -16);
            }
            else
            {
                print_pdf_line(cour_11, temp_word, 30, 100);
                print_pdf_line(cour_11, temp_word, second_chit_left_margin + 30, -16);
            }
            temp_word = "Transport : " + account_detail_from_04[30];
            print_pdf_line(cour_11, temp_word, 30, 0);
            print_pdf_line(cour_11, temp_word, second_chit_left_margin + 30, -16);
            temp_word = sitaxdesc.Text;
            print_pdf_line(cour_11, temp_word, 30, 0);
            print_pdf_line(cour_11, temp_word, second_chit_left_margin + 30, -16);
            temp_word = "---          --------                 ------------";
            print_pdf_line(cour_11, temp_word, 130, -16);
            print_pdf_line(cour_11, temp_word, second_chit_left_margin + 130, -16);
            temp_word = "Total";
            print_pdf_line(cour_11, temp_word, 100, -8);
            print_pdf_line(cour_11, temp_word, second_chit_left_margin + 100, -16);
            temp_word = Convert.ToString(si_invoice_basic_amount);
            temp_word = string.Format("{0:0.00}", Convert.ToDouble(temp_word));
            print_pdf_line(cour_11, temp_word, 255, -16);
            print_pdf_line(cour_11, temp_word, second_chit_left_margin + 255, -16);
            temp_word = "---          --------                 ------------";
            print_pdf_line(cour_11, temp_word, 130, -8);
            print_pdf_line(cour_11, temp_word, second_chit_left_margin + 130, -16);
            temp_word = "------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            print_pdf_line(cour_11, temp_word, second_chit_left_margin + 30, -16);
            temp_word = "Rupees : " + (NumberToWords(Convert.ToInt32(si_invoice_basic_amount))) + " Only";
            print_pdf_line(cour_7, temp_word, 30, -5);
            print_pdf_line(cour_7, temp_word, second_chit_left_margin + 30, -16);
            temp_word = "------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            print_pdf_line(cour_11, temp_word, second_chit_left_margin + 30, -16);
            print_pdf_line(cour_11, " ", 30, 25);
        }

        private void sale_invoice_number_three()
        {
            msalepdf = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\" + ConnectionWithAccess.mNIK + "_si_" + ConnectionWithAccess.mprd + "_" + sidbc.Text + "_" + sidocno.Text + ".pdf";
            doc1 = new Document(PageSize.A4, 10, 45, 40, 25);
            FileStream FS1 = File.Create(msalepdf);
            writer = PdfWriter.GetInstance(doc1, FS1);
            //PdfContentByte cb = writer.DirectContent;
            //cb.MoveTo(10, 100);
            //cb.LineTo(10, 200);
            //cb.Stroke();
            get_account_details_from_01(sia_n.Text, sis_a.Text);
            get_account_details_from_04(sia_n.Text, sis_a.Text);
            doc1.Open();
            current_pdf_page_number = 1;
            Paragraph para = new Paragraph("");
            para.Font.Size = 25;
            temp_word = " ";
            print_pdf_line(cour_11_red, temp_word, (Convert.ToInt32(ConnectionWithAccess.company_details[36]) + 240), 2);
            //print_pdf_line(cour_11_red, temp_word, 180, 0);
            temp_word = "Subject to ULHASNAGAR Jurisdiction";
            print_pdf_line(cour_11_red, temp_word, 180, 75);
            temp_word = "Tax - Invoice";
            print_pdf_line(arabic_14, temp_word, 240, 0);
            temp_word = "Buyer's Name & Address";
            print_pdf_line(cour_11, temp_word, 30, 0);
            temp_word = "Invoice No.";
            print_pdf_line(cour_11, temp_word, 300, -18);
            temp_word = "Date";
            print_pdf_line(cour_11, temp_word, 470, -18);
            temp_word = sidocno.Text;
            print_pdf_line(cour_11, temp_word, 320, -2);
            temp_word = sidatetime.Text;
            print_pdf_line(cour_11, temp_word, 460, -16);
            temp_word = account_detail_from_01[4];
            print_pdf_line(cour_11, temp_word, 30, 0);
            temp_word = account_detail_from_04[4];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = account_detail_from_04[5];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = account_detail_from_01[8] + "-" + account_detail_from_01[10];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "Transport : " + sitransport.Text;
            print_pdf_line(cour_11, temp_word, 300, -15);
            temp_word = account_detail_from_01[12];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = DispEmail.Text;
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "Buyer's";
            print_pdf_line(cour_11, temp_word, 30, 0);
            temp_word = "Tin : " + account_detail_from_04[29];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = account_detail_from_01[17] + " ," + account_detail_from_01[19];
            if (temp_word != null && temp_word != "")
            {
                print_pdf_line(cour_11, temp_word, 100, -18);
            }
            temp_word = "-------------------------------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "Sr.                          Particular's                                                 Pac        Quantity     Rate             Amount";
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "-------------------------------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            si_invoice_basic_amount = 0;
            sale_invoice_amount = 0;
            mpacking = 0;
            for (int i = 0; i < siitemlist.Rows.Count - 1; i++)
            {
                mpacking += Convert.ToInt16(siitemlist.Rows[i].Cells[3].Value.ToString());
                temp_word = Convert.ToString(i + 1);
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(-35, temp_word, "cour_11"), 0);
                temp_word = siitemlist.Rows[i].Cells[2].Value.ToString();
                print_pdf_line(cour_11, temp_word, 60, -16);
                if (siitemlist.Rows[i].Cells[3].Value.ToString() != "0" && siitemlist.Rows[i].Cells[3].Value.ToString() != null)
                {
                    temp_word = siitemlist.Rows[i].Cells[3].Value.ToString();
                    print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(260, temp_word, "cour_11"), -16);
                }
                temp_word = siitemlist.Rows[i].Cells[5].Value.ToString();
                temp_word = string.Format("{0:0.00}", Convert.ToDouble(temp_word));
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(310, temp_word, "cour_11"), -16);
                temp_word = add_comma_to_number(siitemlist.Rows[i].Cells[6].Value.ToString());
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(380, temp_word, "cour_11"), -16);
                temp_word = add_comma_to_number(siitemlist.Rows[i].Cells[7].Value.ToString());
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(455, temp_word, "cour_11"), -16);
                if (siitemlist.Rows[i].Cells[7].Value != System.DBNull.Value)
                    si_invoice_basic_amount = si_invoice_basic_amount + Convert.ToDouble(siitemlist.Rows[i].Cells[7].Value);
            }
            si_invoice_tax_amount = Convert.ToDouble(sitaxamt.Text);
            si_invoice_gross_amount = (si_invoice_basic_amount + si_invoice_tax_amount);
            temp_word = "------------";
            print_pdf_line(cour_11, temp_word, 485, 0);
            temp_word = "Total";
            print_pdf_line(cour_11, temp_word, 375, -5);
            //temp_word = Convert.ToString(si_invoice_basic_amount);
            temp_word = add_comma_to_number(si_invoice_basic_amount.ToString());
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(455, temp_word, "cour_11"), -18);
            temp_word = "------------";
            print_pdf_line(cour_11, temp_word, 485, -10);
            temp_word = NumberToWords(mpacking) + " Packing Only";
            temp_word = temp_word.Replace("AND", "");
            if (siitemlist.Rows.Count > 2)
                print_pdf_line(cour_11, temp_word, 30, (240 - ((siitemlist.Rows.Count - 2) * 16)));
            else
                print_pdf_line(cour_11, temp_word, 30, 240);
            temp_word = sitaxdesc.Text;
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(240, temp_word, "cour_11"), 0);
            //temp_word = sitaxamt.Text;
            temp_word = Convert.ToDouble(sitaxamt.Text).ToString("#,##,##,###0.00");
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(455, temp_word, "cour_11"), -18);
            temp_word = "Note # Cheque Fail Charges Rs. 350/- or 2%";
            print_pdf_line(cour_9, temp_word, 30, 0);
            temp_word = "----      ----                      -----------------";
            print_pdf_line(cour_11, temp_word, 340, -18);
            temp_word = "of Bill Amount Which ever is Higher";
            print_pdf_line(cour_9, temp_word, 75, -5);
            temp_word = "Total";
            print_pdf_line(cour_11, temp_word, 300, -16);
            temp_word = add_comma_to_number(si_invoice_gross_amount.ToString());
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(455, temp_word, "cour_11"), -18);
            temp_word = "----      ----                      -----------------";
            print_pdf_line(cour_11, temp_word, 342, -5);
            temp_word = "L.B.T. Num : " + ConnectionWithAccess.company_details[19];
            print_pdf_line(cour_9_red, temp_word, 30, -5);
            temp_word = "-------------------------------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "Rupees : " + (NumberToWords(Convert.ToInt32(si_invoice_gross_amount))) + " Only";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "-------------------------------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "V.A.T. TIN : " + ConnectionWithAccess.company_details[18];
            print_pdf_line(cour_9_red, temp_word, 30, -9);
            temp_word = "For " + ConnectionWithAccess.company_details[1];
            print_pdf_line(cour_9, temp_word, 530 - (temp_word.Length * 52 / 10), -18);
            temp_word = "C.S.T. TIN : " + ConnectionWithAccess.company_details[27];
            print_pdf_line(cour_9_red, temp_word, 30, -5);
            temp_word = "Added Tax Act 2002 is  in force on the date on  which the sale of  the goods specified in ";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "this Tax  Invoice is made  by us/me  & that the  transaction of  sales covered by this Tax ";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "Invoice has been effected by me/us and it shall be accounted for in the turnover of Sales ";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "while filing of return and the due tax, if any payable on the sale has been paid or shall be ";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "Prop.";
            print_pdf_line(cour_9, temp_word, 510, -18);
            temp_word = "paid.";
            print_pdf_line(cour_9, temp_word, 30, -5);
            if (ConnectionWithAccess.company_details[30].Length > 6)
                temp_word += "Bank Details : " + ConnectionWithAccess.company_details[30];
            if (ConnectionWithAccess.company_details[21].Length > 6)
                temp_word += " A/c. : " + ConnectionWithAccess.company_details[21];
            if (ConnectionWithAccess.company_details[29].Length > 6)
                temp_word += " Ifc Code : " + ConnectionWithAccess.company_details[29];
            print_pdf_line(cour_9, temp_word, 30, -5);
            doc1.Close();
            pdf_invoice.BringToFront();
            pdf_invoice.Visible = true;
            pdf_invoice.LoadFile(msalepdf);
        }

        private void sale_invoice_with_top_free()
        {
            //read_company_text_file();
            msalepdf = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\" + ConnectionWithAccess.mNIK + "_si_" + ConnectionWithAccess.mprd + "_" + sidbc.Text + "_" + sidocno.Text + ".pdf";
            doc1 = new Document(PageSize.A4, 15, 10, 10, 20);
            FileStream FS1 = File.Create(msalepdf);
            writer = PdfWriter.GetInstance(doc1, FS1);
            get_account_details_from_01(sia_n.Text, sis_a.Text);
            get_account_details_from_04(sia_n.Text, sis_a.Text);
            doc1.Open();
            current_pdf_page_number = 1;
            //if (ckbx_Igst.Checked)
            if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "gst invoice interstate.jpg";
            else
                invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "gst invoice state.jpg";
            if (File.Exists(invoice_jpg_filename))
            {
                iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(invoice_jpg_filename);
                pdfimage.ScaleToFit(560f, 700f);
                pdfimage.Alignment = Element.ALIGN_CENTER;
                //pdfimage.SetAbsolutePosition(15, 40);
                pdfimage.SetAbsolutePosition(15, 40 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                doc1.Add(pdfimage);
            }
            invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "sharp accounting logo.jpg";
            if (File.Exists(invoice_jpg_filename))
            {
                iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(invoice_jpg_filename);
                pdfimage.ScaleToFit(21, 21);
                pdfimage.Alignment = Element.ALIGN_CENTER;
                //pdfimage.SetAbsolutePosition(21, 50);
                pdfimage.SetAbsolutePosition(21, 50 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                doc1.Add(pdfimage);
            }
            invoice_jpg_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\" + "invoice_top.jpg";
            if (File.Exists(invoice_jpg_filename))
            {
                iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(invoice_jpg_filename);
                pdfimage.ScaleToFit(700f, 140f);
                pdfimage.Alignment = Element.ALIGN_CENTER;
                //pdfimage.SetAbsolutePosition(21, 690);
                pdfimage.SetAbsolutePosition(21, 690 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                doc1.Add(pdfimage);
            }
            Paragraph para = new Paragraph("");
            para.Font.Size = 25;
            temp_word = " ";
            print_pdf_line(cour_11_red, temp_word, 0, (Convert.ToInt32(ConnectionWithAccess.company_details[36]) + 240));
            gst_invoice_common_matter();
        }
        private void add_boxes_for_gst_INVOICE_IN_SALE()
        {

        }

        private void gst_invoice_common_matter()
        {
            oldsaleinvoicedetails();
            sale_invoice_item_filling();

            if (ConnectionWithAccess.company_details[32].Trim().Length > 5)
                temp_word = "GST NUMBER # ";
            else
                temp_word = "";
            print_pdf_line(cour_11, temp_word, 10, 13);
            temp_word = ConnectionWithAccess.company_details[32];
            print_pdf_line(cour_11_bold, temp_word, 96, -16);
            temp_word = "Invoice Number # ";
            print_pdf_line(cour_11, temp_word, 290, -16);
            temp_word = sidocno.Text;
            print_pdf_line(cour_11_bold, temp_word, 384, -16);
            temp_word = "Invoice Date # ";
            print_pdf_line(cour_11, temp_word, 430, -16);
            temp_word = sidatetime.Value.Date.ToString("dd/MM/yyyy");
            print_pdf_line(cour_11_bold, temp_word, 504, -16);
            if (ConnectionWithAccess.company_details[11].Length > 5)
            {
                if (ConnectionWithAccess.company_details[11].Contains("["))
                {
                    temp_word = "Email Id # " + ConnectionWithAccess.company_details[11].Substring(0, ConnectionWithAccess.company_details[11].IndexOf("["));
                }
                else
                    temp_word = "Email Id # " + ConnectionWithAccess.company_details[11];
            }
            else
                temp_word = "";
            print_pdf_line(cour_9, temp_word, 10, -5);
            if (sitransport.Text.Trim().Length > 3)
                temp_word = "Transport # " + sitransport.Text;
            else
                temp_word = "";
            print_pdf_line(cour_9, temp_word, 290, -16);
            if (ConnectionWithAccess.company_details[13].Trim().Length > 6)
                temp_word = "Pan Card # " + ConnectionWithAccess.company_details[13];
            else
                temp_word = "";
            print_pdf_line(cour_9, temp_word, 10, -5);
            temp_word = "L.R. No ____________ Date __________________";
            print_pdf_line(cour_9, temp_word, 290, -16);
            if (ConnectionWithAccess.company_details[20].Trim().Length > 10)
                temp_word = "Aadhar Card # " + ConnectionWithAccess.company_details[20];
            else
                temp_word = "";
            print_pdf_line(cour_9, temp_word, 10, -5);
            if (account_detail_from_01[4].Trim().Length > 1)
                temp_word = account_detail_from_01[4];
            else
                temp_word = "";
            print_pdf_line(cour_9_bold, temp_word, 10, 24);
            if (account_detail_from_04[24].Trim().Length > 6)
                temp_word = "Email Id # " + account_detail_from_04[24];
            else
                temp_word = "";
            print_pdf_line(cour_9, temp_word, 290, -16);
            temp_word = account_detail_from_04[4];
            print_pdf_line(cour_9, temp_word, 10, -5);
            if (account_detail_from_04[25].Trim().Length > 5)
                temp_word = "Website # " + account_detail_from_04[25];
            else
                temp_word = "";
            print_pdf_line(cour_9, temp_word, 290, -16);
            temp_word = account_detail_from_04[5];
            print_pdf_line(cour_9, temp_word, 10, -5);
            if (account_detail_from_01[28].Trim().Length > 5)
                temp_word = "GST Number # " + account_detail_from_01[28];
            else
                temp_word = "";
            print_pdf_line(cour_9, temp_word, 290, -16);
            temp_word = account_detail_from_04[6];
            print_pdf_line(cour_9, temp_word, 10, -5);
            if (account_detail_from_04[29].Trim().Length > 5)
                temp_word = "Vat Tin # " + account_detail_from_04[29];
            else
                temp_word = "";
            print_pdf_line(cour_9, temp_word, 290, -16);
            temp_word = account_detail_from_04[7];
            if (account_detail_from_01[10].Trim().Length > 5)
                temp_word += "  Pincode - " + account_detail_from_01[10];
            print_pdf_line(cour_9, temp_word, 10, -5);
            if (account_detail_from_01[7].Trim().Length > 5)
                temp_word = "Pan Number # " + account_detail_from_01[7];
            else
                temp_word = "";
            print_pdf_line(cour_9, temp_word, 290, -16);
            if (account_detail_from_01[12].Trim().Length > 5)
                temp_word = "State - " + account_detail_from_01[12];
            else
                temp_word = "";
            print_pdf_line(cour_9, temp_word, 10, -5);
            if (access_line2 != null && access_line2.Length > 2)
                print_pdf_line(cour_15_bold, access_line2, 180, 13);
            else
                print_pdf_line(cour_15_bold, " ", 0, 13);
            print_pdf_line(cour_9, " ", 0, 0);
            si_invoice_basic_amount = 0;
            sale_invoice_amount = 0;
            si_cgst_total_tax_amount = 0;
            si_sgst_total_tax_amount = 0;
            si_igst_total_tax_amount = 0;
            si_invoice_basic_amount = 0;
            si_invoice_gross_amount = 0;
            si_gst_item_total_basic_amount = 0;
            si_gst_item_basic_amount = 0;
            mpacking = 0;
            //if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
            for (row_pointer = 0; row_pointer < siitemlist.Rows.Count - 1; row_pointer++)
            {
                if (siitemlist.Rows[row_pointer].Cells[3].Value != System.DBNull.Value && siitemlist.Rows[row_pointer].Cells[3].Value != null)
                {
                    temp_word = siitemlist.Rows[row_pointer].Cells[3].Value.ToString();
                    if (siitemlist.Rows[row_pointer].Cells[3].Value != System.DBNull.Value)
                    {
                        siitemlist.Rows[row_pointer].Cells[3].Value = siitemlist.Rows[row_pointer].Cells[3].Value.ToString().Replace(".00", "");
                        mpacking += Convert.ToInt16(siitemlist.Rows[row_pointer].Cells[3].Value.ToString());
                    }
                }
                temp_word = Convert.ToString(row_pointer + 1);
                if (siitemlist.Rows.Count > 11)
                    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(-63, temp_word, "cour_7"), -5);
                else
                    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(-63, temp_word, "cour_7"), 0);
                temp_word = siitemlist.Rows[row_pointer].Cells[2].Value.ToString();
                print_pdf_line(cour_9, temp_word, 33, -16);
                temp_word = siitemlist.Rows[row_pointer].Cells[10].Value.ToString();
                print_pdf_line(cour_7, temp_word, 211, -16);
                temp_word = siitemlist.Rows[row_pointer].Cells[5].Value.ToString();
                if (temp_word.Contains(".00"))
                    temp_word = temp_word.Substring(0, temp_word.Length - 3);
                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(199, temp_word, "cour_7"), -16);
                temp_word = siitemlist.Rows[row_pointer].Cells[6].Value.ToString();
                if (temp_word.Contains("."))
                {
                    if (temp_word.Length - temp_word.IndexOf(".") > temp_word.IndexOf("."))
                        temp_word = temp_word.Substring(0, temp_word.IndexOf(".") + 3);
                }
                if (temp_word.Contains(".00"))
                    temp_word = temp_word.Substring(0, temp_word.Length - 3);
                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(257, temp_word, "cour_7"), -16);
                temp_word = siitemlist.Rows[row_pointer].Cells[8].Value.ToString();
                print_pdf_line(cour_7, temp_word, 280, -16);
                if (siitemlist.Rows[row_pointer].Cells[9].Value != null && !string.IsNullOrEmpty(siitemlist.Rows[row_pointer].Cells[9].Value.ToString()))
                    si_igst_tax_per = Convert.ToDouble(siitemlist.Rows[row_pointer].Cells[9].Value.ToString());
                else
                    si_igst_tax_per = 0.00;
                si_gst_item_basic_amount = Convert.ToDouble(siitemlist.Rows[row_pointer].Cells[5].Value.ToString()) * Convert.ToDouble(siitemlist.Rows[row_pointer].Cells[6].Value.ToString());
                si_cgst_tax_per = si_igst_tax_per / 2;
                si_sgst_tax_per = si_igst_tax_per / 2;
                si_cgst_tax_amount = si_gst_item_basic_amount * si_cgst_tax_per / 100;
                si_sgst_tax_amount = si_gst_item_basic_amount * si_sgst_tax_per / 100;
                si_igst_tax_amount = si_gst_item_basic_amount * si_igst_tax_per / 100;
                si_cgst_total_tax_amount += si_cgst_tax_amount;
                si_sgst_total_tax_amount += si_sgst_tax_amount;
                si_igst_total_tax_amount += si_igst_tax_amount;
                si_gst_item_total_basic_amount += si_gst_item_basic_amount;
                temp_word = add_comma_to_number(si_gst_item_basic_amount.ToString());
                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(303, temp_word, "cour_7"), -16);
                if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                {
                    temp_word = si_igst_tax_per.ToString() + "%";
                    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(325, temp_word, "cour_7"), -16);
                    temp_word = add_comma_to_number(si_igst_tax_amount.ToString());
                    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(386, temp_word, "cour_7"), -16);
                    temp_word = add_comma_to_number(Convert.ToString(si_gst_item_basic_amount + si_igst_tax_amount));
                    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(480, temp_word, "cour_7"), -16);
                }
                else
                {
                    temp_word = si_cgst_tax_per.ToString();
                    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(316, temp_word, "cour_7"), -16);
                    temp_word = si_cgst_tax_amount.ToString();
                    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(359, temp_word, "cour_7"), -16);
                    temp_word = si_sgst_tax_per.ToString();
                    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(374, temp_word, "cour_7"), -16);
                    temp_word = si_sgst_tax_amount.ToString();
                    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(420, temp_word, "cour_7"), -16);
                    temp_word = add_comma_to_number(Convert.ToString(si_gst_item_basic_amount + si_cgst_tax_amount + si_sgst_tax_amount));
                    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(480, temp_word, "cour_7"), -16);
                }
                si_invoice_basic_amount = si_invoice_basic_amount + Convert.ToDouble(siitemlist.Rows[row_pointer].Cells[7].Value);
                si_invoice_gross_amount += (si_gst_item_basic_amount + si_cgst_tax_amount + si_sgst_tax_amount);
            }

            temp_word = NumberToWords(mpacking) + " Packing Only";
            temp_word = temp_word.Replace("AND", "");
            if (siitemlist.Rows.Count > 2)
                print_pdf_line(cour_11, temp_word, 36, (145 - ((siitemlist.Rows.Count - 2) * 16)));
            else
                print_pdf_line(cour_11, temp_word, 36, 145);
            if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
            {
                temp_word = add_comma_to_number(si_gst_item_total_basic_amount.ToString());
                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(303, temp_word, "cour_7"), -16);
                temp_word = add_comma_to_number(si_igst_total_tax_amount.ToString());
                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(384, temp_word, "cour_7"), -16);
            }
            else
            {
                temp_word = add_comma_to_number(si_gst_item_total_basic_amount.ToString());
                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(303, temp_word, "cour_7"), -16);
                temp_word = si_cgst_total_tax_amount.ToString();
                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(359, temp_word, "cour_7"), -16);
                temp_word = si_sgst_total_tax_amount.ToString();
                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(420, temp_word, "cour_7"), -16);

            }
            temp_word = add_comma_to_number(Convert.ToString(si_invoice_gross_amount));
            print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(480, temp_word, "cour_7"), 18);
            si_invoice_gross_amount += Convert.ToDouble(si_frieght_amt.Text);
            si_invoice_gross_amount += Convert.ToDouble(si_packing_amt.Text);
            si_invoice_gross_amount += Convert.ToDouble(si_insurance_amt.Text);
            si_invoice_gross_amount += Convert.ToDouble(si_other_amt.Text);
            si_invoice_gross_amount += Convert.ToDouble(siroundoffamt.Text);
            temp_word = add_comma_to_number(si_frieght_amt.Text);
            print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(480, temp_word, "cour_7"), 0);
            temp_word = add_comma_to_number(si_packing_amt.Text);
            print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(480, temp_word, "cour_7"), 0);
            temp_word = add_comma_to_number(si_insurance_amt.Text);
            print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(480, temp_word, "cour_7"), 0);
            temp_word = add_comma_to_number(si_other_amt.Text);
            print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(480, temp_word, "cour_7"), 0);
            temp_word = add_comma_to_number(Convert.ToString(si_invoice_gross_amount));
            print_pdf_line(cour_7_bold, temp_word, para_IndentationLeft_position(480, temp_word, "cour_7"), 0);

            ////Add barcode
            //generate_barcode(ConnectionWithAccess.get_actual_file_name(msalepdf));
            ////barcode_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\temp_barcode.png";
            //if (File.Exists(barcode_filename))
            //{
            //    iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(barcode_filename);
            //    //pdfimage.ScaleToFit(210f, 500f);
            //    pdfimage.ScaleToFit(240f, 500f);
            //    //pdfimage.Alignment = Element.ALIGN_CENTER;
            //    pdfimage.SetAbsolutePosition(398, 114);
            //    //pdfimage.SetAbsolutePosition(10, 670);
            //    doc1.Add(pdfimage);
            //}
            temp_word = "";
            if (ConnectionWithAccess.company_details[30].Length > 6)
                temp_word += "Bank Details : " + ConnectionWithAccess.company_details[30];
            if (ConnectionWithAccess.company_details[21].Length > 6)
                temp_word += " A/c. : " + ConnectionWithAccess.company_details[21];
            if (ConnectionWithAccess.company_details[29].Length > 6)
                temp_word += " Ifc Code : " + ConnectionWithAccess.company_details[29];
            print_pdf_line(cour_9_bold, temp_word, 3, 24);
            temp_word = "Note # Cheque Fail Charges Rs. 350/- or 2% of Bill Amount Which ever is Higher";
            print_pdf_line(cour_9, temp_word, 15, -3);
            temp_word = "Payment after 30 Days from Invoice Date will be charged 2% Interest Per Month";
            print_pdf_line(cour_9, temp_word, 15, -5);
            temp_word = "For " + ConnectionWithAccess.company_details[1];
            //print_pdf_line(cour_7, temp_word, 372, 7);
            print_pdf_line(cour_7, temp_word, 385, 6);
            temp_word = (NumberToWords(Convert.ToInt32(si_invoice_gross_amount))) + " Only";
            print_pdf_line(cour_7, temp_word, 21, 4);
            if (ConnectionWithAccess.company_details[18].Length > 5)
                temp_word = "V.A.T. TIN : " + ConnectionWithAccess.company_details[18];
            else
                temp_word = "";
            print_pdf_line(cour_9_bold, temp_word, 21, -5);
            if (ConnectionWithAccess.company_details[27].Trim().Length > 5)
                temp_word = "C.S.T. TIN : " + ConnectionWithAccess.company_details[27];
            else
                temp_word = "";
            print_pdf_line(cour_9_bold, temp_word, 21, -5);
            if (ConnectionWithAccess.company_details[4].Trim().Length > 2)
                temp_word = "Subject to " + ConnectionWithAccess.company_details[4] + " Jurisdiction";
            else
                temp_word = "";
            print_pdf_line(cour_9_bold, temp_word, 21, -5);
            if (ConnectionWithAccess.company_details[22].Length > 5)
                temp_word = ConnectionWithAccess.company_details[22];
            else
                temp_word = "";
            print_pdf_line(cour_9_bold, temp_word, 21, 0);
            if (access_line4 != null && temp_word.Length > 2)
                print_pdf_line(cour_9_bold, access_line4, 180, 0);
            else
                print_pdf_line(cour_9_bold, " ", 180, 0);
            if (access_line5 != null && access_line5.Length > 2)
                print_pdf_line(cour_9_bold, access_line5, 180, 0);
            else
                print_pdf_line(cour_9_bold, " ", 180, 0);
            doc1.Close();
            pdf_invoice.BringToFront();
            pdf_invoice.Visible = true;
            pdf_invoice.LoadFile(msalepdf);
        }

        private void sale_invoice_gst_with_contant_and_top_address()
        {
            msalepdf = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\" + ConnectionWithAccess.mNIK + "_si_" + ConnectionWithAccess.mprd + "_" + sidbc.Text + "_" + sidocno.Text + ".pdf";
            ConnectionWithAccess.create_file_folder(msalepdf);
            doc1 = new Document(PageSize.A4, 15, 10, 10, 20);
            FileStream FS1 = File.Create(msalepdf);
            writer = PdfWriter.GetInstance(doc1, FS1);
            get_account_details_from_01(sia_n.Text, sis_a.Text);
            get_account_details_from_04(sia_n.Text, sis_a.Text);
            doc1.Open();
            current_pdf_page_number = 1;
            if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "gst invoice interstate.jpg";
            else
                invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "gst invoice state.jpg";
            if (File.Exists(invoice_jpg_filename))
            {
                iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(invoice_jpg_filename);
                pdfimage.ScaleToFit(560f, 700f);
                pdfimage.Alignment = Element.ALIGN_CENTER;
                //pdfimage.SetAbsolutePosition(15, 40);
                pdfimage.SetAbsolutePosition(15, 40 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                doc1.Add(pdfimage);
            }
            invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "sharp accounting logo.jpg";
            if (File.Exists(invoice_jpg_filename))
            {
                iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(invoice_jpg_filename);
                pdfimage.ScaleToFit(21, 21);
                pdfimage.Alignment = Element.ALIGN_CENTER;
                //pdfimage.SetAbsolutePosition(21, 50);
                pdfimage.SetAbsolutePosition(21, 50 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                doc1.Add(pdfimage);
            }
            Paragraph para = new Paragraph("");
            para.Font.Size = 25;
            temp_word = " ";
            print_pdf_line(cour_11_red, temp_word, 0, (Convert.ToInt32(ConnectionWithAccess.company_details[36]) + 2));
            //print_pdf_line(cour_11_red, temp_word, 240, 2);
            //temp_word2 = "012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789";
            //for (int i = 0; i <= 112; i++)
            //{
            //    temp_word = temp_word2.Substring(0, i);
            //    print_pdf_line_at_center(cour_27_red, temp_word, 10, "cour_27_red");
            //}
            temp_word = ConnectionWithAccess.company_details[1].Trim();
            if (temp_word.Length > 50)
            {
                temp_word = temp_word.Substring(0, 50);
                print_pdf_line_at_center(arial_20, temp_word, 10, "cour_20_red");
            }
            else if (temp_word.Length > 39 && temp_word.Length <= 50)
            {
                temp_word = temp_word.Substring(0, 39);
                print_pdf_line_at_center(arial_20, temp_word, 0, "arial_20");
            }
            else
                print_pdf_line_at_center(cour_27_red, temp_word, 10, "cour_27_red");
            temp_word = ConnectionWithAccess.company_details[14].Trim();
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = ConnectionWithAccess.company_details[15].Trim() + ConnectionWithAccess.company_details[16].Trim();
            print_pdf_line_at_center(cour_11_red, temp_word, 0, "cour_11_red");
            temp_word = "Add : " + ConnectionWithAccess.company_details[2].Trim() + " " + ConnectionWithAccess.company_details[3].Trim() + " " + ConnectionWithAccess.company_details[4].Trim() + ")";
            print_pdf_line_at_center(cour_11_red, temp_word, 0, "cour_11_red");
            temp_word = "(" + ConnectionWithAccess.company_details[5].Trim() + ") - " + ConnectionWithAccess.company_details[6].Trim();
            print_pdf_line_at_center(cour_11_red, temp_word, 0, "cour_11_red");
            temp_word = "Mobile : " + ConnectionWithAccess.company_details[9].Trim();
            if (ConnectionWithAccess.company_details[10].Trim().Length > 3)
                temp_word += "/" + ConnectionWithAccess.company_details[10].Trim();
            //if (ConnectionWithAccess.company_details[11].Contains("@"))
            //    temp_word += " Email id. : " + ConnectionWithAccess.company_details[11].Trim();
            //if (ConnectionWithAccess.company_details[28].Length > 3)
            //    temp_word += " Website : " + ConnectionWithAccess.company_details[28].Trim();
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = " ";
            print_pdf_line(cour_11_red, temp_word, 0, (Convert.ToInt32(ConnectionWithAccess.company_details[36]) + 0));
            //print_pdf_line(cour_11_red, temp_word, 240, -10);
            gst_invoice_common_matter();
        }

        private void sale_invoice_gst_with_contant_and_bottom_address()
        {
            msalepdf = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\" + ConnectionWithAccess.mNIK + "_si_" + ConnectionWithAccess.mprd + "_" + sidbc.Text + "_" + sidocno.Text + ".pdf";
            doc1 = new Document(PageSize.A4, 15, 10, 10, 20);
            FileStream FS1 = File.Create(msalepdf);
            writer = PdfWriter.GetInstance(doc1, FS1);
            get_account_details_from_01(sia_n.Text, sis_a.Text);
            get_account_details_from_04(sia_n.Text, sis_a.Text);
            doc1.Open();
            current_pdf_page_number = 1;
            //if (ckbx_Igst.Checked)
            if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "gst invoice interstate.jpg";
            else
                invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "gst invoice state.jpg";
            if (File.Exists(invoice_jpg_filename))
            {
                iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(invoice_jpg_filename);
                pdfimage.ScaleToFit(560f, 700f);
                pdfimage.Alignment = Element.ALIGN_CENTER;
                //pdfimage.SetAbsolutePosition(15, 60);
                pdfimage.SetAbsolutePosition(15, 60 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                doc1.Add(pdfimage);
            }
            invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "sharp accounting logo.jpg";
            if (File.Exists(invoice_jpg_filename))
            {
                iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(invoice_jpg_filename);
                pdfimage.ScaleToFit(21, 21);
                pdfimage.Alignment = Element.ALIGN_CENTER;
                // pdfimage.SetAbsolutePosition(21, 50);
                pdfimage.SetAbsolutePosition(21, 50 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                doc1.Add(pdfimage);
            }
            Paragraph para = new Paragraph("");
            para.Font.Size = 25;
            temp_word = " ";
            print_pdf_line(cour_11_red, temp_word, 0, (Convert.ToInt32(ConnectionWithAccess.company_details[36]) + 2));
            //print_pdf_line(cour_11_red, temp_word, 240, 2);
            //temp_word2 = "012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789";
            //for (int i = 0; i <= 112; i++)
            //{
            //    temp_word = temp_word2.Substring(0, i);
            //    print_pdf_line_at_center(cour_27_red, temp_word, 10, "cour_27_red");
            //}
            temp_word = ConnectionWithAccess.company_details[1].Trim();
            if (temp_word.Length > 50)
            {
                temp_word = temp_word.Substring(0, 50);
                print_pdf_line_at_center(cour_20_red, temp_word, 10, "cour_20_red");
            }
            else if (temp_word.Length > 37 && temp_word.Length <= 50)
            {
                temp_word = temp_word.Substring(0, 37);
                print_pdf_line_at_center(cour_27_red, temp_word, 0, "cour_27_red");
            }
            else
                print_pdf_line_at_center(cour_27_red, temp_word, 10, "cour_27_red");
            temp_word = ConnectionWithAccess.company_details[14].Trim();
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = ConnectionWithAccess.company_details[15].Trim() + ConnectionWithAccess.company_details[16].Trim();
            print_pdf_line_at_center(cour_11_red, temp_word, 0, "cour_11_red");
            temp_word = "Add : " + ConnectionWithAccess.company_details[2].Trim() + " " + ConnectionWithAccess.company_details[3].Trim() + " " + ConnectionWithAccess.company_details[4].Trim() + " - " + ConnectionWithAccess.company_details[6].Trim() + " (" + ConnectionWithAccess.company_details[5].Trim() + ")";
            print_pdf_line_at_center(cour_11_red, temp_word, 0, "cour_11_red");
            temp_word = "Mobile : " + ConnectionWithAccess.company_details[9].Trim();
            if (ConnectionWithAccess.company_details[10].Trim().Length > 3)
                temp_word += "/" + ConnectionWithAccess.company_details[10].Trim();
            //if (ConnectionWithAccess.company_details[11].Contains("@"))
            //    temp_word += " Email id. : " + ConnectionWithAccess.company_details[11].Trim();
            //if (ConnectionWithAccess.company_details[28].Length > 3)
            //    temp_word += " Website : " + ConnectionWithAccess.company_details[28].Trim();
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = " ";
            print_pdf_line(cour_11_red, temp_word, 0, (Convert.ToInt32(ConnectionWithAccess.company_details[36]) + 0));
            //print_pdf_line(cour_11_red, temp_word, 240, 3);
            gst_invoice_common_matter();
        }

        private void sale_invoice_gst_letterpad()
        {
            msalepdf = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\" + ConnectionWithAccess.mNIK + "_si_" + ConnectionWithAccess.mprd + "_" + sidbc.Text + "_" + sidocno.Text + ".pdf";
            doc1 = new Document(PageSize.A4, 15, 10, 10, 20);
            FileStream FS1 = File.Create(msalepdf);
            writer = PdfWriter.GetInstance(doc1, FS1);
            get_account_details_from_01(sia_n.Text, sis_a.Text);
            get_account_details_from_04(sia_n.Text, sis_a.Text);
            doc1.Open();
            current_pdf_page_number = 1;
            if (function_working == "export")
            {
                invoice_jpg_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\images\\letterpad.jpg";
                if (File.Exists(invoice_jpg_filename))
                {
                    iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(invoice_jpg_filename);
                    pdfimage.ScaleToFit(590f, 900f);
                    pdfimage.Alignment = Element.ALIGN_CENTER;
                    //pdfimage.SetAbsolutePosition(21, 50);
                    //pdfimage.SetAbsolutePosition(21, 50 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                    pdfimage.SetAbsolutePosition(4, 4);
                    doc1.Add(pdfimage);
                }
            }
            if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "gst invoice interstate.jpg";
            else
                invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "gst invoice state.jpg";
            if (File.Exists(invoice_jpg_filename))
            {
                iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(invoice_jpg_filename);
                pdfimage.ScaleToFit(560f, 700f);
                pdfimage.Alignment = Element.ALIGN_CENTER;
                //pdfimage.SetAbsolutePosition(15, 40);
                pdfimage.SetAbsolutePosition(15, 40 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                doc1.Add(pdfimage);
            }
            invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "sharp accounting logo.jpg";
            if (File.Exists(invoice_jpg_filename))
            {
                iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(invoice_jpg_filename);
                pdfimage.ScaleToFit(21, 21);
                pdfimage.Alignment = Element.ALIGN_CENTER;
                //pdfimage.SetAbsolutePosition(21, 50);
                pdfimage.SetAbsolutePosition(21, 50 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                doc1.Add(pdfimage);
            }
            //qr_image_details = "SI," + ConnectionWithAccess.company_details[32] + "," + ConnectionWithAccess.company_details[1] + "," + ConnectionWithAccess.company_details[4] + "," + account_detail_from_01[28] + "," + account_detail_from_01[4] + "," + account_detail_from_01[8] + "," + ConnectionWithAccess.mNIK + "," + ConnectionWithAccess.mprd + "," + sidocno.Text + "," + sidatetime.Value.ToShortDateString() + "," + sigrossamt.Text;
            qr_image_details = "SI," + ConnectionWithAccess.company_details[32] + "," + account_detail_from_01[4] + "," + account_detail_from_01[8] + "," + account_detail_from_01[28] + "," + ConnectionWithAccess.mNIK + "," + ConnectionWithAccess.mprd + "," + sidocno.Text + "," + sidatetime.Value.ToShortDateString() + "," + sigrossamt.Text;
            save_qr_code(qr_image_details);
            if (File.Exists(qr_filename))
            {
                iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(qr_filename);
                pdfimage.ScaleToFit(60, 60);
                pdfimage.Alignment = Element.ALIGN_CENTER;
                //pdfimage.SetAbsolutePosition(21, 800);
                //pdfimage.SetAbsolutePosition(450, 140 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                pdfimage.SetAbsolutePosition(30, 220 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                doc1.Add(pdfimage);
            }
            Paragraph para = new Paragraph("");
            para.Font.Size = 25;
            temp_word = " ";
            print_pdf_line(cour_11_red, temp_word, 0, (Convert.ToInt32(ConnectionWithAccess.company_details[36]) + 112));
            //print_pdf_line(cour_11_red, temp_word, 240, 112);
            gst_invoice_common_matter();
        }

        private void Printing_delivery_challan()
        {
            //read_company_text_file();
            msalepdf = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\" + ConnectionWithAccess.mNIK + "_si_" + ConnectionWithAccess.mprd + "_" + sidbc.Text + "_" + sidocno.Text + ".pdf";
            ConnectionWithAccess.create_file_folder(msalepdf);
            doc1 = new Document(PageSize.A4, 15, 10, 10, 20);
            FileStream FS1 = File.Create(msalepdf);
            writer = PdfWriter.GetInstance(doc1, FS1);
            get_account_details_from_01(sia_n.Text, sis_a.Text);
            get_account_details_from_04(sia_n.Text, sis_a.Text);
            doc1.Open();
            current_pdf_page_number = 1;
            if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "gst invoice interstate.jpg";
            else
                invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "gst invoice state.jpg";
            if (File.Exists(invoice_jpg_filename))
            {
                iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(invoice_jpg_filename);
                pdfimage.ScaleToFit(560f, 700f);
                pdfimage.Alignment = Element.ALIGN_CENTER;
                //pdfimage.SetAbsolutePosition(15, 40);
                pdfimage.SetAbsolutePosition(15, 40 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                doc1.Add(pdfimage);
            }
            invoice_jpg_filename = ConnectionWithAccess.setup_drive + "sharp\\" + "sharp accounting logo.jpg";
            if (File.Exists(invoice_jpg_filename))
            {
                iTextSharp.text.Image pdfimage = iTextSharp.text.Image.GetInstance(invoice_jpg_filename);
                pdfimage.ScaleToFit(21, 21);
                pdfimage.Alignment = Element.ALIGN_CENTER;
                //pdfimage.SetAbsolutePosition(21, 50);
                pdfimage.SetAbsolutePosition(21, 50 - (Convert.ToInt32(ConnectionWithAccess.company_details[36]) * 1));
                doc1.Add(pdfimage);
            }
            Paragraph para = new Paragraph("");
            para.Font.Size = 25;
            temp_word = " ";
            print_pdf_line(cour_11_red, temp_word, 240, 2);
            //temp_word2 = "012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789";
            //for (int i = 0; i <= 112; i++)
            //{
            //    temp_word = temp_word2.Substring(0, i);
            //    print_pdf_line_at_center(cour_27_red, temp_word, 10, "cour_27_red");
            //}
            temp_word = ConnectionWithAccess.company_details[1].Trim();
            if (temp_word.Length > 50)
            {
                temp_word = temp_word.Substring(0, 50);
                print_pdf_line_at_center(cour_20_red, temp_word, 10, "cour_20_red");
            }
            else if (temp_word.Length > 37 && temp_word.Length <= 50)
            {
                temp_word = temp_word.Substring(0, 37);
                print_pdf_line_at_center(cour_27_red, temp_word, 0, "cour_27_red");
            }
            else
                print_pdf_line_at_center(cour_27_red, temp_word, 10, "cour_27_red");
            temp_word = ConnectionWithAccess.company_details[14].Trim();
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = ConnectionWithAccess.company_details[15].Trim() + ConnectionWithAccess.company_details[16].Trim();
            print_pdf_line_at_center(cour_11_red, temp_word, 0, "cour_11_red");
            temp_word = "Add : " + ConnectionWithAccess.company_details[2].Trim() + " " + ConnectionWithAccess.company_details[3].Trim() + " " + ConnectionWithAccess.company_details[4].Trim() + " - " + ConnectionWithAccess.company_details[6].Trim() + " (" + ConnectionWithAccess.company_details[5].Trim() + ")";
            print_pdf_line_at_center(cour_11_red, temp_word, 0, "cour_11_red");
            temp_word = "Mobile : " + ConnectionWithAccess.company_details[9].Trim();
            if (ConnectionWithAccess.company_details[10].Trim().Length > 3)
                temp_word += "/" + ConnectionWithAccess.company_details[10].Trim();
            //if (ConnectionWithAccess.company_details[11].Contains("@"))
            //    temp_word += " Email id. : " + ConnectionWithAccess.company_details[11].Trim();
            //if (ConnectionWithAccess.company_details[28].Length > 3)
            //    temp_word += " Website : " + ConnectionWithAccess.company_details[28].Trim();
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = " ";
            print_pdf_line(cour_11_red, temp_word, 0, (Convert.ToInt32(ConnectionWithAccess.company_details[36]) + 3));
            //print_pdf_line(cour_11_red, temp_word, 240, 3);
            gst_invoice_common_matter();
        }

        private void addCell(PdfPTable table, string text, int rowspan)
        {
            //BaseFont bfTimes = BaseFont.CreateFont(BaseFont.TIMES_ROMAN, BaseFont.CP1252, false);

            //iTextSharp.text.Font times = FontFactory.GetFont("Arial", 11, iTextSharp.text.Font.BOLD);

            //iTextSharp.text.Font times = new iTextSharp.text.Font(bfTimes, 11, iTextSharp.text.Font.BOLD, iTextSharp.text.BaseColor.BLACK);

            PdfPCell cell = new PdfPCell(new Phrase(text, cour_11));
            cell.Rowspan = rowspan;

            cell.BorderWidth = 0;

            cell.BorderWidthTop = 1;
            cell.BorderWidthBottom = 1;
            cell.NoWrap = true;
            //cell.Width = cell_width;
            //cell.BackgroundColor = new iTextSharp.text.BaseColor(240, 240, 240);
            cell.HorizontalAlignment = PdfPCell.ALIGN_CENTER;
            cell.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
            table.AddCell(cell);
        }

        private void sale_invoice_number_three_print()
        {
            //pdf_invoice.Location = new Point(20, 144);
            msalepdf = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\saleinvoice_" + sidocno.Text;
            if (chb_add_datetime_in_output.Checked)
                msalepdf += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            msalepdf += ".pdf";
            doc1 = new Document(PageSize.A4, 10, 45, 40, 25);
            FileStream FS1 = File.Create(msalepdf);
            writer = PdfWriter.GetInstance(doc1, FS1);
            get_account_details_from_01(sia_n.Text, sis_a.Text);
            get_account_details_from_04(sia_n.Text, sis_a.Text);
            doc1.Open();
            current_pdf_page_number = 1;
            Paragraph para = new Paragraph("");
            para.Font.Size = 25;
            temp_word = " ";
            print_pdf_line(cour_11_red, temp_word, 180, 0);
            temp_word = "Subject to ULHASNAGAR Jurisdiction";
            print_pdf_line(cour_11_red, temp_word, 180, 75);
            temp_word = "Tax - Invoice";
            print_pdf_line(arabic_14, temp_word, 240, 0);
            temp_word = "Buyer's Name & Address";
            print_pdf_line(cour_11, temp_word, 30, 0);
            temp_word = "Invoice No.";
            print_pdf_line(cour_11, temp_word, 300, -18);
            temp_word = "Date";
            print_pdf_line(cour_11, temp_word, 470, -18);
            temp_word = sidocno.Text;
            print_pdf_line(cour_11, temp_word, 320, -2);
            temp_word = sidatetime.Text;
            print_pdf_line(cour_11, temp_word, 460, -16);
            temp_word = account_detail_from_01[4];
            print_pdf_line(cour_11, temp_word, 30, 0);
            temp_word = account_detail_from_04[4];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = account_detail_from_04[5];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = account_detail_from_01[8] + "-" + account_detail_from_01[10];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "Transport : " + sitransport.Text;
            print_pdf_line(cour_11, temp_word, 300, -15);
            temp_word = account_detail_from_01[12];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = DispEmail.Text;
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "Buyer's";
            print_pdf_line(cour_11, temp_word, 30, 0);
            temp_word = "Tin : " + account_detail_from_04[29];
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = account_detail_from_01[17] + " ," + account_detail_from_01[19];
            if (temp_word != null && temp_word != "")
            {
                print_pdf_line(cour_11, temp_word, 100, -18);
            }
            //temp_word = "-------------------------------------------------------------------------------------------------------------------------------------------";
            //print_pdf_line(cour_11, temp_word, 30, -5);
            //temp_word = "Sr.                          Particular's                                                 Pac        Quantity     Rate             Amount";
            //print_pdf_line(cour_11, temp_word, 30, -5);
            //temp_word = "-------------------------------------------------------------------------------------------------------------------------------------------";
            //print_pdf_line(cour_11, temp_word, 30, -5);
            si_invoice_basic_amount = 0;
            sale_invoice_amount = 0;

            PdfPTable pdfTable = new PdfPTable(siitemlist.ColumnCount);
            pdfTable.HorizontalAlignment = Element.ALIGN_LEFT;
            pdfTable.WidthPercentage = 100;
            List<int> lstTableWidth = new List<int>();

            foreach (DataGridViewColumn column in siitemlist.Columns)
            {
                addCell(pdfTable, column.HeaderText.Trim(), 2);
                //lstTableWidth.Add(column.Width);
            }

            //pdfTable.SetWidths(lstTableWidth.ToArray());
            string cell_value = string.Empty;

            //Adding DataRow
            foreach (DataGridViewRow row in siitemlist.Rows)
            {
                foreach (DataGridViewCell cell in row.Cells)
                {
                    cell_value = string.Empty;
                    if (cell.Value != null)
                        cell_value = cell.Value.ToString();
                    PdfPCell pdf_cell = new PdfPCell(new Phrase(cell_value, cour_11));
                    pdf_cell.Border = 0;

                    //pdf_cell.HorizontalAlignment =  
                    pdfTable.AddCell(pdf_cell);
                }
                si_invoice_basic_amount = si_invoice_basic_amount + Convert.ToDouble(row.Cells[7].Value);
            }

            doc1.Add(pdfTable);
            si_invoice_tax_amount = Convert.ToDouble(sitaxamt.Text);
            si_invoice_gross_amount = (si_invoice_basic_amount + si_invoice_tax_amount);
            temp_word = "------------";
            print_pdf_line(cour_11, temp_word, 485, 0);
            temp_word = "Total";
            print_pdf_line(cour_11, temp_word, 375, -5);
            //temp_word = Convert.ToString(si_invoice_basic_amount);
            temp_word = add_comma_to_number(si_invoice_basic_amount.ToString());
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(455, temp_word, "cour_11"), -18);
            temp_word = "------------";
            print_pdf_line(cour_11, temp_word, 485, -10);
            temp_word = NumberToWords(mpacking) + " Packing Only";
            temp_word = temp_word.Replace("AND", "");
            if (siitemlist.Rows.Count > 2)
                print_pdf_line(cour_11, temp_word, 30, (240 - ((siitemlist.Rows.Count - 2) * 16)));
            else
                print_pdf_line(cour_11, temp_word, 30, 240);
            temp_word = sitaxdesc.Text;
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(240, temp_word, "cour_11"), 0);
            //temp_word = sitaxamt.Text;
            temp_word = Convert.ToDouble(sitaxamt.Text).ToString("#,##,##,###0.00");
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(455, temp_word, "cour_11"), -18);
            temp_word = "Note # Cheque Fail Charges Rs. 350/- or 2%";
            print_pdf_line(cour_9, temp_word, 30, 0);
            temp_word = "----      ----                      -----------------";
            print_pdf_line(cour_11, temp_word, 340, -18);
            temp_word = "of Bill Amount Which ever is Higher";
            print_pdf_line(cour_9, temp_word, 75, -5);
            temp_word = "Total";
            print_pdf_line(cour_11, temp_word, 300, -16);
            temp_word = add_comma_to_number(si_invoice_gross_amount.ToString());
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(455, temp_word, "cour_11"), -18);
            temp_word = "----      ----                      -----------------";
            print_pdf_line(cour_11, temp_word, 342, -5);
            temp_word = "L.B.T. Num : " + ConnectionWithAccess.company_details[19];
            print_pdf_line(cour_9_red, temp_word, 30, -5);
            temp_word = "-------------------------------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "Rupees : " + (NumberToWords(Convert.ToInt32(si_invoice_gross_amount))) + " Only";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "-------------------------------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_11, temp_word, 30, -5);
            temp_word = "V.A.T. TIN : " + ConnectionWithAccess.company_details[18];
            print_pdf_line(cour_9_red, temp_word, 30, -9);
            temp_word = "For " + ConnectionWithAccess.company_details[1];
            print_pdf_line(cour_9, temp_word, 530 - (temp_word.Length * 52 / 10), -18);
            temp_word = "C.S.T. TIN : " + ConnectionWithAccess.company_details[27];
            print_pdf_line(cour_9_red, temp_word, 30, -5);
            temp_word = "Added Tax Act 2002 is  in force on the date on  which the sale of  the goods specified in ";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "this Tax  Invoice is made  by us/me  & that the  transaction of  sales covered by this Tax ";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "Invoice has been effected by me/us and it shall be accounted for in the turnover of Sales ";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "while filing of return and the due tax, if any payable on the sale has been paid or shall be ";
            print_pdf_line(cour_9, temp_word, 30, -5);
            temp_word = "Prop.";
            print_pdf_line(cour_9, temp_word, 510, -18);
            temp_word = "paid.";
            print_pdf_line(cour_9, temp_word, 30, -5);
            if (ConnectionWithAccess.company_details[30].Length > 6)
                temp_word += "Bank Details : " + ConnectionWithAccess.company_details[30];
            if (ConnectionWithAccess.company_details[21].Length > 6)
                temp_word += " A/c. : " + ConnectionWithAccess.company_details[21];
            if (ConnectionWithAccess.company_details[29].Length > 6)
                temp_word += " Ifc Code : " + ConnectionWithAccess.company_details[29];
            print_pdf_line(cour_9, temp_word, 30, -5);
            doc1.Close();
            pdf_invoice.BringToFront();
            pdf_invoice.Visible = true;
            pdf_invoice.LoadFile(msalepdf);
        }

        private string add_comma_to_number(string old_number)
        {
            if (old_number != "")
            {
                check_data_type(old_number);
                if (data_type == "Numeric")
                    old_number = Convert.ToDouble(old_number).ToString("#,##,##,###0.00");
            }
            return old_number;
        }

        # endregion

        private void pdfwithpdfwriter()
        {
            ////Document document = new Document();
            //Document document = new Document(PageSize.A4, 40, 45, 40, 25);
            //FileStream FS = File.Create(ConnectionWithAccess.mpdffile);
            //// step 2:
            //// we create a writer that listens to the document
            //// and directs a PDF-stream to a file
            //PdfWriter.GetInstance(document, FS);
            ////PdfWriter writer = PdfWriter.getInstance(document, new FileStream("Chap1002.pdf", FileMode.Create));


            //// step 3: we open the document
            //document.Open();


            //// step 4: we grab the ContentByte and do some stuff with it
            ////PdfContentByte cb = writer.DirectContent;


            //// we tell the ContentByte we're ready to draw text
            //cb.beginText();


            //// we draw some text on a certain position
            //cb.setTextMatrix(100, 400);
            //cb.showText("Text at position 100,400.");


            //// we tell the contentByte, we've finished drawing text
            //cb.endText();
            //document.Close();
        }

        private void pdfwatermark()
        {
            string watermarkedFile = "Watermarked.pdf";
            // Creating watermark on a separate layer
            // Creating iTextSharp.text.pdf.PdfReader object to read the Existing PDF Document
            PdfReader reader1 = new PdfReader(ConnectionWithAccess.mpdffile);
            using (FileStream fs = new FileStream(watermarkedFile, FileMode.Create, FileAccess.Write, FileShare.None))
            // Creating iTextSharp.text.pdf.PdfStamper object to write Data from iTextSharp.text.pdf.PdfReader object to FileStream object
            using (PdfStamper stamper = new PdfStamper(reader1, fs))
            {
                // Getting total number of pages of the Existing Document
                int pageCount = reader1.NumberOfPages;

                // Create New Layer for Watermark
                PdfLayer layer = new PdfLayer("WatermarkLayer", stamper.Writer);
                // Loop through each Page
                for (int i = 1; i <= pageCount; i++)
                {
                    // Getting the Page Size
                    //Rectangle rect = reader1.GetPageSize(i);

                    // Get the ContentByte object
                    PdfContentByte cb = stamper.GetUnderContent(i);

                    // Tell the cb that the next commands should be "bound" to this new layer
                    cb.BeginLayer(layer);
                    cb.SetFontAndSize(BaseFont.CreateFont(
                      BaseFont.HELVETICA, BaseFont.CP1252, BaseFont.NOT_EMBEDDED), 50);

                    PdfGState gState = new PdfGState();
                    gState.FillOpacity = 0.25f;
                    cb.SetGState(gState);

                    cb.SetColorFill(BaseColor.BLACK);
                    cb.BeginText();
                    //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, watermarkText, rect.Width / 2, rect.Height / 2, 45f);
                    cb.EndText();

                    // Close the layer
                    cb.EndLayer();
                }
            }
        }

        private void btndelete_Click(object sender, EventArgs e)
        {
            if (maintab.SelectedIndex == 1)
            {
            }
            else if (maintab.SelectedIndex == 2)
            {
                if (subtabMasters.SelectedIndex == 0)
                {

                }
                else if (subtabMasters.SelectedIndex == 1)
                {
                    int columnIndex = ItemListDG.CurrentCell.ColumnIndex;
                    int rowIndex = ItemListDG.CurrentCell.RowIndex;
                    if (rowIndex > -1)
                    {
                        ItemListDG.Rows.RemoveAt(rowIndex);
                        ItemListDG.Refresh(); // if needed
                    }
                }
                else if (subtabMasters.SelectedIndex == 2)
                {
                    int columnIndex = TaxListDG.CurrentCell.ColumnIndex;
                    int rowIndex = TaxListDG.CurrentCell.RowIndex;
                    if (rowIndex > -1)
                    {
                        TaxListDG.Rows.RemoveAt(rowIndex);
                        TaxListDG.Refresh(); // if needed
                    }
                }
                else if (subtabMasters.SelectedIndex == 3)
                {
                    int columnIndex = DBCListDG.CurrentCell.ColumnIndex;
                    int rowIndex = DBCListDG.CurrentCell.RowIndex;
                    if (rowIndex > -1)
                    {
                        DBCListDG.Rows.RemoveAt(rowIndex);
                        DBCListDG.Refresh(); // if needed
                    }
                }
                else if (subtabMasters.SelectedIndex == 4)
                {
                    int columnIndex = PeriodListDG.CurrentCell.ColumnIndex;
                    int rowIndex = PeriodListDG.CurrentCell.RowIndex;
                    if (rowIndex > -1)
                    {
                        ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[50] + " where prd = " + PeriodListDG.SelectedCells[0] + " and start = " + PeriodListDG.SelectedCells[1] + " and [end] = " + PeriodListDG.SelectedCells[2];
                        ConnectionCommand.fUpdateInsertDeleteData();
                        PeriodListDG.Rows.RemoveAt(rowIndex);
                        PeriodListDG.Refresh(); // if needed
                    }
                }
            }
            else if (maintab.SelectedIndex == 4)
            {
                if (subtabsettings.SelectedIndex == 0)
                {
                    int columnIndex = UserListDG.CurrentCell.ColumnIndex;
                    int rowIndex = UserListDG.CurrentCell.RowIndex;
                    //string tempvalue1;
                    //string mf1 = (Convert.ToString(UserListDG.SelectedColumns[0]));
                    //tempvalue1.text = UserListDG.row
                    if (rowIndex > -1)
                    {
                        ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[52] + " where f1 = '" + UserListDG.SelectedCells[0].Value + "' and f2 = '" + UserListDG.SelectedCells[1].Value + "'";
                        ConnectionCommand.fUpdateInsertDeleteData();
                        UserListDG.Rows.RemoveAt(rowIndex);
                        UserListDG.Refresh();
                    }
                }
            }
        }

        private void si_item_help_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                mtype = Convert.ToString(si_item_help.CurrentRow.Cells[0].Value);
                mitem_code = Convert.ToString(si_item_help.CurrentRow.Cells[1].Value);
                mtitle = Convert.ToString(siitemlist.Rows[mRowIndex].Cells[2].Value);
                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        siitemlist.Rows[siitemlistrowindex].Cells[0].Value = dtData1.Rows[0][0].ToString();
                        siitemlist.Rows[siitemlistrowindex].Cells[1].Value = dtData1.Rows[0][1].ToString();
                        siitemlist.Rows[siitemlistrowindex].Cells[2].Value = dtData1.Rows[0][2].ToString();
                        mcase = 1;
                        mbox = Convert.ToDouble(dtData1.Rows[0][3].ToString());
                        mqty = Convert.ToDouble(dtData1.Rows[0][4].ToString());
                        mprice = Convert.ToDouble(dtData1.Rows[0][5].ToString());
                        siitemlist.Rows[siitemlistrowindex].Cells[3].Value = mcase;
                        siitemlist.Rows[siitemlistrowindex].Cells[4].Value = mbox * mcase;
                        siitemlist.Rows[siitemlistrowindex].Cells[5].Value = mbox * mqty;
                        siitemlist.Rows[siitemlistrowindex].Cells[6].Value = mprice;
                        mamount = mcase * mbox * mqty * mprice;
                        siitemlist.Rows[siitemlistrowindex].Cells[7].Value = Convert.ToString(mamount);
                        siitemlist.Rows[siitemlistrowindex].Cells[8].Value = dtData1.Rows[0][6].ToString();
                        siitemlist.Rows[siitemlistrowindex].Cells[9].Value = dtData1.Rows[0][8].ToString();
                        siitemlist.Rows[siitemlistrowindex].Cells[10].Value = dtData1.Rows[0][9].ToString();
                        si_item_help.Visible = false;
                        calculateSaleItemTotal();
                    }
                }
            }
            else
                show_images();
        }

        private void sitaxcode_TextChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.query = "select tx_code,tax_rate, [desc] from " + ConnectionWithAccess.tablename[06] + " where d_c = " + Convert.ToInt32(sidbc.Text) + " and tx_code like '" + sitaxcode.Text + "%'";
            ConnectionCommand.accountHelp_datatable_Seperate(sitaxlist, "sitaxlist", "tx_code ASC");
        }

        private void sitaxcode_KeyDown(object sender, KeyEventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Tax";
            if (e.KeyCode == Keys.Down)
            {
                sitaxlist.Focus();
            }
        }

        private void sitaxlist_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                mtx_code = Convert.ToString(sitaxlist.CurrentRow.Cells[0].Value);
                sitaxrate.Text = Convert.ToString(sitaxlist.CurrentRow.Cells[1].Value);
                sitaxdesc.Text = Convert.ToString(sitaxlist.CurrentRow.Cells[2].Value);
                sitaxcode.Text = mtx_code;
                sitaxlist.Visible = false;
            }
        }

        private void sitaxcode_KeyPress(object sender, KeyPressEventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Tax";
            sitaxlist.Visible = true;
            cb_all_sale_invoice_ledger.Visible = false;
            cb_all_sale_invoice_list.Visible = false;
            cb_all_sale_item_list.Visible = false;
        }

        private void report_analysis_check_box_selected_changed()
        {
            cbRepSubType.Items.Clear();
            cbRepFormat.Items.Clear();
            if (cbRepType.Text == "Sale" || cbRepType.Text == "Purchase")
            {
                cbrep_ana_d_c.Visible = true;
                label253.Visible = true;
                cbRepSubType.Items.Add("Invoice");
                cbRepSubType.Items.Add("Replacement");
                cbRepSubType.Items.Add("Brief with Items");
                cbRepSubType.Items.Add("Quotation");
                cbRepSubType.Items.Add("Balance");
                cbRepSubType.Items.Add("Proforma Invoice");
                cbRepFormat.Items.Add("Document Wise");
                cbRepFormat.Items.Add("Party Wise");
                cbRepFormat.Items.Add("Item Wise");
                cbRepFormat.Items.Add("Tax Sheet");
                cbRepFormat.SelectedIndex = 0;
            }
            else if (cbRepType.Text == "Bank")
            {
                cbRepSubType.Items.Add("All");
                cbRepSubType.Items.Add("Receipt");
                cbRepSubType.Items.Add("Payment");
                cbRepSubType.Items.Add("Deposit");
                cbRepSubType.Items.Add("Withdrawal");
                cbRepSubType.Items.Add("Mon.Statement");
                cbRepFormat.Items.Add("Passed");
                cbRepFormat.Items.Add("Failed");
                cbRepFormat.Items.Add("Pending");
                cbRepSubType.SelectedIndex = 0;
                cbRepFormat.SelectedIndex = 0;
            }
            else if (cbRepType.Text == "Cash")
            {
                cbrep_ana_d_c.Visible = false;
                label253.Visible = false;
                //cbRepSubType.Items.Clear();
                cbRepSubType.Items.Add("All");
                cbRepSubType.Items.Add("Receipt");
                cbRepSubType.Items.Add("Payment");
                cbRepFormat.Visible = false;
                cbRepSubType.SelectedIndex = 0;
            }
            else if (cbRepType.Text == "Journal")
            {
                cbrep_ana_d_c.Visible = false;
                label253.Visible = false;
                cbRepSubType.Items.Add("Entry");
                cbRepFormat.Visible = false;
                cbRepSubType.SelectedIndex = 0;
            }
            else if (cbRepType.Text == "Opening Balances" || cbRepType.Text == "Closing Balances")
            {
                cbrep_ana_d_c.Visible = false;
                label253.Visible = false;
                cbRepSubType.Items.Add("Customer's");
                cbRepSubType.Items.Add("Supplier's");
                cbRepFormat.Visible = false;
                cbRepSubType.SelectedIndex = 0;
            }
            else if (cbRepType.Text == "Stock")
            {
                cbrep_ana_d_c.Visible = false;
                label253.Visible = false;
                cbRepSubType.Items.Add("Current Stock");
                cbRepSubType.Items.Add("Short Stock");
                cbRepFormat.Visible = false;
                cbRepSubType.SelectedIndex = 0;
            }
            else if (cbRepType.Text == "Tax")
            {
                cbrep_ana_d_c.Visible = false;
                label253.Visible = false;
                cbRepSubType.Items.Add("General Tax");
                cbRepSubType.Items.Add("LBT Tax");
                cbRepFormat.Visible = false;
                cbRepSubType.SelectedIndex = 0;
            }
            else if (cbRepType.Text == "Item")
            {
                cbrep_ana_d_c.Visible = false;
                label253.Visible = false;
                cbRepSubType.Items.Add("Opening Stock");
                cbRepSubType.Items.Add("Type wise");
                cbRepSubType.Items.Add("Price wise");
                cbRepFormat.Visible = false;
                cbRepSubType.SelectedIndex = 0;
            }
            //cbRepSubType.SelectedIndex = 0;
        }

        private void cbRepType_SelectedIndexChanged(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data");
            objPleaseWait.Show();
            Application.DoEvents();
            chkpartyList.Items.Clear();
            chkcityList.Items.Clear();
            chktaxlist.Items.Clear();
            pb_rep_ana_printer.Visible = false;
            pdf_viewer1.Visible = false;
            gdvreport.Visible = false;
            dgv_tax_report.Visible = false;
            cbRepSubType.Items.Clear();
            cbRepFormat.Items.Clear();
            cbRepFormat.Visible = true;
            report_analysis_check_box_selected_changed();
            cbRepSubType.SelectedIndex = 0;
            cbrep_ana_d_c.Visible = true;
            if (cbRepType.SelectedIndex == 0)
            {
                cbrep_ana_d_c.Items.Clear();
                cbrep_ana_d_c.Visible = true;
                label253.Visible = true;
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[21] + " where d_n = 999999";
                ConnectionCommand.retrieval(cbrep_ana_d_c);
                if (cbrep_ana_d_c.Text != "")
                    raa_n.Text = get_a_n_from_d_c("S", Convert.ToInt32(cbrep_ana_d_c.Text));
            }
            else if (cbRepType.SelectedIndex == 1)
            {
                cbrep_ana_d_c.Items.Clear();
                cbrep_ana_d_c.Visible = true;
                label253.Visible = true;
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[22] + " where d_n = 999999";
                ConnectionCommand.retrieval(cbrep_ana_d_c);
                if (cbrep_ana_d_c.Text != "")
                    raa_n.Text = get_a_n_from_d_c("P", Convert.ToInt32(cbrep_ana_d_c.Text));
            }
            else if (cbRepType.SelectedIndex == 2)
            {
                cbrep_ana_d_c.Items.Clear();
                cbrep_ana_d_c.Visible = true;
                label253.Visible = true;
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[23] + " where d_n = 999999";
                ConnectionCommand.retrieval(cbrep_ana_d_c);
                if (cbrep_ana_d_c.Text != "")
                    raa_n.Text = get_a_n_from_d_c("B", Convert.ToInt32(cbrep_ana_d_c.Text));
            }
            else if (cbRepType.SelectedIndex == 3)
            {
                cbrep_ana_d_c.Items.Clear();
                cbrep_ana_d_c.Visible = true;
                label253.Visible = true;
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[24] + " where d_n = 999999";
                ConnectionCommand.retrieval(cbrep_ana_d_c);
                if (cbrep_ana_d_c.Text != "")
                    raa_n.Text = get_a_n_from_d_c("C", Convert.ToInt32(cbrep_ana_d_c.Text));
            }
            else
            {
                cbrep_ana_d_c.Visible = false;
                label253.Visible = false;
            }
            //AdvanceFilter Queries
            chkpartyList.ResetText();
            chkcityList.Items.Clear();
            AFAnalysis.PartyListQuery = "select [desc],city,a_n,s_a from " + ConnectionWithAccess.tablename[01] + " f1 where f1.a_n = '" + raa_n.Text + "' and f1.s_a <> '@@@' order by a_n,s_a";
            AFAnalysis.CityListQuery = "select distinct [city] from " + ConnectionWithAccess.tablename[01] + " f1 where f1.a_n = '" + raa_n.Text + "' and f1.s_a <> '@@@' order by a_n,s_a";
            AFAnalysis.TaxListQuery = "select distinct f6.tx_code, f6.[desc] from " + ConnectionWithAccess.tablename[06] + " f6 where f6.d_c = " + cbrep_ana_d_c.Text;
            AFAnalysis.AreaListQuery = "select distinct area_code from " + ConnectionWithAccess.tablename[02];
            objPleaseWait.Close();
        }

        private void cbRepFormat_SelecedIndexChanged(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait collecting Data");
            objPleaseWait.Show();
            Application.DoEvents();
            report_keys_enable();
            report_analysis_check_box_selected_changed();
            objPleaseWait.Close();
        }

        private void report_keys_enable()
        {
            pb_rep_ana_printer.Visible = false;
            pdf_viewer1.Visible = false;
            gdvreport.Visible = false;
            dgv_tax_report.Visible = false;
            Generate.Visible = true;
        }

        private void cbledparent_SelectedIndexChanged(object sender, EventArgs e)
        {
            pb_rep_ana_printer.Visible = false;
            //fill_cbledchild_combo_box();
            //if (cbledparent.SelectedIndex == 14)
            //    cbledchild.SelectedIndex = 12;
        }

        private void KeyEvent(object sender, KeyEventArgs e) //Keyup Event 
        {
            //if (e.KeyCode == Keys.F9)
            //{
            //    MessageBox.Show("Function F9");
            //}
            //if (e.KeyCode == Keys.F6)
            //{
            //    MessageBox.Show("Function F6");
            //}
            //else
            //    MessageBox.Show("No Function");

        }

        bool isEscKeyPressed = false;
        private void MainForm_KeyDown(object sender, KeyEventArgs e)
        {
            //MessageBox.Show("Keydown");
            if (e.KeyCode == Keys.F12)
            {
                isEscKeyPressed = true;
                Application.Restart();
                Environment.Exit(0);

            }
            if (maintab.SelectedIndex == 0 && e.KeyCode == Keys.Escape)
            {
                const string message = "Do you want to close application?";
                const string caption = "Close Sharp";
                var result = MessageBox.Show(message, caption,
                                             MessageBoxButtons.YesNo,
                                             MessageBoxIcon.Question);
                if (result == DialogResult.Yes)
                {
                    login_user_time_out();
                    //if (ConnectionWithAccess.detach_exit == "Y")
                    //{
                    //    detachandcloseapplication();
                    //}
                    //this.ParentForm.Dispose();
                    System.Environment.Exit(1);
                    System.Windows.Forms.Application.Exit();
                    Application.Exit();
                    this.Close();
                }
            }
            //if (e.Alt && e.KeyCode == Keys.H || e.KeyCode == Keys.Escape)
            if (e.Alt && e.KeyCode == Keys.H || e.KeyCode == Keys.Escape)
            { maintab.SelectedIndex = 0; maintab_Click(sender, e); }
            else if (e.Alt && e.KeyCode == Keys.D)
            { maintab.SelectedIndex = 1; maintab_Click(sender, e); }
            else if (e.Alt && e.KeyCode == Keys.M)
            { maintab.SelectedIndex = 2; maintab_Click(sender, e); }
            else if (e.Alt && e.KeyCode == Keys.R)
            { maintab.SelectedIndex = 3; maintab_Click(sender, e); }
            else if (e.Alt && e.KeyCode == Keys.E)
            { maintab.SelectedIndex = 4; maintab_Click(sender, e); }
            else if (e.Alt && e.KeyCode == Keys.U)
            { maintab.SelectedIndex = 5; maintab_Click(sender, e); }
            else if (e.Alt && e.KeyCode == Keys.F1)
            { maintab.SelectedIndex = 6; maintab_Click(sender, e); }
            else if (e.KeyCode == Keys.F9)
            {
                maintab.SelectedIndex = 3;
                maintab_Click(sender, e);
                subtabreports.SelectedIndex = 1;
                tb_ledger_account_name.Focus();
            }
            if (maintab.SelectedIndex == 1)
            {//Data Entry
                if (e.Alt && e.KeyCode == Keys.S)
                { subtabDataEntry.SelectedIndex = 0; subtabDataEntry_Click(sender, e); }
                else if (e.Alt && e.KeyCode == Keys.P)
                { subtabDataEntry.SelectedIndex = 1; subtabDataEntry_Click(sender, e); }
                else if (e.Alt && e.KeyCode == Keys.B)
                { subtabDataEntry.SelectedIndex = 2; subtabDataEntry_Click(sender, e); }
                else if (e.Alt && e.KeyCode == Keys.C)
                { subtabDataEntry.SelectedIndex = 3; subtabDataEntry_Click(sender, e); }
                else if (e.Alt && e.KeyCode == Keys.J)
                { subtabDataEntry.SelectedIndex = 4; subtabDataEntry_Click(sender, e); }
                else if (e.Alt && e.KeyCode == Keys.A)
                { subtabDataEntry.SelectedIndex = 5; subtabDataEntry_Click(sender, e); }
                if (subtabDataEntry.SelectedIndex == 0)
                {//Sale
                    if (e.Alt && e.KeyCode == Keys.I)
                        subtabsale.SelectedIndex = 0;
                    else if (e.Alt && e.KeyCode == Keys.Y)
                        subtabsale.SelectedIndex = 1;
                    else if (e.Alt && e.KeyCode == Keys.O)
                        subtabsale.SelectedIndex = 2;
                }
                else if (subtabDataEntry.SelectedIndex == 1)
                {//Purchase
                    if (e.Alt && e.KeyCode == Keys.I)
                    { subtabpurchase.SelectedIndex = 0; subtabpurchase_Click(sender, e); }
                    else if (e.Alt && e.KeyCode == Keys.Y)
                    { subtabpurchase.SelectedIndex = 1; subtabpurchase_Click(sender, e); }
                }
                else if (subtabDataEntry.SelectedIndex == 2)
                {//Bank
                    if (e.Alt && e.KeyCode == Keys.I)
                    { subtabbank.SelectedIndex = 0; subtabbank_Click(sender, e); }
                    else if (e.Alt && e.KeyCode == Keys.Y)
                    { subtabbank.SelectedIndex = 1; subtabbank_Click(sender, e); }
                    else if (e.Alt && e.KeyCode == Keys.D)
                    { subtabbank.SelectedIndex = 2; subtabbank_Click(sender, e); }
                    else if (e.Alt && e.KeyCode == Keys.W)
                    { subtabbank.SelectedIndex = 3; subtabbank_Click(sender, e); }
                    else if (e.Alt && e.KeyCode == Keys.T)
                    { subtabbank.SelectedIndex = 4; subtabbank_Click(sender, e); }
                }
                else if (subtabDataEntry.SelectedIndex == 3)
                {//Cash
                    if (e.Alt && e.KeyCode == Keys.I)
                    { subtabcash.SelectedIndex = 0; subtabcash_Click(sender, e); }
                    else if (e.Alt && e.KeyCode == Keys.Y)
                    { subtabcash.SelectedIndex = 1; subtabcash_Click(sender, e); }
                }
                else if (subtabDataEntry.SelectedIndex == 3)
                {//Additional
                    if (e.Alt && e.KeyCode == Keys.I)
                        tc_dataentry_additional.SelectedIndex = 0;
                    else if (e.Alt && e.KeyCode == Keys.Y)
                        tc_dataentry_additional.SelectedIndex = 1;
                }
            }
            else if (maintab.SelectedIndex == 2)
            {//Masters
                if (e.Alt && e.KeyCode == Keys.Y)
                { subtabMasters.SelectedIndex = 0; subtabMasters_click(sender, e); }
                else if (e.Alt && e.KeyCode == Keys.I)
                { subtabMasters.SelectedIndex = 1; subtabMasters_click(sender, e); }
                else if (e.Alt && e.KeyCode == Keys.T)
                { subtabMasters.SelectedIndex = 2; subtabMasters_click(sender, e); }
                else if (e.Alt && e.KeyCode == Keys.B)
                { subtabMasters.SelectedIndex = 3; subtabMasters_click(sender, e); }
                else if (e.Alt && e.KeyCode == Keys.P)
                { subtabMasters.SelectedIndex = 4; subtabMasters_click(sender, e); }
                else if (e.Alt && e.KeyCode == Keys.A)
                { subtabMasters.SelectedIndex = 5; subtabMasters_click(sender, e); }
            }
            else if (maintab.SelectedIndex == 3)
            {//Reports
                if (e.Alt && e.KeyCode == Keys.A)
                    subtabreports.SelectedIndex = 0;
                else if (e.Alt && e.KeyCode == Keys.L)
                    subtabreports.SelectedIndex = 1;
                else if (e.Alt && e.KeyCode == Keys.T)
                    subtabreports.SelectedIndex = 2;
                else if (e.Alt && e.KeyCode == Keys.G)
                    subtabreports.SelectedIndex = 3;
                else if (e.Alt && e.KeyCode == Keys.C)
                    subtabreports.SelectedIndex = 4;
            }
            else if (maintab.SelectedIndex == 4)
            {//Settings
                if (e.Alt && e.KeyCode == Keys.Y)
                { subtabsettings.SelectedIndex = 0; subtabsettings_Click(sender, e); }
                else if (e.Alt && e.KeyCode == Keys.G)
                { subtabsettings.SelectedIndex = 1; subtabsettings_Click(sender, e); }
                else if (e.Alt && e.KeyCode == Keys.C)
                { subtabsettings.SelectedIndex = 2; subtabsettings_Click(sender, e); }
            }
            else if (maintab.SelectedIndex == 5)
            {//Help
                if (e.Alt && e.KeyCode == Keys.G)
                    subtabhelp.SelectedIndex = 0;
                else if (e.Alt && e.KeyCode == Keys.I)
                    subtabhelp.SelectedIndex = 1;
                else if (e.Alt && e.KeyCode == Keys.Y)
                    subtabhelp.SelectedIndex = 2;
            }
            //if (e.KeyCode == Keys.F12)
            //{
            //    periodgridview.Visible = true;
            //    ConnectionWithAccess.query = "select prd, start, [end] from " + ConnectionWithAccess.tablename[50] + " order by prd desc";
            //    ConnectionCommand.accountHelp(periodgridview, "ChangePeriod");
            //}
            //if(e.KeyCode.ToString() == "F12") 
            //{
            //       periodgridview.Visible = true;
            //    ConnectionWithAccess.query = "select prd, start, [end] from " + ConnectionWithAccess.tablename[50] + " order by prd desc";
            //    ConnectionCommand.accountHelp(periodgridview, "ChangePeriod");
            //}
            //if (e.KeyCode.ToString() == "Ctrl+S")
            //{
            //    atbsave_Click(sender, e);
            //}
        }

        private void periodgridview_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            ConnectionWithAccess.mprd = Convert.ToString(periodgridview.CurrentRow.Cells[0].Value);
            ConnectionWithAccess.msdate = Convert.ToString(periodgridview.CurrentRow.Cells[1].Value);
            ConnectionWithAccess.medate = Convert.ToString(periodgridview.CurrentRow.Cells[2].Value);
            if (DateTime.Today > Convert.ToDateTime(ConnectionWithAccess.msdate))
            {
                if (DateTime.Today <= Convert.ToDateTime(ConnectionWithAccess.medate))
                {
                    ConnectionWithAccess.medate = (DateTime.Today.ToShortDateString()).ToString();
                }
            }
            try
            {
                ConnectionWithAccess.moprd = ConnectionWithAccess.get_old_prd_name(ConnectionWithAccess.mprd);
                ConnectionWithAccess.mnew_prd = ConnectionWithAccess.get_next_prd_name(ConnectionWithAccess.mprd);
                //RepFrom.Value = Convert.ToDateTime(ConnectionWithAccess.msdate);
                //RepTo.Value = Convert.ToDateTime(ConnectionWithAccess.medate);
            }
            catch (Exception ex)
            { }
            periodgridview.Visible = false;
            load_all_period_values();
            ToolStripStatusPeriod.Text = ConnectionWithAccess.mprd.ToString() + "  " + ConnectionWithAccess.msdate + "  To  " + ConnectionWithAccess.medate.ToString();
        }

        # region datagridview
        private void sort_datewise_datagridview(DataGridView mDataGridView, string mgridviewname, int sort_column, int date_column)
        {
            for (int i = 0; i < mDataGridView.Rows.Count; i++)
            {
                if (mDataGridView.Rows[i].Cells[date_column].Value != null && mDataGridView.Rows[i].Cells[date_column].Value.ToString() != "")
                {
                    temp_word2 = mDataGridView.Rows[i].Cells[date_column].Value.ToString();
                    //temp_word = "07/08/2012";
                    //temp_word = mDataGridView.Rows[i].Cells[date_column].Value.ToString();
                    temp_word = temp_word2.Substring(temp_word2.Length - 4, 4);
                    temp_word += temp_word2.Substring(temp_word2.IndexOf("/") + 1, temp_word2.IndexOf("/"));
                    if (temp_word.Substring(temp_word2.IndexOf("/") + 1, temp_word2.IndexOf("/")).Length == 1)
                        temp_word += "0";
                    temp_word += temp_word2.Substring(0, temp_word2.IndexOf("/"));
                    int slash_posi = mDataGridView.Rows[i].Cells[date_column].Value.ToString().IndexOf("/");
                    if (mgridviewname == "Bankrep")
                    {
                        temp_word = temp_word.Trim();
                        temp_word = temp_word + mDataGridView.Rows[i].Cells[10].Value.ToString();
                    }
                    mDataGridView.Rows[i].Cells[sort_column].Value = temp_word.Trim();
                }
            }
            mDataGridView.Columns[sort_column].SortMode = DataGridViewColumnSortMode.Programmatic;
            mDataGridView.Sort(mDataGridView.Columns[sort_column], ListSortDirection.Ascending);
            temporary_datagridview_data = new string[mDataGridView.Rows.Count];
            column_counter = mDataGridView.ColumnCount;
            for (row_pointer = 0; row_pointer < mDataGridView.Rows.Count; row_pointer++)
            {
                temp_word = null;
                for (column_pointer = 0; column_pointer < column_counter; column_pointer++)
                {
                    if (mDataGridView.Rows[row_pointer].Cells[column_pointer].Value != null)
                    {
                        temp_word = temp_word + mDataGridView.Rows[row_pointer].Cells[column_pointer].Value.ToString().Trim() + " ,";
                    }
                    else
                        temp_word = temp_word + " ,";
                }
                if (temp_word.Length > column_counter)
                    temporary_datagridview_data[row_pointer] = temp_word.Trim();
            }
            int new_row;
            new_row = 0;
            mDataGridView.Rows.Clear();
            mDataGridView.Columns[sort_column].SortMode = DataGridViewColumnSortMode.NotSortable;
            for (row_pointer = 0; row_pointer < temporary_datagridview_data.Count(); row_pointer++)
            {
                if (temporary_datagridview_data[row_pointer] != null)
                {
                    mDataGridView.Rows.Add();
                    word = temporary_datagridview_data[row_pointer];
                    var cellArray = word.Split(new[] { ',' });
                    for (column_pointer = 0; column_pointer < column_counter; column_pointer++)
                    {
                        mDataGridView.Rows[new_row].Cells[column_pointer].Value = cellArray[column_pointer];
                    }
                    new_row++;
                }
            }
            mDataGridView.Columns[sort_column].Visible = false;
        }

        private void sort_numberwise_datagridview(DataGridView mDataGridView, int sort_column, int number_column)
        {
            temp_int = 0;
            for (int i = 0; i < mDataGridView.Rows.Count; i++)
            {
                if (mDataGridView.Rows[i].Cells[number_column].Value != null)
                {
                    if (mDataGridView.Rows[i].Cells[number_column].Value.ToString() != "")
                    {
                        if (Convert.ToInt32(mDataGridView.Rows[i].Cells[number_column].Value.ToString()) > temp_int)
                            temp_int = Convert.ToInt32(mDataGridView.Rows[i].Cells[number_column].Value.ToString());
                    }
                }
            }
            temp_word = Convert.ToString(temp_int);
            for (int i = 0; i < mDataGridView.Rows.Count; i++)
            {
                if (mDataGridView.Rows[i].Cells[number_column].Value != null)
                {
                    temp_int = mDataGridView.Rows[i].Cells[number_column].Value.ToString().Length;
                    temp_word2 = null;
                    if (temp_int < temp_word.Length)
                    {
                        for (int j = 0; j < temp_word.Length - temp_int; j++)
                        {
                            temp_word2 = temp_word2 + "0";
                        }
                        //mDataGridView.Rows[i].Cells[sort_column].Value = temp_word2 + mDataGridView.Rows[i].Cells[date_column].Value.ToString();
                    }
                    mDataGridView.Rows[i].Cells[sort_column].Value = temp_word2 + mDataGridView.Rows[i].Cells[number_column].Value.ToString();
                }
            }
            mDataGridView.Columns[sort_column].SortMode = DataGridViewColumnSortMode.Programmatic;
            mDataGridView.Sort(mDataGridView.Columns[sort_column], ListSortDirection.Ascending);
            temporary_datagridview_data = new string[mDataGridView.Rows.Count];
            column_counter = mDataGridView.ColumnCount;
            for (row_pointer = 0; row_pointer < mDataGridView.Rows.Count; row_pointer++)
            {
                temp_word = null;
                for (column_pointer = 0; column_pointer < column_counter; column_pointer++)
                {
                    if (mDataGridView.Rows[row_pointer].Cells[column_pointer].Value != null)
                        temp_word = temp_word + mDataGridView.Rows[row_pointer].Cells[column_pointer].Value.ToString().Trim() + " ,";
                    else
                        temp_word = temp_word + " ,";
                }
                if (temp_word.Length > column_counter)
                    temporary_datagridview_data[row_pointer] = temp_word.Trim();
            }
            int new_row;
            new_row = 0;
            mDataGridView.Rows.Clear();
            mDataGridView.Columns[sort_column].SortMode = DataGridViewColumnSortMode.NotSortable;
            for (row_pointer = 0; row_pointer < temporary_datagridview_data.Count(); row_pointer++)
            {
                if (temporary_datagridview_data[row_pointer] != null)
                {
                    mDataGridView.Rows.Add();
                    word = temporary_datagridview_data[row_pointer];
                    var cellArray = word.Split(new[] { ',' });
                    for (column_pointer = 0; column_pointer < column_counter; column_pointer++)
                    {
                        mDataGridView.Rows[new_row].Cells[column_pointer].Value = cellArray[column_pointer];
                    }
                    new_row++;
                }
            }
            mDataGridView.Columns[sort_column].Visible = false;
        }
        # endregion

        private void add_tax_list_to_sale_purchase_gridview()
        {
            dgv_tax_report.Visible = true;
            dgv_tax_report.Rows.Clear();
            if (cbRepType.Text == "Sale")
            {
                //f30.d_c = '" + cbrep_ana_d_c.Text
                ConnectionWithAccess.query = "select F6.TaX_Rate, f6.[Desc], sum(f21.bamt) as 'BAmount', sum(f21.tamt) as 'TAmount',  sum(f21.gamt) as 'GAmount' from " + ConnectionWithAccess.tablename[21] + " f21 inner join " + ConnectionWithAccess.tablename[06] + " f6 on f21.tx_code = f6.tx_code and f21.d_c = f6.d_c where f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_c = " + cbrep_ana_d_c.Text + " and f21.d_d >= @From and f21.d_d <= @To group by f6.tax_rate, f6.[desc]";
            }
            else
                ConnectionWithAccess.query = "select F6.TaX_Rate, f6.[Desc], sum(f22.bamt) as 'BAmount', sum(f22.tamt) as 'TAmount',  sum(f22.gamt) as 'GAmount' from " + ConnectionWithAccess.tablename[22] + " f22 inner join " + ConnectionWithAccess.tablename[06] + " f6 on f22.tx_code = f6.tx_code and f22.d_c = f6.d_c     where f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To group by f6.tax_rate, f6.[desc]";

            parameters_for_date_range(RepFrom.Text, RepTo.Text);

            ConnectionCommand.accountHelp_datatable_Seperate(dgv_tax_report, "dgv_tax_report");
            dgv_tax_report.Columns[0].HeaderText = "Tax Code";
            dgv_tax_report.Columns[1].HeaderText = "Desc";
            dgv_tax_report.Columns[2].HeaderText = "Basic Amount";
            dgv_tax_report.Columns[3].HeaderText = "Tax Amount";
            dgv_tax_report.Columns[4].HeaderText = "Gross Amount";
        }

        # region fadd_totals

        public void delete_old_date_record_from_bank_cash(DataGridView mDataGridView, int column_pointer, string before_date)
        {
            temp_double = 0;
            temp_int = 0;
            for (row_pointer = 0; row_pointer < mDataGridView.RowCount; row_pointer++)
            {
                if (mDataGridView.Rows[row_pointer].Cells[column_pointer].Value != null)
                {
                    temp_word = mDataGridView.Rows[row_pointer].Cells[column_pointer].Value.ToString().Trim();
                    if (temp_word != null && temp_word != "")
                    {
                        if (Convert.ToDateTime(temp_word) < Convert.ToDateTime(before_date))
                        {
                            //mDataGridView.Rows.RemoveAt(mDataGridView.SelectedRows[0].Index);
                            if (mDataGridView.Rows[row_pointer].Cells[4].Value != null && mDataGridView.Rows[row_pointer].Cells[4].Value.ToString() != "")
                            {
                                temp_double = temp_double + Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[4].Value);
                                mDataGridView.Rows[row_pointer].Cells[4].Value = 0;
                                mDataGridView.Rows[row_pointer].Cells[1].Value = 0;
                            }
                            if (mDataGridView.Rows[row_pointer].Cells[5].Value != null && mDataGridView.Rows[row_pointer].Cells[5].Value.ToString() != "")
                            {
                                temp_double = temp_double - Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[5].Value);
                                mDataGridView.Rows[row_pointer].Cells[5].Value = 0;
                            }
                            if (mDataGridView.Rows[row_pointer].Cells[6].Value != null && mDataGridView.Rows[row_pointer].Cells[6].Value.ToString() != "")
                                mDataGridView.Rows[row_pointer].Cells[6].Value = 0;
                            temp_int = row_pointer;
                        }
                    }
                }
            }
            mDataGridView.Rows[temp_int].Cells[1].Value = 0;
            mDataGridView.Rows[temp_int].Cells[column_pointer].Value = before_date;
            mDataGridView.Rows[temp_int].Cells[2].Value = "Open";
            //            mDataGridView.Rows[temp_int].Cells[5].Value = "";
            mDataGridView.Rows[temp_int].Cells[6].Value = Convert.ToString(Convert.ToInt32(temp_double));
            for (row_pointer = 0; row_pointer < mDataGridView.RowCount; row_pointer++)
            {
                if (mDataGridView.Rows[row_pointer].Cells[6].Value != null)
                {
                    temp_word = mDataGridView.Rows[row_pointer].Cells[4].Value.ToString();
                    temp_word1 = mDataGridView.Rows[row_pointer].Cells[5].Value.ToString();
                    temp_word2 = mDataGridView.Rows[row_pointer].Cells[6].Value.ToString();
                    if (temp_word == "0" && temp_word1 == "0" && temp_word2 == "0")
                    {
                        //mDataGridView.Rows.RemoveAt(mDataGridView.Rows[row_pointer].Index);
                        mDataGridView.Rows.RemoveAt(row_pointer);
                    }
                }
            }
            mDataGridView.Refresh();
        }

        private void fAdd_Bank_Report_Totals(string strSortColumnOrder)
        {
            if (gdvreport.DataSource != null && gdvreport.Rows.Count > 0)
            {
                if (Convert.ToDateTime(RepFrom.Text) > Convert.ToDateTime(ConnectionWithAccess.msdate))
                    delete_old_date_record_from_bank_cash(gdvreport, 0, RepFrom.Text);
                DataTable dtNewTable = ((DataTable)gdvreport.DataSource).Clone();
                dtNewTable = ((DataTable)gdvreport.DataSource);
                //DataTable selected = view.ToTable(false, "amt");
                if (dtNewTable != null)
                {
                    DataView view = new DataView(dtNewTable);
                    view.Sort = strSortColumnOrder;
                    DataTable dtNewTable1 = view.ToTable();
                    DataTable sortedTable = update_datatable_balances(dtNewTable1, 4, 5, 6);
                    string strTotalCol1 = getTotal_Datatable(sortedTable, 4);
                    string strTotalCol2 = getTotal_Datatable(sortedTable, 5);
                    if (!string.IsNullOrEmpty(strTotalCol1) && !string.IsNullOrEmpty(strTotalCol2))
                    {
                        DataRow drTotalRow = sortedTable.NewRow();
                        drTotalRow[4] = strTotalCol1;
                        drTotalRow[5] = strTotalCol2;
                        sortedTable.Rows.Add(drTotalRow);
                    }
                    gdvreport.DataSource = null;
                    gdvreport.DataSource = sortedTable;// dtNewTable.DefaultView;

                    //DataTable dtNewTable = ((DataTable)LedDGV.DataSource).Clone();

                    //dtNewTable = ((DataTable)LedDGV.DataSource);

                    ////DataTable selected = view.ToTable(false, "amt");

                    //if (dtNewTable != null)
                    //{
                    //    //for (int i = dtNewTable.Rows.Count - 1; i >= 0; i--)
                    //    //{
                    //    //    DataRow dr = dtNewTable.Rows[i];
                    //    //    if (dr["debit"].ToString() == "" && dr["credit"].ToString() == "" && dr["balance"].ToString() == "")
                    //    //        dr.Delete();
                    //    //}
                    //    DataView view = new DataView(dtNewTable);
                    //    view.Sort = "[Date] asc";
                    //    DataTable dtNewTable1 = view.ToTable();

                    //    //DataTable dtNewTable1 = ((DataTable)LedDGV.DataSource).Clone();

                    //    DataTable sortedTable = update_datatable_balances(dtNewTable1, 6, 7, 8);

                    //    string strTotalCol1 = getTotal_Datatable(sortedTable, 6);
                    //    string strTotalCol2 = getTotal_Datatable(sortedTable, 7);

                    //    if (!string.IsNullOrEmpty(strTotalCol1) && !string.IsNullOrEmpty(strTotalCol2))
                    //    {
                    //        DataRow drTotalRow = sortedTable.NewRow();
                    //        drTotalRow[6] = strTotalCol1;
                    //        drTotalRow[7] = strTotalCol2;
                    //        sortedTable.Rows.Add(drTotalRow);
                    //    }

                    //    LedDGV.DataSource = null;
                    //    LedDGV.DataSource = sortedTable;// dtNewTable.DefaultView;
                    //}
                    //ConnectionCommand.hide_columns_of_datagridview(LedDGV, "0,1,2");
                    //LedDGV.FirstDisplayedScrollingRowIndex = LedDGV.Rows.Count - 2;
                    //excel_filename = "Ledger of_" + tb_ledger_account_name.Text.Trim() + "_" + rla_n.Text + "_" + rls_a.Text + "_as on_" + ConnectionWithAccess.mprd;
                    //ledger_filename = excel_filename;
                    //ConnectionWithAccess.export(LedDGV, excel_filename);
                    //generate_ledger_report();
                }
            }
        }

        private void fAdd_cash_Report_Totals(string strSortColumnOrder)
        {
            if (gdvreport.DataSource != null && gdvreport.Rows.Count > 0)
            {
                if (Convert.ToDateTime(RepFrom.Text) > Convert.ToDateTime(ConnectionWithAccess.msdate))
                    delete_old_date_record_from_bank_cash(gdvreport, 0, RepFrom.Text);
                DataTable dtNewTable = ((DataTable)gdvreport.DataSource).Clone();
                dtNewTable = ((DataTable)gdvreport.DataSource);
                //DataTable selected = view.ToTable(false, "amt");
                if (dtNewTable != null)
                {
                    DataView view = new DataView(dtNewTable);
                    view.Sort = strSortColumnOrder;
                    DataTable dtNewTable1 = view.ToTable();
                    DataTable sortedTable = update_datatable_balances(dtNewTable1, 4, 5, 6);
                    string strTotalCol1 = getTotal_Datatable(sortedTable, 4);
                    string strTotalCol2 = getTotal_Datatable(sortedTable, 5);
                    if (!string.IsNullOrEmpty(strTotalCol1) && !string.IsNullOrEmpty(strTotalCol2))
                    {
                        DataRow drTotalRow = sortedTable.NewRow();
                        drTotalRow[4] = strTotalCol1;
                        drTotalRow[5] = strTotalCol2;
                        sortedTable.Rows.Add(drTotalRow);
                    }
                    gdvreport.DataSource = null;
                    gdvreport.DataSource = sortedTable;// dtNewTable.DefaultView;
                }
            }
        }

        private void fAdd_Sale_Report_Totals(string strSortColumnOrder)
        {
            if (gdvreport.DataSource != null && gdvreport.Rows.Count > 0)
            {
                DataTable dtReport = (DataTable)gdvreport.DataSource;
                if (dtReport != null && dtReport.Rows.Count > 0)
                {

                    DataColumn dtCol = new DataColumn("SortOrder");
                    dtReport.Columns.Add(dtCol);

                    DataRow drTotalRow = dtReport.NewRow();

                    string strPaymentTotal = dtReport.Compute("Sum(gamt)", "").ToString();
                    drTotalRow[4] = "Total";
                    drTotalRow[5] = strPaymentTotal;
                    drTotalRow[9] = "1";

                    dtReport.Rows.Add(drTotalRow);

                    dtReport.DefaultView.Sort = "SortOrder ASC, " + strSortColumnOrder;

                    gdvreport.DataSource = null;
                    gdvreport.DataSource = dtReport;
                    gdvreport.Columns["SortOrder"].Visible = false;
                }
            }
        }

        private void fAdd_trial_balance_Report_Totals()
        {
            if (BalShDGV.DataSource != null && BalShDGV.Rows.Count > 0)
            {
                DataTable dtReport = (DataTable)BalShDGV.DataSource;
                if (dtReport != null && dtReport.Rows.Count > 0)
                {

                    DataColumn dtCol = new DataColumn("SortOrder");
                    dtReport.Columns.Add(dtCol);

                    DataRow drTotalRow = dtReport.NewRow();

                    string strDebitTotal = dtReport.Compute("Sum(amt_debit)", "").ToString();
                    string strCreditTotal = dtReport.Compute("Sum(amt_credit)", "").ToString();
                    strDebitTotal = Math.Round(Convert.ToDouble(strDebitTotal), 2).ToString();
                    strCreditTotal = Math.Round(Convert.ToDouble(strCreditTotal), 2).ToString();
                    if (Convert.ToDouble(strDebitTotal) > Convert.ToDouble(strCreditTotal))
                    {
                        drTotalRow[2] = "Difference";
                        drTotalRow[4] = Math.Round(Convert.ToDouble(strDebitTotal) - Convert.ToDouble(strCreditTotal), 2);
                        dtReport.Rows.Add(drTotalRow);
                    }
                    else if (Convert.ToDouble(strDebitTotal) < Convert.ToDouble(strCreditTotal))
                    {
                        drTotalRow[2] = "Difference";
                        drTotalRow[3] = Math.Round(Convert.ToDouble(strCreditTotal) - Convert.ToDouble(strDebitTotal), 2);
                        dtReport.Rows.Add(drTotalRow);
                    }
                    drTotalRow = dtReport.NewRow();
                    strDebitTotal = dtReport.Compute("Sum(amt_debit)", "").ToString();
                    strCreditTotal = dtReport.Compute("Sum(amt_credit)", "").ToString();
                    strDebitTotal = Math.Round(Convert.ToDouble(strDebitTotal), 2).ToString();
                    strCreditTotal = Math.Round(Convert.ToDouble(strCreditTotal), 2).ToString();
                    drTotalRow[2] = "Total";
                    drTotalRow[3] = strDebitTotal;
                    drTotalRow[4] = strCreditTotal;

                    drTotalRow["SortOrder"] = "0";

                    dtReport.Rows.Add(drTotalRow);
                    dtReport.DefaultView.Sort = "SortOrder ASC ";

                    BalShDGV.DataSource = null;
                    BalShDGV.DataSource = dtReport;
                    BalShDGV.Columns["SortOrder"].Visible = false;
                }
            }
        }

        private void fAdd_Trading_Report_Totals()
        {
            if (BalShDGV.DataSource != null && BalShDGV.Rows.Count > 0)
            {
                DataTable dtReport = (DataTable)BalShDGV.DataSource;
                if (dtReport != null && dtReport.Rows.Count > 0)
                {

                    DataColumn dtCol = new DataColumn("SortOrder");
                    dtReport.Columns.Add(dtCol);

                    DataRow drTotalRow = dtReport.NewRow();

                    string strDebitTotal = dtReport.Compute("Sum(amt_debit)", "").ToString();
                    string strCreditTotal = dtReport.Compute("Sum(amt_credit)", "").ToString();

                    drTotalRow[3] = "Total";
                    drTotalRow[5] = strDebitTotal;
                    drTotalRow[6] = "Total";
                    drTotalRow[8] = strCreditTotal;
                    drTotalRow["SortOrder"] = "1";

                    dtReport.Rows.Add(drTotalRow);
                    dtReport.DefaultView.Sort = "SortOrder ASC ";

                    BalShDGV.DataSource = null;
                    BalShDGV.DataSource = dtReport;
                    BalShDGV.Columns["SortOrder"].Visible = false;
                }
            }
        }

        private void fAdd_ProfitLoss_Report_Totals()
        {
            if (BalShDGV.DataSource != null && BalShDGV.Rows.Count > 0)
            {
                DataTable dtReport = (DataTable)BalShDGV.DataSource;
                if (dtReport != null && dtReport.Rows.Count > 0)
                {

                    DataColumn dtCol = new DataColumn("SortOrder");
                    dtReport.Columns.Add(dtCol);

                    DataRow drTotalRow = dtReport.NewRow();

                    string strDebitTotal = dtReport.Compute("Sum(amt_debit)", "").ToString();
                    string strCreditTotal = dtReport.Compute("Sum(amt_credit)", "").ToString();

                    drTotalRow[3] = "Total";
                    drTotalRow[5] = strDebitTotal;
                    drTotalRow[6] = "Total";
                    drTotalRow[8] = strCreditTotal;
                    drTotalRow["SortOrder"] = "1";

                    dtReport.Rows.Add(drTotalRow);
                    dtReport.DefaultView.Sort = "SortOrder ASC ";

                    BalShDGV.DataSource = null;
                    BalShDGV.DataSource = dtReport;
                    BalShDGV.Columns["SortOrder"].Visible = false;
                }
            }
        }

        private void fAdd_CapitalAccount_Report_Totals()
        {
            if (BalShDGV.DataSource != null && BalShDGV.Rows.Count > 0)
            {
                DataTable dtReport = (DataTable)BalShDGV.DataSource;
                if (dtReport != null && dtReport.Rows.Count > 0)
                {

                    DataColumn dtCol = new DataColumn("SortOrder");
                    dtReport.Columns.Add(dtCol);

                    DataRow drTotalRow = dtReport.NewRow();

                    string strDebitTotal = dtReport.Compute("Sum(amt_debit)", "").ToString();
                    string strCreditTotal = dtReport.Compute("Sum(amt_credit)", "").ToString();

                    drTotalRow[3] = "Total";
                    drTotalRow[5] = strDebitTotal;
                    drTotalRow[6] = "Total";
                    drTotalRow[8] = strCreditTotal;
                    drTotalRow["SortOrder"] = "1";

                    dtReport.Rows.Add(drTotalRow);
                    dtReport.DefaultView.Sort = "SortOrder ASC ";

                    BalShDGV.DataSource = null;
                    BalShDGV.DataSource = dtReport;
                    BalShDGV.Columns["SortOrder"].Visible = false;
                }
            }
        }

        private void fAdd_Balance_Report_Totals()
        {
            if (BalShDGV.DataSource != null && BalShDGV.Rows.Count > 0)
            {
                DataTable dtReport = (DataTable)BalShDGV.DataSource;
                if (dtReport != null && dtReport.Rows.Count > 0)
                {

                    DataColumn dtCol = new DataColumn("SortOrder");
                    dtReport.Columns.Add(dtCol);

                    DataRow drTotalRow = dtReport.NewRow();

                    string strDebitTotal = dtReport.Compute("Sum(amt_debit)", "").ToString();
                    string strCreditTotal = dtReport.Compute("Sum(amt_credit)", "").ToString();

                    drTotalRow[3] = "Total";
                    drTotalRow[5] = strDebitTotal;
                    drTotalRow[6] = "Total";
                    drTotalRow[8] = strCreditTotal;
                    drTotalRow["SortOrder"] = "1";

                    dtReport.Rows.Add(drTotalRow);
                    dtReport.DefaultView.Sort = "SortOrder ASC ";

                    BalShDGV.DataSource = null;
                    BalShDGV.DataSource = dtReport;
                    BalShDGV.Columns["SortOrder"].Visible = false;
                }
            }
        }

        private void fAdd_total_row(DataGridView mDataGridView, string column_name, int column_number, string strSortColumnOrder)
        {
            if (mDataGridView.DataSource != null && mDataGridView.Rows.Count > 0)
            {
                int mtotal_columns;
                mtotal_columns = mDataGridView.Columns.Count;
                DataTable dtReport = (DataTable)mDataGridView.DataSource;
                if (dtReport != null && dtReport.Rows.Count > 0)
                {
                    DataColumn dtCol = new DataColumn("SortOrder");
                    dtReport.Columns.Add(dtCol);

                    DataRow drTotalRow = dtReport.NewRow();

                    string strPaymentTotal = dtReport.Compute("Sum(" + dtReport.Columns[column_number] + ")", "").ToString();
                    drTotalRow[column_number - 1] = "Total";
                    drTotalRow[column_number] = strPaymentTotal;
                    drTotalRow[mtotal_columns] = "1";

                    dtReport.Rows.Add(drTotalRow);

                    dtReport.DefaultView.Sort = "SortOrder ASC, " + strSortColumnOrder;

                    mDataGridView.DataSource = null;
                    mDataGridView.DataSource = dtReport;
                    mDataGridView.Columns["SortOrder"].Visible = false;
                }
            }
        }
        # endregion

        private void Generate_Click_1(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data");
            objPleaseWait.Show();
            Application.DoEvents();
            pb_rep_ana_printer.Visible = true;
            Generate.Visible = false;
            gdvreport.Visible = true;
            gdvreport.Size = new System.Drawing.Size(960, 372);
            if (cbRepType.Text == "Sale")
            {
                if (cbRepSubType.Text == "Invoice" && cbRepFormat.Text == "Document Wise")
                {
                    if (AFAnalysis.tbselacc.Text == "0 Selected" && AFAnalysis.tbreportcity.Text == "0 Selected" && AFAnalysis.tbreprotArea.Text == "0 Selected" && AFAnalysis.tbreportitems.Text == "0 Selected" && AFAnalysis.tbreporttax.Text == "0 Selected")
                        ConnectionWithAccess.query = "select f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt,f21.d_c,f21.a_n,f21.s_a from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f21.d_c = " + cbrep_ana_d_c.Text + " order by d_d,d_n ";
                    else
                    {
                        if (AFAnalysis.tbselacc.Text != "0 Selected")
                            ConnectionWithAccess.query = "select f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt,f21.d_c,f21.a_n,f21.s_a  from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f21.a_n = '" + raa_n.Text + "' and f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f1.[desc] in (" + AFAnalysis.selectedPartyList + ")  and f1.city in (" + AFAnalysis.selectedPartyCityList + ") and f21.d_c = " + cbrep_ana_d_c.Text + " order by d_d,d_n ";
                        else if (AFAnalysis.tbreportcity.Text != "0 Selected")
                            ConnectionWithAccess.query = "select f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt,f21.d_c,f21.a_n,f21.s_a  from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f21.a_n = '" + raa_n.Text + "' and f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f1.city in (" + AFAnalysis.selectedCityList + ") and f21.d_c = " + cbrep_ana_d_c.Text + " order by d_d,d_n ";
                        else if (AFAnalysis.tbreprotArea.Text != "0 Selected")
                            ConnectionWithAccess.query = "select f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt,f21.d_c,f21.a_n,f21.s_a  from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21, " + ConnectionWithAccess.tablename[02] + " f2 where f21.a_n = '" + raa_n.Text + "' and f1.a_n = f21.a_n and f1.s_a = f21.s_a and f2.city = f1.city and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f2.Area_code in (" + AFAnalysis.selectedAreaList + ") and f21.d_c = " + cbrep_ana_d_c.Text + " order by d_d,d_n ";
                        else if (AFAnalysis.tbreporttax.Text != "0 Selected")
                            ConnectionWithAccess.query = "select f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt,f21.d_c,f21.a_n,f21.s_a  from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f21.a_n = '" + raa_n.Text + "' and f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f21.tx_code in (" + AFAnalysis.selectedTaxList + ") and f21.d_c = " + cbrep_ana_d_c.Text + " order by d_d,d_n ";
                    }

                    //tbreportfromamt and  tbreporttoamt not used
                    //if (tbselacc.Text == "0 Selected" && tbreportcity.Text == "0 Selected" && tbreportitems.Text == "0 Selected" && tbreporttax.Text == "0 Selected")
                    //    ConnectionWithAccess.query = "select f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt,f21.d_c,f21.a_n,f21.s_a from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f21.d_c = " + cbrep_ana_d_c.Text;
                    //else
                    //{
                    //    if (tbselacc.Text != "0 Selected")
                    //        ConnectionWithAccess.query = "select f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f21.a_n = '" + raa_n.Text + "' and f1.a_n = f21.a_n and f1.s_a = f21.s_a f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f1.[desc] in (" + selectedpartyname + ")  and f1.city in (" + selectedpartycity + ") and f21.d_c = " + cbrep_ana_d_c.Text;
                    //    else if (tbreportcity.Text != "0 Selected")
                    //        ConnectionWithAccess.query = "select f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f21.a_n = '" + raa_n.Text + "' and f1.a_n = f21.a_n and f1.s_a = f21.s_a f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f1.city in (" + selectedcitylist + ") and f21.d_c = " + cbrep_ana_d_c.Text;
                    //    else if (tbreporttax.Text != "0 Selected")
                    //        ConnectionWithAccess.query = "select f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f21.a_n = '" + raa_n.Text + "' and f1.a_n = f21.a_n and f1.s_a = f21.s_a f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f21.tx_code in (" + selectedtaxlist + ") and f21.d_c = " + cbrep_ana_d_c.Text;
                    //}
                    excel_filename = "Sale List as on " + ConnectionWithAccess.mprd;
                }
                else if (cbRepSubType.Text == "Invoice" && cbRepFormat.Text == "Party Wise")
                {
                    ConnectionWithAccess.query = "select f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f21.a_n = '" + raa_n.Text + "' and f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f21.d_c = " + cbrep_ana_d_c.Text + " order by d_d,d_n ";
                    excel_filename = "Party Wise Sale List as on " + ConnectionWithAccess.mprd;
                }
                else if (cbRepSubType.Text == "Invoice" && cbRepFormat.Text == "Item Wise")
                {
                    ConnectionWithAccess.query = "select f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f21.a_n = '" + raa_n.Text + "' and f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f21.d_c = " + cbrep_ana_d_c.Text + " order by d_d,d_n ";
                    excel_filename = "Item Wise Sale List as on " + ConnectionWithAccess.mprd;
                }
                else if (cbRepSubType.Text == "Invoice" && cbRepFormat.Text == "Tax Sheet")
                {
                    ConnectionWithAccess.query = "select f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f21.a_n = '" + raa_n.Text + "' and f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f21.d_c = " + cbrep_ana_d_c.Text + " order by d_d,d_n ";
                    excel_filename = "Tax List as on " + ConnectionWithAccess.mprd;
                }
                else if (cbRepSubType.Text == "Replacement" && cbRepFormat.Text == "Document Wise")
                {
                    ConnectionWithAccess.query = "select distinct f30.D_D, f30.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f30.bamt, f30.tamt, f30.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[30] + " f30, " + ConnectionWithAccess.tablename[04] + " f4 where f21.a_n = '" + raa_n.Text + "' and  f1.a_n = f30.a_n and f1.s_a = f30.s_a and IsNull(f1.d_y) = IsNull(f4.d_y) and f6.tx_code = f30.tx_code and f4.a_n = f21.a_n and f4.s_a = f21.s_a and f30.prd = '" + ConnectionWithAccess.mprd + "' and f30.d_d >= @From and f30.d_d <= @To and f30.d_c = " + cbrep_ana_d_c.Text + " and f4.a_n = f30.a_n and f4.s_a = f30.s_a order by f30.d_d,f30.d_n";
                    excel_filename = "Document Wise as on " + ConnectionWithAccess.mprd;
                }
                else if (cbRepSubType.Text == "Brief with Items")
                {
                    if (AFAnalysis.tbselacc.Text == "0 Selected" && AFAnalysis.tbreportcity.Text == "0 Selected" && AFAnalysis.tbreportitems.Text == "0 Selected" && AFAnalysis.tbreporttax.Text == "0 Selected")
                        ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.bamt, f21.tamt, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f21.a_n = '" + raa_n.Text + "' and f1.s_a = f21.s_a  and f6.tx_code = f21.tx_code and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f4.a_n = f21.a_n and f4.s_a = f21.s_a order by f21.d_d,f21.d_n";
                    else
                    {
                        if (AFAnalysis.tbselacc.Text != "0 Selected")
                            ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.bamt, f21.tamt, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and  f21.a_n = '" + raa_n.Text + "' and f1.s_a = f21.s_a  and f6.tx_code = f21.tx_code and f4.a_n = f21.a_n and f4.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f1.[desc] in (" + AFAnalysis.selectedPartyList + ") and f21.d_c = " + cbrep_ana_d_c.Text + " order by f21.d_n";
                        else if (AFAnalysis.tbreportcity.Text != "0 Selected")
                            ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.bamt, f21.tamt, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and  f21.a_n = '" + raa_n.Text + "' and f1.s_a = f21.s_a  and f6.tx_code = f21.tx_code and f4.a_n = f21.a_n and f4.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f1.city in (" + AFAnalysis.selectedCityList + ") and f21.d_c = " + cbrep_ana_d_c.Text + " order by f21.d_n";
                        else if (AFAnalysis.tbreporttax.Text != "0 Selected")
                            ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.bamt, f21.tamt, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and  f21.a_n = '" + raa_n.Text + "' and f1.s_a = f21.s_a  and f6.tx_code = f21.tx_code and f4.a_n = f21.a_n and f4.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f21.tx_code in (" + AFAnalysis.selectedTaxList + ") and f21.d_c = " + cbrep_ana_d_c.Text + " order by f21.d_n";
                    }
                    //if (tbselacc.Text == "0 Selected" && tbreportcity.Text == "0 Selected" && tbreportitems.Text == "0 Selected" && tbreporttax.Text == "0 Selected")
                    //    ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.bamt, f21.tamt, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f21.a_n = '" + raa_n.Text + "' and f1.s_a = f21.s_a  and f6.tx_code = f21.tx_code and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f4.a_n = f21.a_n and f4.s_a = f21.s_a order by f21.d_n";
                    //else
                    //{
                    //    if (tbselacc.Text != "0 Selected")
                    //        ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.bamt, f21.tamt, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and  f21.a_n = '" + raa_n.Text + "' and f1.s_a = f21.s_a  and f6.tx_code = f21.tx_code and f4.a_n = f21.a_n and f4.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f1.[desc] in (" + selectedpartyname + ") and f21.d_c = " + cbrep_ana_d_c.Text + " order by f21.d_n";
                    //    else if (tbreportcity.Text != "0 Selected")
                    //        ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.bamt, f21.tamt, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and  f21.a_n = '" + raa_n.Text + "' and f1.s_a = f21.s_a  and f6.tx_code = f21.tx_code and f4.a_n = f21.a_n and f4.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f1.city in (" + selectedcitylist + ") and f21.d_c = " + cbrep_ana_d_c.Text + " order by f21.d_n";
                    //    else if (tbreporttax.Text != "0 Selected")
                    //        ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.bamt, f21.tamt, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and  f21.a_n = '" + raa_n.Text + "' and f1.s_a = f21.s_a  and f6.tx_code = f21.tx_code and f4.a_n = f21.a_n and f4.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f21.tx_code in (" + selectedtaxlist + ") and f21.d_c = " + cbrep_ana_d_c.Text + " order by f21.d_n";
                    //}
                    excel_filename = "Brief Sale with Items as on " + ConnectionWithAccess.mprd;
                }
                else if (cbRepSubType.Text == "Balance")
                {
                    if (AFAnalysis.tbselacc.Text == "0 Selected" && AFAnalysis.tbreportcity.Text == "0 Selected" && AFAnalysis.tbreportitems.Text == "0 Selected" && AFAnalysis.tbreporttax.Text == "0 Selected")
                        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@'";
                    else
                    {
                        if (AFAnalysis.tbselacc.Text != "0 Selected")
                            ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f1.[desc] in (" + AFAnalysis.selectedPartyList + ")";
                        else if (AFAnalysis.tbreportcity.Text != "0 Selected")
                            ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f1.city in (" + AFAnalysis.selectedCityList + ")";
                        else if (AFAnalysis.tbreporttax.Text != "0 Selected")
                            ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f1.tx_code in (" + AFAnalysis.selectedTaxList + ")";
                    }
                    //if (tbselacc.Text == "0 Selected" && tbreportcity.Text == "0 Selected" && tbreportitems.Text == "0 Selected" && tbreporttax.Text == "0 Selected")
                    //    ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@'";
                    //else
                    //{
                    //    if (tbselacc.Text != "0 Selected")
                    //        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f1.[desc] in (" + selectedpartyname + ")";
                    //    else if (tbreportcity.Text != "0 Selected")
                    //        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f1.city in (" + selectedcitylist + ")";
                    //    else if (tbreporttax.Text != "0 Selected")
                    //        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f1.tx_code in (" + selectedtaxlist + ")";
                    //}
                    excel_filename = "Debitors Outsanding List_" + ConnectionWithAccess.mprd;

                }
                parameters_for_date_range(RepFrom.Text, RepTo.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "SaleList", "d_d ASC");
                fAdd_Sale_Report_Totals("d_d ASC");

                if (gdvreport.Rows.Count > 1)
                {
                    //f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt
                    //gdvreport.DefaultCellStyle.Font = new System.Drawing.Font("Microsoft Sans Serif", 12);
                    gdvreport.Columns[0].HeaderText = "Date";
                    gdvreport.Columns[1].HeaderText = "Doc. No";
                    gdvreport.Columns[2].HeaderText = "Name";
                    gdvreport.Columns[3].HeaderText = "City";
                    gdvreport.Columns[4].HeaderText = "Gst Number";
                    gdvreport.Columns[5].HeaderText = "Gross Amt";
                    gdvreport.Columns[0].Width = 90;
                    gdvreport.Columns[1].Width = 75;
                    gdvreport.Columns[2].Width = 300;
                    gdvreport.Columns[3].Width = 175;
                    gdvreport.Columns[4].Width = 150;
                    gdvreport.Columns[5].Width = 110;
                    gdvreport.Columns[0].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.Columns[1].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.Columns[5].DefaultCellStyle.Format = "N2";
                    gdvreport.AllowUserToResizeColumns = false;
                    gdvreport.Columns[6].Visible = false;
                    gdvreport.Columns[7].Visible = false;
                    gdvreport.Columns[8].Visible = false;
                    gdvreport.FirstDisplayedScrollingRowIndex = gdvreport.Rows.Count - 2;
                    if (gdvreport.Rows.Count > 0)
                        excel_filename = "Mini Sale List as on " + ConnectionWithAccess.mprd;
                    ConnectionWithAccess.export(gdvreport, excel_filename);
                    if (cbRepSubType.Text == "Balance")
                        temp_word = " ";
                    //generate_sale_balance_report();
                    else
                        sale_purchase_report_list_mini();
                }
            }
            else if (cbRepType.Text == "Purchase")
            {
                gdvreport.Visible = true;
                if (cbRepSubType.Text == "Balance")
                {
                    gdvreport.Visible = false;
                    generate_sale_balance_report();

                    pdf_viewer1.LoadFile(pdf_filename);
                    pdf_viewer1.Visible = true;
                }
                else
                {
                    if (cbRepSubType.Text == "Invoice" && cbRepFormat.Text == "Document Wise")
                    {
                        if (AFAnalysis.tbselacc.Text == "0 Selected" && AFAnalysis.tbreportcity.Text == "0 Selected" && AFAnalysis.tbreportitems.Text == "0 Selected" && AFAnalysis.tbreporttax.Text == "0 Selected")
                            ConnectionWithAccess.query = "select f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.gamt, f22.d_c,f22.a_n,f22.s_a from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f22.d_c = " + cbrep_ana_d_c.Text + " order by f22.d_n";
                        else
                        {
                            if (AFAnalysis.tbselacc.Text != "0 Selected")
                                ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f1.[desc] in (" + AFAnalysis.selectedPartyList + ") and f22.d_c = " + cbrep_ana_d_c.Text;
                            else if (AFAnalysis.tbreportcity.Text != "0 Selected")
                                ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f1.city in (" + AFAnalysis.selectedCityList + ") and f22.d_c = " + cbrep_ana_d_c.Text;
                            else if (AFAnalysis.tbreporttax.Text != "0 Selected")
                                ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f22.tx_code in (" + AFAnalysis.selectedTaxList + ") and f22.d_c = " + cbrep_ana_d_c.Text;
                        }
                        //if (tbselacc.Text == "0 Selected" && tbreportcity.Text == "0 Selected" && tbreportitems.Text == "0 Selected" && tbreporttax.Text == "0 Selected")
                        //    ConnectionWithAccess.query = "select f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.gamt, f22.d_c,f22.a_n,f22.s_a from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f22.d_c = " + cbrep_ana_d_c.Text + " order by f22.d_n";
                        //else
                        //{
                        //    if (tbselacc.Text != "0 Selected")
                        //        ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f1.[desc] in (" + selectedpartyname + ") and f22.d_c = " + cbrep_ana_d_c.Text;
                        //    else if (tbreportcity.Text != "0 Selected")
                        //        ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f1.city in (" + selectedcitylist + ") and f22.d_c = " + cbrep_ana_d_c.Text;
                        //    else if (tbreporttax.Text != "0 Selected")
                        //        ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f22.tx_code in (" + selectedtaxlist + ") and f22.d_c = " + cbrep_ana_d_c.Text;
                        //}
                        excel_filename = "Document Wise Purchase List as on " + ConnectionWithAccess.mprd;
                    }
                    else if (cbRepSubType.Text == "Brief with Items")
                    {
                        if (AFAnalysis.tbselacc.Text == "0 Selected" && AFAnalysis.tbreportcity.Text == "0 Selected" && AFAnalysis.tbreportitems.Text == "0 Selected" && AFAnalysis.tbreporttax.Text == "0 Selected")
                            ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.bamt, f22.tamt, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f6.tx_code = f22.tx_code and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f4.a_n = f22.a_n and f4.s_a = f22.s_a order by f22.d_n";
                        else
                        {
                            if (AFAnalysis.tbselacc.Text != "0 Selected")
                                ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.bamt, f22.tamt, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f6.tx_code = f22.tx_code and f4.a_n = f22.a_n and f4.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f1.[desc] in (" + AFAnalysis.selectedPartyList + ") and f22.d_c = " + cbrep_ana_d_c.Text + " order by f22.d_n";
                            else if (AFAnalysis.tbreportcity.Text != "0 Selected")
                                ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.bamt, f22.tamt, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f6.tx_code = f22.tx_code and f4.a_n = f22.a_n and f4.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f1.city in (" + AFAnalysis.selectedCityList + ") and f22.d_c = " + cbrep_ana_d_c.Text + " order by f22.d_n";
                            else if (AFAnalysis.tbreporttax.Text != "0 Selected")
                                ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.bamt, f22.tamt, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f6.tx_code = f22.tx_code and f4.a_n = f22.a_n and f4.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f22.tx_code in (" + AFAnalysis.selectedTaxList + ") and f22.d_c = " + cbrep_ana_d_c.Text + " order by f22.d_n";
                        }
                        //if (tbselacc.Text == "0 Selected" && tbreportcity.Text == "0 Selected" && tbreportitems.Text == "0 Selected" && tbreporttax.Text == "0 Selected")
                        //    ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.bamt, f22.tamt, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f6.tx_code = f22.tx_code and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f4.a_n = f22.a_n and f4.s_a = f22.s_a order by f22.d_n";
                        //else
                        //{
                        //    if (tbselacc.Text != "0 Selected")
                        //        ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.bamt, f22.tamt, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f6.tx_code = f22.tx_code and f4.a_n = f22.a_n and f4.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f1.[desc] in (" + selectedpartyname + ") and f22.d_c = " + cbrep_ana_d_c.Text + " order by f22.d_n";
                        //    else if (tbreportcity.Text != "0 Selected")
                        //        ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.bamt, f22.tamt, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f6.tx_code = f22.tx_code and f4.a_n = f22.a_n and f4.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f1.city in (" + selectedcitylist + ") and f22.d_c = " + cbrep_ana_d_c.Text + " order by f22.d_n";
                        //    else if (tbreporttax.Text != "0 Selected")
                        //        ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.bamt, f22.tamt, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f6.tx_code = f22.tx_code and f4.a_n = f22.a_n and f4.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f22.tx_code in (" + selectedtaxlist + ") and f22.d_c = " + cbrep_ana_d_c.Text + " order by f22.d_n";
                        //}
                        excel_filename = "Brief Items Purchase List as on " + ConnectionWithAccess.mprd;
                    }
                    else if (cbRepSubType.Text == "Replacement" && cbRepFormat.Text == "Document Wise")
                    {
                        ConnectionWithAccess.query = "select distinct f30.D_D, f30.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f30.bamt, f30.tamt, f30.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[06] + " f6, " + ConnectionWithAccess.tablename[30] + " f30 where f1.a_n = f30.a_n and f1.s_a = f30.s_a and IsNull(f1.d_y) = IsNull(f30.d_y) and f6.tx_code = f30.tx_code and f30.prd = '" + ConnectionWithAccess.mprd + "' and f30.d_d >= @From and f30.d_d <= @To order by f30.d_n";
                        excel_filename = "Replacement Purchase List as on " + ConnectionWithAccess.mprd;
                    }
                    else if (cbRepSubType.Text == "Brief with Items")
                    {
                        sort_datewise_datagridview(gdvreport, "PurcList", 0, 1);
                        sale_purchase_party = new string[0];
                        for (row_counter = 0; row_counter < gdvreport.Rows.Count - 1; row_counter++)
                        {
                            temp_word = null;
                            for (column_counter = 0; column_counter < gdvreport.Columns.Count; column_counter++)
                            {
                                temp_word = temp_word + gdvreport.Rows[row_counter].Cells[column_counter].Value.ToString() + " ,";
                            }
                            if (sale_purchase_party.Length == 0)
                                Array.Resize(ref sale_purchase_party, 1);
                            else
                                Array.Resize(ref sale_purchase_party, sale_purchase_party.Length + 1);
                            sale_purchase_party[sale_purchase_party.Length - 1] = temp_word;
                        }
                        generate_full_brief_purchase();
                    }
                    parameters_for_date_range(RepFrom.Text, RepTo.Text);
                    ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "PurcList", "d_d ASC");
                    fAdd_Sale_Report_Totals("d_d ASC");
                    if (gdvreport.Rows.Count > 1)
                    {
                        //f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.gamt
                        //gdvreport.DefaultCellStyle.Font = new System.Drawing.Font("Microsoft Sans Serif", 12);
                        gdvreport.Columns[0].HeaderText = "Date";
                        gdvreport.Columns[1].HeaderText = "Doc. No";
                        gdvreport.Columns[2].HeaderText = "Name";
                        gdvreport.Columns[3].HeaderText = "City";
                        gdvreport.Columns[4].HeaderText = "Gst Number";
                        gdvreport.Columns[5].HeaderText = "Gross Amt";
                        gdvreport.Columns[0].Width = 90;
                        gdvreport.Columns[1].Width = 75;
                        gdvreport.Columns[2].Width = 300;
                        gdvreport.Columns[3].Width = 175;
                        gdvreport.Columns[4].Width = 150;
                        gdvreport.Columns[5].Width = 110;
                        gdvreport.Columns[0].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                        gdvreport.Columns[1].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                        gdvreport.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                        gdvreport.Columns[5].DefaultCellStyle.Format = "N2";
                        gdvreport.AllowUserToResizeColumns = false;
                        gdvreport.FirstDisplayedScrollingRowIndex = gdvreport.Rows.Count - 2;
                        if (gdvreport.Rows.Count > 0)
                            excel_filename = "Mini Sale List as on " + ConnectionWithAccess.mprd;
                        ConnectionWithAccess.export(gdvreport, excel_filename);
                        sale_purchase_report_list_mini();
                    }
                }
            }
            else if (cbRepType.Text == "Bank")
            {
                if (cbRepSubType.Text == "All")
                {
                    if (cbRepFormat.Text == "Passed")
                    {
                        // b_t = "3"
                        StringBuilder strQuery = new StringBuilder();
                        if (cbrep_ana_d_c.Text != "0")
                        {
                            strQuery.Append(" select #" + ConnectionWithAccess.msdate + "# as [PASS_DATE],0 as [d_n],  'Opening Balance' as [desc], '' as [city], f51.amt as [amt], 0 as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[51] + " f51 where f51.prd = '" + ConnectionWithAccess.moprd + "' and f51.a_n = '" + raa_n.Text + "' and d_d = #01-01-1901# and f51.s_a = '@@@' union all");
                            strQuery.Append(" select f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt as [amt], 0 as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt > 0 and r_p = '1' and f23.d_c = " + cbrep_ana_d_c.Text + " and f23.a_n <> '7999' union all ");
                            strQuery.Append(" select f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt as [amt], 0 as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt > 0 and r_p = '2' and f23.d_c = " + cbrep_ana_d_c.Text + " and f23.a_n <> '7999' union all ");
                            strQuery.Append(" select f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city,  0 as [amt], (f23.bamt * -1) as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt < 0 and r_p = '3' and f23.d_c = " + cbrep_ana_d_c.Text + " and f23.a_n <> '7999' union all ");
                            strQuery.Append(" select f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city,  0 as [amt], (f23.bamt * -1) as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt < 0 and r_p = '4' and f23.d_c = " + cbrep_ana_d_c.Text + " and f23.a_n <> '7999' union all ");
                            strQuery.Append(" select f23.PASS_DATE, f23.D_N, 'CASH DEPOSITED IN BANK' as [Desc], '',  f23.bamt as [amt], 0 as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt > 0 and r_p = '1' and f23.d_c = " + cbrep_ana_d_c.Text + " and f23.a_n = '7999' and f23.s_a = 'DEP' union all ");
                            strQuery.Append(" select f23.PASS_DATE, f23.D_N, 'CASH WITHDRAWN FROM BANK' as [Desc], '',  0 as [amt], (f23.bamt * -1) as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt < 0 and r_p = '3' and f23.d_c = " + cbrep_ana_d_c.Text + " and f23.a_n = '7999' and f23.s_a = 'WIT' union all ");
                            strQuery.Append(" select f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city, (f23.bamt * -1) as [amt], 0 as [pay_amt], 0 as [balance_amt] from  " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and r_p = '4' and f23.tran_d_c = " + cbrep_ana_d_c.Text);
                        }
                        else
                        {
                            strQuery.Append(" select  #" + ConnectionWithAccess.msdate + "# as [PASS_DATE], 'Opening Balance', '' as [city], 0 as [d_n], f51.amt as [amt], 0 as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[51] + " f51 where f51.prd = '" + ConnectionWithAccess.moprd + "' and f51.a_n = '" + raa_n.Text + "' and d_d = #01-01-1901# and f51.s_a = '@@@' union all");
                            strQuery.Append(" select f23.PASS_DATE, f1.[desc] as [Desc], f1.city, f23.D_N, f23.bamt as [amt], 0 as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt > 0 and r_p = '1' and f23.a_n = '7999' union all ");
                            strQuery.Append(" select f23.PASS_DATE, f1.[desc] as [Desc], f1.city, f23.D_N, f23.bamt as [amt], 0 as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt > 0 and r_p = '2' and f23.a_n = '7999' union all ");
                            strQuery.Append(" select f23.PASS_DATE, f1.[desc] as [Desc], f1.city, f23.D_N,  0 as [amt], (f23.bamt * -1) as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt < 0 and r_p = '3' and f23.a_n <> '7999' union all ");
                            strQuery.Append(" select f23.PASS_DATE, f1.[desc] as [Desc], f1.city, f23.D_N,  0 as [amt], (f23.bamt * -1) as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt < 0 and r_p = '4' and f23.a_n <> '7999' union all ");
                            strQuery.Append(" select f23.PASS_DATE, f23.D_N, 'Cash Deposited in Bank' as [Desc], '',  (f23.bamt * -1) as [amt], 0 as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt > 0 and r_p = '1' and f23.a_n = '7999' and f23.s_a = 'DEP' union all ");
                            strQuery.Append(" select f23.PASS_DATE, f23.D_N, 'Cash Withdrawn from Bank' as [Desc], '',  0 as [amt], (f23.bamt * -1) as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt < 0 and r_p = '3' and f23.a_n = '7999' and f23.s_a = 'WIT' union all ");
                            strQuery.Append(" select f23.PASS_DATE, f1.[desc] as [Desc], f1.city, f23.D_N, f23.bamt as [amt], 0 as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and r_p = '4'");
                        }
                        ConnectionWithAccess.query = strQuery.ToString();
                        //parameters_for_date_range(RepFrom.Text, RepTo.Text);
                        parameters_for_date_range(ConnectionWithAccess.msdate, RepTo.Text);
                        ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Bankrep", "pass_date ASC");
                        fAdd_Bank_Report_Totals("pass_date ASC");
                        excel_filename = "Passed Bank List as on " + ConnectionWithAccess.mprd;
                    }
                    else if (cbRepFormat.Text == "Failed")
                    {
                        // b_t = "4"
                        StringBuilder strQuery = new StringBuilder();
                        strQuery.Append(" select distinct '', f23.a_n, f23.s_a, f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt, '', '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.b_t = '4' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= #" + RepFrom.Text + "# and f23.d_d <=#" + RepTo.Text + "# and f23.bamt > 0 and f23.d_c = cbrep_ana_d_c.Text union all");
                        strQuery.Append(" select distinct '', f23.a_n, f23.s_a, f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt, '', '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.b_t = '4' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= #" + RepFrom.Text + "# and f23.d_d <=#" + RepTo.Text + "# and f23.bamt > 0 and f23.d_c = cbrep_ana_d_c.Text");
                        //ConnectionWithAccess.query = "select distinct '', f23.a_n, f23.s_a, f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt, '', '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.b_t = '4' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= #" + RepFrom.Text + "# and f23.d_d <=#" + RepTo.Text + "# and f23.bamt > 0 and f23.d_c = " + cbrep_ana_d_c.Text;
                        //ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Bankrep");
                        //ConnectionWithAccess.query = "select distinct '', f23.a_n, f23.s_a, f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, '', (f23.bamt * -1), '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.b_t = '4' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= #" + RepFrom.Text + "# and f23.d_d <=#" + RepTo.Text + "# and f23.bamt < 0 and f23.d_c = " + cbrep_ana_d_c.Text + "";
                        //ConnectionCommand.multiplerows(gdvreport, "Bankrep");
                        excel_filename = "Failed Bank List as on " + ConnectionWithAccess.mprd + "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                    }
                    else if (cbRepFormat.Text == "Pending")
                    {
                        // b_t = "2"
                        ConnectionWithAccess.query = "select distinct '', f23.a_n, f23.s_a, f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt, '', '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.b_t = '2' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= #" + RepFrom.Text + "# and f23.d_d <=#" + RepTo.Text + "# and f23.bamt > 0 and f23.d_c = " + cbrep_ana_d_c.Text + "";
                        ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Bankrep");
                        ConnectionWithAccess.query = "select distinct '', f23.a_n, f23.s_a, f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, '', (f23.bamt * -1), '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.b_t = '2' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= #" + RepFrom.Text + "# and f23.d_d <=#" + RepTo.Text + "# and f23.bamt < 0 and f23.d_c = " + cbrep_ana_d_c.Text + "";
                        ConnectionCommand.multiplerows(gdvreport, "Bankrep");
                        excel_filename = "Pending Bank List as on " + ConnectionWithAccess.mprd;
                    }
                }
                else if (cbRepSubType.Text == "Receipt")
                {
                    // r_p = 1 "Cash Deposit"
                    //r_p = 2 Receipt
                    //r_p = 3 cash withdrawal
                    // r_p = 4 payment
                    if (cbRepFormat.Text == "Passed")
                    {
                        // b_t = "3"
                        ConnectionWithAccess.query = "select distinct '', f23.a_n, f23.s_a, f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt, '', '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f23.bamt > 0 and r_p = '2' and  f23.b_t = '3' and f23.d_c = " + cbrep_ana_d_c.Text + "";
                        excel_filename = "Receipt Bank Passed List as on " + ConnectionWithAccess.mprd;
                    }
                    else if (cbRepFormat.Text == "Failed")
                    {
                        // b_t = "4"
                        ConnectionWithAccess.query = "select distinct '', f23.a_n, f23.s_a, f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt, '', '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt > 0 and r_p = '2' and f23.b_t = '4' and f23.d_c = " + cbrep_ana_d_c.Text + "";
                        excel_filename = "Receipt Bank Failed List as on " + ConnectionWithAccess.mprd;
                    }
                    else if (cbRepFormat.Text == "Pending")
                    {
                        // b_t = "2"
                        ConnectionWithAccess.query = "select distinct '', f23.a_n, f23.s_a, f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt, '', '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt > 0 and r_p = '2' and  f23.b_t = '2' and f23.d_c = " + cbrep_ana_d_c.Text + "";
                        excel_filename = "Receipt Bank Pending List as on " + ConnectionWithAccess.mprd;
                    }
                    parameters_for_date_range(RepFrom.Text, RepTo.Text);
                    ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Bankrep");
                }
                else if (cbRepSubType.Text == "Payment")
                {
                    // r_p = 4 payment
                    if (cbRepFormat.Text == "Pending")
                    {
                        // b_t = "2"
                        ConnectionWithAccess.query = "select distinct '', f23.a_n, f23.s_a, f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, '', (f23.bamt * -1), '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt < 0 and r_p = '4' and  f23.b_t = '2' and f23.d_c = " + cbrep_ana_d_c.Text + "";
                        excel_filename = "Payment Bank Pending List as on " + ConnectionWithAccess.mprd;
                    }
                    else if (cbRepFormat.Text == "Passed")
                    {
                        // b_t = "3"
                        ConnectionWithAccess.query = "select distinct '', f23.a_n, f23.s_a, f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city, '', (f23.bamt * -1), '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt < 0 and r_p = '4' and  f23.b_t = '3' and f23.d_c = " + cbrep_ana_d_c.Text + "";
                        excel_filename = "Payment Bank Passed List as on " + ConnectionWithAccess.mprd;
                    }
                    else if (cbRepFormat.Text == "Failed")
                    {
                        // b_t = "4"
                        ConnectionWithAccess.query = "select distinct '', f23.a_n, f23.s_a, f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, '', (f23.bamt * -1), '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt < 0 and r_p = '4' and  f23.b_t = '4' and f23.d_c = " + cbrep_ana_d_c.Text + "";
                        excel_filename = "Payment Bank Failed List as on " + ConnectionWithAccess.mprd;
                    }
                    parameters_for_date_range(RepFrom.Text, RepTo.Text);
                    ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Bankrep");
                }
                else if (cbRepSubType.Text == "Deposit")
                {
                    // r_p - 1 "Cash Deposit"
                    // b_t = "3"
                    ConnectionWithAccess.query = "select distinct '', f23.a_n, f23.s_a, f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt, '', '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt > 0 and r_p = '1' and  f23.b_t = '3' and f23.d_c = " + cbrep_ana_d_c.Text + "";
                    parameters_for_date_range(RepFrom.Text, RepTo.Text);
                    ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Bankrep");
                    excel_filename = "Bank Deposit List as on " + ConnectionWithAccess.mprd;
                }
                else if (cbRepSubType.Text == "Withdrawal")
                {
                    //r_p = 3 cash withdrawal
                    // b_t = "3"
                    ConnectionWithAccess.query = "select distinct '', f23.a_n, f23.s_a, f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city, '', (f23.bamt * -1), '', f23.r_p from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and IsNull(f1.d_y) = IsNull(f23.d_y) and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt < 0 and r_p = '3' and  f23.b_t = '3' and f23.d_c = " + cbrep_ana_d_c.Text + "";
                    parameters_for_date_range(RepFrom.Text, RepTo.Text);
                    ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Bankrep");
                    excel_filename = "Bank Withdrawal List as on " + ConnectionWithAccess.mprd;
                }
                if (gdvreport.Rows.Count > 1)
                {
                    //gdvreport.DefaultCellStyle.Font = new System.Drawing.Font("Microsoft Sans Serif", 9);
                    gdvreport.Columns[0].HeaderText = "Date";
                    gdvreport.Columns[1].HeaderText = "Doc. No";
                    gdvreport.Columns[2].HeaderText = "Name";
                    gdvreport.Columns[3].HeaderText = "City";
                    gdvreport.Columns[4].HeaderText = "Receipt";
                    gdvreport.Columns[5].HeaderText = "Payment";
                    gdvreport.Columns[6].HeaderText = "Balance";
                    gdvreport.Columns[0].Width = 75;
                    gdvreport.Columns[1].Width = 90;
                    gdvreport.Columns[2].Width = 300;
                    gdvreport.Columns[3].Width = 150;
                    gdvreport.Columns[4].Width = 93;
                    gdvreport.Columns[5].Width = 93;
                    gdvreport.Columns[6].Width = 93;
                    gdvreport.Columns[1].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.Columns[6].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.Columns[4].DefaultCellStyle.Format = "N2";
                    gdvreport.Columns[5].DefaultCellStyle.Format = "N2";
                    gdvreport.Columns[6].DefaultCellStyle.Format = "N2";
                    gdvreport.AllowUserToResizeColumns = false;
                    gdvreport.FirstDisplayedScrollingRowIndex = gdvreport.Rows.Count - 2;
                    if (gdvreport.Rows.Count > 0)
                        excel_filename = "Mini Sale List as on " + ConnectionWithAccess.mprd;
                    ConnectionWithAccess.export(gdvreport, excel_filename);
                    generate_bank_report();
                }
            }
            else if (cbRepType.Text == "Cash")
            {
                StringBuilder strQuery = new StringBuilder();
                gdvreport.Visible = true;
                if (cbRepSubType.Text == "All")
                {
                    strQuery.Append(" select #" + ConnectionWithAccess.msdate + "# as [d_d],0 as [d_n], 'Opening Balance' as [desc], '' as [city], f51.amt as [camt], 0 as [camt * -1], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[51] + " f51 where f51.prd = '" + ConnectionWithAccess.moprd + "' and f51.a_n = '" + raa_n.Text + "' and d_d = #01-01-1901# and f51.s_a = '@@@' union all ");
                    //strQuery.Append("select f24.D_D, f24.D_N, f1.[desc] as [Desc], f1.city, f24.camt, '', 0 as [balance_amt]  from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[24] + " f24 where f1.a_n = f24.a_n and f1.s_a = f24.s_a and (f24.d_y is null or f24.d_y ='' or f24.d_y = '@@@') and f24.prd = '" + ConnectionWithAccess.mprd + "' and f24.d_d >= @From and f24.d_d <= @To and f24.camt > 0 and f24.d_c = " + cbrep_ana_d_c.Text + " and f24.a_n <> '7999'  ");
                    strQuery.Append("select f24.D_D, f24.D_N, f1.[desc] as [Desc], f1.city, f24.camt, '', 0 as [balance_amt] from " + ConnectionWithAccess.tablename[24] + " f24 inner join " + ConnectionWithAccess.tablename[1] + " f1 on f24.a_n = f1.a_n and f24.s_a = f1.s_a and f24.d_y = f1.d_y where f24.prd = '" + ConnectionWithAccess.mprd + "' and f24.d_d >= @From and f24.d_d <= @To and f24.camt > 0 and f24.d_c = " + cbrep_ana_d_c.Text + " and f24.a_n <> '7999' union all  ");
                    strQuery.Append("select f24.D_D, f24.D_N, f1.[desc] as [Desc], f1.city,  '', (f24.camt * -1), 0 as [balance_amt] from " + ConnectionWithAccess.tablename[24] + " f24 inner join " + ConnectionWithAccess.tablename[1] + " f1 on f24.a_n = f1.a_n and f24.s_a = f1.s_a and f24.d_y = f1.d_y where f24.prd = '" + ConnectionWithAccess.mprd + "' and f24.d_d >= @From and f24.d_d <= @To and f24.camt < 0 and f24.d_c = " + cbrep_ana_d_c.Text + " and f24.a_n <> '7999' union all ");
                    strQuery.Append("select f23.D_D, f23.D_N, 'CASH WITHDRAWN FROM BANK' as [Desc], f1.city, (f23.bamt * -1), '', 0 as [balance_amt] from " + ConnectionWithAccess.tablename[23] + " f23 inner join " + ConnectionWithAccess.tablename[1] + " f1 on f23.a_n = f1.a_n and f23.s_a = f1.s_a and f23.d_y = f1.d_y where f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt < 0 and f23.a_n = '7999' and f23.s_a = 'WIT' union all ");
                    strQuery.Append("select f23.D_D, f23.D_N, 'CASH DEPOSITED IN BANK' as [Desc], f1.city, '', f23.bamt, 0 as [balance_amt] from " + ConnectionWithAccess.tablename[23] + " f23 inner join " + ConnectionWithAccess.tablename[1] + " f1 on f23.a_n = f1.a_n and f23.s_a = f1.s_a and f23.d_y = f1.d_y where f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.bamt > 0 and f23.a_n = '7999' and f23.s_a = 'DEP'");
                    excel_filename = "Cash List as on " + ConnectionWithAccess.mprd;
                }
                else if (cbRepSubType.Text == "Receipt")
                {
                    ConnectionWithAccess.query = "select distinct '',  f24.a_n, f24.s_a, f24.D_D, f24.D_N, f1.[desc] as [Desc], f1.city, f24.camt, '', '', '' from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[24] + " f24 where f1.a_n = f24.a_n and f1.s_a = f24.s_a and IsNull(f1.d_y) = IsNull(f24.d_y) and f24.r_p = '1' and f24.prd = '" + ConnectionWithAccess.mprd + "' and f24.d_d >= #" + RepFrom.Text + "# and f24.d_d <=#" + RepTo.Text + "# and f24.d_c = " + cbrep_ana_d_c.Text + " order by f24.d_n";
                    ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Cashrep");
                    ConnectionWithAccess.query = "select distinct '',  f24.a_n, f24.s_a, f24.D_D, f24.D_N, f1.[desc] as [Desc], f1.city, f24.camt, '', '', '' from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[24] + " f24 where f1.a_n = f24.a_n and f1.s_a = f24.s_a and IsNull(f1.d_y) = IsNull(f24.d_y) and f24.r_p = '2' and f24.prd = '" + ConnectionWithAccess.mprd + "' and f24.d_d >= #" + RepFrom.Text + "# and f24.d_d <=#" + RepTo.Text + "# and f24.d_c = " + cbrep_ana_d_c.Text + " order by f24.d_n";
                    ConnectionCommand.multiplerows(gdvreport, "Cashrep");
                    excel_filename = "Cash Receipt List as on " + ConnectionWithAccess.mprd;
                }
                else if (cbRepSubType.Text == "Payment")
                {
                    ConnectionWithAccess.query = "select distinct '',  f24.a_n, f24.s_a, f24.D_D, f24.D_N, f1.[desc] as [Desc], f1.city, '', (f24.camt * -1), '', '' from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[24] + " f24 where f1.a_n = f24.a_n and f1.s_a = f24.s_a and IsNull(f1.d_y) = IsNull(f24.d_y) and f24.r_p = '3' and f24.prd = '" + ConnectionWithAccess.mprd + "' and f24.d_d >= #" + RepFrom.Text + "# and f24.d_d <=#" + RepTo.Text + "# and f24.d_c = " + cbrep_ana_d_c.Text + "  order by f24.d_n";
                    ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Cashrep");
                    ConnectionWithAccess.query = "select distinct '',  f24.a_n, f24.s_a, f24.D_D, f24.D_N, f1.[desc] as [Desc], f1.city, '', (f24.camt * -1), '', '' from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[24] + " f24 where f1.a_n = f24.a_n and f1.s_a = f24.s_a and IsNull(f1.d_y) = IsNull(f24.d_y) and f24.r_p = '4' and f24.prd = '" + ConnectionWithAccess.mprd + "' and f24.d_d >= #" + RepFrom.Text + "# and f24.d_d <=#" + RepTo.Text + "# and f24.d_c = " + cbrep_ana_d_c.Text + "  order by f24.d_n";
                    ConnectionCommand.multiplerows(gdvreport, "Cashrep");
                    excel_filename = "Cash Payment List as on " + ConnectionWithAccess.mprd;
                }
                ConnectionWithAccess.query = strQuery.ToString();
                //parameters_for_date_range(RepFrom.Text, RepTo.Text);
                parameters_for_date_range(ConnectionWithAccess.msdate, RepTo.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Cashrep", "d_d ASC");
                fAdd_cash_Report_Totals("d_d ASC");
                if (gdvreport.Rows.Count > 1)
                {
                    //gdvreport.DefaultCellStyle.Font = new System.Drawing.Font("Microsoft Sans Serif", 9);
                    gdvreport.Columns[0].HeaderText = "Date";
                    gdvreport.Columns[1].HeaderText = "Doc. No";
                    gdvreport.Columns[2].HeaderText = "Name";
                    gdvreport.Columns[3].HeaderText = "City";
                    gdvreport.Columns[4].HeaderText = "Receipt";
                    gdvreport.Columns[5].HeaderText = "Payment";
                    gdvreport.Columns[6].HeaderText = "Balance";
                    gdvreport.Columns[0].Width = 75;
                    gdvreport.Columns[1].Width = 90;
                    gdvreport.Columns[2].Width = 300;
                    gdvreport.Columns[3].Width = 150;
                    gdvreport.Columns[4].Width = 93;
                    gdvreport.Columns[5].Width = 93;
                    gdvreport.Columns[6].Width = 93;
                    gdvreport.Columns[1].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.Columns[6].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.Columns[4].DefaultCellStyle.Format = "N2";
                    gdvreport.Columns[5].DefaultCellStyle.Format = "N2";
                    gdvreport.Columns[6].DefaultCellStyle.Format = "N2";
                    gdvreport.AllowUserToResizeColumns = false;
                    gdvreport.FirstDisplayedScrollingRowIndex = gdvreport.Rows.Count - 2;
                    if (gdvreport.Rows.Count > 0)
                        excel_filename = "Mini Sale List as on " + ConnectionWithAccess.mprd;
                    ConnectionWithAccess.export(gdvreport, excel_filename);
                    generate_cash_report();
                }
            }
            else if (cbRepType.Text == "Journal")
            {
                gdvreport.Visible = true;
                ConnectionWithAccess.query = "select distinct '', f25.a_n, f25.s_a, f25.na_n, f25.ns_a, f25.D_D, f25.D_N, f1.[desc] as [Desc], f1.city, f25.jamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[25] + " f25 where f1.a_n = f25.a_n and f1.s_a = f25.s_a and f25.prd = '" + ConnectionWithAccess.mprd + "' and f25.d_d >= @From and f25.d_d <= @To order by f25.d_n";
                parameters_for_date_range(RepFrom.Text, RepTo.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Jourrep", "d_d ASC");
                excel_filename = "Journal List as on " + ConnectionWithAccess.mprd;
                if (gdvreport.Rows.Count > 1)
                {
                    gdvreport.Columns[0].HeaderText = "Sort Date";
                    gdvreport.Columns[1].HeaderText = "A_n";
                    gdvreport.Columns[2].HeaderText = "S_a";
                    gdvreport.Columns[3].HeaderText = "NA_n";
                    gdvreport.Columns[4].HeaderText = "NS_a";
                    gdvreport.Columns[5].HeaderText = "Date";
                    gdvreport.Columns[6].HeaderText = "Document";
                    gdvreport.Columns[7].HeaderText = "Name ";
                    gdvreport.Columns[8].HeaderText = "City";
                    gdvreport.Columns[9].HeaderText = "Amount";
                    gdvreport.Columns[1].Width = 72;
                    gdvreport.Columns[2].Width = 54;
                    gdvreport.Columns[3].Width = 72;
                    gdvreport.Columns[4].Width = 54;
                    gdvreport.Columns[5].Width = 90;
                    gdvreport.Columns[6].Width = 60;
                    gdvreport.Columns[7].Width = 240;
                    gdvreport.Columns[8].Width = 140;
                    gdvreport.Columns[9].Width = 120;
                    gdvreport.Columns[6].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.Columns[9].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.Columns[0].Visible = false;
                    gdvreport.FirstDisplayedScrollingRowIndex = gdvreport.Rows.Count - 2;
                    if (gdvreport.Rows.Count > 0)
                    {
                        //generate_general_report();
                    }
                }
            }
            else if (cbRepType.Text == "Opening Balances" || cbRepType.Text == "Closing Balances")
            {
                if (cbRepType.Text == "Opening Balances" && cbRepSubType.Text == "Customer's")
                {
                    ConnectionWithAccess.query = "select distinct '', f51.a_n, f51.s_a, f1.[desc] as [Desc], f1.city, f51.amt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[51] + " f51 where f1.a_n = f51.a_n and f1.s_a = f51.s_a and f51.prd = '" + ConnectionWithAccess.moprd + "' and f51.a_n = '2002' and f51.amt <> 0 and d_d = #01-01-1901# and f1.s_a <> '@@@'";
                    ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Cust_bal_rep");
                    excel_filename = "Customers Balance List as on " + ConnectionWithAccess.mprd;
                }
                else if (cbRepType.Text == "Opening Balances" && cbRepSubType.Text == "Supplier's")
                {
                    ConnectionWithAccess.query = "select distinct '', f51.a_n, f51.s_a, f1.[desc] as [Desc], f1.city, (f51.amt *-1) from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[51] + " f51 where f1.a_n = f51.a_n and f1.s_a = f51.s_a and f51.prd = '" + ConnectionWithAccess.moprd + "' and f51.a_n = '4002' and d_d = #01-01-1901# and f1.s_a <> '@@@'";
                    ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Supl_bal_rep");
                    excel_filename = "Suppliers Balance List as on " + ConnectionWithAccess.mprd;
                }
                else if (cbRepType.Text == "Closing Balances" && cbRepSubType.Text == "Customer's")
                {
                    ConnectionWithAccess.query = "select distinct '', f51.a_n, f51.s_a, f1.[desc] as [Desc], f1.city, f51.amt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[51] + " f51 where f1.a_n = f51.a_n and f1.s_a = f51.s_a and f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '2002' and f51.amt <> 0 and d_d = #01-01-1901# and f1.s_a <> '@@@'";
                    ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Cust_bal_rep");
                    excel_filename = "Customers Balance List as on " + ConnectionWithAccess.mprd;
                }
                else if (cbRepType.Text == "Closing Balances" && cbRepSubType.Text == "Supplier's")
                {
                    ConnectionWithAccess.query = "select distinct '', f51.a_n, f51.s_a, f1.[desc] as [Desc], f1.city, (f51.amt *-1) from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[51] + " f51 where f1.a_n = f51.a_n and f1.s_a = f51.s_a and f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '4002' and d_d = #01-01-1901# and f1.s_a <> '@@@'";
                    ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Supl_bal_rep");
                    excel_filename = "Suppliers Balance List as on " + ConnectionWithAccess.mprd;
                }
                if (gdvreport.Rows.Count > 1)
                {
                    gdvreport.Columns[0].HeaderText = "Sort Date";
                    gdvreport.Columns[1].HeaderText = "A_n";
                    gdvreport.Columns[2].HeaderText = "S_a";
                    gdvreport.Columns[3].HeaderText = "Name ";
                    gdvreport.Columns[4].HeaderText = "City";
                    gdvreport.Columns[5].HeaderText = "Balance";
                    gdvreport.Columns[3].Width = 300;
                    gdvreport.Columns[4].Width = 200;
                    gdvreport.Columns[5].Width = 120;
                    gdvreport.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    gdvreport.FirstDisplayedScrollingRowIndex = gdvreport.Rows.Count - 2;
                    if (gdvreport.Rows.Count > 0)
                    {
                        //getTotal(gdvreport, 5);
                        gdvreport.Columns[0].Visible = false;
                        gdvreport.Columns[1].Visible = false;
                        gdvreport.Columns[2].Visible = false;
                        generate_Debitors_creditors_report();
                    }
                }
            }
            else if (cbRepType.Text == "Item")
            {
                if (cbRepSubType.Text == "Opening Stock")
                {
                    gdvreport.Visible = true;
                    ConnectionWithAccess.query = "select [type],item_code,[title],opn_stk,price,o_s_amt,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where opn_stk > 0";
                    ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Jourrep");
                    excel_filename = "Items Opening Stock List as on " + ConnectionWithAccess.mprd;
                    if (gdvreport.Rows.Count > 1)
                    {
                        for (row_pointer = 0; row_pointer < gdvreport.Rows.Count - 1; row_pointer++)
                        {
                            gdvreport.Rows[row_pointer].Cells[5].Value = (Convert.ToInt32(gdvreport.Rows[row_pointer].Cells[3].Value.ToString()) * Convert.ToInt32(gdvreport.Rows[row_pointer].Cells[4].Value.ToString())).ToString();
                        }
                        gdvreport.Columns[0].HeaderText = "Type";
                        gdvreport.Columns[1].HeaderText = "Item_code";
                        gdvreport.Columns[2].HeaderText = "title";
                        gdvreport.Columns[3].HeaderText = "Open. Stock";
                        gdvreport.Columns[4].HeaderText = "Price";
                        gdvreport.Columns[5].HeaderText = "Amount";
                        gdvreport.FirstDisplayedScrollingRowIndex = gdvreport.Rows.Count - 2;
                        if (gdvreport.Rows.Count > 0)
                        {
                            //generate_general_report();
                        }
                    }
                }
                else if (cbRepSubType.Text == "Type wise")
                {
                    gdvreport.Visible = true;
                    ConnectionWithAccess.query = "select [type],item_code,[title],opn_stk,clo_stk,price from " + ConnectionWithAccess.tablename[05] + " order by [title]";
                    ConnectionCommand.accountHelp_datatable_Seperate(gdvreport, "Item Stock");
                    excel_filename = "Items Opening Stock List as on " + ConnectionWithAccess.mprd;
                    if (gdvreport.Rows.Count > 1)
                    {
                        //for (row_pointer = 0; row_pointer < gdvreport.Rows.Count - 1; row_pointer++)
                        //{
                        //    gdvreport.Rows[row_pointer].Cells[5].Value = (Convert.ToInt32(gdvreport.Rows[row_pointer].Cells[3].Value.ToString()) * Convert.ToInt32(gdvreport.Rows[row_pointer].Cells[4].Value.ToString())).ToString();
                        //}
                        gdvreport.Columns[0].HeaderText = "Type";
                        gdvreport.Columns[1].HeaderText = "Item_code";
                        gdvreport.Columns[2].HeaderText = "title";
                        gdvreport.Columns[3].HeaderText = "Open. Stock";
                        gdvreport.Columns[4].HeaderText = "Clos. Stock";
                        gdvreport.Columns[5].HeaderText = "Price";
                        gdvreport.Columns[0].Width = 50;
                        gdvreport.Columns[1].Width = 75;
                        gdvreport.Columns[2].Width = 350;
                        gdvreport.Columns[3].Width = 100;
                        gdvreport.Columns[4].Width = 100;
                        gdvreport.Columns[5].Width = 100;
                        gdvreport.Columns[3].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                        gdvreport.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                        gdvreport.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                        gdvreport.Columns[3].DefaultCellStyle.Format = "N2";
                        gdvreport.Columns[4].DefaultCellStyle.Format = "N2";
                        gdvreport.Columns[5].DefaultCellStyle.Format = "N2";
                        gdvreport.FirstDisplayedScrollingRowIndex = gdvreport.Rows.Count - 2;
                        if (gdvreport.Rows.Count > 0)
                        {
                            generate_item_list();
                            //generate_general_report();
                        }
                    }
                }
            }
            ConnectionWithAccess.export(gdvreport, excel_filename);
            objPleaseWait.Close();
        }

        private void cb_rg_report_type_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (maintab.SelectedIndex == 3)
            {
                dgv_gst_report.Visible = false;
                btn_gst_generate_report.Visible = true;
                lbl_gst_bamt.Visible = false;
                lbl_gst_tamt.Visible = false;
                lbl_gst_gamt.Visible = false;
                if (cb_rg_report_type.SelectedItem.Equals("SALE") && cb_rg_report_type.SelectedItem.Equals("PURCHASE"))
                {
                    cb_rg_d_c.Visible = true;
                    lbl_gst_report_daybook.Visible = true;
                    if (cb_rg_report_type.SelectedItem.Equals("SALE"))
                        ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[21] + " where d_n = 999999";
                    else if (cb_rg_report_type.SelectedItem.Equals("PURCHASE"))
                        ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[22] + " where d_n = 999999";
                    ConnectionCommand.retrieval(cb_rg_d_c);
                    if (cb_rg_d_c.Text != "")
                    {
                        if (cb_rg_report_type.SelectedItem.Equals("Sale"))
                            rg_a_n.Text = get_a_n_from_d_c("S", Convert.ToInt32(cb_rg_d_c.Text));
                        else if (cb_rg_report_type.SelectedItem.Equals("Purchase"))
                            rg_a_n.Text = get_a_n_from_d_c("P", Convert.ToInt32(cb_rg_d_c.Text));
                    }
                }
                if (cb_rg_report_type.SelectedItem.Equals("DIFFERENCE"))
                    ck_gst_report_add_brief_tax.Visible = true;
                else
                    ck_gst_report_add_brief_tax.Visible = false;
            }
        }

        # region gst_csv_reports
        private void btn_gst_generate_report_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data");
            objPleaseWait.Show();
            Application.DoEvents();
            if (cb_rg_report_type.SelectedItem.Equals("SALE") || cb_rg_report_type.SelectedItem.Equals("PURCHASE"))
            {
                dgv_gst_report.Visible = true;
                if (cb_rg_report_type.SelectedItem.Equals("Sale"))
                    ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.bamt,f21.IGST_AMT, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f21.d_c = " + cb_rg_d_c.Text + " order by f21.d_n";
                else if (cb_rg_report_type.SelectedItem.Equals("Purchase"))
                    ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.bamt,f22.IGST_AMT, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f22.d_c = " + cb_rg_d_c.Text + " order by f22.d_n";
                parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(dgv_gst_report, "Gst Sale List");
                excel_filename = "Sale List as on " + ConnectionWithAccess.mprd;
                if (dgv_gst_report.Rows.Count > 1)
                {
                    //f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.bamt, f21.tamt, f21.gamt
                    dgv_gst_report.Columns[0].HeaderText = "Date";
                    dgv_gst_report.Columns[1].HeaderText = "Doc. No";
                    dgv_gst_report.Columns[2].HeaderText = "Name";
                    dgv_gst_report.Columns[3].HeaderText = "City";
                    dgv_gst_report.Columns[4].HeaderText = "Gst Number";
                    dgv_gst_report.Columns[5].HeaderText = "Basic. Amt";
                    dgv_gst_report.Columns[6].HeaderText = "Tax Amt";
                    dgv_gst_report.Columns[7].HeaderText = "Gross Amt";

                    dgv_gst_report.Columns[0].Width = 75;
                    dgv_gst_report.Columns[1].Width = 75;
                    dgv_gst_report.Columns[2].Width = 240;
                    dgv_gst_report.Columns[3].Width = 150;
                    dgv_gst_report.Columns[4].Width = 120;
                    dgv_gst_report.Columns[5].Width = 80;
                    dgv_gst_report.Columns[6].Width = 70;
                    dgv_gst_report.Columns[7].Width = 90;
                    dgv_gst_report.Columns[0].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    dgv_gst_report.Columns[1].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    dgv_gst_report.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    dgv_gst_report.Columns[6].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    dgv_gst_report.Columns[7].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    ////getTotal(dgv_gst_report, 5);
                    ////getTotal(dgv_gst_report, 6);
                    ////getTotal(dgv_gst_report, 7);
                    double bamt = 0, tamt = 0, gamt = 0;
                    for (row_pointer = 0; row_pointer < dgv_gst_report.Rows.Count; row_pointer++)
                    {
                        if (dgv_gst_report.Rows[row_pointer].Cells[5].Value != System.DBNull.Value)
                            bamt += Convert.ToInt32(dgv_gst_report.Rows[row_pointer].Cells[5].Value);
                        if (dgv_gst_report.Rows[row_pointer].Cells[6].Value != System.DBNull.Value)
                            tamt += Convert.ToInt32(dgv_gst_report.Rows[row_pointer].Cells[6].Value);
                        if (dgv_gst_report.Rows[row_pointer].Cells[7].Value != System.DBNull.Value)
                            gamt += Convert.ToInt32(dgv_gst_report.Rows[row_pointer].Cells[7].Value);
                    }
                    lbl_gst_bamt.Visible = true;
                    lbl_gst_tamt.Visible = true;
                    lbl_gst_gamt.Visible = true;
                    lbl_gst_bamt.Text = bamt.ToString();
                    lbl_gst_tamt.Text = tamt.ToString();
                    lbl_gst_gamt.Text = gamt.ToString();
                    excel_filename = "Gst Sale List as on " + ConnectionWithAccess.mprd;
                }
                ConnectionWithAccess.export(gdvreport, excel_filename);
            }
            else if (cb_rg_report_type.SelectedItem.Equals("DIFFERENCE"))
            {
                generate_pdf_for_gst_difference();
                gst_report_pdf_viewer.LoadFile(report_filename);
                gst_report_pdf_viewer.Visible = true;
            }
            else if (cb_rg_report_type.SelectedItem.Equals("GSTR1"))
            {
                //generate_GSTR1_excel_file();
                generate_gstr1_csv_file();
            }
            else if (cb_rg_report_type.SelectedItem.Equals("Sales Register"))
            {
                generate_Sales_Register_csv_file();
            }
            objPleaseWait.Close();
        }

        private void Convert_CSV_To_Excel(string strcsvFilePath, string strExcelFilePath)
        {
            Excel.Application app = new Excel.Application();
            Excel.Workbook wb = app.Workbooks.Open(strcsvFilePath);
            wb.SaveAs(strExcelFilePath, Excel.XlFileFormat.xlOpenXMLWorkbook);
            wb.Close();
            app.Quit();
        }

        private void generate_item_list()
        {
            report_filetype = cbRepType.Text + " " + cbRepSubType.Text + " " + cbRepFormat.Text;
            pdf_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
            if (chb_add_datetime_in_output.Checked)
                pdf_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            pdf_filename += ".pdf";
            pdf_filename = ConnectionWithAccess.remove_filename_error(pdf_filename);
            doc1 = new Document(PageSize.A4, 10, 10, 20, 20);
            FileStream FS1 = File.Create(pdf_filename);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            add_header_footer = false;
            //header_text_message = report_filetype + " " + " From : " + RepFrom.Text + " to " + RepTo.Text;
            header_text_message = report_filetype + " From " + ConnectionWithAccess.msdate + " to " + ConnectionWithAccess.medate + " as on " + RepTo.Text;
            pdf_top_heading = "Sr. No                Name                                                                                          City                                  Amount";
            Paragraph para = new Paragraph();


            //pdf_file = filepath + "//component_stack.pdf";
            //Document doc1 = new Document(PageSize.A4, 40, 45, 40, 25);
            //FileStream FS1 = File.Create(pdf_file);
            //PdfWriter writer = PdfWriter.GetInstance(doc1, FS1);
            //doc1.Open();



            //PdfContentByte cb = writer.DirectContent;
            //Paragraph para = new Paragraph("");
            //para = new Paragraph("Components Stack in Machine");
            //para.SpacingBefore = spacebefore;
            //para.Font.Size = fontsize;
            //para.IndentationLeft = 0;
            //doc1.Add(para);

            //PdfPTable table = new PdfPTable(3);
            //PdfPCell cell = new PdfPCell(new Phrase("Components Stack in Machine"));
            //cell.Colspan = 3;
            //cell.HorizontalAlignment = 1; //0=Left, 1=Centre, 2=Right
            //table.AddCell(cell);
            //table.AddCell("Col 1 Row 1");
            //table.AddCell("Col 2 Row 1");
            //table.AddCell("Col 3 Row 1");
            //table.AddCell("Col 1 Row 2");
            //table.AddCell("Col 2 Row 2");
            //table.AddCell("Col 3 Row 2");
            //doc1.Add(table);



            //PdfPTable table2 = new PdfPTable(3);
            //table.TotalWidth = 144f;
            //table.LockedWidth = true;
            //table.HorizontalAlignment = 0;
            //PdfPCell left = new PdfPCell(new Paragraph("Rotated"));
            //left.Rotation = 90;
            //table.AddCell(left);
            //PdfPCell middle = new PdfPCell(new Paragraph("Rotated"));
            //middle.Rotation = -90;
            //table.AddCell(middle);
            //table.AddCell("Not Rotated");
            //doc1.Add(table2);




            //PdfPTable table3 = new PdfPTable(4);
            //table.TotalWidth = 400f;
            //table.LockedWidth = true;
            //PdfPCell header = new PdfPCell(new Phrase("Header"));
            //header.Colspan = 4;
            //table.AddCell(header);
            //table.AddCell("Cell 1");
            //table.AddCell("Cell 2");
            //table.AddCell("Cell 3");
            //table.AddCell("Cell 4");
            //PdfPTable nested = new PdfPTable(1);
            //nested.AddCell("Nested Row 1");
            //nested.AddCell("Nested Row 2");
            //nested.AddCell("Nested Row 3");
            //PdfPCell nesthousing = new PdfPCell(nested);
            //nesthousing.Padding = 0f;
            //table.AddCell(nesthousing);
            //PdfPCell bottom = new PdfPCell(new Phrase("bottom"));
            //bottom.Colspan = 3;
            //table.AddCell(bottom);
            //doc1.Add(table3);

            PdfPTable table = new PdfPTable(6);
            PdfPCell cell = new PdfPCell(new Phrase("Item List"));

            cell.Colspan = 6;
            cell.HorizontalAlignment = 1; //0=Left, 1=Centre, 2=Right
            table.TotalWidth = 570f;
            table.LockedWidth = true;
            float[] widths = new float[] { 30f, 70f, 300f, 70f, 70f, 70f };
            table.SetWidths(widths); 
            table.HorizontalAlignment = 0;
            table.AddCell(cell);
            table.AddCell("Type");
            table.AddCell("Item Code");
            table.AddCell("Title                   .");
            table.AddCell("Price");
            table.AddCell("Open Stock");
            table.AddCell("Clos Stock");
            //doc1.Add(table);


            for (row_counter = 0; row_counter < gdvreport.Rows.Count -1; row_counter++)
            {
                //table.AddCell(new Phrase(gdvreport["itemName"].ToString(), tableFont));
                //double price = Convert.ToDouble(gdvreport["price"]);
                //PdfPCell pcell = new PdfPCell();
                //pcell.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
                //pcell.AddElement(new Phrase(price.ToString("0.00"), tableFont));
                //table.AddCell(pcell);




                table.AddCell(gdvreport.Rows[row_counter].Cells[0].Value.ToString());
                table.AddCell(gdvreport.Rows[row_counter].Cells[1].Value.ToString());
                table.AddCell(gdvreport.Rows[row_counter].Cells[2].Value.ToString());
                cell.HorizontalAlignment = Element.ALIGN_RIGHT;
                table.AddCell(gdvreport.Rows[row_counter].Cells[3].Value.ToString());
                table.HorizontalAlignment = 2;
                table.AddCell(gdvreport.Rows[row_counter].Cells[4].Value.ToString());
                table.HorizontalAlignment = 2;
                table.AddCell(gdvreport.Rows[row_counter].Cells[5].Value.ToString());
            }
            doc1.Add(table);
            doc1.Close();
        }

        private void generate_Sales_Register_Excel_file()
        {
            // f21.d_d >= @From and f21.d_d <= @To
            temporary_list_array.Clear();
            ConnectionWithAccess.query = "select f21.d_n,f21.D_D,f1.state, f1.gst_number, f1.[desc] as [Desc], 'N','Regular', '',f21.bamt,f21.sgst_amt,f21.cgst_amt,f21.IGST_AMT, f21.gamt,f21.prd,f21.d_c,f21.a_n,f21.s_a, " +
                " f3.[type], f3.item_code, f3.[title], f3.q_cs, [box], f3.qty, f3.price, f3.amount,f3.cat,f3.igst_per,f3.hsn_code,f3.cgst_amt,f3.sgst_amt,f3.igst_amt " +
                " from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21, " + ConnectionWithAccess.tablename[01] + " f3 " +
                " where f1.a_n = f21.a_n and f1.s_a = f21.s_a and f3.d_c = f21.d_c and f3.d_n = f21.d_n " +
                " and f21.prd = '" + ConnectionWithAccess.mprd + "' and f3.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_n <> 999999 and f21.d_d >= @From and f21.d_d <= @To and f3.amount > 0 order by f21.d_n asc ";

            parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
            }
        }

        private void gst_tax_brief_sale_list(string book, string mprd, string md_c, string md_n, string ma_n, string ms_a)
        {
            gst_tax_brief_sale_list_array.Clear();
            if (book == "S")
                ConnectionWithAccess.query = "select d_n, sum(amount) as Amount,igst_per,sum(igst_amt) as igst_amt from " + ConnectionWithAccess.tablename[03] + " where prd = '" + mprd + "' and d_c = " + md_c + " and d_n = " + md_n + " and amount > 0 group by d_n, igst_per ";
            else if (book == "P")
                ConnectionWithAccess.query = "select d_n, sum(amount) as Amount,igst_per,sum(igst_amt) as igst_amt from " + ConnectionWithAccess.tablename[03] + " where prd = '" + mprd + "' and d_c = " + md_c + " and d_n = " + md_n + " and a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and amount > 0 group by d_n, igst_per ";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows.Count >= 1)
                {
                    temp_word = "";
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        temp_word = temp_word1 + String.Format("{0:0.00}", dtData1.Rows[iRowCount]["igst_per"].ToString()) + " ," + String.Format("{0:0.00}", dtData1.Rows[iRowCount]["igst_amt"].ToString()).ToString() + " ," + String.Format("{0:0.00}", dtData1.Rows[iRowCount]["amount"].ToString()).ToString() + " ,";
                        gst_tax_brief_sale_list_array.Add(temp_word);
                    }
                }
            }
        }

        private void generate_Sales_Register_csv_file()
        {
            // f21.d_d >= @From and f21.d_d <= @To
            temporary_list_array.Clear();
            ConnectionWithAccess.query = "select f21.d_n,f21.D_D,f1.state, f1.gst_number, f1.[desc] as [Desc], 'N','Regular', '',f21.bamt,f21.sgst_amt,f21.cgst_amt,f21.IGST_AMT, f21.gamt,f21.prd,f21.d_c,f21.a_n,f21.s_a from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_n <> 999999 and f21.d_d >= @From and f21.d_d <= @To order by d_n asc ";
            parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                int mcolumncount = dtData1.Columns.Count;
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temp_word = "";
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        if (i == 1)
                        {
                            temp_word1 = dtData1.Rows[iRowCount][i].ToString();
                            temp_word1 = temp_word1.Substring(0, temp_word1.IndexOf(" "));
                            temp_word += temp_word1 + " ,";
                        }
                        else if (i == 2)
                        {
                            temp_word1 = dtData1.Rows[iRowCount][i].ToString();
                            for (row_counter = 0; row_counter < State_gst_code.Count; row_counter++)
                            {
                                if (State_gst_code[row_counter].Trim().ToUpper() == dtData1.Rows[iRowCount][i].ToString().ToUpper())
                                {
                                    temp_word2 = row_counter.ToString() + " - " + dtData1.Rows[iRowCount][i].ToString();
                                    row_counter = State_gst_code.Count;
                                }
                            }
                            temp_word += temp_word2 + " ,";
                        }
                        else
                            temp_word += dtData1.Rows[iRowCount][i].ToString() + " ,";
                    }
                    temp_word = temp_word.Substring(0, temp_word.Length - 1);
                    temporary_list_array.Add(temp_word);
                }
            }
            gst_csv_list.Clear();
            temp_count = 1;
            for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            {
                temp_word = "";
                var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
                get_account_details_from_01(cellArray[15], cellArray[16]);
                temp_word1 = cellArray[0] + " ," + cellArray[1];
                ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code,cgst_amt,sgst_amt,igst_amt from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[0] + " and amount > 0";
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    temp_word = "";
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                            temp_word = "Sales," + cellArray[0] + " ," + temp_count.ToString() + " ," + cellArray[3] + " ," + dtData1.Rows[iRowCount][10].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + dtData1.Rows[iRowCount][5].ToString() + " ," + dtData1.Rows[iRowCount][8].ToString() + " ," + cellArray[2] + " ," + dtData1.Rows[iRowCount][9].ToString() + " ," + dtData1.Rows[iRowCount][7].ToString() + " ," + dtData1.Rows[iRowCount][11].ToString() + " ," + dtData1.Rows[iRowCount][12].ToString() + " ," + (Convert.ToDouble(dtData1.Rows[iRowCount][7].ToString()) + Convert.ToDouble(dtData1.Rows[iRowCount][11].ToString()) + Convert.ToDouble(dtData1.Rows[iRowCount][12].ToString())).ToString();
                        else
                            temp_word = cellArray[1] + " ," + cellArray[4] + " " + account_detail_from_01[8] + " ," + "Sales," + cellArray[0] + " ," + temp_count.ToString() + " ," + cellArray[3] + " ," + dtData1.Rows[iRowCount][5].ToString() + " " + dtData1.Rows[iRowCount][8].ToString() + " ," + dtData1.Rows[iRowCount][6].ToString() + "/" + dtData1.Rows[iRowCount][8].ToString() + " ," + (Convert.ToDouble(dtData1.Rows[iRowCount][7].ToString()) + Convert.ToDouble(dtData1.Rows[iRowCount][11].ToString()) + Convert.ToDouble(dtData1.Rows[iRowCount][12].ToString())).ToString() + " ," + dtData1.Rows[iRowCount][7].ToString() + " ," + dtData1.Rows[iRowCount][11].ToString() + " ," + dtData1.Rows[iRowCount][12].ToString();
                        gst_csv_list.Add(temp_word);
                        temp_count++;
                    }
                }
            }
            csv_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + ConnectionWithAccess.mNIK + "_gst_" + ConnectionWithAccess.mprd + "_Sales_Register";
            csv_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            csv_filename += ".csv";
            ConnectionWithAccess.create_file_folder(csv_filename);
            if (File.Exists(csv_filename))
                File.Delete(csv_filename);
            StringBuilder sb = new StringBuilder();
            string strPeriod = Convert.ToDateTime(dtp_rg_from_date.Text).ToString("dd-MMM-yyyy") + " to " + Convert.ToDateTime(dtp_rg_to_date.Text).ToString("dd-MMM-yyyy");
            temp_word = "List of All Sales Vouchers, " + strPeriod + " ,,,,,,,,,,";
            sb.AppendLine(temp_word);
            temp_word = ",,,,,,,,,,,";
            sb.AppendLine(temp_word);
            temp_word = "Date,Particulars,Voucher Type,Vch No.,Voucher Ref.,TIN/Sales Tax No.,Quantity,Rate,Gross Total,GST SALES,SGST @ 9%,CGST @ 9%";
            sb.AppendLine(temp_word);
            for (row_counter = 0; row_counter < gst_csv_list.Count; row_counter++)
            {
                sb.AppendLine(gst_csv_list[row_counter]);
            }
            TextWriter writer = new StreamWriter(csv_filename);
            writer.WriteLine(sb);
            writer.Flush();
            //MessageBox.Show("File Created Successfully");
            writer.Close();

            string strExcelFileName = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + ConnectionWithAccess.mNIK + "_gst_" + ConnectionWithAccess.mprd + "_Sales_Register";
            strExcelFileName += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            strExcelFileName += ".xlsx";
            Convert_CSV_To_Excel(csv_filename, strExcelFileName);
            MergeColumns(strExcelFileName);
            if (File.Exists(csv_filename))
                File.Delete(csv_filename);
        }

        private void MergeColumns(string strFilePath)
        {
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strFilePath);

            Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];
            xlWorksheet.Name = "Sales Register";
            xlWorksheet.Columns.AutoFit();
            xlWorksheet.get_Range("A1", "B2").Cells.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;
            //xlWorksheet.Columns[0].ColumnWidth = 12;
            //xlWorksheet.Columns[1].ColumnWidth = 12;
            //xlWorksheet.Columns[2].ColumnWidth = 12;
            //xlWorksheet.Columns[3].ColumnWidth = 12;
            //xlWorksheet.Columns[4].ColumnWidth = 12;
            //xlWorksheet.Columns[5].ColumnWidth = 12;
            //xlWorksheet.Columns[6].ColumnWidth = 12;
            //xlWorksheet.Columns[7].ColumnWidth = 12;
            xlWorksheet.Range["B1:L1"].Merge();
            xlWorksheet.Range["B1:L1"].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            xlWorkbook.Save();
            xlWorkbook.Close();
        }

        private void generate_gstr1_csv_file()
        {
            generate_gstr1_b2b_csv_file();
            generate_gstr1_b2cs_csv_file();
            //generate_gstr1_json_file();
        }

        private void generate_gstr1_b2b_csv_file()
        {
            temporary_list_array.Clear();
            ConnectionWithAccess.query = "select f1.gst_number,f21.D_N, f21.D_D, f1.[desc] as [Desc],f1.state, 'N','Regular', '',f21.bamt,f21.sgst_amt,f21.cgst_amt,f21.IGST_AMT, f21.gamt,f21.prd,f21.d_c from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_n <> 999999 and f21.d_d >= @From and f21.d_d <= @To order by d_n asc ";
            parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                int mcolumncount = dtData1.Columns.Count;
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temp_word = "";
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        if (i == 2)
                        {
                            temp_word1 = dtData1.Rows[iRowCount][i].ToString();
                            temp_word1 = temp_word1.Substring(0, temp_word1.IndexOf(" "));
                            temp_word1 = Convert.ToDateTime(temp_word1).ToString("dd-MMM-yy");
                            temp_word += temp_word1 + " ,";
                        }
                        else if (i == 4)
                        {
                            temp_word1 = dtData1.Rows[iRowCount][i].ToString();
                            for (row_counter = 0; row_counter < State_gst_code.Count; row_counter++)
                            {
                                if (State_gst_code[row_counter].Trim().ToUpper() == dtData1.Rows[iRowCount][i].ToString().ToUpper())
                                {
                                    temp_word2 = row_counter.ToString() + " - " + dtData1.Rows[iRowCount][i].ToString();
                                    row_counter = State_gst_code.Count;
                                }
                            }
                            temp_word += temp_word2 + " ,";
                        }
                        else
                            temp_word += dtData1.Rows[iRowCount][i].ToString() + " ,";
                    }
                    temp_word = temp_word.Substring(0, temp_word.Length - 1);
                    temporary_list_array.Add(temp_word);
                }
            }
            gst_csv_list_b2b.Clear();
            basicamount = 0;
            grossamount = 0;
            cessamount = 0;
            tax_rate = 0;
            temp_int = 0;
            for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            {
                temp_word = "";
                var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
                if (cellArray[0] != "")
                {
                    basicamount += Convert.ToDouble(cellArray[8]);
                    temp_int++;
                    //ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0";
                    ConnectionWithAccess.query = "select d_n, sum(amount) as Amount,igst_per from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0 group by d_n, igst_per ";
                    dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        if (dtData1.Rows.Count > 1)
                        {
                            temporary_list_1.Clear();
                            temp_word = "";
                            temp_int = 0;
                            temp_double = 0;
                            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                            {
                                temp_double = Convert.ToDouble(dtData1.Rows[iRowCount]["amount"].ToString()) + (Convert.ToDouble(dtData1.Rows[iRowCount]["amount"].ToString()) * Convert.ToDouble(dtData1.Rows[iRowCount]["igst_per"].ToString()) / 100);
                                if (iRowCount == 0)
                                    temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + String.Format("{0:0.00}", temp_double) + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + " ,";
                                else
                                    temp_word1 = cellArray[0] + " ," + cellArray[1] + "/" + temp_int + " ," + cellArray[2] + " ," + String.Format("{0:0.00}", temp_double) + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + " ,";
                                temp_word = temp_word1 + String.Format("{0:0.00}", dtData1.Rows[iRowCount]["igst_per"].ToString()) + " ," + String.Format("{0:0.00}", dtData1.Rows[iRowCount]["amount"].ToString()).ToString() + " ,";
                                temporary_list_1.Add(temp_word);
                                gst_csv_list_b2b.Add(temp_word);
                                grossamount += temp_double;
                                temp_int++;
                            }
                        }
                        else
                        {
                            temp_word = "";
                            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                            {
                                temp_double = Convert.ToDouble(cellArray[8]) + (Convert.ToDouble(cellArray[8]) * Convert.ToDouble(dtData1.Rows[iRowCount]["igst_per"].ToString()) / 100);
                                temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + String.Format("{0:0.00}", temp_double) + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + " ,";
                                temp_word = temp_word1 + String.Format("{0:0.00}", dtData1.Rows[iRowCount]["igst_per"].ToString()) + " ," + String.Format("{0:0.00}", dtData1.Rows[iRowCount]["amount"].ToString()) + " ,";
                                grossamount += temp_double;
                                gst_csv_list_b2b.Add(temp_word);
                            }
                        }
                    }
                }
            }
            if (cmbDateRangeGST.Text != "Custom Range")
                csv_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + cmbDateRangeGST.Text + "_" + Convert.ToDateTime(dtp_rg_from_date.Text).Year + "-" + (Convert.ToDateTime(dtp_rg_from_date.Text).Year + 1).ToString().Substring(2, 2) + "_GSTR1_" + ConnectionWithAccess.company_details[32] + "_b2b";
            else
            {
                csv_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + ConnectionWithAccess.mNIK + "_gst_" + ConnectionWithAccess.mprd + "_gtr1_b2b";
                csv_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            }
            csv_filename += ".csv";
            ConnectionWithAccess.create_file_folder(csv_filename);
            if (File.Exists(csv_filename))
                File.Delete(csv_filename);
            StringBuilder sb = new StringBuilder();
            temp_word = "GSTIN/UIN of Recipient,Invoice Number,Invoice date,Invoice Value,Place Of Supply,Reverse Charge,Invoice Type,E-Commerce GSTIN,Rate,Taxable Value,Cess Amount";
            sb.AppendLine(temp_word);
            for (row_counter = 0; row_counter < gst_csv_list_b2b.Count; row_counter++)
            {
                sb.AppendLine(gst_csv_list_b2b[row_counter]);
            }
            TextWriter writer = new StreamWriter(csv_filename);
            writer.WriteLine(sb);
            writer.Flush();
            writer.Close();
        }

        private void generate_gstr1_b2cs_csv_file()
        {
            if (temporary_list_array.Count > 1)
            {
                gst_csv_list_b2cs.Clear();
                //ConnectionWithAccess.query = "select sum(amount) as Amount,igst_per from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0 group by igst_per";
                ConnectionWithAccess.query = " select f1.state,f3.igst_per, sum(amount) as Amount " +
                    "from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21, " + ConnectionWithAccess.tablename[03] + " f3 " +
                    "where f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd =  '" + ConnectionWithAccess.mprd + "' and f21.d_n <> 999999  " +
                    "and f3.d_n  = f21.d_n and f3.d_c = f21.d_c and f3.prd = f21.prd and f3.amount > 0 " +
                    "and f21.d_d >= @From and f21.d_d <= @To  and f1.gst_number = '' " +
                    "group by f1.state,f3.igst_per ";

                parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    temp_word = "";
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        temp_word1 = dtData1.Rows[iRowCount]["State"].ToString();
                        for (row_counter = 0; row_counter < State_gst_code.Count; row_counter++)
                        {
                            if (State_gst_code[row_counter].Trim().ToUpper() == dtData1.Rows[iRowCount]["State"].ToString().ToUpper())
                            {
                                temp_word2 = row_counter.ToString() + " - " + dtData1.Rows[iRowCount]["State"].ToString();
                                row_counter = State_gst_code.Count;
                            }
                        }
                        temp_word = "OE," + temp_word2 + " ," + dtData1.Rows[iRowCount]["igst_per"].ToString() + " ," + dtData1.Rows[iRowCount]["Amount"].ToString() + " ,,,";
                        gst_csv_list_b2cs.Add(temp_word);
                    }
                }

                if (cmbDateRangeGST.Text != "Custom Range")
                    csv_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + cmbDateRangeGST.Text + "_" + Convert.ToDateTime(dtp_rg_from_date.Text).Year + "-" + (Convert.ToDateTime(dtp_rg_from_date.Text).Year + 1).ToString().Substring(2, 2) + "_GSTR1_" + ConnectionWithAccess.company_details[32] + "_b2cs";
                else
                {
                    csv_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + ConnectionWithAccess.mNIK + "_gst_" + ConnectionWithAccess.mprd + "_gtr1_b2cs";
                    csv_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                }
                csv_filename += ".csv";
                ConnectionWithAccess.create_file_folder(csv_filename);
                if (File.Exists(csv_filename))
                    File.Delete(csv_filename);
                StringBuilder sb = new StringBuilder();
                temp_word = "Type,Place Of Supply,Rate,Taxable Value,Cess Amount,E-Commerce GSTIN,";
                sb.AppendLine(temp_word);
                for (row_counter = 0; row_counter < gst_csv_list_b2cs.Count; row_counter++)
                {
                    sb.AppendLine(gst_csv_list_b2cs[row_counter]);
                }
                TextWriter writer = new StreamWriter(csv_filename);
                writer.WriteLine(sb);
                writer.Flush();
                writer.Close();
            }
        }

        private void generate_gstr1_b2cs_csv_fileold()
        {
            if (temporary_list_array.Count > 1)
            {
                gst_csv_list.Clear();
                for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
                {
                    var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
                    if (cellArray[0] == "")
                    {
                        temp_int++;
                        temp_word1 = "OE," + cellArray[4] + " ,";
                        //ConnectionWithAccess.query = "select f1.state, f21.bamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_n <> 999999 and f21.d_d >= @From and f21.d_d <= @To " + " and gamt > 0 group by igst_per";
                        //ConnectionWithAccess.query = "select f1.gst_number,f21.D_N, f21.D_D, f1.[desc] as [Desc],f1.state, 'N','Regular', '',f21.bamt,f21.sgst_amt,f21.cgst_amt,f21.IGST_AMT, f21.gamt,f21.prd,f21.d_c from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_n <> 999999 and f21.d_d >= @From and f21.d_d <= @To " + " and gamt > 0 group by igst_per";
                        ConnectionWithAccess.query = "select sum(amount) as Amount,igst_per from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0 group by igst_per";
                        DataTable dtData1 = ConnectionCommand.fGetDataTable();
                        if (dtData1 != null && dtData1.Rows.Count > 0)
                        {
                            temp_word = "";
                            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                            {
                                temp_word = temp_word1 + dtData1.Rows[iRowCount]["igst_per"].ToString() + " ," + dtData1.Rows[iRowCount]["amount"].ToString() + " ,,,";
                                gst_csv_list.Add(temp_word);
                            }
                        }
                    }
                }
                if (cmbDateRangeGST.Text != "Custom Range")
                    csv_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + cmbDateRangeGST.Text + "_" + Convert.ToDateTime(dtp_rg_from_date.Text).Year + "-" + (Convert.ToDateTime(dtp_rg_from_date.Text).Year + 1).ToString().Substring(2, 2) + "_GSTR1_" + ConnectionWithAccess.company_details[32] + "_b2cs";
                else
                {
                    csv_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + ConnectionWithAccess.mNIK + "_gst_" + ConnectionWithAccess.mprd + "_gtr1";
                    csv_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                }
                csv_filename += ".csv";
                ConnectionWithAccess.create_file_folder(csv_filename);
                if (File.Exists(csv_filename))
                    File.Delete(csv_filename);
                StringBuilder sb = new StringBuilder();
                temp_word = "Type,Place Of Supply,Rate,Taxable Value,Cess Amount,E-Commerce GSTIN,";
                sb.AppendLine(temp_word);
                for (row_counter = 0; row_counter < gst_csv_list.Count; row_counter++)
                {
                    sb.AppendLine(gst_csv_list[row_counter]);
                }
                TextWriter writer = new StreamWriter(csv_filename);
                writer.WriteLine(sb);
                writer.Flush();
                writer.Close();
            }
        }

        #endregion

        private void generate_gstr1_json_file()
        {
            temporary_list_array.Clear();
            if (cmbDateRangeGST.Text != "Custom Range")
                csv_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + cmbDateRangeGST.Text + "_" + Convert.ToDateTime(dtp_rg_from_date.Text).Year + "-" + (Convert.ToDateTime(dtp_rg_from_date.Text).Year + 1).ToString().Substring(2, 2) + "_GSTR1_" + ConnectionWithAccess.company_details[32];
            else
            {
                csv_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + ConnectionWithAccess.mNIK + "_gst_" + ConnectionWithAccess.mprd + "_gtr1";
                csv_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            }
            csv_filename += ".json";
            ConnectionWithAccess.create_file_folder(csv_filename);
            if (File.Exists(csv_filename))
                File.Delete(csv_filename);
            temp_d_n = 0;
            StringBuilder sb = new StringBuilder();
            add_b2b_data_for_json();
            temp_gst_company_details = "\"gstin\":\"" + ConnectionWithAccess.company_details[32] + "\",";
            temp_word1 = dtp_rg_from_date.Text.Substring(3, 2) + dtp_rg_from_date.Text.Substring(6, 4);
            temp_gst_company_details += "\"fp\":\"" + temp_word1 + "\",\"gt\":1,\"cur_gt\":2,\"version\":\"GST1.1\",\"hash\":\"hash\",";
            temp_gst_b2b_details = "\"b2b\":[";
            for (row_counter = 0; row_counter < gst_csv_list_b2b.Count; row_counter++)
            {
                var cellArray = gst_csv_list_b2b[row_counter].Split(new[] { ',' });
                if (cellArray[3].Contains("."))
                {
                    if (cellArray[3].Length > cellArray[3].IndexOf(".") + 3)
                        cellArray[3] = cellArray[3].Substring(0, cellArray[3].IndexOf(".") + 3);

                }
                if (cellArray[8].Contains("."))
                {
                    if (cellArray[8].Length > cellArray[8].IndexOf(".") + 3)
                        cellArray[8] = cellArray[8].Substring(0, cellArray[8].IndexOf(".") + 3);

                }
                if (cellArray[9].Contains("."))
                {
                    if (cellArray[9].Length > cellArray[9].IndexOf(".") + 3)
                        cellArray[9] = cellArray[9].Substring(0, cellArray[9].IndexOf(".") + 3);

                }
                //if (!cellArray[1].Contains("/"))
                //{
                temp_word += "{";
                temp_d_n = Convert.ToInt32(cellArray[1]);
                if (cellArray[0] != old_gstnumber)
                    temp_gst_number_details = "\"ctin\":\"" + cellArray[0] + "\",\"inv\":";
                temp_gst_invoice_details = "\"inum\":\"" + cellArray[1] + "\",\"idt\":\"" + cellArray[2] + "\",\"val\":" + cellArray[3].Replace(".00", "") + " ,\"pos\":\"" + cellArray[4].Substring(0, cellArray[4].IndexOf(" ")) + "\",\"rchrg\":\"" + cellArray[5] + "\",\"inv_typ\":\"" + cellArray[6].Substring(0, 1) + "\",\"itms\":";
                temp_gst_tax_details = "\"num\":1,\"itm_det\":";
                temp_gst_tax_details += "{\"txval\":" + cellArray[9].Replace(".00", "") + " ,\"rt\":" + cellArray[8].Replace(".00", "") + " ,\"camt\":" + (Convert.ToDouble(cellArray[9]) * Convert.ToDouble(cellArray[8]) / 2 / 100).ToString().Replace(".00", "") + " ,\"samt\":" + (Convert.ToDouble(cellArray[9]) * Convert.ToDouble(cellArray[8]) / 2 / 100).ToString().Replace(".00", "") + " ,\"csamt\":" + cellArray[10] + "}";

                temp_word = "{" + temp_gst_number_details + "{" + "[" + temp_gst_invoice_details + "[" + temp_gst_tax_details + "]" + "]" + "}";
                if (cellArray[0] != old_gstnumber)
                    temp_word += "}";
                old_gstnumber = cellArray[0];
                //}
                //else
                //{
                //    temp_word1 = cellArray[1].Substring(0,cellArray[1].IndexOf("/"));
                //    if (temp_d_n == Convert.ToInt32(cellArray[1].Substring(0, cellArray[1].IndexOf("/"))))
                //    {
                //        temp_word += "{\"inum\":\"" + cellArray[1] + "\",\"idt\":\"" + cellArray[2] + "\",\"val\":" + cellArray[3].Replace(".00", "") + " ,\"pos\":\"" + cellArray[4].Substring(0, cellArray[4].IndexOf(" ")) + "\",\"rchrg\":\"" + cellArray[5] + "\",\"inv_typ\":\"" + cellArray[6].Substring(0, 1) + "\",\"itms\":";
                //        temp_word += "{\"num\":1,\"itm_det\":{\"txval\":" + cellArray[9].Replace(".00", "") + " ,\"rt\":" + cellArray[8].Replace(".00", "") + " ,\"camt\":" + (Convert.ToDouble(cellArray[9]) * Convert.ToDouble(cellArray[8]) / 2 / 100).ToString().Replace(".00", "") + " ,\"samt\":" + (Convert.ToDouble(cellArray[9]) * Convert.ToDouble(cellArray[8]) / 2 / 100).ToString().Replace(".00", "") + " ,\"csamt\":" + cellArray[10] + "}";
                //        temp_word += "}";
                //        temp_word += "]}]},";
                //    }
                //}
            }
            //temp_word = temp_word.Substring(0, temp_word.Length - 1);
            temp_gst_b2b_details += temp_word + "]";
            temp_gst_json_full_details = "{" + temp_gst_company_details + temp_gst_b2b_details + "}";

            sb.AppendLine(temp_gst_json_full_details);
            TextWriter writer = new StreamWriter(csv_filename);
            writer.WriteLine(sb);
            writer.Flush();
            writer.Close();
        }

        private void add_b2b_data_for_json()
        {
            ConnectionWithAccess.query = "select f1.gst_number,f21.D_N, f21.D_D, f1.[desc] as [Desc],f1.state, 'N','Regular', '',f21.bamt,f21.sgst_amt,f21.cgst_amt,f21.IGST_AMT, f21.gamt,f21.prd,f21.d_c from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_n <> 999999 and f21.d_d >= @From and f21.d_d <= @To order by d_n asc ";
            parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                int mcolumncount = dtData1.Columns.Count;
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temp_word = "";
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        if (i == 2)
                        {
                            temp_word1 = dtData1.Rows[iRowCount][i].ToString();
                            temp_word1 = temp_word1.Substring(0, temp_word1.IndexOf(" "));
                            temp_word1 = Convert.ToDateTime(temp_word1).ToString("dd-MM-yyyy");
                            temp_word += temp_word1 + " ,";
                        }
                        else if (i == 4)
                        {
                            temp_word1 = dtData1.Rows[iRowCount][i].ToString();
                            for (row_counter = 0; row_counter < State_gst_code.Count; row_counter++)
                            {
                                if (State_gst_code[row_counter].Trim().ToUpper() == dtData1.Rows[iRowCount][i].ToString().ToUpper())
                                {
                                    temp_word2 = row_counter.ToString() + " - " + dtData1.Rows[iRowCount][i].ToString();
                                    row_counter = State_gst_code.Count;
                                }
                            }
                            temp_word += temp_word2 + " ,";
                        }
                        else
                            temp_word += dtData1.Rows[iRowCount][i].ToString() + " ,";
                    }
                    temp_word = temp_word.Substring(0, temp_word.Length - 1);
                    temporary_list_array.Add(temp_word);
                }
            }
            gst_csv_list_b2b.Clear();
            basicamount = 0;
            grossamount = 0;
            cessamount = 0;
            tax_rate = 0;
            temp_int = 0;
            for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            {
                temp_word = "";
                var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
                if (cellArray[0] != "")
                {
                    basicamount += Convert.ToDouble(cellArray[8]);
                    temp_int++;
                    //ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0";
                    ConnectionWithAccess.query = "select d_n, sum(amount) as Amount,igst_per from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0 group by d_n, igst_per ";
                    dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        if (dtData1.Rows.Count > 1)
                        {
                            temporary_list_1.Clear();
                            temp_word = "";
                            temp_int = 0;
                            temp_double = 0;
                            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                            {
                                temp_double = Convert.ToDouble(dtData1.Rows[iRowCount]["amount"].ToString()) + (Convert.ToDouble(dtData1.Rows[iRowCount]["amount"].ToString()) * Convert.ToDouble(dtData1.Rows[iRowCount]["igst_per"].ToString()) / 100);
                                if (iRowCount == 0)
                                    temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + temp_double + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + " ,";
                                else
                                    temp_word1 = cellArray[0] + " ," + cellArray[1] + "/" + temp_int + " ," + cellArray[2] + " ," + temp_double + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + " ,";
                                temp_word = temp_word1 + dtData1.Rows[iRowCount]["igst_per"].ToString() + " ," + dtData1.Rows[iRowCount]["amount"].ToString().ToString() + " ,0";
                                temporary_list_1.Add(temp_word);
                                gst_csv_list_b2b.Add(temp_word);
                                grossamount += temp_double;
                                temp_int++;
                            }
                        }
                        else
                        {
                            temp_word = "";
                            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                            {
                                temp_double = Convert.ToDouble(cellArray[8]) + (Convert.ToDouble(cellArray[8]) * Convert.ToDouble(dtData1.Rows[iRowCount]["igst_per"].ToString()) / 100);
                                temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + temp_double + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + " ,";
                                temp_word = temp_word1 + dtData1.Rows[iRowCount]["igst_per"].ToString() + " ," + dtData1.Rows[iRowCount]["amount"].ToString() + " ,0";
                                grossamount += temp_double;
                                gst_csv_list_b2b.Add(temp_word);
                            }
                        }
                    }
                }
            }
        }

        # region gst_excel_format
        private void generate_GSTR1_excel_file()
        {
            temporary_list_array.Clear();
            ConnectionWithAccess.query = "select f1.gst_number,f21.D_N, f21.D_D, f1.[desc] as [Desc],f1.state, 'N','Regular', '',f21.bamt,f21.sgst_amt,f21.cgst_amt,f21.IGST_AMT, f21.gamt,f21.prd,f21.d_c from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_n <> 999999 and f21.d_d >= @From and f21.d_d <= @To order by d_n asc ";
            parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                int mcolumncount = dtData1.Columns.Count;
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temp_word = "";
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        if (i == 2)
                        {
                            temp_word1 = dtData1.Rows[iRowCount][i].ToString();
                            temp_word1 = temp_word1.Substring(0, temp_word1.IndexOf(" "));
                            temp_word1 = Convert.ToDateTime(temp_word1).ToString("dd-MMM-yyyy");
                            temp_word += temp_word1 + " ,";
                        }
                        else if (i == 4)
                        {
                            temp_word1 = dtData1.Rows[iRowCount][i].ToString();
                            for (row_counter = 0; row_counter < State_gst_code.Count; row_counter++)
                            {
                                if (State_gst_code[row_counter].Trim().ToUpper() == dtData1.Rows[iRowCount][i].ToString().ToUpper())
                                {
                                    temp_word2 = row_counter.ToString() + " - " + dtData1.Rows[iRowCount][i].ToString();
                                    row_counter = State_gst_code.Count;
                                }
                            }
                            temp_word += temp_word2 + " ,";
                        }
                        else
                            temp_word += dtData1.Rows[iRowCount][i].ToString() + " ,";
                    }
                    temp_word = temp_word.Substring(0, temp_word.Length - 1);
                    temporary_list_array.Add(temp_word);
                }
            }
            gst_csv_list.Clear();
            basicamount = 0;
            grossamount = 0;
            cessamount = 0;
            temp_int = 0;
            for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            {
                temp_word = "";
                var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
                if (cellArray[0] != "")
                {
                    basicamount += Convert.ToDouble(cellArray[8]);
                    temp_int++;
                    //ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0";
                    ConnectionWithAccess.query = "select d_n, sum(amount) as Amount,igst_per from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0 group by d_n, igst_per ";
                    dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        if (dtData1.Rows.Count > 1)
                        {
                            temporary_list_1.Clear();
                            temp_word = "";
                            temp_int = 0;
                            temp_double = 0;
                            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                            {
                                temp_double = Convert.ToDouble(dtData1.Rows[iRowCount]["amount"].ToString()) + (Convert.ToDouble(dtData1.Rows[iRowCount]["amount"].ToString()) * Convert.ToDouble(dtData1.Rows[iRowCount]["igst_per"].ToString()) / 100);

                                if (iRowCount == 0)
                                    temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + temp_double + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[0] + " ,";
                                else
                                    temp_word1 = cellArray[0] + " ,=\"" + cellArray[1] + "/" + temp_int + "\"," + cellArray[2] + " ," + temp_double + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[0] + " ,";
                                temp_word = temp_word1 + dtData1.Rows[iRowCount]["igst_per"].ToString() + " ," + dtData1.Rows[iRowCount]["amount"].ToString();
                                //gst_csv_list.Add(temp_word);
                                temporary_list_1.Add(temp_word);
                                gst_csv_list.Add(temp_word);
                                grossamount += temp_double;
                                temp_int++;
                            }
                        }
                        else
                        {
                            temp_word = "";
                            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                            {
                                temp_double = Convert.ToDouble(cellArray[8]) + (Convert.ToDouble(cellArray[8]) * Convert.ToDouble(dtData1.Rows[iRowCount]["igst_per"].ToString()) / 100);
                                temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + temp_double + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[0] + " ,";
                                temp_word = temp_word1 + dtData1.Rows[iRowCount]["igst_per"].ToString() + " ," + dtData1.Rows[iRowCount]["amount"].ToString();
                                grossamount += temp_double;
                                gst_csv_list.Add(temp_word);
                            }
                        }
                    }
                }
            }
            csv_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + ConnectionWithAccess.mNIK + "_gst_" + ConnectionWithAccess.mprd + "_GSTR1";
            csv_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            csv_filename += ".csv";
            ConnectionWithAccess.create_file_folder(csv_filename);
            //if (File.Exists(csv_filename))
            //    File.Delete(csv_filename);
            StringBuilder sb = new StringBuilder();
            temp_word = "Summary for B2B(4)";
            sb.AppendLine(temp_word);
            temp_word = "No. of Recipents, No of Invoices,, Total Invoice Value,,,,,,Total Taxable Value, Total Cess";
            sb.AppendLine(temp_word);
            temp_word = "1," + temp_int.ToString() + " ,," + Convert.ToDouble(grossamount) + " ,,,,,," + Convert.ToDouble(basicamount) + " ," + cessamount.ToString();
            sb.AppendLine(temp_word);
            temp_word = "GSTIN/UIN of Recipient,Invoice Number,Invoice date,Invoice Value,Place Of Supply,Reverse Charge,Invoice Type,E-Commerce GSTIN,Rate,Taxable Value,Cess Amount,";
            sb.AppendLine(temp_word);
            for (row_counter = 0; row_counter < gst_csv_list.Count; row_counter++)
            {
                sb.AppendLine(gst_csv_list[row_counter]);
            }
            TextWriter writer = new StreamWriter(csv_filename);
            writer.WriteLine(sb);
            writer.Flush();
            writer.Close();
            string strExcelFileName = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + ConnectionWithAccess.mNIK + "_gst_" + ConnectionWithAccess.mprd + "_GSTR1";
            if (cmbDateRangeGST.Text != "Custom Range")
                strExcelFileName += "_" + cmbDateRangeGST.Text;
            else
                strExcelFileName += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            strExcelFileName += ".xlsx";
            Convert_CSV_To_Excel(csv_filename, strExcelFileName);
            //if (File.Exists(csv_filename))
            //    File.Delete(csv_filename);
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strExcelFileName);
            Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];
            xlWorksheet.Name = "B2B";
            xlWorksheet.Columns.AutoFit();
            xlWorksheet.get_Range("A1", "B2").Cells.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;
            xlWorksheet.get_Range("A1").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlWorksheet.get_Range("A2", "K2").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlWorksheet.get_Range("A4", "K4").Cells.Interior.Color = System.Drawing.Color.FromArgb(250, 192, 144);
            xlWorksheet.get_Range("A2", "K2").Cells.Font.Color = Color.White;
            xlWorksheet.Cells.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;
            xlWorksheet.Range["D3"].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            xlWorksheet.Range["J3"].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            xlWorksheet.Range["K3"].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            xlWorksheet.Range["A5", "A" + gst_csv_list.Count + 4].HorizontalAlignment = Excel.XlHAlign.xlHAlignLeft;
            xlWorksheet.Range["B5", "B" + gst_csv_list.Count + 4].HorizontalAlignment = Excel.XlHAlign.xlHAlignLeft;
            xlWorksheet.Range["B5", "B" + gst_csv_list.Count + 4].NumberFormat = "@";
            xlWorksheet.Range["C4", "C" + gst_csv_list.Count + 4].NumberFormat = "dd-mmm-yyyy";
            xlWorksheet.Range["D2", "D" + gst_csv_list.Count + 4].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            xlWorksheet.Range["D2", "D" + gst_csv_list.Count + 4].NumberFormat = "0.00";
            xlWorksheet.Range["J2", "I" + gst_csv_list.Count + 4].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            xlWorksheet.Range["J2", "I" + gst_csv_list.Count + 4].NumberFormat = "0.00";
            xlWorksheet.Range["J2", "J" + gst_csv_list.Count + 4].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            xlWorksheet.Range["J2", "J" + gst_csv_list.Count + 4].NumberFormat = "0.00";
            xlWorksheet.Range["K2", "K" + gst_csv_list.Count + 4].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            //xlWorksheet.Columns[0].ColumnWidth = 12;
            xlWorkbook.Save();
            xlWorkbook.Close();
            add_b2cl_sheet_in_GSTR1_excel_sheet(strExcelFileName);
            add_b2cs_sheet_in_GSTR1_excel_sheet(strExcelFileName);
            add_cdnr_sheet_in_GSTR1_excel_sheet(strExcelFileName);
            add_cdnur_sheet_in_GSTR1_excel_sheet(strExcelFileName);
            add_exp_sheet_in_GSTR1_excel_sheet(strExcelFileName);
            add_at_sheet_in_GSTR1_excel_sheet(strExcelFileName);
            add_atadj_sheet_in_GSTR1_excel_sheet(strExcelFileName);
            add_exemp_sheet_in_GSTR1_excel_sheet(strExcelFileName);
            add_hsn_sheet_in_GSTR1_excel_sheet(strExcelFileName);
            add_docs_sheet_in_GSTR1_excel_sheet(strExcelFileName);
            add_master_sheet_in_GSTR1_excel_sheet(strExcelFileName);
        }

        private void add_b2cl_sheet_in_GSTR1_excel_sheet(string strExcelFileName)
        {
            gst_csv_list.Clear();
            basicamount = 0;
            grossamount = 0;
            cessamount = 0;
            temp_int = 0;
            temp_word = "Summary for B2CL(5),,,,,,,,,,";
            gst_csv_list.Add(temp_word);
            temp_word = "No of Invoices,, Total Invoice Value,,,Total Taxable Value, Total Cess,";
            gst_csv_list.Add(temp_word);
            temp_word = temp_int.ToString() + " ,," + Convert.ToDouble(grossamount) + " ,,," + Convert.ToDouble(basicamount) + " ," + Convert.ToDouble(cessamount) + " ,";
            gst_csv_list.Add(temp_word);
            temp_word = "Invoice Number,Invoice date,Invoice Value,Place Of Supply,Rate,Taxable Value,Cess Amount,E-Commerce GSTIN";
            gst_csv_list.Add(temp_word);
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strExcelFileName);
            var xlSheets = xlWorkbook.Sheets as Excel.Sheets;
            var xlNewSheet = (Excel.Worksheet)xlSheets.Add(After: xlWorkbook.Sheets[xlWorkbook.Sheets.Count]);
            xlNewSheet.Name = "B2CL";
            xlNewSheet.get_Range("A1", "B2").Cells.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;
            xlNewSheet.get_Range("A1").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A2", "H2").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A4", "H4").Cells.Interior.Color = System.Drawing.Color.FromArgb(250, 192, 144);
            xlNewSheet.get_Range("A2", "H2").Cells.Font.Color = Color.White;
            xlNewSheet.Cells.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;
            xlNewSheet.Range["D2", "D" + gst_csv_list.Count + 4].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            AddDataInNewExcelSheet(xlNewSheet);
            xlNewSheet.Columns.AutoFit();
            xlWorkbook.Save();
            xlWorkbook.Close();
        }

        private void add_b2cs_sheet_in_GSTR1_excel_sheet(string strExcelFileName)
        {
            gst_csv_list.Clear();
            basicamount = 0;
            grossamount = 0;
            cessamount = 0;
            temp_int = 0;
            for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            {
                var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
                if (cellArray[0] == "")
                {
                    basicamount += Convert.ToDouble(cellArray[8]);
                    temp_int++;
                }
            }
            temp_word = "Summary for B2CS(7)";
            gst_csv_list.Add(temp_word);
            temp_word = ",,,Total Taxable Value, Total Cess";
            gst_csv_list.Add(temp_word);
            temp_word = ",,," + Convert.ToDouble(basicamount) + " ," + Convert.ToDouble(cessamount) + " ,";
            gst_csv_list.Add(temp_word);
            temp_word = "Type,Place Of Supply,Rate,Taxable Value,Cess Amount,E-Commerce GSTIN";
            gst_csv_list.Add(temp_word);
            for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            {
                var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
                if (cellArray[0] == "")
                {
                    temp_int++;
                    temp_word1 = "OE," + cellArray[4] + " ,";
                    //ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0";
                    ConnectionWithAccess.query = "select d_n, sum(amount) as Amount,igst_per from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0 group by d_n, igst_per";
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        temp_word = "";
                        for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                        {
                            temp_word = temp_word1 + dtData1.Rows[iRowCount]["igst_per"].ToString() + " ," + dtData1.Rows[iRowCount]["amount"].ToString();
                            gst_csv_list.Add(temp_word);
                        }
                    }
                }
            }
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strExcelFileName);
            var xlSheets = xlWorkbook.Sheets as Excel.Sheets;
            var xlNewSheet = (Excel.Worksheet)xlSheets.Add(After: xlWorkbook.Sheets[xlWorkbook.Sheets.Count]);
            xlNewSheet.Name = "b2cs";
            xlNewSheet.get_Range("A1", "B2").Cells.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;
            xlNewSheet.get_Range("A1").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A2", "F2").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A4", "F4").Cells.Interior.Color = System.Drawing.Color.FromArgb(250, 192, 144);
            xlNewSheet.get_Range("A2", "F2").Cells.Font.Color = Color.White;
            xlNewSheet.Cells.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;
            xlNewSheet.Range["C2", "C" + gst_csv_list.Count].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            xlNewSheet.Range["C2", "C" + gst_csv_list.Count].NumberFormat = "0.00";
            xlNewSheet.Range["D2", "D" + gst_csv_list.Count].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            xlNewSheet.Range["D2", "D" + gst_csv_list.Count].NumberFormat = "0.00";
            AddDataInNewExcelSheet(xlNewSheet);
            xlNewSheet.Columns.AutoFit();
            xlWorkbook.Save();
            xlWorkbook.Close();
        }

        private void add_cdnr_sheet_in_GSTR1_excel_sheet(string strExcelFileName)
        {
            gst_csv_list.Clear();
            basicamount = 0;
            grossamount = 0;
            cessamount = 0;
            temp_int = 0;
            temp_word = "Summary for CDNR(9B)";
            gst_csv_list.Add(temp_word);
            temp_word = "No. of Recipients,No of Invoices,,No of Notes/Vouchers, Total Note Value,Total Taxable Value, Total Cess";
            gst_csv_list.Add(temp_word);
            temp_word = "1," + temp_int.ToString() + " ,," + Convert.ToDouble(grossamount) + " ,,,,,," + Convert.ToDouble(basicamount) + " ," + Convert.ToDouble(cessamount) + " ,";
            gst_csv_list.Add(temp_word);
            temp_word = "UR Type,Note/Refund Voucher Number,Note/Refund Voucher date,Document Type,Invoice/Advance Receipt Number,Invoice/Advance Receipt Date,Reason of issuing document,Place Of Supply,Note/Refund Voucher Value,Rate,Taxable Value,Cess Amount,Pre GST";
            gst_csv_list.Add(temp_word);
            //for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            //{
            //    temp_word = "";
            //    var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
            //    if (cellArray[0] == "")
            //    {
            //        basicamount += Convert.ToDouble(cellArray[8]);
            //        grossamount += Convert.ToDouble(cellArray[12]);
            //        temp_int++;
            //        temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + cellArray[12] + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[0] + " ,";
            //        ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0";
            //        DataTable dtData1 = ConnectionCommand.fGetDataTable();
            //        if (dtData1 != null && dtData1.Rows.Count > 0)
            //        {
            //            temp_word = "";
            //            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
            //            {
            //                temp_word = temp_word1 + dtData1.Rows[iRowCount][9].ToString() + " ," + dtData1.Rows[iRowCount][7].ToString();
            //                gst_csv_list.Add(temp_word);
            //            }
            //        }
            //    }
            //}
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strExcelFileName);
            var xlSheets = xlWorkbook.Sheets as Excel.Sheets;
            var xlNewSheet = (Excel.Worksheet)xlSheets.Add(After: xlWorkbook.Sheets[xlWorkbook.Sheets.Count]);
            xlNewSheet.Name = "cdnr";
            xlNewSheet.get_Range("A1", "B2").Cells.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;
            xlNewSheet.get_Range("A1").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A2", "M2").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A4", "M4").Cells.Interior.Color = System.Drawing.Color.FromArgb(250, 192, 144);
            xlNewSheet.get_Range("A2", "M2").Cells.Font.Color = Color.White;
            xlNewSheet.Cells.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;
            xlNewSheet.Range["D2", "D" + gst_csv_list.Count].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            AddDataInNewExcelSheet(xlNewSheet);
            xlNewSheet.Columns.AutoFit();
            xlWorkbook.Save();
            xlWorkbook.Close();
        }

        private void add_cdnur_sheet_in_GSTR1_excel_sheet(string strExcelFileName)
        {
            gst_csv_list.Clear();
            basicamount = 0;
            grossamount = 0;
            cessamount = 0;
            temp_int = 0;
            temp_word = "Summary for CDNUR(9B)";
            gst_csv_list.Add(temp_word);
            temp_word = "No. of Recipients,No of Invoices,,No of Notes/Vouchers, Total Note Value,Total Taxable Value, Total Cess";
            gst_csv_list.Add(temp_word);
            temp_word = "1," + temp_int.ToString() + " ,," + Convert.ToDouble(grossamount) + " ,,,,,," + Convert.ToDouble(basicamount) + " ," + Convert.ToDouble(cessamount) + " ,";
            gst_csv_list.Add(temp_word);
            temp_word = "UR Type,Note/Refund Voucher Number,Note/Refund Voucher date,Document Type,Invoice/Advance Receipt Number,Invoice/Advance Receipt Date,Reason of issuing document,Place Of Supply,Note/Refund Voucher Value,Rate,Taxable Value,Cess Amount,Pre GST";
            gst_csv_list.Add(temp_word);
            //for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            //{
            //    temp_word = "";
            //    var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
            //    if (cellArray[0] == "")
            //    {
            //        basicamount += Convert.ToDouble(cellArray[8]);
            //        grossamount += Convert.ToDouble(cellArray[12]);
            //        temp_int++;
            //        temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + cellArray[12] + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[0] + " ,";
            //        ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0";
            //        DataTable dtData1 = ConnectionCommand.fGetDataTable();
            //        if (dtData1 != null && dtData1.Rows.Count > 0)
            //        {
            //            temp_word = "";
            //            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
            //            {
            //                temp_word = temp_word1 + dtData1.Rows[iRowCount][9].ToString() + " ," + dtData1.Rows[iRowCount][7].ToString();
            //                gst_csv_list.Add(temp_word);
            //            }
            //        }
            //    }
            //}
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strExcelFileName);
            var xlSheets = xlWorkbook.Sheets as Excel.Sheets;
            var xlNewSheet = (Excel.Worksheet)xlSheets.Add(After: xlWorkbook.Sheets[xlWorkbook.Sheets.Count]);
            xlNewSheet.Name = "cdnur";
            xlNewSheet.get_Range("A1", "B2").Cells.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;
            xlNewSheet.get_Range("A1").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A2", "M2").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A4", "M4").Cells.Interior.Color = System.Drawing.Color.FromArgb(250, 192, 144);
            xlNewSheet.get_Range("A2", "M2").Cells.Font.Color = Color.White;
            xlNewSheet.Cells.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;
            xlNewSheet.Range["D2", "D" + gst_csv_list.Count].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            AddDataInNewExcelSheet(xlNewSheet);
            xlNewSheet.Columns.AutoFit();
            xlWorkbook.Save();
            xlWorkbook.Close();
        }

        private void add_exp_sheet_in_GSTR1_excel_sheet(string strExcelFileName)
        {
            gst_csv_list.Clear();
            basicamount = 0;
            grossamount = 0;
            temp_int = 0;
            //for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            //{
            //    temp_word = "";
            //    var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
            //    if (cellArray[0] == "")
            //    {
            //        basicamount += Convert.ToDouble(cellArray[8]);
            //        grossamount += Convert.ToDouble(cellArray[12]);
            //        temp_int++;
            //        temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + cellArray[12] + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[0] + " ,";
            //        ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0";
            //        DataTable dtData1 = ConnectionCommand.fGetDataTable();
            //        if (dtData1 != null && dtData1.Rows.Count > 0)
            //        {
            //            temp_word = "";
            //            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
            //            {
            //                temp_word = temp_word1 + dtData1.Rows[iRowCount][9].ToString() + " ," + dtData1.Rows[iRowCount][7].ToString();
            //                gst_csv_list.Add(temp_word);
            //            }
            //        }
            //    }
            //}
            StringBuilder sb = new StringBuilder();
            temp_word = "Summary For EXP(6)";
            gst_csv_list.Add(temp_word);
            temp_word = ",No of Invoices,, Total Invoice Value,,No of Shipping Bill,, Total Taxable Value";
            gst_csv_list.Add(temp_word);
            temp_word = "," + temp_int.ToString() + " ," + Convert.ToDouble(grossamount) + " ," + Convert.ToDouble(basicamount);
            gst_csv_list.Add(temp_word);
            temp_word = "Export Type,Invoice Number,Invoice date,Invoice Value,Part Code,Shipping Bill Number,Shipping Bill Date,Rate,Taxable Value";
            gst_csv_list.Add(temp_word);
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strExcelFileName);
            var xlSheets = xlWorkbook.Sheets as Excel.Sheets;
            //var xlNewSheet = (Excel.Worksheet)xlSheets.Add(xlSheets[1], Type.Missing, Type.Missing, Type.Missing);
            var xlNewSheet = (Excel.Worksheet)xlSheets.Add(After: xlWorkbook.Sheets[xlWorkbook.Sheets.Count]);//, Type.Missing, Type.Missing, Type.Missing);
            xlNewSheet.Name = "exp";
            xlNewSheet.Columns.AutoFit();
            xlNewSheet.get_Range("A1", "B2").Cells.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;
            xlNewSheet.get_Range("A1").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A2", "I2").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A4", "I4").Cells.Interior.Color = System.Drawing.Color.FromArgb(250, 192, 144);
            xlNewSheet.get_Range("A2", "I2").Cells.Font.Color = Color.White;
            xlNewSheet.Cells.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;
            xlNewSheet.Range["D2", "D" + gst_csv_list.Count].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            AddDataInNewExcelSheet(xlNewSheet);
            xlNewSheet.Columns.AutoFit();
            xlWorkbook.Save();
            xlWorkbook.Close();
        }

        private void add_at_sheet_in_GSTR1_excel_sheet(string strExcelFileName)
        {
            gst_csv_list.Clear();
            basicamount = 0;
            grossamount = 0;
            temp_int = 0;
            //for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            //{
            //    temp_word = "";
            //    var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
            //    if (cellArray[0] == "")
            //    {
            //        basicamount += Convert.ToDouble(cellArray[8]);
            //        grossamount += Convert.ToDouble(cellArray[12]);
            //        temp_int++;
            //        temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + cellArray[12] + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[0] + " ,";
            //        ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0";
            //        DataTable dtData1 = ConnectionCommand.fGetDataTable();
            //        if (dtData1 != null && dtData1.Rows.Count > 0)
            //        {
            //            temp_word = "";
            //            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
            //            {
            //                temp_word = temp_word1 + dtData1.Rows[iRowCount][9].ToString() + " ," + dtData1.Rows[iRowCount][7].ToString();
            //                gst_csv_list.Add(temp_word);
            //            }
            //        }
            //    }
            //}
            StringBuilder sb = new StringBuilder();
            temp_word = "Summary For Advance Received (11B)";
            gst_csv_list.Add(temp_word);
            temp_word = ",,Total Advance Received, Total Cess";
            gst_csv_list.Add(temp_word);
            temp_word = ",," + Convert.ToDouble(grossamount) + " ," + Convert.ToDouble(basicamount);
            gst_csv_list.Add(temp_word);
            temp_word = "Place Of Supply,Rate,Gross Advance Received,Cess Amount";
            gst_csv_list.Add(temp_word);
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strExcelFileName);
            var xlSheets = xlWorkbook.Sheets as Excel.Sheets;
            //var xlNewSheet = (Excel.Worksheet)xlSheets.Add(xlSheets[1], Type.Missing, Type.Missing, Type.Missing);
            var xlNewSheet = (Excel.Worksheet)xlSheets.Add(After: xlWorkbook.Sheets[xlWorkbook.Sheets.Count]);//, Type.Missing, Type.Missing, Type.Missing);
            xlNewSheet.Name = "at";
            xlNewSheet.Columns.AutoFit();
            xlNewSheet.get_Range("A1", "B2").Cells.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;
            xlNewSheet.get_Range("A1").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A2", "D2").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A4", "D4").Cells.Interior.Color = System.Drawing.Color.FromArgb(250, 192, 144);
            xlNewSheet.get_Range("A2", "D2").Cells.Font.Color = Color.White;
            xlNewSheet.Cells.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;
            xlNewSheet.Range["D2", "D" + gst_csv_list.Count].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            AddDataInNewExcelSheet(xlNewSheet);
            xlNewSheet.Columns.AutoFit();
            xlWorkbook.Save();
            xlWorkbook.Close();
        }

        private void add_atadj_sheet_in_GSTR1_excel_sheet(string strExcelFileName)
        {
            gst_csv_list.Clear();
            basicamount = 0;
            grossamount = 0;
            temp_int = 0;
            //for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            //{
            //    temp_word = "";
            //    var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
            //    if (cellArray[0] == "")
            //    {
            //        basicamount += Convert.ToDouble(cellArray[8]);
            //        grossamount += Convert.ToDouble(cellArray[12]);
            //        temp_int++;
            //        temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + cellArray[12] + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[0] + " ,";
            //        ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0";
            //        DataTable dtData1 = ConnectionCommand.fGetDataTable();
            //        if (dtData1 != null && dtData1.Rows.Count > 0)
            //        {
            //            temp_word = "";
            //            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
            //            {
            //                temp_word = temp_word1 + dtData1.Rows[iRowCount][9].ToString() + " ," + dtData1.Rows[iRowCount][7].ToString();
            //                gst_csv_list.Add(temp_word);
            //            }
            //        }
            //    }
            //}
            StringBuilder sb = new StringBuilder();
            temp_word = "Summary For Advance Adjusted (11B)";
            gst_csv_list.Add(temp_word);
            temp_word = ",,Total Advance Adjusted, Total Cess";
            gst_csv_list.Add(temp_word);
            temp_word = ",," + Convert.ToDouble(grossamount) + " ," + Convert.ToDouble(basicamount);
            gst_csv_list.Add(temp_word);
            temp_word = "Place Of Supply,Rate,Gross Advance Adjusted,Cess Amount";
            gst_csv_list.Add(temp_word);
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strExcelFileName);
            var xlSheets = xlWorkbook.Sheets as Excel.Sheets;
            var xlNewSheet = (Excel.Worksheet)xlSheets.Add(After: xlWorkbook.Sheets[xlWorkbook.Sheets.Count]);
            xlNewSheet.Name = "atadj";
            xlNewSheet.Columns.AutoFit();
            xlNewSheet.get_Range("A1", "B2").Cells.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;
            xlNewSheet.get_Range("A1").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A2", "D2").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A4", "D4").Cells.Interior.Color = System.Drawing.Color.FromArgb(250, 192, 144);
            xlNewSheet.get_Range("A2", "D2").Cells.Font.Color = Color.White;
            xlNewSheet.Cells.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;
            xlNewSheet.Range["D2", "D" + gst_csv_list.Count].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            AddDataInNewExcelSheet(xlNewSheet);
            xlNewSheet.Columns.AutoFit();
            xlWorkbook.Save();
            xlWorkbook.Close();
        }

        private void add_exemp_sheet_in_GSTR1_excel_sheet(string strExcelFileName)
        {
            gst_csv_list.Clear();
            basicamount = 0;
            grossamount = 0;
            temp_int = 0;
            //for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            //{
            //    temp_word = "";
            //    var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
            //    if (cellArray[0] == "")
            //    {
            //        basicamount += Convert.ToDouble(cellArray[8]);
            //        grossamount += Convert.ToDouble(cellArray[12]);
            //        temp_int++;
            //        temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + cellArray[12] + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[0] + " ,";
            //        ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0";
            //        DataTable dtData1 = ConnectionCommand.fGetDataTable();
            //        if (dtData1 != null && dtData1.Rows.Count > 0)
            //        {
            //            temp_word = "";
            //            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
            //            {
            //                temp_word = temp_word1 + dtData1.Rows[iRowCount][9].ToString() + " ," + dtData1.Rows[iRowCount][7].ToString();
            //                gst_csv_list.Add(temp_word);
            //            }
            //        }
            //    }
            //}
            StringBuilder sb = new StringBuilder();
            temp_word = "[Summary For Nil rated, exempted and non GST outward supplies (8)]";
            gst_csv_list.Add(temp_word);
            temp_word = ",Total Nil Rated Supplies,Total Exempted Supplies,Total Non-GST Supplies";
            gst_csv_list.Add(temp_word);
            temp_word = ",," + Convert.ToDouble(grossamount) + " ," + Convert.ToDouble(basicamount);
            gst_csv_list.Add(temp_word);
            temp_word = "Description,Nil Rated Supplies,Exempted (other than nil rated/non GST supply ),Non-GST supplies";
            gst_csv_list.Add(temp_word);
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strExcelFileName);
            var xlSheets = xlWorkbook.Sheets as Excel.Sheets;
            var xlNewSheet = (Excel.Worksheet)xlSheets.Add(After: xlWorkbook.Sheets[xlWorkbook.Sheets.Count]);
            xlNewSheet.Name = "exemp";
            xlNewSheet.Columns.AutoFit();
            xlNewSheet.get_Range("A1", "B2").Cells.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;
            xlNewSheet.get_Range("A1").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A2", "D2").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A4", "D4").Cells.Interior.Color = System.Drawing.Color.FromArgb(250, 192, 144);
            xlNewSheet.get_Range("A2", "D2").Cells.Font.Color = Color.White;
            xlNewSheet.Cells.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;
            xlNewSheet.Range["D2", "D" + gst_csv_list.Count].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            AddDataInNewExcelSheet(xlNewSheet);
            xlNewSheet.Columns.AutoFit();
            xlWorkbook.Save();
            xlWorkbook.Close();
        }

        private void add_hsn_sheet_in_GSTR1_excel_sheet(string strExcelFileName)
        {
            gst_csv_list.Clear();
            basicamount = 0;
            grossamount = 0;
            temp_int = 0;
            total_value = 0;
            total_taxable_value = 0;
            total_integerated_tax = 0;
            total_central_tax = 0;
            total_state_ut_tax = 0;
            total_cess = 0;
            //for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            //{
            //    temp_word = "";
            //    var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
            //    if (cellArray[0] == "")
            //    {
            //        basicamount += Convert.ToDouble(cellArray[8]);
            //        grossamount += Convert.ToDouble(cellArray[12]);
            //        temp_int++;
            //        temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + cellArray[12] + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[0] + " ,";
            //        ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0";
            //        DataTable dtData1 = ConnectionCommand.fGetDataTable();
            //        if (dtData1 != null && dtData1.Rows.Count > 0)
            //        {
            //            temp_word = "";
            //            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
            //            {
            //                temp_word = temp_word1 + dtData1.Rows[iRowCount][9].ToString() + " ," + dtData1.Rows[iRowCount][7].ToString();
            //                gst_csv_list.Add(temp_word);
            //            }
            //        }
            //    }
            //}
            StringBuilder sb = new StringBuilder();
            temp_word = "Summary for HSN(12)";
            gst_csv_list.Add(temp_word);

            temp_word = "No. of HSN,,,, Total Value,Total Taxable Value,Total Integerated Tax,Total Central Tax,Total State/UT Tax,Total Cess";
            gst_csv_list.Add(temp_word);
            temp_word = temp_int.ToString() + " ,,," + total_value.ToString() + " ," + total_taxable_value.ToString() + " ," + total_integerated_tax.ToString() + " ," + total_central_tax.ToString() + " ," + total_state_ut_tax.ToString() + " ," + total_cess.ToString();
            gst_csv_list.Add(temp_word);
            temp_word = "HSN,Description,UQC,Total Quantity,Total Value,Total Taxable Value,Total Integrated Tax Value,Total Central Tax,Total State/UT Tax,Cess Amount,";
            gst_csv_list.Add(temp_word);
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strExcelFileName);
            var xlSheets = xlWorkbook.Sheets as Excel.Sheets;
            var xlNewSheet = (Excel.Worksheet)xlSheets.Add(After: xlWorkbook.Sheets[xlWorkbook.Sheets.Count]);
            xlNewSheet.Name = "hsn";
            xlNewSheet.Columns.AutoFit();
            xlNewSheet.get_Range("A1", "B2").Cells.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;
            xlNewSheet.get_Range("A1").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A2", "J2").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A4", "J4").Cells.Interior.Color = System.Drawing.Color.FromArgb(250, 192, 144);
            xlNewSheet.get_Range("A2", "J2").Cells.Font.Color = Color.White;
            xlNewSheet.Cells.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;
            xlNewSheet.Range["D2", "D" + gst_csv_list.Count].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            AddDataInNewExcelSheet(xlNewSheet);
            xlNewSheet.Columns.AutoFit();
            xlWorkbook.Save();
            xlWorkbook.Close();
        }

        private void add_docs_sheet_in_GSTR1_excel_sheet(string strExcelFileName)
        {
            gst_csv_list.Clear();
            basicamount = 0;
            grossamount = 0;
            temp_int = 0;
            total_number = 0;
            total_cancelled = 0;
            //for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            //{
            //    temp_word = "";
            //    var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
            //    if (cellArray[0] == "")
            //    {
            //        basicamount += Convert.ToDouble(cellArray[8]);
            //        grossamount += Convert.ToDouble(cellArray[12]);
            //        temp_int++;
            //        temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + cellArray[12] + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[0] + " ,";
            //        ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0";
            //        DataTable dtData1 = ConnectionCommand.fGetDataTable();
            //        if (dtData1 != null && dtData1.Rows.Count > 0)
            //        {
            //            temp_word = "";
            //            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
            //            {
            //                temp_word = temp_word1 + dtData1.Rows[iRowCount][9].ToString() + " ," + dtData1.Rows[iRowCount][7].ToString();
            //                gst_csv_list.Add(temp_word);
            //            }
            //        }
            //    }
            //}
            StringBuilder sb = new StringBuilder();
            temp_word = "Summary of documents issued during the tax period (13)";
            gst_csv_list.Add(temp_word);
            temp_word = ",,,Total Number,Total Cancelled";
            gst_csv_list.Add(temp_word);
            temp_word = ",,," + total_number.ToString() + " ," + total_cancelled.ToString();
            gst_csv_list.Add(temp_word);
            temp_word = "Nature of Document,Sr. No. From,Sr. No. To, Total Number,Cancelled";
            gst_csv_list.Add(temp_word);
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strExcelFileName);
            var xlSheets = xlWorkbook.Sheets as Excel.Sheets;
            var xlNewSheet = (Excel.Worksheet)xlSheets.Add(After: xlWorkbook.Sheets[xlWorkbook.Sheets.Count]);
            xlNewSheet.Name = "docs";
            xlNewSheet.Columns.AutoFit();
            xlNewSheet.get_Range("A1", "B2").Cells.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;
            xlNewSheet.get_Range("A1").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A2", "D2").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.get_Range("A4", "D4").Cells.Interior.Color = System.Drawing.Color.FromArgb(250, 192, 144);
            xlNewSheet.get_Range("A2", "D2").Cells.Font.Color = Color.White;
            xlNewSheet.Cells.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;
            xlNewSheet.Range["D2", "D" + gst_csv_list.Count].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            AddDataInNewExcelSheet(xlNewSheet);
            xlNewSheet.Columns.AutoFit();
            xlWorkbook.Save();
            xlWorkbook.Close();
        }

        private void add_master_sheet_in_GSTR1_excel_sheet(string strExcelFileName)
        {
            gst_csv_list.Clear();
            basicamount = 0;
            grossamount = 0;
            temp_int = 0;
            //for (row_counter = 0; row_counter < temporary_list_array.Count; row_counter++)
            //{
            //    temp_word = "";
            //    var cellArray = temporary_list_array[row_counter].Split(new[] { ',' });
            //    if (cellArray[0] == "")
            //    {
            //        basicamount += Convert.ToDouble(cellArray[8]);
            //        grossamount += Convert.ToDouble(cellArray[12]);
            //        temp_int++;
            //        temp_word1 = cellArray[0] + " ," + cellArray[1] + " ," + cellArray[2] + " ," + cellArray[12] + " ," + cellArray[4] + " ," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[0] + " ,";
            //        ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd = '" + cellArray[13] + "' and d_c = " + cellArray[14] + " and d_n = " + cellArray[1] + " and amount > 0";
            //        DataTable dtData1 = ConnectionCommand.fGetDataTable();
            //        if (dtData1 != null && dtData1.Rows.Count > 0)
            //        {
            //            temp_word = "";
            //            for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
            //            {
            //                temp_word = temp_word1 + dtData1.Rows[iRowCount][9].ToString() + " ," + dtData1.Rows[iRowCount][7].ToString();
            //                gst_csv_list.Add(temp_word);
            //            }
            //        }
            //    }
            //}
            StringBuilder sb = new StringBuilder();
            temp_word = "UQC,Export Type,Reverse Charge/Provisional Assessment,Note Type,Type,Tax Rate,POS,Invoice Type,Reason of Issuing Note,Nature of Document,UR Type";
            gst_csv_list.Add(temp_word);
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strExcelFileName);
            var xlSheets = xlWorkbook.Sheets as Excel.Sheets;
            var xlNewSheet = (Excel.Worksheet)xlSheets.Add(After: xlWorkbook.Sheets[xlWorkbook.Sheets.Count]);
            xlNewSheet.Name = "master";
            xlNewSheet.Columns.AutoFit();
            xlNewSheet.get_Range("A1", "K1").Cells.Interior.Color = System.Drawing.Color.FromArgb(140, 200, 220);
            xlNewSheet.Cells.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;
            xlNewSheet.Range["D2", "D" + gst_csv_list.Count].HorizontalAlignment = Excel.XlHAlign.xlHAlignRight;
            AddDataInNewExcelSheet(xlNewSheet);
            xlNewSheet.get_Range("A1", "K1").Cells.RowHeight = 100;
            //xlNewSheet.Columns.AutoFit();
            xlWorkbook.Save();
            xlWorkbook.Close();
        }
        # endregion

        private void AddDataInNewExcelSheet(Excel.Worksheet xlNewSheet1)
        {
            for (int i = 0; i < gst_csv_list.Count; i++)
            {
                String line = gst_csv_list[i];

                Excel.Range c1 = (Excel.Range)xlNewSheet1.Cells[i + 1, 1];
                Excel.Range c2 = (Excel.Range)xlNewSheet1.Cells[i + 1, 1 + line.Length];
                Excel.Range range = xlNewSheet1.get_Range(c1, c2);
                string[] split = line.Split(',');
                for (int c = 1; c <= split.Length; c++)
                {
                    range.Cells[1, c] = split[c - 1];
                }
            }
        }

        private void generate_pdf_for_gst_difference()
        {
            gst_last_month_credit_debit_amount = 0;
            gst_debit_credit_amount = 0;
            gst_amount_list.Clear();
            for (row_counter = 0; row_counter <= 24; row_counter++)
            {
                gst_amount_list.Add("0.00");
            }
            // 0-4 cgst amount (sale,purchase,bank,cash,journal)
            // 5-9 sgst amount (sale,purchase,bank,cash,journal)
            // 10-14 igst amount (sale,purchase,bank,cash,journal)
            // 15-19 balance amount (sale,purchase,bank,cash,journal)
            temporary_list_array.Clear();
            actual_line_number_of_page = 0;
            //report_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + ConnectionWithAccess.mNIK + "_gst_" + ConnectionWithAccess.mprd + "_difference_report.pdf";
            if (cmbDateRangeGST.Text != "Custom Range")
                report_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + cmbDateRangeGST.Text + "_" + Convert.ToDateTime(dtp_rg_from_date.Text).Year + "-" + (Convert.ToDateTime(dtp_rg_from_date.Text).Year + 1).ToString().Substring(2, 2) + "_GSTR1_" + ConnectionWithAccess.company_details[32] + "_difference_report.pdf";
            else
            {
                report_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\gst_reports\\" + ConnectionWithAccess.mNIK + "_gst_" + ConnectionWithAccess.mprd + "_difference_report";
                report_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                report_filename += ".pdf";
            }

            doc1 = new Document(PageSize.A4, 15, 10, 10, 20);
            ConnectionWithAccess.create_file_folder(report_filename);
            FileStream FS1 = File.Create(report_filename);
            writer = PdfWriter.GetInstance(doc1, FS1);
            // var current_print_line_position = writer.GetVerticalPosition(false);
            doc1.Open();
            current_pdf_page_number = 1;
            require_header_footer = false;
            //if (ckbx_Igst.Checked)
            Paragraph para = new Paragraph("");
            for (int i = 0; i < 6; i++)
            {
                temp_word = ConnectionWithAccess.company_details[i + 1];
                print_pdf_line_at_center(cour_9, temp_word, -5, "cour_9");
                actual_line_number_of_page++;
            }
            temp_word = "Period :" + dtp_rg_from_date.Text + "   -   " + dtp_rg_to_date.Text;
            if (cmbDateRangeGST.Text != "Custom Range")
                temp_word += "     (" + cmbDateRangeGST.Text + "   " + Convert.ToDateTime(dtp_rg_from_date.Text).Year + ")";
            print_pdf_line_at_center(cour_9_bold, temp_word, 0, "cour_9");
            temp_word = "G.S.T Tax Report" + " # " + ConnectionWithAccess.company_details[32];
            print_pdf_line_at_center(cour_9_bold, temp_word, 0, "cour_9");
            if (cmbDateRangeGST.Text != "Custom Range")
            {
                temp_datetime = Convert.ToDateTime(dtp_rg_from_date.Text);
                temp_datetime = temp_datetime.AddMonths(-1);
                temp_word = temp_datetime.ToString("MMMM") + " " + temp_datetime.Year;
                ConnectionWithAccess.query = "select balance_amt from " + ConnectionWithAccess.tablename[12] + " where prd = '" + ConnectionWithAccess.mprd + "' and month = '" + temp_word + "' and tax_type = 'SGST'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    temp_double = Convert.ToDouble(dtData1.Rows[0][0].ToString());
                    gst_last_month_credit_debit_amount = temp_double;
                    if (temp_double > 0)
                    {
                        temp_word += " GST Credit of Rs.";
                        print_pdf_line(cour_11_bold, temp_word, 300, 10);
                        print_pdf_line(cour_11_bold, temp_double.ToString(), para_IndentationLeft_position(470, temp_double.ToString(), "cour_11_bold"), -16);
                    }
                    else
                    {
                        temp_word += " GST Debit of Rs.";
                        print_pdf_line(cour_11_bold, temp_word, 300, 10);
                        print_pdf_line(cour_11_bold, (temp_double * -1).ToString(), para_IndentationLeft_position(470, (temp_double * -1).ToString(), "cour_11_bold"), -16);
                    }
                }
            }
            temp_word = "G.S.T Sale's Report";
            print_pdf_line_at_center(cour_9_bold, temp_word, 10, "cour_9");
            add_gst_details_in_report_with_tax_details("S");
            temp_word = "G.S.T Purchase's Report";
            print_pdf_line_at_center(cour_9_bold, temp_word, 10, "cour_9");
            add_gst_details_in_report_with_tax_details("P");
            temp_word = "G.S.T Bank's Report";
            print_pdf_line_at_center(cour_9_bold, temp_word, 10, "cour_9");
            add_gst_details_in_report("B");
            temp_word = "G.S.T Cash's Report";
            print_pdf_line_at_center(cour_9_bold, temp_word, 10, "cour_9");
            add_gst_details_in_report("C");
            temp_word = "G.S.T Journal's Report";
            print_pdf_line_at_center(cour_9_bold, temp_word, 10, "cour_9");
            add_gst_details_in_report("J");

            //                               9999999999999999999.99,9999999999999999999.99,9999999999999999999.99,9999999999999999999.99,
            temp_word = "Purchase           Bank           Cash           Jour           Sale         Credit          Debit        Balance";
            //        99999999999.99,99999999999.99,99999999999.99,99999999999.99,99999999999.99,99999999999.99,99999999999.99,99999999999.99,
            print_pdf_line(cour_11, temp_word, 60, 0);
            if (gst_last_month_credit_debit_amount != 0)
            {
                if (gst_last_month_credit_debit_amount > 0)
                    temp_word = "Last Month Credit";
                else
                    temp_word = "Last Month Debit";
                print_pdf_line(cour_11_bold, temp_word, 15, 0);
                temp_word = gst_last_month_credit_debit_amount.ToString();
                print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(470, temp_word, "cour_11_bold"), -16);
                gst_debit_credit_amount += gst_last_month_credit_debit_amount;
            }
            temp_word = "IGST";
            print_pdf_line(cour_11_bold, temp_word, 15, 0);
            temp_word = String.Format("{0:0.00}", gst_amount_list[11].ToString());
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(35, temp_word, "cour_11_bold"), -16);
            temp_word = String.Format("{0:0.00}", gst_amount_list[12].ToString());
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(95, temp_word, "cour_11_bold"), -16);
            temp_word = String.Format("{0:0.00}", gst_amount_list[13].ToString());
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(155, temp_word, "cour_11_bold"), -16);
            temp_word = String.Format("{0:0.00}", gst_amount_list[14].ToString());
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(215, temp_word, "cour_11_bold"), -16);
            temp_word = String.Format("{0:0.00}", gst_amount_list[10].ToString());
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(275, temp_word, "cour_11_bold"), -16);
            temp_double = Convert.ToDouble(gst_amount_list[11]) + Convert.ToDouble(gst_amount_list[12]) + Convert.ToDouble(gst_amount_list[13]) + Convert.ToDouble(gst_amount_list[14]);
            if (temp_double > Convert.ToDouble(gst_amount_list[10]))
            {
                temp_double = temp_double - Convert.ToDouble(gst_amount_list[10]);
                temp_word = String.Format("{0:0.00}", temp_double.ToString());
                if (!temp_word.Contains("."))
                    temp_word += ".00";
                gst_amount_list[15] = temp_word;
                print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(335, temp_word, "cour_11_bold"), -16);
                gst_debit_credit_amount += temp_double;
            }
            else
            {
                temp_double = Convert.ToDouble(gst_amount_list[10]) - temp_double;
                temp_word = String.Format("{0:0.00}", temp_double.ToString());
                if (!temp_word.Contains("."))
                    temp_word += ".00";
                gst_amount_list[16] = temp_word;
                print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(395, temp_word, "cour_11_bold"), -16);
                gst_debit_credit_amount -= temp_double;
            }
            gst_debit_credit_amount = Math.Round(gst_debit_credit_amount, 2);
            temp_word = String.Format("{0:0.00}", gst_debit_credit_amount.ToString());
            if (!temp_word.Contains("."))
                temp_word += ".00";
            gst_amount_list[17] = temp_word;
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(470, temp_word, "cour_11_bold"), -16);

            temp_word = "CGST";
            print_pdf_line(cour_11_bold, temp_word, 15, 0);
            temp_word = String.Format("{0:0.00}", gst_amount_list[1].ToString());
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(35, temp_word, "cour_11_bold"), -16);
            temp_word = String.Format("{0:0.00}", gst_amount_list[2]);
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(95, temp_word, "cour_11_bold"), -16);
            temp_word = String.Format("{0:0.00}", gst_amount_list[3]);
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(155, temp_word, "cour_11_bold"), -16);
            temp_word = String.Format("{0:0.00}", gst_amount_list[4]);
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(215, temp_word, "cour_11_bold"), -16);
            temp_word = String.Format("{0:0.00}", gst_amount_list[0]);
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(275, temp_word, "cour_11_bold"), -16);
            temp_double = Convert.ToDouble(gst_amount_list[1]) + Convert.ToDouble(gst_amount_list[2]) + Convert.ToDouble(gst_amount_list[3]) + Convert.ToDouble(gst_amount_list[4]);
            if (temp_double > Convert.ToDouble(gst_amount_list[0]))
            {
                temp_double = temp_double - Convert.ToDouble(gst_amount_list[0]);
                temp_word = String.Format("{0:0.00}", temp_double.ToString());
                if (!temp_word.Contains("."))
                    temp_word += ".00";
                gst_amount_list[18] = temp_word;
                print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(335, temp_word, "cour_11_bold"), -16);
                gst_debit_credit_amount += temp_double;
            }
            else
            {
                temp_double = Convert.ToDouble(gst_amount_list[0]) - temp_double;
                temp_word = String.Format("{0:0.00}", temp_double.ToString());
                if (!temp_word.Contains("."))
                    temp_word += ".00";
                gst_amount_list[19] = temp_word;
                print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(395, temp_word, "cour_11_bold"), -16);
                gst_debit_credit_amount -= temp_double;
            }
            gst_debit_credit_amount = Math.Round(gst_debit_credit_amount, 2);
            temp_word = String.Format("{0:0.00}", gst_debit_credit_amount.ToString());
            gst_amount_list[20] = temp_word;
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(470, temp_word, "cour_11_bold"), -16);
            temp_word = "SGST";
            print_pdf_line(cour_11_bold, temp_word, 15, 0);
            temp_word = String.Format("{0:0.00}", gst_amount_list[6].ToString());
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(35, temp_word, "cour_11_bold"), -16);
            temp_word = String.Format("{0:0.00}", gst_amount_list[7].ToString());
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(95, temp_word, "cour_11_bold"), -16);
            temp_word = String.Format("{0:0.00}", gst_amount_list[8].ToString());
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(155, temp_word, "cour_11_bold"), -16);
            temp_word = String.Format("{0:0.00}", gst_amount_list[9].ToString());
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(215, temp_word, "cour_11_bold"), -16);
            temp_word = String.Format("{0:0.00}", gst_amount_list[5].ToString());
            if (!temp_word.Contains("."))
                temp_word += ".00";
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(275, temp_word, "cour_11_bold"), -16);
            temp_double = Convert.ToDouble(gst_amount_list[6]) + Convert.ToDouble(gst_amount_list[7]) + Convert.ToDouble(gst_amount_list[8]) + Convert.ToDouble(gst_amount_list[9]);
            if (temp_double > Convert.ToDouble(gst_amount_list[5]))
            {
                temp_double = temp_double - Convert.ToDouble(gst_amount_list[5]);
                temp_word = String.Format("{0:0.00}", temp_double.ToString());
                if (!temp_word.Contains("."))
                    temp_word += ".00";
                gst_amount_list[21] = temp_word;
                print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(335, temp_word, "cour_11_bold"), -16);
                gst_debit_credit_amount += temp_double;
            }
            else
            {
                temp_double = Convert.ToDouble(gst_amount_list[5]) - temp_double;
                temp_word = String.Format("{0:0.00}", temp_double.ToString());
                if (!temp_word.Contains("."))
                    temp_word += ".00";
                gst_amount_list[22] = temp_word;
                print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(395, temp_word, "cour_11_bold"), -16);
                gst_debit_credit_amount -= temp_double;
            }
            gst_debit_credit_amount = Math.Round(gst_debit_credit_amount, 2);
            temp_word = String.Format("{0:0.00}", gst_debit_credit_amount.ToString());
            gst_amount_list[23] = temp_word;
            print_pdf_line(cour_11_bold, temp_word, para_IndentationLeft_position(470, temp_word, "cour_11_bold"), -16);
            if (cmbDateRangeGST.Text != "Custom Range")
            {
                temp_word = cmbDateRangeGST.Text + " " + Convert.ToDateTime(dtp_rg_from_date.Text).Year;
                if (gst_debit_credit_amount > 0)
                    temp_word += " GST Credit of Rs." + gst_debit_credit_amount.ToString();
                else
                    temp_word += " GST Debit of Rs." + (gst_debit_credit_amount * -1).ToString();
                print_pdf_line(cour_15_bold, temp_word, 150, 10);
            }
            temp_word = "For " + ConnectionWithAccess.company_details[1];
            print_pdf_line(cour_9, temp_word, 366 - temp_word.Length, 0);
            temp_word = "Prop.";
            print_pdf_line(cour_9, temp_word, 520, 20);
            doc1.Close();
            require_header_footer = true;
        }

        private void add_gst_details_in_report_with_tax_details(string book)
        {
            dgv_gst_report.DataSource = null;
            gst_csv_list.Clear();
            if (book == "S")
            {
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[21] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_rg_d_c);
                rg_a_n.Text = get_a_n_from_d_c("S", Convert.ToInt32(cb_rg_d_c.Text));
                ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.bamt,f21.CGST_AMT, f21.SGST_AMT,f21.IGST_AMT, f21.gamt,f21.prd,f21.d_c,f21.d_n from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f21.d_c = " + cb_rg_d_c.Text + " order by f21.d_n";
                parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(dgv_gst_report, "Gst Sale List");
                for (row_pointer = 0; row_pointer < dgv_gst_report.Rows.Count; row_pointer++)
                {
                    if ((dgv_gst_report.Rows[row_pointer].Cells[0].Value != System.DBNull.Value) && (dgv_gst_report.Rows[row_pointer].Cells[1].Value != System.DBNull.Value) && (dgv_gst_report.Rows[row_pointer].Cells[0].Value != null) && (dgv_gst_report.Rows[row_pointer].Cells[1].Value != null))
                    {
                        temp_word2 = dgv_gst_report.Rows[row_pointer].Cells[0].Value.ToString();
                        temp_word2 = temp_word2.Substring(0, temp_word2.IndexOf(" "));
                        temp_word = "S," + temp_word2 + "-" + dgv_gst_report.Rows[row_pointer].Cells[1].Value.ToString();
                        temp_word += ",";
                        temp_word += dgv_gst_report.Rows[row_pointer].Cells[2].Value.ToString().Replace(",", "") + " ," + dgv_gst_report.Rows[row_pointer].Cells[3].Value.ToString();
                        temp_word += ",";
                        temp_word += dgv_gst_report.Rows[row_pointer].Cells[4].Value.ToString();
                        temp_word += ",";
                        if (dgv_gst_report.Rows[row_pointer].Cells[5].Value != null && dgv_gst_report.Rows[row_pointer].Cells[5].Value != System.DBNull.Value)
                            temp_word += (dgv_gst_report.Rows[row_pointer].Cells[5].Value.ToString());
                        temp_word += ",";
                        if (dgv_gst_report.Rows[row_pointer].Cells[6].Value != null && dgv_gst_report.Rows[row_pointer].Cells[6].Value != System.DBNull.Value)
                            temp_word += (dgv_gst_report.Rows[row_pointer].Cells[6].Value.ToString());
                        temp_word += ",";
                        if (dgv_gst_report.Rows[row_pointer].Cells[7].Value != null && dgv_gst_report.Rows[row_pointer].Cells[7].Value != System.DBNull.Value)
                            temp_word += (dgv_gst_report.Rows[row_pointer].Cells[7].Value.ToString());
                        temp_word += ",";
                        if (dgv_gst_report.Rows[row_pointer].Cells[8].Value != null && dgv_gst_report.Rows[row_pointer].Cells[8].Value != System.DBNull.Value)
                            temp_word += (dgv_gst_report.Rows[row_pointer].Cells[8].Value.ToString());
                        temp_word += ",";
                        if (dgv_gst_report.Rows[row_pointer].Cells[9].Value != null && dgv_gst_report.Rows[row_pointer].Cells[9].Value != System.DBNull.Value)
                            temp_word += (dgv_gst_report.Rows[row_pointer].Cells[9].Value.ToString());
                        temp_word += "," + dgv_gst_report.Rows[row_pointer].Cells[10].Value.ToString();
                        temp_word += "," + dgv_gst_report.Rows[row_pointer].Cells[11].Value.ToString();
                        temp_word += "," + dgv_gst_report.Rows[row_pointer].Cells[12].Value.ToString();
                        gst_csv_list.Add(temp_word);
                    }
                }
            }
            else if (book == "P")
            {
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[22] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_rg_d_c);
                rg_a_n.Text = get_a_n_from_d_c("P", Convert.ToInt32(cb_rg_d_c.Text));
                ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.bamt,f22.CGST_AMT, f22.SGST_AMT,f22.IGST_AMT, f22.gamt,f22.prd,f22.d_c,f22.d_n,f22.a_n,f22.s_a from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f22.d_c = " + cb_rg_d_c.Text + " order by f22.d_d";
                parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(dgv_gst_report, "Gst Purchase List");
                for (row_pointer = 0; row_pointer < dgv_gst_report.Rows.Count; row_pointer++)
                {
                    if ((dgv_gst_report.Rows[row_pointer].Cells[0].Value != System.DBNull.Value) && (dgv_gst_report.Rows[row_pointer].Cells[1].Value != System.DBNull.Value) && (dgv_gst_report.Rows[row_pointer].Cells[0].Value != null) && (dgv_gst_report.Rows[row_pointer].Cells[1].Value != null))
                    {
                        temp_word2 = dgv_gst_report.Rows[row_pointer].Cells[0].Value.ToString();
                        temp_word2 = temp_word2.Substring(0, temp_word2.IndexOf(" "));
                        temp_word = "P," + temp_word2 + "-" + dgv_gst_report.Rows[row_pointer].Cells[1].Value.ToString();
                        temp_word += ",";
                        temp_word += dgv_gst_report.Rows[row_pointer].Cells[2].Value.ToString().Replace(",", "") + " ," + dgv_gst_report.Rows[row_pointer].Cells[3].Value.ToString();
                        temp_word += ",";
                        temp_word += dgv_gst_report.Rows[row_pointer].Cells[4].Value.ToString();
                        temp_word += ",";
                        if (dgv_gst_report.Rows[row_pointer].Cells[5].Value != null && dgv_gst_report.Rows[row_pointer].Cells[5].Value != System.DBNull.Value)
                            temp_word += (dgv_gst_report.Rows[row_pointer].Cells[5].Value.ToString());
                        temp_word += ",";
                        if (dgv_gst_report.Rows[row_pointer].Cells[6].Value != null && dgv_gst_report.Rows[row_pointer].Cells[6].Value != System.DBNull.Value)
                            temp_word += (dgv_gst_report.Rows[row_pointer].Cells[6].Value.ToString());
                        temp_word += ",";
                        if (dgv_gst_report.Rows[row_pointer].Cells[7].Value != null && dgv_gst_report.Rows[row_pointer].Cells[7].Value != System.DBNull.Value)
                            temp_word += (dgv_gst_report.Rows[row_pointer].Cells[7].Value.ToString());
                        temp_word += ",";
                        if (dgv_gst_report.Rows[row_pointer].Cells[8].Value != null && dgv_gst_report.Rows[row_pointer].Cells[8].Value != System.DBNull.Value)
                            temp_word += (dgv_gst_report.Rows[row_pointer].Cells[8].Value.ToString());
                        temp_word += ",";
                        if (dgv_gst_report.Rows[row_pointer].Cells[9].Value != null && dgv_gst_report.Rows[row_pointer].Cells[9].Value != System.DBNull.Value)
                            temp_word += (dgv_gst_report.Rows[row_pointer].Cells[9].Value.ToString());
                        temp_word += "," + dgv_gst_report.Rows[row_pointer].Cells[10].Value.ToString();
                        temp_word += "," + dgv_gst_report.Rows[row_pointer].Cells[11].Value.ToString();
                        temp_word += "," + dgv_gst_report.Rows[row_pointer].Cells[12].Value.ToString();
                        temp_word += "," + dgv_gst_report.Rows[row_pointer].Cells[13].Value.ToString();
                        temp_word += "," + dgv_gst_report.Rows[row_pointer].Cells[14].Value.ToString();
                        gst_csv_list.Add(temp_word);
                    }
                }
            }
            else if (book == "B")
            {
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[23] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_rg_d_c);
                rg_a_n.Text = get_a_n_from_d_c("B", Convert.ToInt32(cb_rg_d_c.Text));
                //ConnectionWithAccess.query = "select f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f23.bamt,f23.CGST_AMT, f23.SGST_AMT,f23.IGST_AMT, f23.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.igst_amt > 0 order by f23.d_d";
                ConnectionWithAccess.query = "select f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, ((-f23.igst_amt - f23.bamt)) ,f23.IGST_AMT, (f23.bamt * -1) from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.igst_amt > 0 order by f23.d_d";
                parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(dgv_gst_report, "Gst Bank List");
            }
            else if (book == "C")
            {
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[24] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_rg_d_c);
                rg_a_n.Text = get_a_n_from_d_c("C", Convert.ToInt32(cb_rg_d_c.Text));
                //ConnectionWithAccess.query = "select f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f23.bamt,f23.CGST_AMT, f23.SGST_AMT,f23.IGST_AMT, f23.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.igst_amt > 0 order by f23.d_d";
                ConnectionWithAccess.query = "select f24.D_D, f24.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f24.basic_amt ,f24.IGST_AMT, f24.camt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[24] + " f24 where f1.a_n = f24.a_n and f1.s_a = f24.s_a and f24.prd = '" + ConnectionWithAccess.mprd + "' and f24.d_d >= @From and f24.d_d <= @To and f24.igst_amt > 0 order by f24.d_d";
                parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(dgv_gst_report, "Gst Cash List");
            }
            else if (book == "J")
            {
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[25] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_rg_d_c);
                rg_a_n.Text = get_a_n_from_d_c("J", Convert.ToInt32(cb_rg_d_c.Text));
                //ConnectionWithAccess.query = "select f25.D_D, f25.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, ((-f25.igst_amt - f25.jamt)) ,f25.IGST_AMT, (f25.jamt * -1) from " + ConnectionWithAccess.tablename[25] + " f25 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f25.A_N = f1.A_N and f25.S_A = f1.S_A where f25.prd = '" + ConnectionWithAccess.mprd + "' and f25.igst_amt > 0 order by f25.d_d";
                ConnectionWithAccess.query = "select f25.D_D, f25.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f25.basic_amt, f25.IGST_AMT, f25.jamt from " + ConnectionWithAccess.tablename[25] + " f25 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f25.A_N = f1.A_N and f25.S_A = f1.S_A where f25.prd = '" + ConnectionWithAccess.mprd + "' and f25.d_d >= @From and f25.d_d <= @To and f25.igst_amt > 0 order by f25.d_d";
                parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(dgv_gst_report, "Gst Journal List");
            }
            temp_word = "Date - Inv.                        Party's Name       City                             Gst Number                           Basic Amount       Cgst Amount        Sgst Amount        Igst Amount        Gross Amount";
            //                                                                                                 x00000000000000x00000000000000x00000000000000x00000000000000x0000000000000
            print_pdf_line(cour_7, temp_word, 10, 0);
            double bamt = 0, cgst_amt = 0, sgst_amt = 0, igst_amt = 0, gamt = 0;
            for (row_pointer = 0; row_pointer < gst_csv_list.Count(); row_pointer++)
            {
                var cellArray = gst_csv_list[row_pointer].Split(new[] { ',' });
                if (cellArray[0] == "S" && book == "S")
                {
                    print_pdf_line(cour_7, cellArray[1], 10, -3);
                    temp_word = cellArray[2] + " ," + cellArray[3];
                    if (temp_word.Length > 25)
                        temp_word = temp_word.Substring(0, 25);
                    print_pdf_line(cour_7, temp_word, 90, -16);
                    print_pdf_line(cour_7, cellArray[4], 210, -16);
                    if (cellArray[5] != "")
                    {
                        temp_word = add_comma_to_number(cellArray[5]);
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(270, temp_word, "cour_7"), -16);
                        bamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[5].Value);
                    }
                    if (cellArray[6] != "")
                    {
                        temp_word = add_comma_to_number(cellArray[6]);
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(325, temp_word, "cour_7"), -16);
                        cgst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[6].Value);
                    }
                    if (cellArray[7] != "")
                    {
                        temp_word = add_comma_to_number(cellArray[7]);
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(380, temp_word, "cour_7"), -16);
                        sgst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[7].Value);
                    }
                    if (cellArray[8] != "")
                    {
                        temp_word = add_comma_to_number(cellArray[8]);
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(435, temp_word, "cour_7"), -16);
                        igst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[8].Value);
                    }
                    if (cellArray[9] != "")
                    {
                        temp_word = add_comma_to_number(cellArray[9]);
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(490, temp_word, "cour_7"), -16);
                        gamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[9].Value);
                    }
                    if (ck_gst_report_add_brief_tax.Checked)
                    {
                        gst_tax_brief_sale_list(cellArray[0], cellArray[10], cellArray[11], cellArray[12], "", "");
                        if (gst_tax_brief_sale_list_array.Count() > 0)
                        {
                            for (row_counter = 0; row_counter < gst_tax_brief_sale_list_array.Count(); row_counter++)
                            {
                                var cellArray1 = gst_tax_brief_sale_list_array[row_counter].Split(new[] { ',' });
                                temp_word = cellArray1[0] + " %";
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(60, temp_word, "cour_7"), -5);
                                temp_word = cellArray1[1];
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(120, temp_word, "cour_7"), -16);
                                temp_word = cellArray1[2];
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(200, temp_word, "cour_7"), -16);
                            }
                        }
                    }
                }
                else if (cellArray[0] == "P" && book == "P")
                {
                    if (cellArray[4] != "")
                        print_pdf_line(cour_7, cellArray[1], 10, -3);
                    else
                        print_pdf_line(cour_9_bold, cellArray[1], 10, -3);
                    temp_word = cellArray[2] + " ," + cellArray[3];
                    if (temp_word.Length > 25)
                        temp_word = temp_word.Substring(0, 25);
                    if ((cellArray[6].ToString() == "" || cellArray[6].ToString() == "0.00") && (cellArray[7].ToString() == "" || cellArray[7].ToString() == "0.00") && (cellArray[8].ToString() == "" || cellArray[8].ToString() == "0.00"))
                        print_pdf_line(cour_9_bold, temp_word, 90, -16);
                    else

                        print_pdf_line(cour_7, temp_word, 90, -16);
                    print_pdf_line(cour_7, cellArray[4], 210, -16);
                    if (cellArray[5] != "")
                    {
                        temp_word = add_comma_to_number(cellArray[5]);
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(270, temp_word, "cour_7"), -16);
                        bamt += Convert.ToDouble(cellArray[5]);
                    }
                    if (cellArray[6] != "")
                    {
                        temp_word = add_comma_to_number(cellArray[6]);
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(325, temp_word, "cour_7"), -16);
                        cgst_amt += Convert.ToDouble(cellArray[6]);
                    }
                    if (cellArray[7] != "")
                    {
                        temp_word = add_comma_to_number(cellArray[7]);
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(380, temp_word, "cour_7"), -16);
                        sgst_amt += Convert.ToDouble(cellArray[7]);
                    }
                    if (cellArray[8] != "" && cellArray[8] != "0.00")
                    {
                        temp_word = add_comma_to_number(cellArray[8]);
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(435, temp_word, "cour_7"), -16);
                        igst_amt += Convert.ToDouble(cellArray[8]);
                    }
                    if (cellArray[9] != "")
                    {
                        temp_word = add_comma_to_number(cellArray[9]);
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(490, temp_word, "cour_7"), -16);
                        gamt += Convert.ToDouble(cellArray[9]);
                    }
                    if (ck_gst_report_add_brief_tax.Checked)
                    {
                        gst_tax_brief_sale_list(cellArray[0], cellArray[10], cellArray[11], cellArray[12], cellArray[13], cellArray[14]);
                        if (gst_tax_brief_sale_list_array.Count() > 0)
                        {
                            for (row_counter = 0; row_counter < gst_tax_brief_sale_list_array.Count(); row_counter++)
                            {
                                var cellArray1 = gst_tax_brief_sale_list_array[row_counter].Split(new[] { ',' });
                                temp_word = cellArray1[0] + " %";
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(60, temp_word, "cour_7"), -5);
                                temp_word = cellArray1[1];
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(120, temp_word, "cour_7"), -16);
                                temp_word = cellArray1[2];
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(200, temp_word, "cour_7"), -16);
                            }
                        }
                    }
                }
                else if (book == "B")
                {
                    print_pdf_line(cour_7, temp_word, 10, -3);
                    temp_word = dgv_gst_report.Rows[row_pointer].Cells[2].Value.ToString() + " ," + dgv_gst_report.Rows[row_pointer].Cells[3].Value.ToString();
                    if (temp_word.Length > 25)
                        temp_word = temp_word.Substring(0, 25);
                    print_pdf_line(cour_7, temp_word, 96, -16);
                    if (dgv_gst_report.Rows[row_pointer].Cells[5].Value != null && dgv_gst_report.Rows[row_pointer].Cells[5].Value != System.DBNull.Value)
                    {
                        temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[5].Value.ToString());
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(270, temp_word, "cour_7"), -16);
                        bamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[5].Value);
                    }
                    if (dgv_gst_report.Rows[row_pointer].Cells[6].Value != null && dgv_gst_report.Rows[row_pointer].Cells[6].Value != System.DBNull.Value)
                    {
                        temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[6].Value.ToString());
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(325, temp_word, "cour_7"), -16);
                        cgst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[6].Value);
                    }
                    if (dgv_gst_report.Rows[row_pointer].Cells[7].Value != null && dgv_gst_report.Rows[row_pointer].Cells[7].Value != System.DBNull.Value)
                    {
                        temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[7].Value.ToString());
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(380, temp_word, "cour_7"), -16);
                        sgst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[7].Value);
                    }
                    if (dgv_gst_report.Rows[row_pointer].Cells[8].Value != null && dgv_gst_report.Rows[row_pointer].Cells[8].Value != System.DBNull.Value)
                    {
                        temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[8].Value.ToString());
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(435, temp_word, "cour_7"), -16);
                        igst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[8].Value);
                    }
                    if (dgv_gst_report.Rows[row_pointer].Cells[9].Value != null && dgv_gst_report.Rows[row_pointer].Cells[9].Value != System.DBNull.Value)
                    {
                        temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[9].Value.ToString());
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(490, temp_word, "cour_7"), -16);
                        gamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[9].Value);
                    }
                }
                else if (book == "J")
                {
                    print_pdf_line(cour_7, temp_word, 10, -3);
                    temp_word = dgv_gst_report.Rows[row_pointer].Cells[2].Value.ToString() + " ," + dgv_gst_report.Rows[row_pointer].Cells[3].Value.ToString();
                    if (temp_word.Length > 25)
                        temp_word = temp_word.Substring(0, 25);
                    print_pdf_line(cour_7, temp_word, 96, -16);
                    if (dgv_gst_report.Rows[row_pointer].Cells[5].Value != null && dgv_gst_report.Rows[row_pointer].Cells[5].Value != System.DBNull.Value)
                    {
                        temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[5].Value.ToString());
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(270, temp_word, "cour_7"), -16);
                        bamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[5].Value);
                    }
                    if (dgv_gst_report.Rows[row_pointer].Cells[6].Value != null && dgv_gst_report.Rows[row_pointer].Cells[6].Value != System.DBNull.Value)
                    {
                        temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[6].Value.ToString());
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(435, temp_word, "cour_7"), -16);
                        igst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[6].Value);
                    }
                    if (dgv_gst_report.Rows[row_pointer].Cells[7].Value != null && dgv_gst_report.Rows[row_pointer].Cells[7].Value != System.DBNull.Value)
                    {
                        temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[7].Value.ToString());
                        print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(490, temp_word, "cour_7"), -16);
                        gamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[7].Value);
                    }
                }
                if (actual_line_number_of_page > 55)
                    temp_word = "";
            }
            temp_word = "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_9, temp_word, 10, -5);
            if (book == "S")
                temp_word = "Sale's Book";
            else if (book == "P")
                temp_word = "Purchase's Book";
            else if (book == "B")
                temp_word = "Bank's Book";
            else if (book == "C")
                temp_word = "Cash's Book";
            else if (book == "J")
                temp_word = "Journal's Book";
            temp_word2 = temp_word;
            print_pdf_line(cour_9, temp_word, 10, -5);
            if (!bamt.ToString().Contains("."))
                temp_word = bamt.ToString() + ".00";
            else
                temp_word = bamt.ToString();
            temp_word2 += "," + temp_word;
            temp_word = add_comma_to_number(temp_word);
            print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(270, temp_word, "cour_7"), -16);
            if (!cgst_amt.ToString().Contains("."))
                temp_word = cgst_amt.ToString() + ".00";
            else
                temp_word = cgst_amt.ToString();
            temp_word2 += "," + temp_word;
            temp_word = add_comma_to_number(temp_word);
            print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(325, temp_word, "cour_7"), -16);
            if (!sgst_amt.ToString().Contains("."))
                temp_word = sgst_amt.ToString() + ".00";
            else
                temp_word = sgst_amt.ToString();
            temp_word2 += "," + temp_word;
            temp_word = add_comma_to_number(temp_word);
            print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(380, temp_word, "cour_7"), -16);
            if (book == "S")
            {
                gst_amount_list[0] = cgst_amt.ToString();
                gst_amount_list[5] = sgst_amt.ToString();
                gst_amount_list[10] = igst_amt.ToString();
            }
            else if (book == "P")
            {
                gst_amount_list[1] = cgst_amt.ToString();
                gst_amount_list[6] = sgst_amt.ToString();
                gst_amount_list[11] = igst_amt.ToString();
            }
            else if (book == "B")
            {
                gst_amount_list[2] = cgst_amt.ToString();
                gst_amount_list[7] = sgst_amt.ToString();
                gst_amount_list[12] = igst_amt.ToString();
            }
            else if (book == "C")
            {
                gst_amount_list[3] = cgst_amt.ToString();
                gst_amount_list[8] = sgst_amt.ToString();
                gst_amount_list[13] = igst_amt.ToString();
            }
            else if (book == "J")
            {
                gst_amount_list[4] = cgst_amt.ToString();
                gst_amount_list[9] = sgst_amt.ToString();
                gst_amount_list[14] = igst_amt.ToString();
            }
            if (!igst_amt.ToString().Contains("."))
                temp_word = igst_amt.ToString() + ".00";
            else
                temp_word = igst_amt.ToString();
            temp_word2 += "," + temp_word;
            temp_word = add_comma_to_number(temp_word);
            print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(435, temp_word, "cour_7"), -16);
            if (!gamt.ToString().Contains("."))
                temp_word = gamt.ToString() + ".00";
            else
                temp_word = gamt.ToString();
            temp_word2 += "," + temp_word;
            temp_word = add_comma_to_number(temp_word);
            print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(490, temp_word, "cour_7"), -16);
            temp_word = "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_9, temp_word, 10, -5);
            temporary_list_array.Add(temp_word2);
        }

        private void add_gst_details_in_report(string book)
        {
            dgv_gst_report.DataSource = null;
            if (book == "S")
            {
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[21] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_rg_d_c);
                rg_a_n.Text = get_a_n_from_d_c("S", Convert.ToInt32(cb_rg_d_c.Text));
                ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f21.bamt,f21.CGST_AMT, f21.SGST_AMT,f21.IGST_AMT, f21.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f1.s_a = f21.s_a and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_d >= @From and f21.d_d <= @To and f21.d_c = " + cb_rg_d_c.Text + " order by f21.d_n";
                parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(dgv_gst_report, "Gst Sale List");
            }
            else if (book == "P")
            {
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[22] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_rg_d_c);
                rg_a_n.Text = get_a_n_from_d_c("P", Convert.ToInt32(cb_rg_d_c.Text));
                ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f22.bamt,f22.CGST_AMT, f22.SGST_AMT,f22.IGST_AMT, f22.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_d >= @From and f22.d_d <= @To and f22.d_c = " + cb_rg_d_c.Text + " order by f22.d_d";
                parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(dgv_gst_report, "Gst Purchase List");
            }
            else if (book == "B")
            {
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[23] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_rg_d_c);
                rg_a_n.Text = get_a_n_from_d_c("B", Convert.ToInt32(cb_rg_d_c.Text));
                //ConnectionWithAccess.query = "select f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f23.bamt,f23.CGST_AMT, f23.SGST_AMT,f23.IGST_AMT, f23.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.igst_amt > 0 order by f23.d_d";
                ConnectionWithAccess.query = "select f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number,0,0,0 ,f23.IGST_AMT,0  from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.igst_amt > 0 order by f23.d_d";
                parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(dgv_gst_report, "Gst Bank List");
            }
            else if (book == "C")
            {
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[24] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_rg_d_c);
                rg_a_n.Text = get_a_n_from_d_c("C", Convert.ToInt32(cb_rg_d_c.Text));
                //ConnectionWithAccess.query = "select f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f23.bamt,f23.CGST_AMT, f23.SGST_AMT,f23.IGST_AMT, f23.gamt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_d >= @From and f23.d_d <= @To and f23.igst_amt > 0 order by f23.d_d";
                ConnectionWithAccess.query = "select f24.D_D, f24.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f24.basic_amt ,f24.IGST_AMT, f24.camt from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[24] + " f24 where f1.a_n = f24.a_n and f1.s_a = f24.s_a and f24.prd = '" + ConnectionWithAccess.mprd + "' and f24.d_d >= @From and f24.d_d <= @To and f24.igst_amt > 0 order by f24.d_d";
                parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(dgv_gst_report, "Gst Cash List");
            }
            else if (book == "J")
            {
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[25] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_rg_d_c);
                rg_a_n.Text = get_a_n_from_d_c("J", Convert.ToInt32(cb_rg_d_c.Text));
                //ConnectionWithAccess.query = "select f25.D_D, f25.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, ((-f25.igst_amt - f25.jamt)) ,f25.IGST_AMT, (f25.jamt * -1) from " + ConnectionWithAccess.tablename[25] + " f25 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f25.A_N = f1.A_N and f25.S_A = f1.S_A where f25.prd = '" + ConnectionWithAccess.mprd + "' and f25.igst_amt > 0 order by f25.d_d";
                ConnectionWithAccess.query = "select f25.D_D, f25.D_N, f1.[desc] as [Desc], f1.city, f1.gst_number, f25.basic_amt, f25.IGST_AMT, f25.jamt from " + ConnectionWithAccess.tablename[25] + " f25 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f25.A_N = f1.A_N and f25.S_A = f1.S_A where f25.prd = '" + ConnectionWithAccess.mprd + "' and f25.d_d >= @From and f25.d_d <= @To and f25.igst_amt > 0 order by f25.d_d";
                parameters_for_date_range(dtp_rg_from_date.Text, dtp_rg_to_date.Text);
                ConnectionCommand.accountHelp_datatable_Seperate(dgv_gst_report, "Gst Journal List");
            }
            if (dgv_gst_report.Rows.Count > 1)
            {
                temp_word = "Date - Inv.                        Party's Name       City                             Gst Number                           Basic Amount       Cgst Amount        Sgst Amount        Igst Amount        Gross Amount";
                print_pdf_line(cour_7, temp_word, 10, 0);

                double bamt = 0, cgst_amt = 0, sgst_amt = 0, igst_amt = 0, gamt = 0;
                for (row_pointer = 0; row_pointer < dgv_gst_report.Rows.Count; row_pointer++)
                {
                    if ((dgv_gst_report.Rows[row_pointer].Cells[0].Value != System.DBNull.Value) && (dgv_gst_report.Rows[row_pointer].Cells[1].Value != System.DBNull.Value) && (dgv_gst_report.Rows[row_pointer].Cells[0].Value != null) && (dgv_gst_report.Rows[row_pointer].Cells[1].Value != null))
                    {
                        temp_word2 = dgv_gst_report.Rows[row_pointer].Cells[0].Value.ToString();
                        temp_word2 = temp_word2.Substring(0, temp_word2.IndexOf(" "));
                        temp_word = temp_word2 + "-" + dgv_gst_report.Rows[row_pointer].Cells[1].Value.ToString();
                        if (book == "S")
                        {
                            print_pdf_line(cour_7, temp_word, 10, -3);
                            temp_word = dgv_gst_report.Rows[row_pointer].Cells[2].Value.ToString() + " ," + dgv_gst_report.Rows[row_pointer].Cells[3].Value.ToString();
                            if (temp_word.Length > 25)
                                temp_word = temp_word.Substring(0, 25);
                            print_pdf_line(cour_7, temp_word, 90, -16);
                            temp_word = dgv_gst_report.Rows[row_pointer].Cells[4].Value.ToString();
                            print_pdf_line(cour_7, temp_word, 210, -16);
                            if (dgv_gst_report.Rows[row_pointer].Cells[5].Value != null && dgv_gst_report.Rows[row_pointer].Cells[5].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[5].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(270, temp_word, "cour_7"), -16);
                                bamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[5].Value);
                            }
                            if (dgv_gst_report.Rows[row_pointer].Cells[6].Value != null && dgv_gst_report.Rows[row_pointer].Cells[6].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[6].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(325, temp_word, "cour_7"), -16);
                                cgst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[6].Value);
                            }
                            if (dgv_gst_report.Rows[row_pointer].Cells[7].Value != null && dgv_gst_report.Rows[row_pointer].Cells[7].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[7].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(380, temp_word, "cour_7"), -16);
                                sgst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[7].Value);
                            }
                            if (dgv_gst_report.Rows[row_pointer].Cells[8].Value != null && dgv_gst_report.Rows[row_pointer].Cells[8].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[8].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(435, temp_word, "cour_7"), -16);
                                igst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[8].Value);
                            }
                            if (dgv_gst_report.Rows[row_pointer].Cells[9].Value != null && dgv_gst_report.Rows[row_pointer].Cells[9].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[9].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(490, temp_word, "cour_7"), -16);
                                gamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[9].Value);
                            }
                        }
                        else if (book == "P")
                        {
                            print_pdf_line(cour_7, temp_word, 10, -3);
                            temp_word = dgv_gst_report.Rows[row_pointer].Cells[2].Value.ToString() + " ," + dgv_gst_report.Rows[row_pointer].Cells[3].Value.ToString();
                            if (temp_word.Length > 25)
                                temp_word = temp_word.Substring(0, 25);
                            print_pdf_line(cour_7, temp_word, 96, -16);
                            temp_word = dgv_gst_report.Rows[row_pointer].Cells[4].Value.ToString();
                            print_pdf_line(cour_7, temp_word, 210, -16);
                            if (dgv_gst_report.Rows[row_pointer].Cells[5].Value != null && dgv_gst_report.Rows[row_pointer].Cells[5].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[5].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(270, temp_word, "cour_7"), -16);
                                bamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[5].Value);
                            }
                            if (dgv_gst_report.Rows[row_pointer].Cells[6].Value != null && dgv_gst_report.Rows[row_pointer].Cells[6].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[6].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(325, temp_word, "cour_7"), -16);
                                cgst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[6].Value);
                            }
                            if (dgv_gst_report.Rows[row_pointer].Cells[7].Value != null && dgv_gst_report.Rows[row_pointer].Cells[7].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[7].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(380, temp_word, "cour_7"), -16);
                                sgst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[7].Value);
                            }
                            if (dgv_gst_report.Rows[row_pointer].Cells[8].Value != null && dgv_gst_report.Rows[row_pointer].Cells[8].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[8].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(435, temp_word, "cour_7"), -16);
                                igst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[8].Value);
                            }
                            if (dgv_gst_report.Rows[row_pointer].Cells[9].Value != null && dgv_gst_report.Rows[row_pointer].Cells[9].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[9].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(490, temp_word, "cour_7"), -16);
                                gamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[9].Value);
                            }
                        }
                        else if (book == "B")
                        {
                            print_pdf_line(cour_7, temp_word, 10, -3);
                            temp_word = dgv_gst_report.Rows[row_pointer].Cells[2].Value.ToString() + " ," + dgv_gst_report.Rows[row_pointer].Cells[3].Value.ToString();
                            if (temp_word.Length > 25)
                                temp_word = temp_word.Substring(0, 25);
                            print_pdf_line(cour_7, temp_word, 96, -16);
                            //if (dgv_gst_report.Rows[row_pointer].Cells[5].Value != null && dgv_gst_report.Rows[row_pointer].Cells[5].Value != System.DBNull.Value)
                            //{
                            //    temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[5].Value.ToString());
                            //    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(270, temp_word, "cour_7"), -16);
                            //    bamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[5].Value);
                            //}
                            //if (dgv_gst_report.Rows[row_pointer].Cells[6].Value != null && dgv_gst_report.Rows[row_pointer].Cells[6].Value != System.DBNull.Value)
                            //{
                            //    temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[6].Value.ToString());
                            //    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(325, temp_word, "cour_7"), -16);
                            //    cgst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[6].Value);
                            //}
                            //if (dgv_gst_report.Rows[row_pointer].Cells[7].Value != null && dgv_gst_report.Rows[row_pointer].Cells[7].Value != System.DBNull.Value)
                            //{
                            //    temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[7].Value.ToString());
                            //    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(380, temp_word, "cour_7"), -16);
                            //    sgst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[7].Value);
                            //}
                            if (dgv_gst_report.Rows[row_pointer].Cells[8].Value != null && dgv_gst_report.Rows[row_pointer].Cells[8].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[8].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(435, temp_word, "cour_7"), -16);
                                igst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[8].Value);
                            }
                            //if (dgv_gst_report.Rows[row_pointer].Cells[9].Value != null && dgv_gst_report.Rows[row_pointer].Cells[9].Value != System.DBNull.Value)
                            //{
                            //    temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[9].Value.ToString());
                            //    print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(490, temp_word, "cour_7"), -16);
                            //    gamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[9].Value);
                            //}
                        }
                        else if (book == "J")
                        {
                            print_pdf_line(cour_7, temp_word, 10, -3);
                            temp_word = dgv_gst_report.Rows[row_pointer].Cells[2].Value.ToString() + " ," + dgv_gst_report.Rows[row_pointer].Cells[3].Value.ToString();
                            if (temp_word.Length > 25)
                                temp_word = temp_word.Substring(0, 25);
                            print_pdf_line(cour_7, temp_word, 96, -16);
                            if (dgv_gst_report.Rows[row_pointer].Cells[5].Value != null && dgv_gst_report.Rows[row_pointer].Cells[5].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[5].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(270, temp_word, "cour_7"), -16);
                                bamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[5].Value);
                            }
                            if (dgv_gst_report.Rows[row_pointer].Cells[6].Value != null && dgv_gst_report.Rows[row_pointer].Cells[6].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[6].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(435, temp_word, "cour_7"), -16);
                                igst_amt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[6].Value);
                            }
                            if (dgv_gst_report.Rows[row_pointer].Cells[7].Value != null && dgv_gst_report.Rows[row_pointer].Cells[7].Value != System.DBNull.Value)
                            {
                                temp_word = add_comma_to_number(dgv_gst_report.Rows[row_pointer].Cells[7].Value.ToString());
                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(490, temp_word, "cour_7"), -16);
                                gamt += Convert.ToDouble(dgv_gst_report.Rows[row_pointer].Cells[7].Value);
                            }
                        }
                    }
                    if (actual_line_number_of_page > 55)
                        temp_word = "";
                }
                temp_word = "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
                print_pdf_line(cour_9, temp_word, 10, -5);
                if (book == "S")
                    temp_word = "Sale's Book";
                else if (book == "P")
                    temp_word = "Purchase's Book";
                else if (book == "B")
                    temp_word = "Bank's Book";
                else if (book == "C")
                    temp_word = "Cash's Book";
                else if (book == "J")
                    temp_word = "Journal's Book";
                temp_word2 = temp_word;
                print_pdf_line(cour_9, temp_word, 10, -5);
                if (book == "S")
                {
                    gst_amount_list[0] = cgst_amt.ToString();
                    gst_amount_list[5] = sgst_amt.ToString();
                    gst_amount_list[10] = igst_amt.ToString();
                }
                else if (book == "P")
                {
                    gst_amount_list[1] = cgst_amt.ToString();
                    gst_amount_list[6] = sgst_amt.ToString();
                    gst_amount_list[11] = igst_amt.ToString();
                }
                else if (book == "B")
                {
                    gst_amount_list[2] = cgst_amt.ToString();
                    gst_amount_list[7] = sgst_amt.ToString();
                    gst_amount_list[12] = igst_amt.ToString();
                }
                else if (book == "C")
                {
                    gst_amount_list[3] = cgst_amt.ToString();
                    gst_amount_list[8] = sgst_amt.ToString();
                    gst_amount_list[13] = igst_amt.ToString();
                }
                else if (book == "J")
                {
                    gst_amount_list[4] = cgst_amt.ToString();
                    gst_amount_list[9] = sgst_amt.ToString();
                    gst_amount_list[14] = igst_amt.ToString();
                }
                if (!bamt.ToString().Contains("."))
                    temp_word = bamt.ToString() + ".00";
                else
                    temp_word = bamt.ToString();
                temp_word2 += "," + temp_word;
                temp_word = add_comma_to_number(temp_word);
                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(270, temp_word, "cour_7"), -16);
                if (!cgst_amt.ToString().Contains("."))
                    temp_word = cgst_amt.ToString() + ".00";
                else
                    temp_word = cgst_amt.ToString();
                temp_word2 += "," + temp_word;
                temp_word = add_comma_to_number(temp_word);
                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(325, temp_word, "cour_7"), -16);
                if (!sgst_amt.ToString().Contains("."))
                    temp_word = sgst_amt.ToString() + ".00";
                else
                    temp_word = sgst_amt.ToString();
                temp_word2 += "," + temp_word;
                temp_word = add_comma_to_number(temp_word);
                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(380, temp_word, "cour_7"), -16);
                if (!igst_amt.ToString().Contains("."))
                    temp_word = igst_amt.ToString() + ".00";
                else
                    temp_word = igst_amt.ToString();
                temp_word2 += "," + temp_word;
                temp_word = add_comma_to_number(temp_word);
                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(435, temp_word, "cour_7"), -16);
                if (!gamt.ToString().Contains("."))
                    temp_word = gamt.ToString() + ".00";
                else
                    temp_word = gamt.ToString();
                temp_word2 += "," + temp_word;
                temp_word = add_comma_to_number(temp_word);
                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(490, temp_word, "cour_7"), -16);
                temp_word = "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
                print_pdf_line(cour_9, temp_word, 10, -5);
                temporary_list_array.Add(temp_word2);
            }
            else
            {
                print_pdf_line(cour_9_bold, ":  Nil", 330, -16);
            }
        }

        private void parameters_for_date_range(string start_date, string end_date)
        {
            List<ConnectionWithAccess.QueryParams> objParams = new List<ConnectionWithAccess.QueryParams>();
            ConnectionWithAccess.QueryParams ParamFrom = new ConnectionWithAccess.QueryParams();
            ParamFrom.paramName = "@From";
            ParamFrom.paramValue = Convert.ToDateTime(start_date);
            objParams.Add(ParamFrom);

            ConnectionWithAccess.QueryParams ParamTo = new ConnectionWithAccess.QueryParams();
            ParamTo.paramName = "@To";
            ParamTo.paramValue = Convert.ToDateTime(end_date);
            objParams.Add(ParamTo);

            ConnectionWithAccess.QueryParamList = objParams;
        }

        public void alignGridView(DataGridView mDataGridView, int colCount)
        {
            // .ToShortDateString();
            report_columns_size = new string[colCount];
            report_columns_name = new string[colCount];
            report_column_header = new string[colCount];
            report_column_type = new string[colCount];

            for (column_pointer = 0; column_pointer < colCount; column_pointer++)
            {
                for (row_pointer = 0; row_pointer < mDataGridView.RowCount; row_pointer++)
                {
                    if (mDataGridView.Rows[row_pointer].Cells[column_pointer].Value != null)
                    {
                        temp_word = mDataGridView.Rows[row_pointer].Cells[column_pointer].Value.ToString().Trim();
                        if (temp_word != null && temp_word != "")
                        {
                            mDataGridView.Rows[row_pointer].Cells[column_pointer].Value = temp_word;
                            check_data_type(temp_word);
                            if (report_column_type[column_pointer] == null)
                                report_column_type[column_pointer] = data_type;
                        }
                        else
                            temp_word = "abcd";
                    }
                    else
                        temp_word = "abcd";
                }
            }

            for (int i = 0; i < colCount; i++)
            {
                if (report_column_type[i] == "Date")
                {
                    column_pointer = i;
                    for (row_pointer = 0; row_pointer < mDataGridView.RowCount; row_pointer++)
                    {
                        if (mDataGridView.Rows[row_pointer].Cells[column_pointer].Value != null)
                        {
                            temp_word = mDataGridView.Rows[row_pointer].Cells[column_pointer].Value.ToString();
                            if (temp_word.Contains("/"))
                            {
                                if (temp_word.Contains(" "))
                                {
                                    temp_word = temp_word.Substring(0, temp_word.IndexOf(" "));
                                    mDataGridView.Rows[row_pointer].Cells[column_pointer].Value = temp_word;

                                    //mDataGridView.Columns[column_pointer].DefaultCellStyle.Format = "dd/MM/yyyy";
                                }
                            }
                        }
                    }
                }
            }

            for (column_pointer = 0; column_pointer < colCount; column_pointer++)
            {
                for (row_pointer = 0; row_pointer < mDataGridView.RowCount; row_pointer++)
                {
                    if (mDataGridView.Rows[row_pointer].Cells[column_pointer].Value != null)
                    {
                        temp_word = mDataGridView.Rows[row_pointer].Cells[column_pointer].Value.ToString();
                        temp_word = temp_word.Trim();
                        if (temp_word.Trim().Length > Convert.ToInt32((report_columns_size[column_pointer])))
                        {
                            report_columns_size[column_pointer] = temp_word.Length.ToString();
                        }
                    }
                }
            }
            for (column_pointer = 0; column_pointer < colCount; column_pointer++)
            {
                if (report_column_type[column_pointer] == "Date")
                {
                    mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 8;
                    mDataGridView.Columns[column_pointer].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                }
                else if (report_column_type[column_pointer] == "String")
                {
                    if (Convert.ToInt32(report_columns_size[column_pointer]) == 1)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 20;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 2)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 12;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 3)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 12;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 4)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 12;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 5)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 10;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 6)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 10;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 7)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 10;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 8)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 11;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 9)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 11;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 10)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 12;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) > 10 && Convert.ToInt32(report_columns_size[column_pointer]) <= 20)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 9;
                    else
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 9;
                    mDataGridView.Columns[column_pointer].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleLeft;
                }
                else if (report_column_type[column_pointer] == "Numeric")
                {
                    if (Convert.ToInt32(report_columns_size[column_pointer]) == 1)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 20;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 2)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 12;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 3)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 11;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 4)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 11;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 5)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 10;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 6)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 9;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 7)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 8;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 8)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 8;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 9)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 8;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) == 10)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 8;
                    else if (Convert.ToInt32(report_columns_size[column_pointer]) > 10 && Convert.ToInt32(report_columns_size[column_pointer]) <= 20)
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 9;
                    else
                        mDataGridView.Columns[column_pointer].Width = Convert.ToInt32(report_columns_size[column_pointer]) * 9;
                    mDataGridView.Columns[column_pointer].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                    mDataGridView.Columns[column_pointer].ValueType = typeof(double);
                }
            }
        }

        private DataTable update_datatable_balances(DataTable mDataGridView, int debitcolumn, int creditcolumn, int balancecolumn)
        {
            for (row_pointer = 0; row_pointer < mDataGridView.Rows.Count; row_pointer++)
            {
                if (mDataGridView.Rows[row_pointer][debitcolumn].ToString() != null && mDataGridView.Rows[row_pointer][debitcolumn].ToString() != "")
                {
                    if (Convert.ToDouble(mDataGridView.Rows[row_pointer][debitcolumn].ToString()) != 0)
                    {
                        if (row_pointer > 0)
                        {
                            if (mDataGridView.Rows[row_pointer - 1][balancecolumn].ToString() != "")
                                mDataGridView.Rows[row_pointer][balancecolumn] = Math.Round(Convert.ToDouble(mDataGridView.Rows[row_pointer - 1][balancecolumn].ToString()) + Convert.ToDouble(mDataGridView.Rows[row_pointer][debitcolumn].ToString()), 2);
                            else
                                mDataGridView.Rows[row_pointer][balancecolumn] = Math.Round(Convert.ToDouble(mDataGridView.Rows[row_pointer][debitcolumn].ToString()), 2);
                        }
                        else
                            mDataGridView.Rows[row_pointer][balancecolumn] = Math.Round(Convert.ToDouble(mDataGridView.Rows[row_pointer][debitcolumn].ToString()), 2);
                    }
                }
                if (mDataGridView.Rows[row_pointer][creditcolumn].ToString() != null && mDataGridView.Rows[row_pointer][creditcolumn].ToString() != "")
                {
                    if (Convert.ToDouble(mDataGridView.Rows[row_pointer][creditcolumn].ToString()) != 0)
                    {
                        if (row_pointer > 0)
                        {
                            if (mDataGridView.Rows[row_pointer - 1][balancecolumn].ToString() != "")
                                mDataGridView.Rows[row_pointer][balancecolumn] = Math.Round(Convert.ToDouble(mDataGridView.Rows[row_pointer - 1][balancecolumn].ToString()) - Convert.ToDouble(mDataGridView.Rows[row_pointer][creditcolumn].ToString()), 2);
                            else
                                mDataGridView.Rows[row_pointer][balancecolumn] = Math.Round(Convert.ToDouble(mDataGridView.Rows[row_pointer][creditcolumn].ToString()), 2);
                        }
                        else
                            mDataGridView.Rows[row_pointer][balancecolumn] = Math.Round(Convert.ToDouble(mDataGridView.Rows[row_pointer][creditcolumn].ToString()) * -1, 2);
                    }
                }
            }
            return mDataGridView;
        }

        private void update_gridview_balances(DataGridView mDataGridView, int debitcolumn, int creditcolumn, int balancecolumn)
        {
            for (row_pointer = 0; row_pointer < mDataGridView.Rows.Count; row_pointer++)
            {
                if (mDataGridView.Rows[row_pointer].Cells[debitcolumn].Value != null && mDataGridView.Rows[row_pointer].Cells[debitcolumn].Value.ToString() != "")
                {
                    if (Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[debitcolumn].Value.ToString()) != 0)
                    {
                        if (row_pointer > 0)
                        {
                            if (mDataGridView.Rows[row_pointer - 1].Cells[balancecolumn].Value.ToString() != "")
                                mDataGridView.Rows[row_pointer].Cells[balancecolumn].Value = Math.Round(Convert.ToDouble(mDataGridView.Rows[row_pointer - 1].Cells[balancecolumn].Value.ToString()) + Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[debitcolumn].Value.ToString()), 2);
                            else
                                mDataGridView.Rows[row_pointer].Cells[balancecolumn].Value = Math.Round(Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[debitcolumn].Value.ToString()), 2);
                        }
                        else
                            mDataGridView.Rows[row_pointer].Cells[balancecolumn].Value = Math.Round(Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[debitcolumn].Value.ToString()), 2);
                    }
                }
                if (mDataGridView.Rows[row_pointer].Cells[creditcolumn].Value != null && mDataGridView.Rows[row_pointer].Cells[creditcolumn].Value.ToString() != "")
                {
                    if (Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[creditcolumn].Value.ToString()) != 0)
                    {
                        if (row_pointer > 0)
                        {
                            if (mDataGridView.Rows[row_pointer - 1].Cells[balancecolumn].Value.ToString() != "")
                                mDataGridView.Rows[row_pointer].Cells[balancecolumn].Value = Math.Round(Convert.ToDouble(mDataGridView.Rows[row_pointer - 1].Cells[balancecolumn].Value.ToString()) - Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[creditcolumn].Value.ToString()), 2);
                            else
                                mDataGridView.Rows[row_pointer].Cells[balancecolumn].Value = Math.Round(Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[creditcolumn].Value.ToString()), 2);
                        }
                        else
                            mDataGridView.Rows[row_pointer].Cells[balancecolumn].Value = Math.Round(Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[creditcolumn].Value.ToString()) * -1, 2);
                    }
                }
            }
        }

        public void check_data_type(string temp_word)
        {
            data_type = null;
            int slash_count = 0;
            if (temp_word.Contains("/"))
            {
                for (int i = 0; i < temp_word.Length; i++)
                {
                    if (temp_word.Substring(i, 1) == "/")
                    {
                        slash_count++;
                    }
                }
                if (slash_count == 2)
                    data_type = "Date";
                else
                    data_type = "String";
            }
            else
            {
                for (int i = 0; i < temp_word.Length; i++)
                {
                    char c = Convert.ToChar(temp_word.Substring(i, 1));
                    asc_value = Convert.ToInt32(c);
                    if (asc_value >= 45 && asc_value <= 57)
                    {
                        if (data_type == null)
                            data_type = "Numeric";
                    }
                    else if (asc_value >= 58 && asc_value <= 130)
                    {
                        data_type = "String";
                    }
                    else
                        if (data_type == null)
                            data_type = "unknown";
                }
            }
        }

        private string getTotal_Datatable(DataTable mDataGridView, int total_of_column)
        {
            temp_double = 0;
            string strReturnValue = "0";
            for (row_pointer = 0; row_pointer < mDataGridView.Rows.Count; row_pointer++)
            {
                if (mDataGridView.Rows[row_pointer][total_of_column].ToString() != null && mDataGridView.Rows[row_pointer][total_of_column].ToString() != "")
                    if (Convert.ToDouble(mDataGridView.Rows[row_pointer][total_of_column].ToString()) != 0)
                        temp_double = temp_double + Convert.ToDouble(mDataGridView.Rows[row_pointer][total_of_column].ToString());
            }
            strReturnValue = temp_double.ToString();

            return strReturnValue;
        }

        private void getTotal(DataGridView mDataGridView, int total_of_column)
        {
            temp_double = 0;
            for (row_pointer = 0; row_pointer < mDataGridView.Rows.Count; row_pointer++)
            {
                if (mDataGridView.Rows[row_pointer].Cells[total_of_column].Value != null && mDataGridView.Rows[row_pointer].Cells[total_of_column].Value.ToString() != "")
                    if (Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[total_of_column].Value.ToString()) != 0)
                        temp_double = temp_double + Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[total_of_column].Value.ToString());
            }
            ConnectionWithAccess.connectionStart();
            try
            {
                mDataGridView.Rows.Add();
                mDataGridView.Rows[mDataGridView.Rows.Count - 1].Cells[total_of_column].Value = Convert.ToString(temp_double);
            }
            catch (Exception ex)
            {
            }
        }

        private void get_two_totals(DataGridView mDataGridView, int total_of_column1, int total_of_column2)
        {
            temp_double = 0;
            temp_double2 = 0;
            for (row_pointer = 0; row_pointer < mDataGridView.Rows.Count; row_pointer++)
            {
                if (mDataGridView.Rows[row_pointer].Cells[total_of_column1].Value != null && mDataGridView.Rows[row_pointer].Cells[total_of_column1].Value.ToString() != "")
                    if (Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[total_of_column1].Value.ToString()) != 0)
                        temp_double = temp_double + Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[total_of_column1].Value.ToString());
                if (mDataGridView.Rows[row_pointer].Cells[total_of_column2].Value != null && mDataGridView.Rows[row_pointer].Cells[total_of_column2].Value.ToString() != "")
                    if (Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[total_of_column2].Value.ToString()) != 0)
                        temp_double2 = temp_double2 + Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[total_of_column2].Value.ToString());
            }
            ConnectionWithAccess.connectionStart();
            try
            {
                mDataGridView.Rows.Add();
                mDataGridView.Rows[mDataGridView.Rows.Count - 1].Cells[total_of_column1].Value = Convert.ToString(temp_double);
                mDataGridView.Rows[mDataGridView.Rows.Count - 1].Cells[total_of_column2].Value = Convert.ToString(temp_double2);
            }
            catch (Exception ex)
            {
            }
        }

        private void ReportGenerator()
        {
        }

        private void cbledchild_SelectedIndexChanged(object sender, EventArgs e)
        {
            //LedDGV.Rows.Clear();
            LedDGV.DataSource = null;
            LedDGV.Visible = false;
            btn_gen_ledg.Visible = true;
        }

        private void DateSort()
        {
            int i, j;

            ConnectionWithAccess.datetemparray = new int[LedDGV.Rows.Count];

            for (i = 0; i < LedDGV.Rows.Count - 1; i++)
            {
                for (j = 0; j <= 0; j++)
                {
                    ConnectionWithAccess.datetemparray[i] = DateTime.Compare(Convert.ToDateTime(LedDGV.Rows[i].Cells[j].Value), Convert.ToDateTime(LedDGV.Rows[i].Cells[j + 1].Value));
                }
            }
        }

        private void generate_sale_balance_report()
        {
            temp_word = null;
            temp_count = 0;
            report_filetype = "Debitors outstanding List";
            pdf_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
            if (chb_add_datetime_in_output.Checked)
                pdf_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            pdf_filename += ".pdf";
            pdf_filename = ConnectionWithAccess.remove_filename_error(pdf_filename);
            doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
            FileStream FS1 = File.Create(pdf_filename);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            add_header_footer = true;
            //header_text_message = report_filetype + " " + " From : " + RepFrom.Text + " to " + RepTo.Text;
            header_text_message = report_filetype + " From " + ConnectionWithAccess.msdate + " to " + ConnectionWithAccess.medate + " as on " + RepTo.Text;
            pdf_top_heading = "Sr. No                Name                                                                                          City                                  Amount";
            Paragraph para = new Paragraph();
            basicamount = 0;
            int lineno = 0;
            temp_int = 0;
            row_counter = 1;
            for (row_pointer = 0; row_pointer < temporary_list_array.Count(); row_pointer++)
            {
                if (temporary_list_array[row_pointer] != "")
                {
                    var cellArray = temporary_list_array[row_pointer].Split(new[] { ',' });
                    if ((Convert.ToDouble(cellArray[4]) * 1) > 0)
                    {
                        temp_word = Convert.ToString(row_counter);
                        print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(-20, temp_word, "cour_9"), -9);
                        temp_word = cellArray[2].ToString();
                        print_pdf_line(cour_9, temp_word, 85, -15);
                        temp_word = cellArray[3].ToString();
                        print_pdf_line(cour_9, temp_word, 320, -15);
                        temp_word = (Convert.ToDouble(cellArray[4]) * 1).ToString();
                        temp_word = add_comma_to_number(temp_word);
                        print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(430, temp_word, "cour_9"), -15);
                        basicamount = basicamount + Convert.ToDouble(temp_word);
                        lineno++;
                        row_counter++;
                    }
                    else if ((Convert.ToDouble(cellArray[4]) * 1) < 0)
                        temp_int++;

                }
            }
            print_pdf_line(cour_9, "----------------", 450, -7);
            temp_word = basicamount.ToString();
            temp_word = add_comma_to_number(temp_word);
            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(430, temp_word, "cour_9"), -7);
            print_pdf_line(cour_9, "----------------", 450, -7);
            print_footer();
            if (temp_int > 0)
            {
                temp_word = ConnectionWithAccess.company_details[1];
                print_pdf_line(cour_9, temp_word, 85, 0);
                temp_word = "Debitors Advance List as on " + RepTo.Text;
                print_pdf_line(cour_9, temp_word, 85, 0);
                pdf_top_heading = "Sr. No                Name                                                                                          City                                  Amount";
                add_pdf_top_heading(pdf_top_heading);
                basicamount = 0;
                lineno = 0;
                row_counter = 1;
                for (row_pointer = 0; row_pointer < temporary_list_array.Count(); row_pointer++)
                {
                    if (temporary_list_array[row_pointer] != "")
                    {
                        var cellArray = temporary_list_array[row_pointer].Split(new[] { ',' });
                        if ((Convert.ToDouble(cellArray[4]) * 1) < 0)
                        {
                            temp_word = Convert.ToString(row_counter);
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(-20, temp_word, "cour_9"), -9);
                            temp_word = cellArray[2].ToString();
                            print_pdf_line(cour_9, temp_word, 85, -15);
                            temp_word = cellArray[3].ToString();
                            print_pdf_line(cour_9, temp_word, 320, -15);
                            temp_word = (Convert.ToDouble(cellArray[4]) * -1).ToString();
                            temp_word = add_comma_to_number(temp_word);
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(430, temp_word, "cour_9"), -15);
                            basicamount = basicamount + Convert.ToDouble(temp_word);
                            lineno++;
                            row_counter++;
                        }
                    }
                }
                print_pdf_line(cour_9, "----------------", 450, -7);
                temp_word = Convert.ToString(basicamount);
                temp_word = add_comma_to_number(temp_word);
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(430, temp_word, "cour_9"), -7);
                print_pdf_line(cour_9, "----------------", 450, -7);
                print_footer();
            }
            doc1.Close();
        }

        private void cbRepSubType_SelectedIndexChanged(object sender, EventArgs e)
        {
            pb_rep_ana_printer.Visible = false;
            ckbx_include_payments.Visible = false;
            pdf_viewer1.Visible = false;
            gdvreport.Visible = false;
            dgv_tax_report.Visible = false;
            Generate.Visible = true;
            pdf_filename = null;
            if (cbRepType.SelectedIndex == 0 && cbRepSubType.SelectedIndex == 0)
            {
                cbrep_ana_d_c.Items.Clear();
                cbrep_ana_d_c.Visible = true;
                label253.Visible = true;
                ConnectionWithAccess.query = "select d_c from " + ConnectionWithAccess.tablename[21] + " where d_n = 999999";
                ConnectionCommand.retrieval(cbrep_ana_d_c);
            }
            else if (cbRepType.SelectedIndex == 0 && cbRepSubType.SelectedIndex == 1)
            {
                cbrep_ana_d_c.Items.Clear();
                cbrep_ana_d_c.Visible = true;
                label253.Visible = true;
                ConnectionWithAccess.query = "select d_c from " + ConnectionWithAccess.tablename[30] + " where d_n = 999999";
                ConnectionCommand.retrieval(cbrep_ana_d_c);
            }
            else if (cbRepSubType.SelectedItem.Equals("Mon.Statement"))
            {
                cbRepFormat.Items.Clear();
                temp_int = GetMonthsBetween(Convert.ToDateTime(ConnectionWithAccess.msdate), Convert.ToDateTime(ConnectionWithAccess.medate));
                cbRepFormat.Items.Add("April");
                cbRepFormat.Items.Add("May");
                cbRepFormat.Items.Add("June");
                cbRepFormat.Items.Add("July");
                cbRepFormat.Items.Add("August");
                cbRepFormat.Items.Add("September");
                cbRepFormat.Items.Add("October");
                cbRepFormat.Items.Add("November");
                cbRepFormat.Items.Add("December");
                cbRepFormat.Items.Add("January");
                cbRepFormat.Items.Add("Feburary");
                cbRepFormat.Items.Add("March");
            }
            else if (cbRepSubType.SelectedIndex == 0 || cbRepSubType.SelectedIndex == 1)
            {
                if (cbRepType.SelectedIndex == 2)
                {
                    cbRepFormat.Visible = true;
                    cbRepFormat.Items.Clear();
                    cbRepFormat.Items.Add("Passed");
                    cbRepFormat.Items.Add("Failed");
                    cbRepFormat.Items.Add("Pending");
                    cbRepFormat.SelectedIndex = 0;
                }
            }
            else if (cbRepType.SelectedIndex == 0 && cbRepSubType.SelectedIndex == 2)
            {
                ckbx_include_payments.Visible = true;
            }
            else
            {
                cbRepFormat.Visible = false;
            }
        }

        public static int GetMonthsBetween(DateTime from, DateTime to)
        {
            if (from > to) return GetMonthsBetween(to, from);

            var monthDiff = Math.Abs((to.Year * 12 + (to.Month - 1)) - (from.Year * 12 + (from.Month - 1)));

            if (from.AddMonths(monthDiff) > to || to.Day < from.Day)
            {
                return monthDiff - 1;
            }
            else
            {
                return monthDiff;
            }
        }

        private void btnexporttoexcel_Click(object sender, EventArgs e)
        {
            //if (chbcompanydetail.Checked == true)
            excel_filename = "as on " + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            ConnectionWithAccess.export(LedDGV, excel_filename);
        }

        private void Button7_Click(object sender, EventArgs e)
        {
        }

        #region user_settings_checkbox_click

        private void chbPrivDataEntAllV_Click(object sender, EventArgs e)
        {
            if (chbPrivDataEntAllV.Checked == true)
            {
                chbPrivSaleV.Checked = true;
                chbPrivPurchaseV.Checked = true;
                chbPrivBankV.Checked = true;
                chbPrivCashV.Checked = true;
                chbPrivJournalV.Checked = true;
                chbPrivDataEntAllE.Checked = false;
                chbPrivSaleE.Checked = false;
                chbPrivPurchaseE.Checked = false;
                chbPrivBankE.Checked = false;
                chbPrivCashE.Checked = false;
                chbPrivJournalE.Checked = false;
            }
            else
            {
                chbPrivSaleV.Checked = false;
                chbPrivPurchaseV.Checked = false;
                chbPrivBankV.Checked = false;
                chbPrivCashV.Checked = false;
                chbPrivJournalV.Checked = false;
            }
        }

        private void chbPrivMastersAllV_Click(object sender, EventArgs e)
        {
            if (chbPrivMastersAllV.Checked == true)
            {
                chbPrivAccountV.Checked = true;
                chbPrivItemV.Checked = true;
                chbPrivTaxV.Checked = true;
                chbPrivDbcV.Checked = true;
                chbPrivPeriodV.Checked = true;
                chbPrivMastersAllE.Checked = false;
                chbPrivAccountE.Checked = false;
                chbPrivItemE.Checked = false;
                chbPrivTaxE.Checked = false;
                chbPrivDbcE.Checked = false;
                chbPrivPeriodE.Checked = false;
            }
            else
            {
                chbPrivAccountV.Checked = false;
                chbPrivItemV.Checked = false;
                chbPrivTaxV.Checked = false;
                chbPrivDbcV.Checked = false;
                chbPrivPeriodV.Checked = false;
            }
        }

        private void chbPrivOthersAllV_Click(object sender, EventArgs e)
        {
            if (chbPrivOthersAllV.Checked == true)
            {
                chbPrivUSetngV.Checked = true;
                chbPrivGSetngV.Checked = true;
                chbPrivCompInV.Checked = true;
                chbPrivReportsV.Checked = true;
                chbPrivUtilitiesV.Checked = true;
                chbPrivUSetngE.Checked = false;
                chbPrivGSetngE.Checked = false;
                chbPrivCompInE.Checked = false;
                chbPrivReportsE.Checked = false;
                chbPrivUtilitiesE.Checked = false;
                chbPrivOthersAllE.Checked = false;
            }
            else
            {
                chbPrivUSetngV.Checked = false;
                chbPrivGSetngV.Checked = false;
                chbPrivCompInV.Checked = false;
                chbPrivReportsV.Checked = false;
                chbPrivUtilitiesV.Checked = false;
            }
        }

        private void chbPrivMastersAllE_Click(object sender, EventArgs e)
        {
            if (chbPrivMastersAllE.Checked == true)
            {
                chbPrivAccountE.Checked = true;
                chbPrivItemE.Checked = true;
                chbPrivTaxE.Checked = true;
                chbPrivDbcE.Checked = true;
                chbPrivPeriodE.Checked = true;
                chbPrivMastersAllV.Checked = false;
                chbPrivAccountV.Checked = false;
                chbPrivItemV.Checked = false;
                chbPrivTaxV.Checked = false;
                chbPrivDbcV.Checked = false;
                chbPrivPeriodV.Checked = false;
            }
            else
            {
                chbPrivAccountV.Checked = false;
                chbPrivAccountE.Checked = false;
                chbPrivItemE.Checked = false;
                chbPrivTaxE.Checked = false;
                chbPrivDbcE.Checked = false;
                chbPrivPeriodE.Checked = false;
            }
        }

        private void chbPrivAccountV_Click(object sender, EventArgs e)
        {
            if (chbPrivAccountV.Checked == true)
            {
                chbPrivMastersAllE.Checked = false;
                chbPrivAccountE.Checked = false;
            }
            else
                chbPrivMastersAllV.Checked = false;
        }

        private void chbPrivItemV_Click(object sender, EventArgs e)
        {
            if (chbPrivItemV.Checked == true)
            {
                chbPrivMastersAllE.Checked = false;
                chbPrivItemE.Checked = false;
            }
            else
                chbPrivMastersAllV.Checked = false;
        }

        private void chbPrivTaxV_Click(object sender, EventArgs e)
        {
            if (chbPrivTaxV.Checked == true)
            {
                chbPrivMastersAllE.Checked = false;
                chbPrivTaxE.Checked = false;
            }
            else
                chbPrivMastersAllV.Checked = false;
        }

        private void chbPrivDbcV_Click(object sender, EventArgs e)
        {
            if (chbPrivDbcV.Checked == true)
            {
                chbPrivMastersAllE.Checked = false;
                chbPrivDbcE.Checked = false;
            }
            else
                chbPrivMastersAllV.Checked = false;
        }

        private void chbPrivPeriodV_Click(object sender, EventArgs e)
        {
            if (chbPrivPeriodV.Checked == true)
            {
                chbPrivMastersAllE.Checked = false;
                chbPrivPeriodE.Checked = false;
            }
            else
                chbPrivMastersAllV.Checked = false;
        }

        private void chbPrivAccountE_Click(object sender, EventArgs e)
        {
            if (chbPrivAccountE.Checked == true)
            {
                chbPrivMastersAllV.Checked = false;
                chbPrivAccountV.Checked = false;
            }
            else
                chbPrivMastersAllE.Checked = false;
        }

        private void chbPrivItemE_Click(object sender, EventArgs e)
        {
            if (chbPrivItemE.Checked == true)
            {
                chbPrivMastersAllV.Checked = false;
                chbPrivItemV.Checked = false;
            }
            else
                chbPrivMastersAllE.Checked = false;
        }

        private void chbPrivTaxE_Click(object sender, EventArgs e)
        {
            if (chbPrivTaxE.Checked == true)
            {
                chbPrivMastersAllV.Checked = false;
                chbPrivTaxV.Checked = false;
            }
            else
                chbPrivMastersAllE.Checked = false;
        }

        private void chbPrivDbcE_Click(object sender, EventArgs e)
        {
            if (chbPrivDbcE.Checked == true)
            {
                chbPrivMastersAllV.Checked = false;
                chbPrivDbcV.Checked = false;
            }
            else
                chbPrivMastersAllE.Checked = false;
        }

        private void chbPrivPeriodE_Click(object sender, EventArgs e)
        {
            if (chbPrivPeriodE.Checked == true)
            {
                chbPrivMastersAllV.Checked = false;
                chbPrivPeriodV.Checked = false;
            }
            else
                chbPrivMastersAllE.Checked = false;
        }

        private void chbPrivDataEntAllE_Click(object sender, EventArgs e)
        {
            if (chbPrivDataEntAllE.Checked == true)
            {
                chbPrivDataEntAllV.Checked = false;
                chbPrivSaleV.Checked = false;
                chbPrivPurchaseV.Checked = false;
                chbPrivBankV.Checked = false;
                chbPrivCashV.Checked = false;
                chbPrivJournalV.Checked = false;
                chbPrivSaleE.Checked = true;
                chbPrivPurchaseE.Checked = true;
                chbPrivBankE.Checked = true;
                chbPrivCashE.Checked = true;
                chbPrivJournalE.Checked = true;
            }
            else
            {
                chbPrivSaleE.Checked = false;
                chbPrivPurchaseE.Checked = false;
                chbPrivBankE.Checked = false;
                chbPrivCashE.Checked = false;
                chbPrivJournalE.Checked = false;
            }
        }

        private void chbPrivSaleV_Click(object sender, EventArgs e)
        {
            if (chbPrivSaleV.Checked == true)
            {
                chbPrivDataEntAllE.Checked = false;
                chbPrivSaleE.Checked = false;
            }
            else
                chbPrivDataEntAllV.Checked = false;
        }

        private void chbPrivPurchaseE_Click(object sender, EventArgs e)
        {
            if (chbPrivPurchaseE.Checked == true)
            {
                chbPrivDataEntAllV.Checked = false;
                chbPrivPurchaseV.Checked = false;
            }
            else
                chbPrivDataEntAllE.Checked = false;
        }

        private void chbPrivBankE_Click(object sender, EventArgs e)
        {
            if (chbPrivBankE.Checked == true)
            {
                chbPrivDataEntAllV.Checked = false;
                chbPrivBankV.Checked = false;
            }
            else
                chbPrivDataEntAllE.Checked = false;
        }

        private void chbPrivCashE_Click(object sender, EventArgs e)
        {
            if (chbPrivCashE.Checked == true)
            {
                chbPrivDataEntAllV.Checked = false;
                chbPrivCashV.Checked = false;
            }
            else
                chbPrivDataEntAllE.Checked = false;
        }

        private void chbPrivJournalE_Click(object sender, EventArgs e)
        {
            if (chbPrivJournalE.Checked == true)
            {
                chbPrivDataEntAllV.Checked = false;
                chbPrivJournalV.Checked = false;
            }
            else
                chbPrivDataEntAllE.Checked = false;
        }

        private void chbPrivPurchaseV_Click(object sender, EventArgs e)
        {
            if (chbPrivPurchaseV.Checked == true)
            {
                chbPrivDataEntAllE.Checked = false;
                chbPrivPurchaseE.Checked = false;
            }
            else
                chbPrivDataEntAllV.Checked = false;
        }

        private void chbPrivBankV_Click(object sender, EventArgs e)
        {
            if (chbPrivBankV.Checked == true)
            {
                chbPrivDataEntAllE.Checked = false;
                chbPrivBankE.Checked = false;
            }
            else
                chbPrivDataEntAllV.Checked = false;
        }

        private void chbPrivCashV_Click(object sender, EventArgs e)
        {
            if (chbPrivCashV.Checked == true)
            {
                chbPrivDataEntAllE.Checked = false;
                chbPrivCashE.Checked = false;
            }
            else
                chbPrivDataEntAllV.Checked = false;
        }

        private void chbPrivJournalV_Click(object sender, EventArgs e)
        {
            if (chbPrivJournalV.Checked == true)
            {
                chbPrivDataEntAllE.Checked = false;
                chbPrivJournalE.Checked = false;
            }
            else
                chbPrivDataEntAllV.Checked = false;
        }

        private void chbPrivSaleE_Click(object sender, EventArgs e)
        {
            if (chbPrivSaleE.Checked == true)
            {
                chbPrivDataEntAllV.Checked = false;
                chbPrivSaleV.Checked = false;
            }
            else
                chbPrivDataEntAllE.Checked = false;
        }

        private void chbPrivOthersAllE_Click(object sender, EventArgs e)
        {
            if (chbPrivOthersAllE.Checked == true)
            {
                chbPrivUSetngE.Checked = true;
                chbPrivGSetngE.Checked = true;
                chbPrivCompInE.Checked = true;
                chbPrivReportsE.Checked = true;
                chbPrivUtilitiesE.Checked = true;
                chbPrivOthersAllV.Checked = false;
                chbPrivUSetngV.Checked = false;
                chbPrivGSetngV.Checked = false;
                chbPrivCompInV.Checked = false;
                chbPrivReportsV.Checked = false;
                chbPrivUtilitiesV.Checked = false;
            }
            else
            {
                chbPrivUSetngE.Checked = false;
                chbPrivGSetngE.Checked = false;
                chbPrivCompInE.Checked = false;
                chbPrivReportsE.Checked = false;
                chbPrivUtilitiesE.Checked = false;
            }
        }

        private void chbPrivUSetngV_Click(object sender, EventArgs e)
        {
            if (chbPrivUSetngV.Checked == true)
            {
                chbPrivOthersAllE.Checked = false;
                chbPrivUSetngE.Checked = false;
            }
            else
                chbPrivOthersAllV.Checked = false;
        }

        private void chbPrivUSetngE_Click(object sender, EventArgs e)
        {
            if (chbPrivUSetngE.Checked == true)
            {
                chbPrivOthersAllV.Checked = false;
                chbPrivUSetngV.Checked = false;
            }
            else
                chbPrivOthersAllE.Checked = false;
        }

        private void chbPrivGSetngE_Click(object sender, EventArgs e)
        {
            if (chbPrivGSetngE.Checked == true)
            {
                chbPrivOthersAllV.Checked = false;
                chbPrivGSetngV.Checked = false;
            }
            else
                chbPrivOthersAllE.Checked = false;
        }

        private void chbPrivCompInE_Click(object sender, EventArgs e)
        {
            if (chbPrivCompInE.Checked == true)
            {
                chbPrivOthersAllV.Checked = false;
                chbPrivCompInV.Checked = false;
            }
            else
                chbPrivOthersAllE.Checked = false;
        }

        private void chbPrivReportsE_Click(object sender, EventArgs e)
        {
            if (chbPrivReportsE.Checked == true)
            {
                chbPrivOthersAllV.Checked = false;
                chbPrivReportsV.Checked = false;
            }
            else
                chbPrivOthersAllE.Checked = false;
        }

        private void chbPrivUtilitiesE_Click(object sender, EventArgs e)
        {
            if (chbPrivUtilitiesE.Checked == true)
            {
                chbPrivOthersAllV.Checked = false;
                chbPrivUtilitiesV.Checked = false;
            }
            else
                chbPrivOthersAllE.Checked = false;
        }

        private void chbPrivGSetngV_Click(object sender, EventArgs e)
        {

            if (chbPrivGSetngV.Checked == true)
            {
                chbPrivOthersAllE.Checked = false;
                chbPrivGSetngE.Checked = false;
            }
            else
                chbPrivOthersAllV.Checked = false;
        }

        private void chbPrivCompInV_Click(object sender, EventArgs e)
        {
            if (chbPrivCompInV.Checked == true)
            {
                chbPrivOthersAllE.Checked = false;
                chbPrivCompInE.Checked = false;
            }
            else
                chbPrivOthersAllV.Checked = false;
        }

        private void chbPrivReportsV_Click(object sender, EventArgs e)
        {
            if (chbPrivReportsV.Checked == true)
            {
                chbPrivOthersAllE.Checked = false;
                chbPrivReportsE.Checked = false;
            }
            else
                chbPrivOthersAllV.Checked = false;
        }

        private void chbPrivUtilitiesV_Click(object sender, EventArgs e)
        {
            if (chbPrivUtilitiesV.Checked == true)
            {
                chbPrivOthersAllE.Checked = false;
                chbPrivUtilitiesE.Checked = false;
            }
            else
                chbPrivOthersAllV.Checked = false;
        }
        # endregion

        private void cbParent_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (maintab.SelectedIndex == 2)
            {
                btn_add_delivery_account.Visible = false;
                tbdelivery.Enabled = false;
                tbdelivery_city.Enabled = false;
                tbDesc.Text = null;
                refresh_master_account();
                master_accounts_process();
                lbl_master_d_c.Visible = false;
                update_master_account_screen_details(tbA_N.Text, tbS_A.Text, tbd_y.Text);
            }
        }

        private void refresh_bank_details()
        {
            bankname.Text = "";
            BANKADDRESS.Text = "";
            BANKCITY.Text = "";
            BANKACCNUMBER.Text = "0";
            BANKNEFTIFSC.Text = "";
        }

        private void refresh_master_account()
        {
            btn_add_delivery_account.Visible = false;
            refresh_bank_details();
            cb_add_new_account.Checked = false;
            if (tbDesc.Text == "")
            {
                tbS_A.Text = "@@@";
                tbd_y.Text = "@@@";
                tbCity.Text = "";
                lbl_master_master_account_name.Visible = false;
                if (cbParent.SelectedItem.Equals("BANK ACCOUNT"))
                    tbA_N.Text = "2011";
                else if (cbParent.SelectedItem.Equals("OLD CAPITAL ACCOUNT"))
                    tbA_N.Text = "3000";
                else if (cbParent.SelectedItem.Equals("CAPITAL ACCOUNT"))
                    tbA_N.Text = "3001";
                else if (cbParent.SelectedItem.Equals("CASH IN HAND"))
                    tbA_N.Text = "2010";
                else if (cbParent.SelectedItem.Equals("DIRECT EXPENSES(TRADING)"))
                    tbA_N.Text = "70";
                else if (cbParent.SelectedItem.Equals("DIRECT INCOMES(TRADING)"))
                    tbA_N.Text = "70";
                else if (cbParent.SelectedItem.Equals("FIXED ASSETS"))
                    tbA_N.Text = "1";
                else if (cbParent.SelectedItem.Equals("INDIRECT EXPENSES(P&L)") || cbParent.SelectedItem.Equals("INDIRECT INCOMES(P&L)"))
                    tbA_N.Text = "75";
                else if (cbParent.SelectedItem.Equals("LOAN GIVEN"))
                    tbA_N.Text = "3501";
                else if (cbParent.SelectedItem.Equals("LOAN RECEIVED"))
                    tbA_N.Text = "3500";
                else if (cbParent.SelectedItem.Equals("SUNDRY CREDITORS"))
                    tbA_N.Text = "4002";
                else if (cbParent.SelectedItem.Equals("SUNDRY DEBTORS"))
                {
                    if (cb_master_d_c.Text != "")
                    {
                        tbA_N.Text = get_a_n_from_d_c("S", Convert.ToInt32(cb_master_d_c.Text));
                        tbS_A.Text = "@@@";
                        tbd_y.Text = "@@@";
                    }
                    else
                        tbA_N.Text = "2002";

                    //cb_master_d_c.Text = get_d_c_from_a_n(tbA_N.Text).ToString();
                }
                else if (cbParent.SelectedItem.Equals("INVESTMENTS"))
                    tbA_N.Text = "3508";
                get_account_details_from_01(tbA_N.Text, "@@@");
                if (function_working != "New" && function_working != null)
                {// make tbdesc blank if its atbnew
                    tbDesc.Text = account_detail_from_01[4];
                    tbCity.Text = account_detail_from_01[8];
                    //update_master_account_screen_details(tbA_N.Text, tbS_A.Text, tbd_y.Text);
                }
            }
            else
            {
                tbDesc.Text = "";
                tbCity.Text = "";
                tbS_A.Text = "@@@";
                tbd_y.Text = "@@@";
            }
            //cb_change_master_account_name.Visible = false;
            if (cbParent.SelectedItem.Equals("BANK ACCOUNT") || cbParent.SelectedItem.Equals("CASH IN HAND") || cbParent.SelectedItem.Equals("SUNDRY CREDITORS") || cbParent.SelectedItem.Equals("SUNDRY DEBTORS"))
                cb_add_new_account.Visible = true;
            else
                cb_add_new_account.Visible = false;
            cb_change_master_account_name.Checked = false;
            master_account_help_dg.Visible = false;
            dgvStdCodeHelp.Visible = false;
            Bank_Details.Visible = true;
            //tbCity.Text = "";
            tbMNo1.Text = "";
            tbAdd1.Text = "";
            tbAdd2.Text = "";
            tbAdd3.Text = "";
            tbTINNo.Text = "";
            tbMaxLim.Text = "";
            tbPincode.Text = "0";
            tbadharcard.Text = "0";
            tbgst_number.Text = "";
            tbpan.Text = "";
            tbdistrict.Clear();
            tbTPT.Enabled = true;
            tbTPT.Items.Clear();
            tbTPT.Items.Add("Hand Delivery");
            tbTaxDesc.Text = "";
            //cbMTC.Text = Convert.ToString(AccountListDG.SelectedCells[10].Value);
            tbStd.Text = "";
            tbMNo2.Text = "";
            tbOPh2.Text = "";
            tbOPh1.Text = "";
            tbRPh2.Text = "";
            tbFax.Text = "";
            tbEmail.Text = "";
            tbWebsite.Text = "";
            tbstate.Text = "";
            tbstate.BackColor = Color.White;
            tbopenbalance.Text = "0.00";
            tbgst_number.Text = "";
            tbdelivery.Text = "";
            tbdelivery_city.Text = "";
            tbDesc.Enabled = true;
            tbCity.Enabled = true;
            tbdelivery.Enabled = false;
            tbdelivery_city.Enabled = false;
            tbDesc.Focus();
            //master_accounts_process();
        }

        private void master_accounts_process()
        {
            cb_master_d_c.Visible = false;
            cb_master_d_c.Enabled = true;
            cb_master_d_c.Items.Clear();
            lbl_master_d_c.Visible = true;
            tbd_y.Text = null;
            ConnectionWithAccess.ms_a = null;
            if (cbParent.SelectedItem.Equals("BANK ACCOUNT"))
            {
                tbA_N.Text = "2011";
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[23] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_master_d_c);
                if (cb_master_d_c.Items.Count == 1)
                {
                    cb_master_d_c.Enabled = false;
                    cb_master_d_c.SelectedIndex = 0;
                }
                get_account_name_from_d_c("B", Convert.ToInt32(cb_master_d_c.Items[0].ToString()));
                get_bank_details();
            }
            else if (cbParent.SelectedItem.Equals("OLD CAPITAL ACCOUNT"))
                tbA_N.Text = "3000";
            else if (cbParent.SelectedItem.Equals("CAPITAL ACCOUNT"))
                tbA_N.Text = "3001";
            else if (cbParent.SelectedItem.Equals("CASH IN HAND"))
                tbA_N.Text = "2010";
            else if (cbParent.SelectedItem.Equals("DIRECT EXPENSES(TRADING)"))
                tbA_N.Text = "70";
            else if (cbParent.SelectedItem.Equals("DIRECT INCOMES(TRADING)"))
                tbA_N.Text = "70";
            else if (cbParent.SelectedItem.Equals("FIXED ASSETS"))
                tbA_N.Text = "1";
            else if (cbParent.SelectedItem.Equals("INDIRECT EXPENSES(P&L)") || cbParent.SelectedItem.Equals("INDIRECT INCOMES(P&L)"))
                tbA_N.Text = "75";
            else if (cbParent.SelectedItem.Equals("LOAN GIVEN"))
                tbA_N.Text = "3501";
            else if (cbParent.SelectedItem.Equals("LOAN RECEIVED"))
                tbA_N.Text = "3500";
            else if (cbParent.SelectedItem.Equals("SUNDRY CREDITORS"))
            {
                tbA_N.Text = "4002";
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[22] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_master_d_c);
                cb_master_d_c.Visible = true;
                if (cb_master_d_c.Items.Count == 1)
                    cb_master_d_c.Enabled = false;
                if (cb_master_d_c.Items[0].ToString() != "")
                {
                    get_account_name_from_d_c("P", Convert.ToInt32(cb_master_d_c.Items[0].ToString()));
                    ConnectionWithAccess.query = "select [desc] from " + ConnectionWithAccess.tablename[06] + " where d_c = " + Convert.ToInt32(cb_master_d_c.Items[0].ToString()) + " order by tx_code";
                    ConnectionCommand.retrieval(cbMtaxDesc);
                }
            }
            else if (cbParent.SelectedItem.Equals("SUNDRY DEBTORS"))
            {
                tbA_N.Text = "2002";
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[21] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_master_d_c);
                cb_master_d_c.Visible = true;
                if (cb_master_d_c.Items.Count == 1)
                    cb_master_d_c.Enabled = false;
                get_account_name_from_d_c("S", Convert.ToInt32(cb_master_d_c.Text));
                ConnectionWithAccess.query = "select [desc] from " + ConnectionWithAccess.tablename[06] + " where d_c = " + Convert.ToInt32(cb_master_d_c.Items[0].ToString()) + " order by tx_code";
                ConnectionCommand.retrieval(cbMtaxDesc);
            }
        }

        private void brtranlist_Click(object sender, EventArgs e)
        {
            bramt.ReadOnly = false;
            brdatetime.Value = Convert.ToDateTime(brtranlist.SelectedCells[0].Value);
            brdocno.Text = Convert.ToString(brtranlist.SelectedCells[1].Value);
            brpartycode.Text = Convert.ToString(brtranlist.SelectedCells[2].Value);
            brpartyname.Text = Convert.ToString(brtranlist.SelectedCells[2].Value);
            brpartycity.Text = Convert.ToString(brtranlist.SelectedCells[3].Value);
            bramt.Text = Convert.ToString(brtranlist.SelectedCells[4].Value);
            old_bank_receipt_amount = Convert.ToDouble(brtranlist.SelectedCells[4].Value);
            brchkno.Text = Convert.ToString(brtranlist.SelectedCells[5].Value);
            if (brtranlist.SelectedCells[6].Value.ToString() != "" && brtranlist.SelectedCells[6].Value != null)
                brchkdate.Value = Convert.ToDateTime(brtranlist.SelectedCells[6].Value);
            cbchqbank.Text = Convert.ToString(brtranlist.SelectedCells[7].Value);
            brpassdate.Text = Convert.ToString(brtranlist.SelectedCells[8].Value);
            brcomm.Text = Convert.ToString(brtranlist.SelectedCells[9].Value);
            bra_n.Text = Convert.ToString(brtranlist.SelectedCells[10].Value);
            brs_a.Text = Convert.ToString(brtranlist.SelectedCells[11].Value);
            brpartyoverallbalance.Text = Convert.ToString(calculate_account_balance(bra_n.Text, brs_a.Text, Convert.ToString(brdatetime.Text)));
            //b_t = 2 for balance, b_t = 3 for passed, b_t = 4 for failed.
            if (Convert.ToString(brtranlist.SelectedCells[12].Value) == "2")
                brchkstatus.SelectedIndex = 0;
            else if (Convert.ToString(brtranlist.SelectedCells[12].Value) == "3")
            {
                brchkstatus.SelectedIndex = 1;
                old_bank_receipt_amount = Convert.ToDouble(bramt.Text);
            }
            else if (Convert.ToString(brtranlist.SelectedCells[12].Value) == "4")
                brchkstatus.SelectedIndex = 2;
            populate_screen();

            //calculate_account_balance(bra_n.Text, brs_a.Text, Convert.ToString(brdatetime.Text));

            bramt.Focus();
        }

        private void bdtranlist_Click(object sender, EventArgs e)
        {
            bddatetime.Value = Convert.ToDateTime(bdtranlist.SelectedCells[0].Value);
            bddocno.Text = Convert.ToString(bdtranlist.SelectedCells[1].Value);
            ConnectionWithAccess.md_n = Convert.ToString(bdtranlist.SelectedCells[1].Value);
            bdamt.Text = Convert.ToString(bdtranlist.SelectedCells[2].Value);
            old_bank_deposit_amount = Convert.ToDouble(bdtranlist.SelectedCells[2].Value);
            bdcomm.Text = Convert.ToString(bdtranlist.SelectedCells[3].Value);
            //bda_n.Text = Convert.ToString(bdtranlist.SelectedCells[5].Value);
            //bds_a.Text = Convert.ToString(bdtranlist.SelectedCells[6].Value);
        }

        private void bwtranlist_Click(object sender, EventArgs e)
        {
            bwdatetime.Value = Convert.ToDateTime(bwtranlist.SelectedCells[0].Value);
            bwdocno.Text = Convert.ToString(bwtranlist.SelectedCells[1].Value);
            bwamt.Text = Convert.ToString(Convert.ToDouble((bwtranlist.SelectedCells[2].Value).ToString()) * -1);
            old_bank_withdrawal_amount = Convert.ToDouble((bwtranlist.SelectedCells[2].Value).ToString()) * -1;
            bwcomm.Text = Convert.ToString(bwtranlist.SelectedCells[3].Value);
        }

        private void bptranlist_Click(object sender, EventArgs e)
        {
            bpdatetime.Value = Convert.ToDateTime(bptranlist.SelectedCells[1].Value);
            bpdocno.Text = "";
            if (bpdocno.Text == Convert.ToString(bptranlist.SelectedCells[2].Value))
                bpdocno_TextChanged(sender, e);
            else
                bpdocno.Text = Convert.ToString(bptranlist.SelectedCells[2].Value);
        }

        private void TabControl2_MouseClick(object sender, MouseEventArgs e)
        {
            xmouse_point = Convert.ToString(e.X);
            ymouse_point = Convert.ToString(e.Y);
            lblmousex.Text = xmouse_point;
            lblmousey.Text = ymouse_point;
        }

        private void TabPage1_MouseMove(object sender, MouseEventArgs e)
        {
            xmouse_point = Convert.ToString(e.X);
            ymouse_point = Convert.ToString(e.Y);
            lblmousex.Text = xmouse_point;
            lblmousey.Text = ymouse_point;
        }

        private void TabPage1_MouseClick(object sender, MouseEventArgs e)
        {
            //xmouse_point = Convert.ToString(e.X);
            //ymouse_point = Convert.ToString(e.Y);
            //lblmousex.Text = xmouse_point;
            //lblmousey.Text = ymouse_point;
            //if (Convert.ToInt32(xmouse_point) >= 660 && Convert.ToInt32(xmouse_point) <= 853 && Convert.ToInt32(ymouse_point) >= 55 && Convert.ToInt32(ymouse_point) <= 70)
            //{
            //    fill_tax_description();
            //    cbMtaxDesc.Visible = true;
            //}
            //else
            //{
            //    if (cbMtaxDesc.Visible == true)
            //        cbMtaxDesc.Visible = false;
            //}
        }

        private void tbTitle_TextChanged(object sender, EventArgs e)
        {
            //if (tbTitle.Text != "")
            //    master_item_help.Visible = true;
            //ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where title like '%" + tbTitle.Text + "%'";
            //ConnectionCommand.accountHelp_datatable_Seperate(master_item_help, "master_item_help");
            //master_item_help.Columns[0].Visible = false;
            //master_item_help.Columns[1].Visible = false;
            //master_item_help.Columns[2].Width = 300;
        }

        private void vClearItemDetails()
        {
            tbItemType.Text = null;
            tbItemCode.Text = null;
            tbCB.Text = "0";
            tbBQ.Text = "0";
            tbItemRate.Text = "0.00";
            tbMinStock.Text = "0";
            master_item_help.Visible = false;
        }

        private void rdbvisiting_Click(object sender, EventArgs e)
        {
            show_images();
        }

        private void rdbpersonal_Click(object sender, EventArgs e)
        {
            show_images();
        }

        bool bsiPartyChangeIgnore = false;
        private void si_party_help_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data");
            objPleaseWait.Show();
            Application.DoEvents();
            try
            {
                if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
                {
                    if (sideliverycode.Text == "")
                    {
                        bsiPartyChangeIgnore = true;
                        sipartycode.Text = Convert.ToString(si_party_help.CurrentRow.Cells[0].Value);
                        sicity.Text = Convert.ToString(si_party_help.CurrentRow.Cells[1].Value);
                        sia_n.Text = Convert.ToString(si_party_help.CurrentRow.Cells[2].Value);
                        sis_a.Text = Convert.ToString(si_party_help.CurrentRow.Cells[3].Value);
                        sid_y.Text = Convert.ToString(si_party_help.CurrentRow.Cells[4].Value);
                        get_account_details_from_04(sia_n.Text, sis_a.Text);
                        fill_transport(sia_n.Text, sicity.Text, sitransport);
                        sitransport.Text = account_detail_from_04[30];
                        check_if_have_delivery_account(sia_n.Text, sis_a.Text);
                    }
                    else
                    {
                        sideliverycode.Text = Convert.ToString(si_party_help.CurrentRow.Cells[0].Value);
                        sideliverycity.Text = Convert.ToString(si_party_help.CurrentRow.Cells[1].Value);
                        sid_y.Text = Convert.ToString(si_party_help.CurrentRow.Cells[4].Value);
                    }
                    siitemlist.Enabled = true;
                    siitemlist.Visible = true;
                }
                populate_screen();
                get_tax_desc_from_dc("S", sidbc.Text, Convert.ToInt32(sitaxcode.Text));
                show_images();
                si_party_help.Visible = false;
            }
            catch (Exception ex)
            {

            }
            finally
            {
                bsiPartyChangeIgnore = false;
            }
            objPleaseWait.Close();
            siitemlist.Enabled = true;
            siitemlist.Visible = true;
        }

        private void check_if_have_delivery_account(string ma_n, string ms_a)
        {
            ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and d_y <> '@@@'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                sideliverycode.Visible = true;
                sideliverycity.Visible = true;
                lbl_sideliver.Visible = true;
            }
            else
            {
                sideliverycode.Visible = false;
                sideliverycity.Visible = false;
                lbl_sideliver.Visible = false;
            }
        }

        private void si_party_help_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                ConnectionWithAccess.query = "select a_n, s_a, d_y, [desc], city from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + sidbc.Text + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='') and ([desc] like '%" + si_party_help.SelectedCells[0].Value + "%')";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        sia_n.Text = dtData1.Rows[0][0].ToString();
                        sis_a.Text = dtData1.Rows[0][1].ToString();
                        sid_y.Text = dtData1.Rows[0][2].ToString();
                        show_images();
                    }
                }
                fill_transport(sia_n.Text, sicity.Text, sitransport);
                sitransport.Enabled = true;
                populate_screen();
                ConnectionWithAccess.query = "select tx_code,tax_rate, [desc] from " + ConnectionWithAccess.tablename[06] + " where d_c = " + Convert.ToInt32(sidbc.Text) + " and tx_code = " + sitaxcode.Text;
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        sitaxrate.Text = dtData1.Rows[0][1].ToString();
                        sitaxdesc.Text = dtData1.Rows[0][2].ToString();
                    }
                    else
                    {
                        sitaxdesc.Text = "";
                        sitaxrate.Text = "0.00";
                    }
                }
                else
                {
                    sitaxdesc.Text = "";
                    sitaxrate.Text = "0.00";
                }
                si_party_help.Visible = false;
                sipartycode.Text = sipartyname.Text;
            }
            else
            {
                if (e.KeyCode == Keys.Down)
                {
                    rowIndex = si_party_help.CurrentRow.Index + 1;
                }
                else
                    if (e.KeyCode == Keys.Up)
                    {
                        rowIndex = si_party_help.CurrentRow.Index - 1;
                    }
                show_images();
            }
        }

        private void siitemlist_RowValidating(object sender, DataGridViewCellCancelEventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Item";
        }

        private void truncate(string tablename)
        {
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.mNIK + "_0" + tablename;
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void insert_table_data(string tablename, string colnames, string data)
        {
            ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.mNIK + "_0" + tablename + "(" + colnames + ") values(" + data + ")";
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void subtabreports_Click(object sender, EventArgs e)
        {
            current_working_tab = "3" + subtabreports.SelectedIndex;
            pdf_viewer1.Visible = false;
            pdf_viewer2.Visible = false;
            pdf_viewer3.Visible = false;
            pdf_viewer_report_outstanding.Visible = false;
            if (subtabreports.SelectedIndex == 0)
            {
                gdvreport.Visible = true;
                fPopulatecmbDateRange(cmbDateRangeANALYSIS);
            }
            else if (subtabreports.SelectedIndex == 1)
            {
                fPopulatecmbDateRange(cmbDateRangeLedger);
                ConnectionWithAccess.data_entry_working = "Ledger";
                //cbledparent.SelectedIndex = 0;
                //cbledparent.SelectedIndex = 15;
                tb_ledger_account_name.Focus();
            }
            else if (subtabreports.SelectedIndex == 2)
            {
            }
            else if (subtabreports.SelectedIndex == 3)
                fPopulatecmbDateRange(cmbDateRangeGST);
            else if (subtabreports.SelectedIndex == 6)
                fPopulatecmbDateRange(cmbDateRangeMIX);
            else if (subtabreports.SelectedIndex == 7)
            {
                fPopulatecmbDateRange(cmbDateRangeOut);
                rodbc.Visible = true;
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[21] + " where d_n = 999999";
                ConnectionCommand.retrieval(rodbc);
            }

        }

        private void add_contains_of_trading_account_in_gridviewold(bool dont_cleargridview = false)
        {
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT , '' , '', '' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n = '2001'";
            if (dont_cleargridview)
                ConnectionCommand.multiplerows(BalShDGV, "Trading Account");
            else
            {
                ConnectionCommand.accountHelp(BalShDGV, "Trading Account");
                BalShDGV.Columns[0].HeaderText = "Sort";
                BalShDGV.Columns[1].HeaderText = "A_n";
                BalShDGV.Columns[2].HeaderText = "S_a";
                BalShDGV.Columns[3].HeaderText = "Particular's";
                BalShDGV.Columns[4].HeaderText = "Debit_extra";
                BalShDGV.Columns[5].HeaderText = "Debit";
                BalShDGV.Columns[6].HeaderText = "Particular's";
                BalShDGV.Columns[7].HeaderText = "Credit_extra";
                BalShDGV.Columns[8].HeaderText = "Credit";
                BalShDGV.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                BalShDGV.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                BalShDGV.Columns[7].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                BalShDGV.Columns[8].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;

            }
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT , '' , '', '' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '6000%'";
            ConnectionCommand.multiplerows(BalShDGV, "Trading Account");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT , '' , '', '' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '61%'";
            ConnectionCommand.multiplerows(BalShDGV, "Trading Account");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT , '' , '', '' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '65%'";
            ConnectionCommand.multiplerows(BalShDGV, "Trading Account");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT , '' , '', '' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '70%'";
            ConnectionCommand.multiplerows(BalShDGV, "Trading Account");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '', '', '', f1.[DESC], '', (f51.AMT * -1) from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '5000%'";
            ConnectionCommand.multiplerows(BalShDGV, "Trading Account");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '', '', '', f1.[DESC], '', (f51.AMT * -1) from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '6000%'";
            ConnectionCommand.multiplerows(BalShDGV, "Trading Account");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '', '', '', f1.[DESC], '', (f51.AMT * -1) from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '65%'";
            ConnectionCommand.multiplerows(BalShDGV, "Trading Account");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '', '', '', f1.[DESC], '', (f51.AMT * -1) from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '70%'";
            ConnectionCommand.multiplerows(BalShDGV, "Trading Account");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT , '' , '', '' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n = '719999'";
            ConnectionCommand.multiplerows(BalShDGV, "Trading Account");
        }

        private void add_contains_of_profit_and_loss_in_gridviewold(bool dont_cleargridview = false)
        {
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '', '', '', f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n = '719999'";
            if (dont_cleargridview)
                ConnectionCommand.multiplerows(BalShDGV, "Profit and Loss Account");
            else
            {
                ConnectionCommand.accountHelp(BalShDGV, "Profit and Loss Account");
                BalShDGV.Columns[0].HeaderText = "Sort";
                BalShDGV.Columns[1].HeaderText = "A_n";
                BalShDGV.Columns[2].HeaderText = "S_a";
                BalShDGV.Columns[3].HeaderText = "Particular's";
                BalShDGV.Columns[4].HeaderText = "Debit_extra";
                BalShDGV.Columns[5].HeaderText = "Debit";
                BalShDGV.Columns[6].HeaderText = "Particular's";
                BalShDGV.Columns[7].HeaderText = "Credit_extra";
                BalShDGV.Columns[8].HeaderText = "Credit";
                BalShDGV.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                BalShDGV.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                BalShDGV.Columns[7].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                BalShDGV.Columns[8].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            }
            ConnectionWithAccess.query = "select '', f1.a_n,  f1.s_a,f1.[DESC], '', f51.AMT , '' , '' , '' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '75%'";
            ConnectionCommand.multiplerows(BalShDGV, "Profit and Loss Account");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '', '', '', f1.[DESC], '', (f51.AMT * -1) from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '75%'";
            ConnectionCommand.multiplerows(BalShDGV, "Profit and Loss Account");
            ConnectionWithAccess.query = "select '', f1.a_n,  f1.s_a,f1.[DESC], '', f51.AMT , '' , '' , '' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n = '7998'";
            ConnectionCommand.multiplerows(BalShDGV, "Profit and Loss Account");
            ConnectionWithAccess.query = "select '', f1.a_n,  f1.s_a,'', '', '' , 'Net Loss' , '' , (f51.AMT * -1) from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n = '7998'";
            ConnectionCommand.multiplerows(BalShDGV, "Profit and Loss Account");
        }

        private void fTradingAllReports(string mprd)
        {
            StringBuilder strQuery = new StringBuilder();

            //Trading
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc], '' as [City], f51.AMT as [amt_debit] , '' as [Desc1] , (amt-amt) as [credit_extra], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n = '2001' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc], '' as [City], f51.AMT as [amt_debit] , '' as [Desc1] , (amt-amt) as [credit_extra], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '6000%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc], '' as [City], f51.AMT as [amt_debit] , '' as [Desc1] , (amt-amt) as [credit_extra], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '61%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc], '' as [City], f51.AMT as [amt_debit] , '' as [Desc1] , (amt-amt) as [credit_extra], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '65%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc], '' as [City], f51.AMT as [amt_debit] , '' as [Desc1] , (amt-amt) as [credit_extra], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '70%' UNION ALL ");

            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc], '' as [City], 0 as [amt_debit], f1.[DESC] as [Desc1], (amt-amt) as [credit_extra], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '5000%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc], '' as [City], 0 as [amt_debit], f1.[DESC] as [Desc1], (amt-amt) as [credit_extra], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '6000%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc], '' as [City], 0 as [amt_debit], f1.[DESC] as [Desc1], (amt-amt) as [credit_extra], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '65%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc], '' as [City], 0 as [amt_debit], f1.[DESC] as [Desc1], (amt-amt) as [credit_extra], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '70%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc], '' as [City], f51.AMT as [amt_debit] , '' as [Desc1] , (amt-amt) as [credit_extra], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n = '719999' ");
            ConnectionWithAccess.query = strQuery.ToString();
            DataTable dtTrading = ConnectionCommand.fReturnDataTable();
            strQuery.Clear();

            //Profit Loss/
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc], '' as [City], 0 as [amt_debit], f1.[DESC] as [Desc1], (amt-amt) as [credit_extra], f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n = '719999' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc], '' as [City], f51.AMT as [amt_debit] , '' as [Desc1] , (amt-amt) as [credit_extra] , 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '75%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc], '' as [City], 0 as [amt_debit], f1.[DESC] as [Desc1], (amt-amt) as [credit_extra], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '75%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc], '' as [City], f51.AMT as [amt_debit], '' as [Desc1] , (amt-amt) as [credit_extra] , 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n = '7998' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc], '' as [City], 0 as [amt_debit], 'Net Loss' as [Desc1] , (amt-amt) as [credit_extra] , (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n = '7998' ");

            ConnectionWithAccess.query = strQuery.ToString();
            DataTable dtProfitLoss = ConnectionCommand.fReturnDataTable();
            strQuery.Clear();

            //Capital
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc], '' as [City], 0 as [amt_debit],f1.[DESC] as [Desc1] , (amt-amt) as [credit_extra], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.a_n = '3000' UNION ALL ");

            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc], '' as [City], 0 as [amt_debit], f1.[DESC] as [Desc1] , (amt-amt) as [credit_extra], f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.a_n = '7998' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, 'Net Loss' as [Desc], '' as [City], (f51.AMT * -1) as [amt_debit], '' as [Desc1] , (amt-amt) as [credit_extra] , 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n = '7998' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc], '' as [City], f51.AMT as [amt_debit],'' as [Desc1] , (amt-amt) as [credit_extra] , 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a <> '@@@' and f51.a_n like '3001%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc], '' as [City], 0 as [amt_debit], f1.[DESC] as [Desc1] , (amt-amt) as [credit_extra], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.a_n like '3001%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc], '' as [City], f51.AMT as [amt_debit],'' as [Desc1] , (amt-amt) as [credit_extra] , 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.a_n = '3001' and f51.s_a = '@@@'  ");

            ConnectionWithAccess.query = strQuery.ToString();
            DataTable dtCapital = ConnectionCommand.fReturnDataTable();
            strQuery.Clear();

            //Balance Sheet
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc],'' as [City] , 0 as [amt_debit] , f1.[DESC] as [Desc1], f51.AMT as [credit_extra], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + "  f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.a_n like '1%' union all select '', f1.a_n, f1.s_a, '' as [Desc],'' as [City] , (JAMT-JAMT) as [amt_debit] , f1.[DESC] as [Desc1], f25.JAMT as [credit_extra], (JAMT-JAMT) as [amt_credit]  from " + ConnectionWithAccess.tablename[25] + " f25 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f1.A_n = f25.NA_n where f25.prd = '" + mprd + "' and f25.a_n = '75Dep' and f25.s_a = 'DEP' UNION ALL ");

            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc],'' as [City] , 0 as [amt_debit] , f1.[DESC] as [Desc1], (amt-amt) as [credit_extra], f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '2%' and f51.a_n <> '2001' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc],'' as [City] , 0 as [amt_debit] , f1.[DESC] as [Desc1], (amt-amt) as [credit_extra], f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '3%' and f51.a_n <> '3001'and f51.a_n <> '3500' and f51.a_n <> '3501' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc],'' as [City] , 0 as [amt_debit]  , f1.[DESC] as [Desc1], (amt-amt) as [credit_extra], f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a <> '@@@' and f51.a_n LIKE '35%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc],'' as [City] , 0 as [amt_debit]  , f1.[DESC] as [Desc1], (amt-amt) as [credit_extra], f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '4%' UNION ALL ");

            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc],'' as [City] , 0 as [amt_debit] , f1.[DESC] as [Desc1], (amt-amt) as [credit_extra], f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '65%' UNION ALL ");

            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc] , '' as [City], f51.AMT as [amt_debit], '' as [Desc1], (amt-amt) as [credit_extra],0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n = '3001' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [Desc],'' as [City] , 0 as [amt_debit] , f1.[DESC] as [Desc1], (amt-amt) as [credit_extra], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '5%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc] , '' as [City], (f51.AMT * -1) as [amt_debit], '' as [Desc1], (amt-amt) as [credit_extra],0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '2%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc] , '' as [City], (f51.AMT * -1) as [amt_debit], '' as [Desc1], (amt-amt) as [credit_extra],0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '3%' and f51.a_n <> '3000' and f51.a_n <> '3500' and f51.a_n <> '3501' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc] , '' as [City], (f51.AMT * -1) as [amt_debit], '' as [Desc1], (amt-amt) as [credit_extra],0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and (f51.s_a <> '@@@' and f51.s_a <> '') and f51.a_n LIKE '35%' and f51.a_n <> '3500' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc] , '' as [City], (f51.AMT * -1) as [amt_debit], '' as [Desc1], (amt-amt) as [credit_extra],0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '4%'  ");

            ConnectionWithAccess.query = strQuery.ToString();
            DataTable dtBalanceSheet = ConnectionCommand.fReturnDataTable();
            strQuery.Clear();

            //debitors_outstanding
            //strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC],f1.[CITY], f51.AMT as [amt_debit], '', 0.00,0.00 as [amt_credit]  from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a <> '@@@' and f51.amt > 0 and f51.a_n like '2002%' order by f1.a_n + f1.s_a ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc],f1.[CITY] as [City], f51.AMT as [amt_debit], '' as [Desc1],  (amt-amt) as [credit_extra],  (amt-amt) as [amt_credit]  from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a <> '@@@' and f51.amt > 0 and f51.a_n like '2002%' order by f1.a_n + f1.s_a ");

            ConnectionWithAccess.query = strQuery.ToString();
            DataTable dtDebitorsOutstanding = ConnectionCommand.fReturnDataTable();
            strQuery.Clear();

            //creditors_outstanding
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc],f1.[CITY] as [City], (f51.AMT *-1) as [amt_debit], '' as [Desc1],  (amt-amt) as [credit_extra], (amt-amt) as [amt_credit]  from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a <> '@@@' and f51.amt < 0 and f51.a_n = '4002'  ");

            ConnectionWithAccess.query = strQuery.ToString();
            DataTable dtCreditorsOutstanding = ConnectionCommand.fReturnDataTable();
            strQuery.Clear();

            //debitors_advances
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc],f1.[CITY] as [City], (f51.AMT * -1) as [amt_debit], '' as [Desc1],  (amt-amt) as [credit_extra], (amt-amt) as [amt_credit]  from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a <> '@@@' and f51.amt < 0 and f51.a_n = '2002' ");

            ConnectionWithAccess.query = strQuery.ToString();
            DataTable dtDebitorsAdvances = ConnectionCommand.fReturnDataTable();
            strQuery.Clear();

            //creditors_deposits
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [Desc],f1.[CITY] as [City], f51.AMT as [amt_debit], '' as [Desc1],  (amt-amt) as [credit_extra] , (amt-amt) as [amt_credit]  from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a <> '@@@' and f51.amt > 0 and f51.a_n = '4002' ");

            ConnectionWithAccess.query = strQuery.ToString();
            DataTable dtCreditorsDeposits = ConnectionCommand.fReturnDataTable();
            strQuery.Clear();

            DataTable dtAll = new DataTable();
            dtAll.Merge(dtTrading);
            dtAll.Merge(dtProfitLoss);
            dtAll.Merge(dtCapital);
            dtAll.Merge(dtBalanceSheet);
            dtAll.Merge(dtDebitorsOutstanding);
            dtAll.Merge(dtCreditorsOutstanding);
            dtAll.Merge(dtDebitorsAdvances);
            dtAll.Merge(dtCreditorsDeposits);

            BalShDGV.AutoGenerateColumns = true;
            BalShDGV.DataSource = null;
            BalShDGV.DataSource = dtAll;

            //ConnectionCommand.accountHelp_datatable_Seperate(BalShDGV, "Balance Sheet");

        }

        private void trading_report_generate_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data");
            objPleaseWait.Show();
            Application.DoEvents();
            BalShDGV.Visible = true;
            //BalShDGV.Rows.Clear();
            BalShDGV.DataSource = null;
            if (cbBalShAc.Text == "Trial Balance Report")
            {
                add_contains_of_trial_balance_in_gridview();
                excel_filename = "Trial Balance_" + cbBalShPer.Text;
                generate_trial_balance();
            }
            else if (cbBalShAc.Text == "Trading Account")
            {
                add_contains_of_trading_account_in_gridview();
                //add_difference_record_in_trading_pl_balance_sheet();
                //get_two_totals(BalShDGV, 5, 8);
                //ConnectionCommand.hide_columns_of_datagridview(BalShDGV, "0,1");
                excel_filename = "Trading Account_" + cbBalShPer.Text;
                generate_trading_account();
            }
            else if (cbBalShAc.Text == "Profit and Loss Account")
            {
                add_contains_of_profit_and_loss_in_gridview();
                //add_difference_record_in_trading_pl_balance_sheet();
                //get_two_totals(BalShDGV, 5, 8);
                //ConnectionCommand.hide_columns_of_datagridview(BalShDGV, "0,1");
                excel_filename = "Profit and Loss Account_" + cbBalShPer.Text;
                generate_profit_and_loss_account();
            }
            else if (cbBalShAc.Text == "Capital Account")
            {
                add_contains_of_capital_account_in_gridview(cbBalShPer.Text);
                //add_difference_record_in_trading_pl_balance_sheet();
                //get_two_totals(BalShDGV, 5, 8);
                //ConnectionCommand.hide_columns_of_datagridview(BalShDGV, "0,1,2");
                excel_filename = "Capital Account_" + cbBalShPer.Text;
                generate_capital_account();
            }
            else if (cbBalShAc.Text == "Balance Sheet")
            {
                add_contains_of_balance_sheet_in_gridview(cbBalShPer.Text);
                //ConnectionCommand.hide_columns_of_datagridview(BalShDGV, "0,1,2");
                //this.BalShDGV.RowTemplate.DefaultCellStyle.Font = new System.Drawing.Font("cour", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
                excel_filename = "Balance Sheet_" + cbBalShPer.Text;
                generate_balance_sheet_account();
            }
            else if (cbBalShAc.Text == "Tr_Pl_Ca_Blst")
            {
                if (ckbx_all_periods.Checked)
                {
                    generate_all_period_tr_pl_ca_blst();
                }
                else
                {
                    generate_full_balance_sheet_report(cbBalShPer.Text);
                    atbpreview_Click(sender, e);
                }
                ////fTradingAllReports(cbBalShPer.Text);
                //add_contains_of_trading_account_in_gridviewold();
                //add_contains_of_profit_and_loss_in_gridviewold(true);
                //add_contains_of_capital_account_in_gridviewold(cbBalShPer.Text, true);
                //add_contains_of_balance_sheet_in_gridviewold(ConnectionWithAccess.mprd, true);
                ////add_contains_of_debitors_outstanding_in_gridview(true);
                ////add_contains_of_creditors_outstanding_in_gridview(true);
                ////add_contains_of_debitors_advances_in_gridview(true);
                ////add_contains_of_creditors_deposits_in_gridview(true);
                //excel_filename = "All Reports_" + cbBalShPer.Text;
                //generate_tr_pl_capital_balance_sheet_together();
            }
            else if (cbBalShAc.Text == "Debitors Outstanding")
            {
                add_contains_of_debitors_outstanding_in_gridview();
                excel_filename = "Debitors Outstanding List_" + cbBalShPer.Text;
            }
            else if (cbBalShAc.Text == "Creditors Balance")
            {
                add_contains_of_creditors_outstanding_in_gridview();
                excel_filename = "Creditors Outstanding List_" + cbBalShPer.Text;
            }
            else if (cbBalShAc.Text == "Debitors Advances")
            {
                add_contains_of_debitors_advances_in_gridview();
                excel_filename = "Debitors Advances List_" + cbBalShPer.Text;
            }
            else if (cbBalShAc.Text == "Creditors Deposits")
            {
                add_contains_of_creditors_deposits_in_gridview();
                excel_filename = "Creditors Deposits List_" + cbBalShPer.Text;
            }
            else if (cbBalShAc.Text == "Balance sheet Summary")
            {
                generate_balance_sheet_summary();
            }
            ConnectionCommand.delete_empty_gridview_rows(BalShDGV);
            ConnectionCommand.invisible_empty_gridview_column(BalShDGV);
            if (BalShDGV.Rows.Count > 3)
                BalShDGV.FirstDisplayedScrollingRowIndex = BalShDGV.Rows.Count - 2;
            ConnectionWithAccess.export(BalShDGV, excel_filename);
            objPleaseWait.Close();
        }

        private void generate_all_period_tr_pl_ca_blst()
        {
            list_of_period_array.Clear();
            ConnectionWithAccess.query = "select prd from " + ConnectionWithAccess.tablename[50] + " order by prd";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                int mcolumncount = dtData1.Columns.Count;
                for (int iRowCount = 1; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    list_of_period_array.Add(dtData1.Rows[iRowCount][0].ToString());
                }
            }
            if (list_of_period_array.Count > 1)
            {
                temp_int = 1;
                for (int array_count = 0; array_count < list_of_period_array.Count(); array_count++)
                {
                    if (list_of_period_array[array_count] == ConnectionWithAccess.mprd)
                    {
                        temp_int = array_count;
                        array_count = list_of_period_array.Count();
                    }
                }
                for (int array_count = temp_int; array_count < list_of_period_array.Count(); array_count++)
                {
                    cbBalShPer.Text = list_of_period_array[array_count];
                    generate_full_balance_sheet_report(list_of_period_array[array_count]);
                }
            }

        }

        private void save_gridview_lines(DataGridView mDataGridView, int column_number, int column_number2)
        {
            for (row_pointer = 0; row_pointer < mDataGridView.Rows.Count; row_pointer++)
            {
                if (mDataGridView.Rows[row_pointer].Cells[column_number].Value == null || mDataGridView.Rows[row_pointer].Cells[column_number].Value.ToString() == " ")
                {
                    for (int i = 0; i < mDataGridView.Rows.Count; i++)
                    {
                        if (mDataGridView.Rows[i].Cells[column_number].Value != null && mDataGridView.Rows[i].Cells[column_number].Value.ToString() != "")
                        {
                            temp_word = mDataGridView.Rows[i].Cells[column_number].Value.ToString();
                            temp_double = Convert.ToDouble(mDataGridView.Rows[i].Cells[column_number2].Value.ToString());
                            mDataGridView.Rows[i].Cells[column_number].Value = null;
                            mDataGridView.Rows[i].Cells[column_number2].Value = null;
                            mDataGridView.Rows[row_pointer].Cells[column_number].Value = temp_word;
                            mDataGridView.Rows[row_pointer].Cells[column_number2].Value = Convert.ToString(temp_double);
                            i = mDataGridView.Rows.Count;
                        }
                    }
                }
            }
            mDataGridView.Refresh();
        }

        #region add_contains_in_gridview
        private void add_contains_of_trial_balance_in_gridview()
        {
            StringBuilder strQuery = new StringBuilder();

            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], f51.AMT as [amt_debit], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n = '2001' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], f51.AMT as [amt_debit], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '6000%' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], f51.AMT as [amt_debit], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '61%' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], f51.AMT as [amt_debit], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '65%' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], f51.AMT as [amt_debit], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '70%' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], 0 as [amt_debit], (f51.amt * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '70%' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], 0 as [amt_debit], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '6000%' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], 0 as [amt_debit], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '65%' UNION ALL ");


            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], f51.AMT as [amt_debit], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '75%' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], 0 as [amt_debit], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '75%' UNION ALL ");


            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], f51.AMT as [amt_debit], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a <> '@@@' and f51.a_n like '3001%' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], 0 as [amt_debit], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.a_n = '3000' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], 0 as [amt_debit], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.a_n like '3001%' UNION ALL ");


            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], f51.AMT as [amt_debit], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.a_n like '1%' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], f51.AMT as [amt_debit], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a <> '@@@' and f51.a_n LIKE '35%' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], f51.AMT as [amt_debit], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '2%' and f51.a_n <> '2001' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], (f51.AMT * -1) as [amt_debit], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '3%' and f51.a_n <> '3000' and f51.a_n <> '3001' and f51.a_n <> '3500' and f51.a_n <> '3501' and f51.a_n <> '3508' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], 0 as [amt_debit], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '2%' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], 0 as [amt_debit], f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '3%' and f51.a_n <> '3001'and f51.a_n <> '3500' and f51.a_n <> '3501' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], 0 as [amt_debit], f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '4%' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], 0 as [amt_debit], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '3%' and f51.a_n <> '3000' and f51.a_n <> '3001' and f51.a_n <> '3500' and f51.a_n <> '3501' and f51.a_n <> '3508' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], 0 as [amt_debit], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and (f51.s_a <> '@@@' and f51.s_a <> '') and f51.a_n LIKE '35%' and f51.a_n <> '3500' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], 0 as [amt_debit], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n LIKE '35%' and f51.a_n <> '3500' and f51.a_n <> '3501' UNION ALL ");
            strQuery.Append("select f1.a_n, f1.s_a, f1.[DESC], 0 as [amt_debit], (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '4%' ");

            ConnectionWithAccess.query = strQuery.ToString();

            ConnectionCommand.accountHelp_datatable_Seperate(BalShDGV, "Trading Account");

            fAdd_trial_balance_Report_Totals();

            BalShDGV.Columns[0].HeaderText = "A_n";
            BalShDGV.Columns[1].HeaderText = "S_a";
            BalShDGV.Columns[2].HeaderText = "Particular's";
            BalShDGV.Columns[3].HeaderText = "Debit";
            BalShDGV.Columns[4].HeaderText = "Credit";

            BalShDGV.Columns[3].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            BalShDGV.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
        }

        private void add_contains_of_trading_account_in_gridview(bool dont_cleargridview = false)
        {
            StringBuilder strQuery = new StringBuilder();
            ConnectionWithAccess.query = query_contains_for_trading_account_union(cbBalShPer.Text); ;// strQuery.ToString();
            ConnectionCommand.accountHelp_datatable_Seperate(BalShDGV, "Trading Account");
            fAdd_Trading_Report_Totals();

            BalShDGV.Columns[0].HeaderText = "Sort";
            BalShDGV.Columns[1].HeaderText = "A_n";
            BalShDGV.Columns[2].HeaderText = "S_a";
            BalShDGV.Columns[3].HeaderText = "Particular's";
            BalShDGV.Columns[4].HeaderText = "Debit_extra";
            BalShDGV.Columns[5].HeaderText = "Debit";
            BalShDGV.Columns[6].HeaderText = "Particular's";
            BalShDGV.Columns[7].HeaderText = "Credit_extra";
            BalShDGV.Columns[8].HeaderText = "Credit";

            BalShDGV.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            BalShDGV.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            BalShDGV.Columns[7].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            BalShDGV.Columns[8].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            //BalShDGV.Columns[4].DefaultCellStyle.Format = "N2";
            //BalShDGV.Columns[5].DefaultCellStyle.Format = "N2";
            //BalShDGV.Columns[7].DefaultCellStyle.Format = "N2";
            //BalShDGV.Columns[8].DefaultCellStyle.Format = "N2";
            BalShDGV.Columns[0].Visible = false;
            BalShDGV.Columns[1].Visible = false;
            BalShDGV.Columns[2].Visible = false;
            BalShDGV.Columns[4].Visible = false;
            BalShDGV.Columns[7].Visible = false;
        }

        private void add_contains_of_profit_and_loss_in_gridview(bool dont_cleargridview = false)
        {
            StringBuilder strQuery = new StringBuilder();
            ConnectionWithAccess.query = query_contains_for_profit_and_loss_account_union(cbBalShPer.Text); ;// strQuery.ToString();
            ConnectionCommand.accountHelp_datatable_Seperate(BalShDGV, "Profit and Loss Account");
            fAdd_ProfitLoss_Report_Totals();

            BalShDGV.Columns[0].HeaderText = "Sort";
            BalShDGV.Columns[1].HeaderText = "A_n";
            BalShDGV.Columns[2].HeaderText = "S_a";
            BalShDGV.Columns[3].HeaderText = "Particular's";
            BalShDGV.Columns[4].HeaderText = "Debit_extra";
            BalShDGV.Columns[5].HeaderText = "Debit";
            BalShDGV.Columns[6].HeaderText = "Particular's";
            BalShDGV.Columns[7].HeaderText = "Credit_extra";
            BalShDGV.Columns[8].HeaderText = "Credit";

            BalShDGV.Columns[0].Visible = false;
            BalShDGV.Columns[1].Visible = false;
            BalShDGV.Columns[2].Visible = false;
            BalShDGV.Columns[4].Visible = false;
            BalShDGV.Columns[7].Visible = false;

            BalShDGV.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            BalShDGV.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            BalShDGV.Columns[7].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            BalShDGV.Columns[8].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;

        }

        private void add_contains_of_capital_account_in_gridview(string emerg_prd, bool dont_cleargridview = false)
        {
            StringBuilder strQuery = new StringBuilder();
            ConnectionWithAccess.query = query_contains_for_capital_account_union(emerg_prd); ;// strQuery.ToString();
            ConnectionCommand.accountHelp_datatable_Seperate(BalShDGV, "Capital Account");
            fAdd_CapitalAccount_Report_Totals();  // dont remove this its compulsory (sanjay)
        }

        private void add_contains_of_capital_account_in_gridviewold(string emerg_prd, bool dont_cleargridview = false)
        {
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '', '', '',f1.[DESC] , '', f51.AMT * -1 from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + emerg_prd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.a_n = '3000'";
            if (dont_cleargridview)
                ConnectionCommand.multiplerows(BalShDGV, "Capital Account");
            else
            {
                ConnectionCommand.accountHelp(BalShDGV, "Capital Account");
                BalShDGV.Columns[0].HeaderText = "Sort";
                BalShDGV.Columns[1].HeaderText = "A_n";
                BalShDGV.Columns[2].HeaderText = "S_a";
                BalShDGV.Columns[3].HeaderText = "Particular's";
                BalShDGV.Columns[4].HeaderText = "Debit_extra";
                BalShDGV.Columns[5].HeaderText = "Debit";
                BalShDGV.Columns[6].HeaderText = "Particular's";
                BalShDGV.Columns[7].HeaderText = "Credit_extra";
                BalShDGV.Columns[8].HeaderText = "Credit";
                BalShDGV.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                BalShDGV.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                BalShDGV.Columns[7].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                BalShDGV.Columns[8].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            }
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '', '', '',f1.[DESC] , '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + emerg_prd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.a_n = '7998'";
            ConnectionCommand.multiplerows(BalShDGV, "Capital Account");
            ConnectionWithAccess.query = "select '', f1.a_n,  f1.s_a,'Net Loss','', (f51.AMT * -1), '' , '' , '' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n = '7998'";
            ConnectionCommand.multiplerows(BalShDGV, "Profit and Loss Account");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT,'' , '' , '' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + emerg_prd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a <> '@@@' and f51.a_n like '3001%'";
            ConnectionCommand.multiplerows(BalShDGV, "Capital Account");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '', '', '',f1.[DESC] , '', (f51.AMT * -1) from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + emerg_prd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.a_n like '3001%'";
            ConnectionCommand.multiplerows(BalShDGV, "Capital Account");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT,'' , '' , '' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + emerg_prd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.a_n = '3001' and f51.s_a = '@@@'";
            ConnectionCommand.multiplerows(BalShDGV, "Capital Account");
        }

        private void add_contains_of_balance_sheet_in_gridview(string mprd, bool dont_cleargridview = false)
        {
            StringBuilder strQuery = new StringBuilder();
            ConnectionWithAccess.query = query_contains_for_balance_sheet_union(mprd); ;// strQuery.ToString();
            ConnectionCommand.accountHelp_datatable_Seperate(BalShDGV, "Balance Sheet");
            //fAdd_Balance_Report_Totals();
            add_difference_record_in_trading_pl_balance_sheet();

            BalShDGV.Columns[0].HeaderText = "Sort";
            BalShDGV.Columns[1].HeaderText = "A_n";
            BalShDGV.Columns[2].HeaderText = "S_a";
            BalShDGV.Columns[3].HeaderText = "Particular's";
            BalShDGV.Columns[4].HeaderText = "Debit_extra";
            BalShDGV.Columns[5].HeaderText = "Debit";
            BalShDGV.Columns[6].HeaderText = "Particular's";
            BalShDGV.Columns[7].HeaderText = "Credit_extra";
            BalShDGV.Columns[8].HeaderText = "Credit";
            BalShDGV.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            BalShDGV.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            BalShDGV.Columns[7].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            BalShDGV.Columns[8].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            temp_double = 0;
            temp_word = null;
        }

        private void add_contains_of_balance_sheet_in_gridviewold(string mprd, bool dont_cleargridview = false)
        {
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '','' , '' , f1.[DESC], f51.AMT, '' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + "  f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.a_n like '1%' union  select '', f1.a_n, f1.s_a, '','' , '' , f1.[DESC], f25.JAMT, ''  from " + ConnectionWithAccess.tablename[25] + " f25 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f1.A_n = f25.NA_n where f25.prd = '" + mprd + "' and f25.a_n = '75Dep' and f25.s_a = 'DEP'";
            if (dont_cleargridview)
                ConnectionCommand.multiplerows(BalShDGV, "Balance Sheet");
            else
            {
                BalShDGV.Rows.Clear();
                ConnectionCommand.accountHelp(BalShDGV, "Balance Sheet");
                BalShDGV.Columns[0].HeaderText = "Sort";
                BalShDGV.Columns[1].HeaderText = "A_n";
                BalShDGV.Columns[2].HeaderText = "S_a";
                BalShDGV.Columns[3].HeaderText = "Particular's";
                BalShDGV.Columns[4].HeaderText = "Debit_extra";
                BalShDGV.Columns[5].HeaderText = "Debit";
                BalShDGV.Columns[6].HeaderText = "Particular's";
                BalShDGV.Columns[7].HeaderText = "Credit_extra";
                BalShDGV.Columns[8].HeaderText = "Credit";
                BalShDGV.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                BalShDGV.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                BalShDGV.Columns[7].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                BalShDGV.Columns[8].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            }
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '','' , '' , f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '2%' and f51.a_n <> '2001'";
            ConnectionCommand.multiplerows(BalShDGV, "Balance Sheet");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '','' , '' , f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '3%' and f51.a_n <> '3001'and f51.a_n <> '3500' and f51.a_n <> '3501'";
            ConnectionCommand.multiplerows(BalShDGV, "Balance Sheet");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '','' , ''  , f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a <> '@@@' and f51.a_n LIKE '35%'";
            ConnectionCommand.multiplerows(BalShDGV, "Balance Sheet");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '','' , ''  , f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '4%'";
            ConnectionCommand.multiplerows(BalShDGV, "Balance Sheet");
            // added new 
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '','' , ''  , f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '65%'";
            ConnectionCommand.multiplerows(BalShDGV, "Balance Sheet");
            // added new 
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC] , '', f51.AMT, '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n = '3001'";
            ConnectionCommand.multiplerows(BalShDGV, "Balance Sheet");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '','' , ''  , f1.[DESC], '', (f51.AMT * -1) from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '5%'";
            ConnectionCommand.multiplerows(BalShDGV, "Balance Sheet");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '2%'";
            ConnectionCommand.multiplerows(BalShDGV, "Balance Sheet");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '3%' and f51.a_n <> '3000' and f51.a_n <> '3500' and f51.a_n <> '3501'";
            ConnectionCommand.multiplerows(BalShDGV, "Balance Sheet");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and (f51.s_a <> '@@@' and f51.s_a <> '') and f51.a_n LIKE '35%' and f51.a_n <> '3500'";
            ConnectionCommand.multiplerows(BalShDGV, "Balance Sheet");
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '4%'";
            ConnectionCommand.multiplerows(BalShDGV, "Balance Sheet");
            //BalShDGV.Sort(BalShDGV.Columns[1], ListSortDirection.Ascending);
            temp_double = 0;
            temp_word = null;
            add_difference_record_in_trading_pl_balance_sheet();
        }

        bool balance_sheet_tally = true;
        private void add_difference_record_in_trading_pl_balance_sheet()
        {
            temp_double = 0;
            balance_sheet_tally = true;
            try
            {
                if (BalShDGV.Rows.Count > 0)
                {
                    for (int i = 0; i < BalShDGV.Rows.Count; i++)
                    {
                        if (BalShDGV.Rows[i].Cells[1].Value != null)
                        {
                            if (BalShDGV.Rows[i].Cells[1].Value.ToString().Trim() != "")
                            {
                                if (BalShDGV.Rows[i].Cells[1].Value.ToString().Substring(0, 1) == "1")
                                {
                                    if (temp_word == null && temp_word != "")
                                        temp_word = BalShDGV.Rows[i].Cells[1].Value.ToString();
                                    if (BalShDGV.Rows[i].Cells[1].Value.ToString().Trim() != temp_word)
                                    {
                                        if (i > 0)
                                        {
                                            BalShDGV.Rows[i - 1].Cells[8].Value = Math.Round(temp_double, 2);
                                            temp_word = BalShDGV.Rows[i].Cells[1].Value.ToString();
                                            temp_double = Convert.ToDouble(BalShDGV.Rows[i].Cells[7].Value.ToString());
                                            //BalShDGV.Rows[i - 1].Cells[8].Value = (Convert.ToDouble(BalShDGV.Rows[i + 1].Cells[7].Value.ToString())) + temp_double;
                                        }
                                        else
                                        {
                                            BalShDGV.Rows[0].Cells[8].Value = Math.Round(temp_double, 2);
                                            temp_word = BalShDGV.Rows[0].Cells[1].Value.ToString();
                                            temp_double = Convert.ToDouble(BalShDGV.Rows[i].Cells[7].Value.ToString());
                                        }
                                    }
                                    else
                                    {
                                        temp_double = temp_double + Convert.ToDouble(BalShDGV.Rows[i].Cells[7].Value.ToString());
                                    }
                                }
                                else if (temp_double != 0)
                                {
                                    if (i > 0)
                                        BalShDGV.Rows[i - 1].Cells[8].Value = Math.Round(temp_double, 2);
                                    temp_double = 0;
                                }
                            }
                        }
                    }
                    debitamount = 0;
                    creditamount = 0;
                    for (int i = 0; i < BalShDGV.Rows.Count; i++)
                    {
                        if (BalShDGV.Rows[i].Cells[5].Value != null)
                        {
                            if (BalShDGV.Rows[i].Cells[5].Value.ToString().Trim() != "0")
                            {
                                debitamount = debitamount + (Convert.ToDouble(BalShDGV.Rows[i].Cells[5].Value.ToString()));
                            }
                        }
                        if (BalShDGV.Rows[i].Cells[8].Value != null)
                        {
                            if (BalShDGV.Rows[i].Cells[8].Value.ToString().Trim() != "0")
                            {
                                creditamount = creditamount + (Convert.ToDouble(BalShDGV.Rows[i].Cells[8].Value.ToString()));
                            }
                        }
                    }

                    DataTable dtReport = (DataTable)BalShDGV.DataSource;
                    if (Math.Round(creditamount, 2) < Math.Round(debitamount, 2))
                    {
                        DataRow drTotalRow = dtReport.NewRow();

                        drTotalRow[6] = "Difference";
                        drTotalRow[8] = Math.Round((debitamount - creditamount), 2);
                        dtReport.Rows.Add(drTotalRow);
                        creditamount = debitamount;
                        balance_sheet_tally = false;
                    }
                    else if (Math.Round(creditamount, 2) > Math.Round(debitamount, 2))
                    {
                        DataRow drTotalRow = dtReport.NewRow();

                        drTotalRow[2] = "Difference";
                        drTotalRow[5] = Math.Round(creditamount - debitamount, 2);
                        drTotalRow[8] = "0";
                        dtReport.Rows.Add(drTotalRow);
                        debitamount = creditamount;
                        balance_sheet_tally = false;
                    }
                    DataRow drTotalRow1 = dtReport.NewRow();

                    drTotalRow1[3] = "Total";
                    drTotalRow1[5] = Math.Round(debitamount, 2);
                    drTotalRow1[6] = "Total";
                    drTotalRow1[8] = Math.Round(creditamount, 2);
                    dtReport.Rows.Add(drTotalRow1);

                    BalShDGV.DataSource = null;
                    BalShDGV.DataSource = dtReport;
                }
            }
            catch (Exception ex)
            {
            }
        }

        private void add_difference_record_in_trading_pl_balance_sheetold()
        {
            balance_sheet_tally = true;
            try
            {
                if (BalShDGV.Rows.Count > 0)
                {
                    for (int i = 0; i < BalShDGV.Rows.Count; i++)
                    {
                        if (BalShDGV.Rows[i].Cells[1].Value != null)
                        {
                            if (BalShDGV.Rows[i].Cells[1].Value.ToString().Trim() != "")
                            {
                                if (BalShDGV.Rows[i].Cells[1].Value.ToString().Substring(0, 1) == "1")
                                {
                                    if (temp_word == null)
                                        temp_word = BalShDGV.Rows[i].Cells[1].Value.ToString();
                                    if (BalShDGV.Rows[i].Cells[1].Value.ToString().Trim() != temp_word)
                                    {
                                        BalShDGV.Rows[i - 1].Cells[8].Value = Math.Round(temp_double, 2);
                                        temp_word = BalShDGV.Rows[i].Cells[1].Value.ToString();
                                        temp_double = Convert.ToDouble(BalShDGV.Rows[i].Cells[7].Value.ToString());
                                        //BalShDGV.Rows[i - 1].Cells[8].Value = (Convert.ToDouble(BalShDGV.Rows[i + 1].Cells[7].Value.ToString())) + temp_double;
                                    }
                                    else
                                    {
                                        temp_double = temp_double + Convert.ToDouble(BalShDGV.Rows[i].Cells[7].Value.ToString());
                                    }
                                }
                                else if (temp_double != 0)
                                {
                                    if (i > 0)
                                        BalShDGV.Rows[i - 1].Cells[8].Value = Math.Round(temp_double, 2);
                                    temp_double = 0;
                                }
                            }
                        }
                    }
                    debitamount = 0;
                    creditamount = 0;
                    for (int i = 0; i < BalShDGV.Rows.Count; i++)
                    {
                        if (BalShDGV.Rows[i].Cells[5].Value != null)
                        {
                            if (BalShDGV.Rows[i].Cells[5].Value.ToString().Trim() != "")
                            {
                                debitamount = debitamount + (Convert.ToDouble(BalShDGV.Rows[i].Cells[5].Value.ToString()));
                            }
                        }
                        if (BalShDGV.Rows[i].Cells[8].Value != null)
                        {
                            if (BalShDGV.Rows[i].Cells[8].Value.ToString().Trim() != "")
                            {
                                creditamount = creditamount + (Convert.ToDouble(BalShDGV.Rows[i].Cells[8].Value.ToString()));
                            }
                        }
                    }
                    if (Math.Round(creditamount, 2) < Math.Round(debitamount, 2))
                    {
                        BalShDGV.Rows.Add();
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[0].Value = "";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[1].Value = "";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[2].Value = "";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[3].Value = "";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[4].Value = "";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[5].Value = "0";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[6].Value = "Difference";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[7].Value = "";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[8].Value = Math.Round((debitamount - creditamount), 2);
                        creditamount = debitamount;
                        balance_sheet_tally = false;
                    }
                    else if (Math.Round(creditamount, 2) > Math.Round(debitamount, 2))
                    {
                        BalShDGV.Rows.Add();
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[0].Value = "";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[1].Value = "";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[2].Value = "Difference";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[3].Value = "";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[4].Value = "";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[5].Value = Math.Round(creditamount - debitamount, 2);
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[6].Value = "";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[7].Value = "";
                        BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[8].Value = "0.00";
                        debitamount = creditamount;
                        balance_sheet_tally = false;
                    }
                    BalShDGV.Rows.Add();
                    BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[0].Value = "";
                    BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[1].Value = "";
                    BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[2].Value = "";
                    BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[3].Value = "Total";
                    BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[4].Value = "";
                    BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[5].Value = Math.Round(debitamount, 2);
                    BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[6].Value = "Total";
                    BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[7].Value = "";
                    BalShDGV.Rows[BalShDGV.Rows.Count - 1].Cells[8].Value = Math.Round(creditamount, 2);
                }
            }
            catch (Exception ex)
            {
            }
        }

        private void add_contains_of_debitors_outstanding_in_gridview(bool dont_cleargridview = false)
        {
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC],f1.[CITY], f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a <> '@@@' and f51.amt > 0 and f51.a_n like '2002%' order by f1.a_n + f1.s_a ";
            if (dont_cleargridview)
                ConnectionCommand.multiplerows(BalShDGV, "Debitors Outstanding");
            else
            {
                ConnectionCommand.accountHelp(BalShDGV, "Debitors Outstanding");
                //getTotal(BalShDGV, 5);
                BalShDGV.Columns[0].HeaderText = "Sort";
                BalShDGV.Columns[1].HeaderText = "A_n";
                BalShDGV.Columns[2].HeaderText = "S_a";
                BalShDGV.Columns[3].HeaderText = "Name";
                BalShDGV.Columns[4].HeaderText = "City";
                BalShDGV.Columns[5].HeaderText = "Amount";
                BalShDGV.Columns[0].Visible = false;
                BalShDGV.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            }
        }

        private void add_contains_of_creditors_outstanding_in_gridview(bool dont_cleargridview = false)
        {
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC],f1.[CITY], (f51.AMT *-1) from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a <> '@@@' and f51.amt < 0 and f51.a_n = '4002'";
            if (dont_cleargridview)
                ConnectionCommand.multiplerows(BalShDGV, "Creditors Balance");
            else
            {
                ConnectionCommand.accountHelp(BalShDGV, "Creditors Balance");
                //getTotal(BalShDGV, 5);
                BalShDGV.Columns[0].HeaderText = "Sort";
                BalShDGV.Columns[1].HeaderText = "A_n";
                BalShDGV.Columns[2].HeaderText = "S_a";
                BalShDGV.Columns[3].HeaderText = "Name";
                BalShDGV.Columns[4].HeaderText = "City";
                BalShDGV.Columns[5].HeaderText = "Amount";
                BalShDGV.Columns[0].Visible = false;
                BalShDGV.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            }
        }

        private void add_contains_of_debitors_advances_in_gridview(bool dont_cleargridview = false)
        {
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC],f1.[CITY], (f51.AMT * -1) from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a <> '@@@' and f51.amt < 0 and f51.a_n = '2002'";
            if (dont_cleargridview)
                ConnectionCommand.multiplerows(BalShDGV, "Debitors Outstanding");
            else
            {
                ConnectionCommand.accountHelp(BalShDGV, "Debitors Outstanding");
                //getTotal(BalShDGV, 5);
                BalShDGV.Columns[0].HeaderText = "Sort";
                BalShDGV.Columns[1].HeaderText = "A_n";
                BalShDGV.Columns[2].HeaderText = "S_a";
                BalShDGV.Columns[3].HeaderText = "Name";
                BalShDGV.Columns[4].HeaderText = "City";
                BalShDGV.Columns[5].HeaderText = "Amount";
                BalShDGV.Columns[0].Visible = false;
                BalShDGV.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            }
        }

        private void add_contains_of_creditors_deposits_in_gridview(bool dont_cleargridview = false)
        {
            ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC],f1.[CITY], f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.s_a <> '@@@' and f51.amt > 0 and f51.a_n = '4002'";
            if (dont_cleargridview)
                ConnectionCommand.multiplerows(BalShDGV, "Creditors Balance");
            else
            {
                ConnectionCommand.accountHelp(BalShDGV, "Creditors Balance");
                //getTotal(BalShDGV, 5);
                BalShDGV.Columns[0].HeaderText = "Sort";
                BalShDGV.Columns[1].HeaderText = "A_n";
                BalShDGV.Columns[2].HeaderText = "S_a";
                BalShDGV.Columns[3].HeaderText = "Name";
                BalShDGV.Columns[4].HeaderText = "City";
                BalShDGV.Columns[5].HeaderText = "Amount";
                BalShDGV.Columns[0].Visible = false;
                BalShDGV.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            }
        }

        private string query_contains_for_trading_account_union(string mprd)
        {
            StringBuilder strQuery = new StringBuilder();
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT as [amt_debit] , '' , '' as [desc], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n = '2001' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT as [amt_debit] , '' , '' as [desc], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '6000%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT as [amt_debit] , '' , '' as [desc], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '61%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT as [amt_debit] , '' , '' as [desc], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '65%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT as [amt_debit] , '' , '' as [desc], 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '70%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '', '', 0 as [amt_debit], f1.[DESC], '', (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '5000%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '', '', 0 as [amt_debit], f1.[DESC], '', (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '6000%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '', '', 0 as [amt_debit], f1.[DESC], '', (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '65%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '', '', 0 as [amt_debit], f1.[DESC], '', (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '70%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '', '', 0 as [amt_debit], 'Gross Loss', '', (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n = '719999' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT as [amt_debit] , '' , '', 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n = '719999' ");
            ConnectionWithAccess.query = strQuery.ToString();
            return strQuery.ToString();
        }

        private string query_contains_for_profit_and_loss_account_union(string mprd)
        {
            StringBuilder strQuery = new StringBuilder();
            strQuery.Append("select '', f1.a_n, f1.s_a, '', '', 0 as [amt_debit], f1.[DESC], '', f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n = '719999' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT as [amt_debit] , '' , '' , 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n like '75%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '', '', 0 as [amt_debit], f1.[DESC], '', (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n like '75%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC], '', f51.AMT as [amt_debit], '' , '' , 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt > 0 and f51.a_n = '7998' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '', '', 0 as [amt_debit], 'Net Loss' , '' , (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n = '7998' ");
            ConnectionWithAccess.query = strQuery.ToString();
            return strQuery.ToString();
        }

        private string query_contains_for_capital_account_union(string mprd)
        {
            StringBuilder strQuery = new StringBuilder();
            strQuery.Append("select '', f1.a_n, f1.s_a, '', '', 0 as [amt_debit],f1.[DESC] as [desc1] , '', (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.a_n = '3000' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [desc1], '', 0 as [amt_debit], f1.[DESC] as [desc], '', f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.a_n = '7998' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, 'Net Loss' as [desc1], '', (f51.AMT * -1) as [amt_debit], '' as [desc] , '' , 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.s_a = '@@@' and f51.amt < 0 and f51.a_n = '7998' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [desc1], '', f51.AMT as [amt_debit],'' as [desc] , '' , 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a <> '@@@' and f51.a_n like '3001%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '' as [desc1], '', 0 as [amt_debit], f1.[DESC] as [desc] , '', (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.a_n like '3001%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] as [desc1], '', f51.AMT as [amt_debit],''  as [desc], '' , 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and  f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.a_n = '3001' and f51.s_a = '@@@' ");
            ConnectionWithAccess.query = strQuery.ToString();
            return strQuery.ToString();
        }

        private string query_contains_for_balance_sheet_union(string mprd)
        {
            StringBuilder strQuery = new StringBuilder();
            strQuery.Append("select '', f1.a_n, f1.s_a, '','' , 0 as [amt_debit] , f1.[DESC], f51.AMT, 0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + "  f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.a_n like '1%' union  select '', f1.a_n, f1.s_a, '','' , '' , f1.[DESC], f25.JAMT, ''  from " + ConnectionWithAccess.tablename[25] + " f25 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f1.A_n = f25.NA_n where f25.prd = '" + mprd + "' and f25.a_n = '75Dep' and f25.s_a = 'DEP' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '','' , 0 as [amt_debit] , f1.[DESC], 0, f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '2%' and f51.a_n <> '2001' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '','' , 0 as [amt_debit] , f1.[DESC], 0, f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '3%' and f51.a_n <> '3001'and f51.a_n <> '3500' and f51.a_n <> '3501' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '','' , 0 as [amt_debit]  , f1.[DESC], 0, f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a <> '@@@' and f51.a_n = '3500' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '','' , 0 as [amt_debit]  , f1.[DESC], 0, f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '4%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '','' , 0 as [amt_debit] , f1.[DESC], 0, (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n = '3001' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '','' , 0 as [amt_debit] , f1.[DESC], 0, (f51.AMT * -1) as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '5%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '','' , 0 as [amt_debit] , f1.[DESC], 0, f51.AMT as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '65%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1) as [amt_debit], '', 0,0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '2%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1) as [amt_debit], '', 0,0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '3%' and f51.a_n <> '3000' and f51.a_n <> '3001' and f51.a_n <> '3500' and f51.a_n <> '3501' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * 1)  as [amt_debit], '', 0,0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n = '3001' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1) as [amt_debit], '', 0,0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and (f51.s_a <> '@@@' and f51.s_a <> '') and f51.a_n LIKE '35%' and f51.a_n <> '3500' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1) as [amt_debit], '', 0,0 as [amt_credit] from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + mprd + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '4%' ");
            ConnectionWithAccess.query = strQuery.ToString();
            return strQuery.ToString();
        }

        private string query_contains_for_ledger_account_union(string ma_n, string ms_a, string end_date)
        {
            StringBuilder strQuery = new StringBuilder();
            if (ms_a != "@@@")
            {
                //(string book, string mprd, int md_c, string ma_n, string ms_a, string md_n)
                strQuery.Append("select distinct '' as [DATE_SORT],f51.a_n as [ACC_NAME], f51.s_a as [SUB_ACC_NAME], f51.d_d as [DATE], 'Open' as [DOCUMENTS], 'O' as [ACC_TYPE], f51.amt as [DEBIT], 0 as [CREDIT], f51.amt as [BALANCE], 0 as [d_c], '' as [prd],'' as [a_n], '' as [s_a] from " + ConnectionWithAccess.tablename[51] + " f51 where f51.prd = '@' and f51.a_n = '" + ma_n + "' and f51.s_a = '" + ms_a + "' and d_d = #01-01-1901# UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f21.a_n as [ACC_NAME], f21.s_a as [SUB_ACC_NAME], f21.d_d as [DATE] ,f21.d_n as [DOCUMENTS],'Sale' as [ACC_TYPE], f21.gamt as [DEBIT],0 as [CREDIT],0 as [BALANCE], f21.d_c as [d_c], f21.prd as [mprd], f21.a_n as [a_n], f21.s_a as [s_a] from " + ConnectionWithAccess.tablename[21] + " f21 where f21.a_n = '" + ma_n + "' and f21.s_a = '" + ms_a + "' and f21.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f22.a_n as [ACC_NAME], f22.s_a as [SUB_ACC_NAME], f22.d_d as [DATE], f22.d_n as [DOCUMENTS],'Purc' as [ACC_TYPE], 0 as [DEBIT], f22.gamt as [CREDIT] ,0 as [BALANCE], f22.d_c as [d_c], f22.prd as [mprd], f22.a_n as [a_n], f22.s_a as [s_a] from " + ConnectionWithAccess.tablename[22] + " f22 where f22.a_n = '" + ma_n + "' and f22.s_a = '" + ms_a + "' and f22.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f23.a_n as [ACC_NAME], f23.s_a as [SUB_ACC_NAME], f23.d_d as [DATE], f23.d_n as [DOCUMENTS],'Bank' as [ACC_TYPE], 0 as [DEBIT], f23.bamt as [CREDIT],0 as [BALANCE], f23.d_c as [d_c], f23.prd as [mprd], f23.a_n as [a_n], f23.s_a as [s_a] from " + ConnectionWithAccess.tablename[23] + " f23 where f23.a_n = '" + ma_n + "' and f23.s_a = '" + ms_a + "'" + " and f23.b_t = '3' and f23.bamt > 0  and f23.d_d <= @From UNION ALL ");
                //strQuery.Append("select '' as [DATE_SORT],f23.a_n as [ACC_NAME], f23.s_a as [SUB_ACC_NAME], f23.d_d as [DATE], f23.d_n as [DOCUMENTS],'Bank' as [ACC_TYPE], 0 as [DEBIT], f23.bamt as [CREDIT],0 as [BALANCE], " +
                //  "(select b.desc from " + ConnectionWithAccess.tablename[23] + " a inner join " + ConnectionWithAccess.tablename[01] + " b on b.a_n = a.a_n " +
                //  " where a.d_n = 999999 and b.s_a ='@@@' and a.d_c = f23.d_c) as [d_c] " +
                //  "from " + ConnectionWithAccess.tablename[23] + " f23 where f23.a_n = '" + ma_n + "' and f23.s_a = '" + ms_a + "'" + " and f23.b_t = '3' and f23.bamt > 0  and f23.d_d <= #" + end_date + "# UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f23.a_n as [ACC_NAME], f23.s_a as [SUB_ACC_NAME], f23.d_d as [DATE], f23.d_n as [DOCUMENTS],'Bank' as [ACC_TYPE], (f23.bamt * -1) as [DEBIT], 0 as [CREDIT],0 as [BALANCE], f23.d_c as [d_c], f23.prd as [mprd], f23.a_n as [a_n], f23.s_a as [s_a] from " + ConnectionWithAccess.tablename[23] + " f23 where f23.a_n = '" + ma_n + "' and f23.s_a = '" + ms_a + "'" + " and f23.b_t = '3' and f23.bamt < 0  and f23.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f24.a_n as [ACC_NAME], f24.s_a as [SUB_ACC_NAME], f24.d_d as [DATE], f24.d_n as [DOCUMENTS],'Cash' as [ACC_TYPE], 0 as [DEBIT], f24.Camt as [CREDIT],0 as [BALANCE], f24.d_c as [d_c], f24.prd as [mprd], f24.a_n as [a_n], f24.s_a as [s_a] from " + ConnectionWithAccess.tablename[24] + " f24 where f24.a_n = '" + ma_n + "' and f24.s_a = '" + ms_a + "' and f24.camt > 0  and f24.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f24.a_n as [ACC_NAME], f24.s_a as [SUB_ACC_NAME], f24.d_d as [DATE], f24.d_n as [DOCUMENTS],'Cash' as [ACC_TYPE], (f24.Camt * -1) as [DEBIT],0 as [CREDIT], 0 as [BALANCE] , f24.d_c as [d_c], f24.prd as [mprd], f24.a_n as [a_n], f24.s_a as [s_a]  from " + ConnectionWithAccess.tablename[24] + " f24 where f24.a_n = '" + ma_n + "' and f24.s_a = '" + ms_a + "' and f24.camt < 0  and f24.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f25.a_n as [ACC_NAME], f25.s_a as [SUB_ACC_NAME], f25.d_d as [DATE], f25.d_n as [DOCUMENTS],'Jour' as [ACC_TYPE], f25.jamt as [DEBIT], 0 as [CREDIT], 0 as [BALANCE], f25.d_c as [d_c], f25.prd as [mprd], f25.a_n as [a_n], f25.s_a as [s_a] from " + ConnectionWithAccess.tablename[25] + " f25 where f25.a_n = '" + ma_n + "' and f25.s_a = '" + ms_a + "'  and f25.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f25.a_n as [ACC_NAME], f25.s_a as [SUB_ACC_NAME], f25.d_d as [DATE], f25.d_n as [DOCUMENTS],'Jour' as [ACC_TYPE], 0 as [DEBIT], f25.jamt as [CREDIT], 0 as [BALANCE], f25.d_c as [d_c], f25.prd as [mprd], f25.a_n as [a_n], f25.s_a as [s_a] from " + ConnectionWithAccess.tablename[25] + " f25 where f25.na_n = '" + ma_n + "' and f25.ns_a = '" + ms_a + "' and f25.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f30.a_n as [ACC_NAME], f30.s_a as [SUB_ACC_NAME], f30.d_d as [DATE], f30.d_n as [DOCUMENTS],'Repl' as [ACC_TYPE], 0 as [DEBIT], f30.gamt as [CREDIT], 0 as [BALANCE], f30.d_c as [d_c], f30.prd as [mprd], f30.a_n as [a_n], f30.s_a as [s_a] from " + ConnectionWithAccess.tablename[30] + " f30 where f30.a_n = '" + ma_n + "' and f30.s_a = '" + ms_a + "' and f30.d_d <= @From ");
            }
            else
            {
                strQuery.Append("select distinct '' as [DATE_SORT],f51.a_n as [ACC_NAME], f51.s_a as [SUB_ACC_NAME], f51.d_d as [DATE], 'Open' as [DOCUMENTS], 'O' as [ACC_TYPE], f51.amt as [DEBIT], 0 as [CREDIT], f51.amt as [BALANCE], '' as [d_c], '' as [prd],'' as [a_n], '' as [s_a] from " + ConnectionWithAccess.tablename[51] + " f51 where f51.prd = '@' and f51.a_n = '" + ma_n + "' and d_d = #01-01-1901# UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f21.a_n as [ACC_NAME], f21.s_a as [SUB_ACC_NAME], f21.d_d as [DATE] ,f21.d_n as [DOCUMENTS],'Sale' as [ACC_TYPE], f21.gamt as [DEBIT],0 as [CREDIT],0 as [BALANCE],f21.d_c as [d_c], f21.prd as [mprd], f21.a_n as [a_n], f21.s_a as [s_a] from " + ConnectionWithAccess.tablename[21] + " f21 where f21.a_n = '" + ma_n + "' and f21.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f22.a_n as [ACC_NAME], f22.s_a as [SUB_ACC_NAME], f22.d_d as [DATE], f22.d_n as [DOCUMENTS],'Purc' as [ACC_TYPE], 0 as [DEBIT], f22.gamt as [CREDIT] ,0 as [BALANCE], f22.d_c as [d_c], f22.prd as [mprd], f22.a_n as [a_n], f22.s_a as [s_a]  from " + ConnectionWithAccess.tablename[22] + " f22 where f22.a_n = '" + ma_n + "' and f22.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f23.a_n as [ACC_NAME], f23.s_a as [SUB_ACC_NAME], f23.d_d as [DATE], f23.d_n as [DOCUMENTS],'Bank' as [ACC_TYPE], 0 as [DEBIT], f23.bamt as [CREDIT],0 as [BALANCE], f23.d_c as [d_c], f23.prd as [mprd], f23.a_n as [a_n], f23.s_a as [s_a]  from " + ConnectionWithAccess.tablename[23] + " f23 where f23.a_n = '" + ma_n + "'" + " and f23.b_t = '3' and f23.bamt > 0  and f23.d_d <= @From UNION ALL ");
                //strQuery.Append("select '' as [DATE_SORT],f23.a_n as [ACC_NAME], f23.s_a as [SUB_ACC_NAME], f23.d_d as [DATE], f23.d_n as [DOCUMENTS],'Bank' as [ACC_TYPE], 0 as [DEBIT], f23.bamt as [CREDIT],0 as [BALANCE], " +
                //  "(select b.desc from " + ConnectionWithAccess.tablename[23] + " a inner join " + ConnectionWithAccess.tablename[01] + " b on b.a_n = a.a_n " +
                //  " where a.d_n = 999999 and b.s_a ='@@@' and a.d_c = f23.d_c) as [d_c] " +
                //  "from " + ConnectionWithAccess.tablename[23] + " f23 where f23.a_n = '" + ma_n + "' and f23.s_a = '" + ms_a + "'" + " and f23.b_t = '3' and f23.bamt > 0  and f23.d_d <= #" + end_date + "# UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f23.a_n as [ACC_NAME], f23.s_a as [SUB_ACC_NAME], f23.d_d as [DATE], f23.d_n as [DOCUMENTS],'Bank' as [ACC_TYPE], (f23.bamt * -1) as [DEBIT], 0 as [CREDIT],0 as [BALANCE], f23.d_c as [d_c], f23.prd as [mprd], f23.a_n as [a_n], f23.s_a as [s_a] from " + ConnectionWithAccess.tablename[23] + " f23 where f23.a_n = '" + ma_n + "'" + " and f23.b_t = '3' and f23.bamt < 0  and f23.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f24.a_n as [ACC_NAME], f24.s_a as [SUB_ACC_NAME], f24.d_d as [DATE], f24.d_n as [DOCUMENTS],'Cash' as [ACC_TYPE], 0 as [DEBIT], f24.Camt as [CREDIT],0 as [BALANCE], f24.d_c as [d_c], f24.prd as [mprd], f24.a_n as [a_n], f24.s_a as [s_a] from " + ConnectionWithAccess.tablename[24] + " f24 where f24.a_n = '" + ma_n + "' and f24.camt > 0  and f24.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f24.a_n as [ACC_NAME], f24.s_a as [SUB_ACC_NAME], f24.d_d as [DATE], f24.d_n as [DOCUMENTS],'Cash' as [ACC_TYPE], (f24.Camt * -1) as [DEBIT],0 as [CREDIT], 0 as [BALANCE] , f24.d_c as [d_c], f24.prd as [mprd], f24.a_n as [a_n], f24.s_a as [s_a] from " + ConnectionWithAccess.tablename[24] + " f24 where f24.a_n = '" + ma_n + "' and f24.camt < 0  and f24.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f25.a_n as [ACC_NAME], f25.s_a as [SUB_ACC_NAME], f25.d_d as [DATE], f25.d_n as [DOCUMENTS],'Jour' as [ACC_TYPE], f25.jamt as [DEBIT], 0 as [CREDIT], 0 as [BALANCE], f25.d_c as [d_c], f25.prd as [mprd], f25.a_n as [a_n], f25.s_a as [s_a] from " + ConnectionWithAccess.tablename[25] + " f25 where f25.a_n = '" + ma_n + "'  and f25.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f25.a_n as [ACC_NAME], f25.s_a as [SUB_ACC_NAME], f25.d_d as [DATE], f25.d_n as [DOCUMENTS],'Jour' as [ACC_TYPE], 0 as [DEBIT], f25.jamt as [CREDIT], 0 as [BALANCE], f25.d_c as [d_c], f25.prd as [mprd], f25.a_n as [a_n], f25.s_a as [s_a] from " + ConnectionWithAccess.tablename[25] + " f25 where f25.na_n = '" + ma_n + "' and f25.d_d <= @From UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f30.a_n as [ACC_NAME], f30.s_a as [SUB_ACC_NAME], f30.d_d as [DATE], f30.d_n as [DOCUMENTS],'Repl' as [ACC_TYPE], 0 as [DEBIT], f30.gamt as [CREDIT], 0 as [BALANCE], f30.d_c as [d_c], f30.prd as [mprd], f30.a_n as [a_n], f30.s_a as [s_a] from " + ConnectionWithAccess.tablename[30] + " f30 where f30.a_n = '" + ma_n + "' and f30.d_d <= @From ");
            }

            List<ConnectionWithAccess.QueryParams> objParams = new List<ConnectionWithAccess.QueryParams>();
            ConnectionWithAccess.QueryParams ParamFrom = new ConnectionWithAccess.QueryParams();
            ParamFrom.paramName = "@From";
            ParamFrom.paramValue = Convert.ToDateTime(end_date);
            objParams.Add(ParamFrom);
            ConnectionWithAccess.QueryParamList = objParams;
            //add_user_date_time_function_compulsory_program();
            return strQuery.ToString();
        }

        private void contains_for_ledger_account_union(string ma_n, string ms_a, string end_date)
        {
            StringBuilder strQuery = new StringBuilder();
            ConnectionWithAccess.query = query_contains_for_ledger_account_union(ma_n, ms_a, end_date);// strQuery.ToString();
            ConnectionCommand.accountHelp_datatable_Seperate(LedDGV, "LEDGER");
        }

        private string query_contains_for_ledger_item_union(string mtype, string mitem_code, string end_date)
        {
            StringBuilder strQuery = new StringBuilder();
            if (mtype != "" && mitem_code != "")
            {
                //(string book, string mprd, int md_c, string ma_n, string ms_a, string md_n)
                strQuery.Append("select '' as [DATE_SORT],'' as [ACC_NAME], '' as [SUB_ACC_NAME],         f3.d_d as [DATE], 'Open' as [DOCUMENTS], 'O' as [ACC_TYPE], 0 as [DEBIT], 0 as [CREDIT], f5.opn_stk as [BALANCE], 0 as [d_c], '' as [prd],'' as [a_n], '' as [s_a] from " + ConnectionWithAccess.tablename[5] + " f5 where f5.type = '" + mtype + "' and f5.item_code = '" + mitem_code + "' UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f3.a_n as [ACC_NAME], f3.s_a as [SUB_ACC_NAME], f3.d_d as [DATE] ,f3.d_n as [DOCUMENTS],'Purc' as [ACC_TYPE], f3.qty as [DEBIT],0 as [CREDIT],0 as [BALANCE], f3.d_c as [d_c], f3.prd as [mprd], f3.a_n as [a_n], f3.s_a as [s_a] from " + ConnectionWithAccess.tablename[3] + " f3 where F3.A_N LIKE '4002%' AND f3.type = '" + mtype + "' and f3.item_code = '" + mitem_code + "' UNION ALL ");
                strQuery.Append("select '' as [DATE_SORT],f3.a_n as [ACC_NAME], f3.s_a as [SUB_ACC_NAME], f3.d_d as [DATE] ,f3.d_n as [DOCUMENTS],'Sale' as [ACC_TYPE], 0 as [DEBIT],F3.QTY as [CREDIT],0 as [BALANCE], f3.d_c as [d_c], f3.prd as [mprd], f3.a_n as [a_n], f3.s_a as [s_a] from " + ConnectionWithAccess.tablename[3] + " f3 where F3.A_N LIKE '2002%' AND f3.type = '" + mtype + "' and f3.item_code = '" + mitem_code + "'");
                List<ConnectionWithAccess.QueryParams> objParams = new List<ConnectionWithAccess.QueryParams>();
                ConnectionWithAccess.QueryParams ParamFrom = new ConnectionWithAccess.QueryParams();
                ParamFrom.paramName = "@From";
                ParamFrom.paramValue = Convert.ToDateTime(end_date);
                objParams.Add(ParamFrom);
                ConnectionWithAccess.QueryParamList = objParams;
                //add_user_date_time_function_compulsory_program();
            }
            return strQuery.ToString();
        }

        private void contains_for_ledger_item_union(string mtype, string mitem_code, string end_date)
        {
            StringBuilder strQuery = new StringBuilder();

            ConnectionWithAccess.query = query_contains_for_ledger_item_union(mtype, mitem_code, end_date);// strQuery.ToString();
            ConnectionCommand.accountHelp_datatable_Seperate(LedDGV, "LEDGER");
        }

        #endregion

        private void go_to_selected_period(string mprd)
        {
            ConnectionWithAccess.mprd = mprd;
            ConnectionWithAccess.query = "select [lock],[start],[end] from " + ConnectionWithAccess.tablename[50] + " where prd = '" + mprd + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    ConnectionWithAccess.prd_lock = dtData1.Rows[0][0].ToString();
                    ConnectionWithAccess.msdate = dtData1.Rows[0][1].ToString();
                    ConnectionWithAccess.medate = dtData1.Rows[0][2].ToString();
                }
            }
            if (DateTime.Today > Convert.ToDateTime(ConnectionWithAccess.msdate))
            {
                if (DateTime.Today <= Convert.ToDateTime(ConnectionWithAccess.medate))
                {
                    ConnectionWithAccess.medate = (DateTime.Today.ToShortDateString()).ToString();
                }
            }
            try
            {
                RepFrom.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date).Date;
                RepFrom.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date).Date;
                RepTo.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date).Date;
                RepTo.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date).Date;
                ConnectionWithAccess.moprd = ConnectionWithAccess.get_old_prd_name(ConnectionWithAccess.mprd);
                ConnectionWithAccess.mnew_prd = ConnectionWithAccess.get_next_prd_name(ConnectionWithAccess.mprd);
                RepFrom.Value = Convert.ToDateTime(ConnectionWithAccess.msdate);
                RepTo.Value = Convert.ToDateTime(ConnectionWithAccess.medate);
            }
            catch (Exception ex)
            { }
            dgv_period.Visible = false;
            load_all_period_values();
            ToolStripStatusPeriod.Text = ConnectionWithAccess.mprd.ToString() + "  " + ConnectionWithAccess.msdate + "  To  " + ConnectionWithAccess.medate.ToString();
            text_to_display_on_top = ConnectionWithAccess.company_details[1] + " " + version + "ver  ";
        }

        private void cbBalShAc_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (maintab.SelectedIndex == 3)
            {
                ckbx_all_periods.Visible = false;
                if (cbBalShAc.SelectedItem.Equals("GP/NP Calculation"))
                {
                    gb_tradingacc.Visible = true;
                    gb_profit_loss.Visible = true;
                    trading_report_generate.Visible = false;
                    get_gp_percent_from_file_fifty(cbBalShPer.Text);
                    blstgp_per.Text = Convert.ToString(ConnectionWithAccess.gp_percent);
                    calculate_gross_profit_using_gp_per(cbBalShPer.Text);
                }
                else if (cbBalShAc.SelectedItem.Equals("Tr_Pl_Ca_Blst"))
                    ckbx_all_periods.Visible = true;
                else
                {
                    gb_tradingacc.Visible = false;
                    gb_profit_loss.Visible = false;
                    BalShDGV.Visible = false;
                    pdf_viewer3.Visible = false;
                    cbBalShAc.Visible = true;
                    trading_report_generate.Visible = true;
                }
            }
        }

        #region generate_pdf_files
        private void generate_balance_sheet_summary()
        {
            //if (ConnectionWithAccess.period_array == null)
            //    fill_period_array();
            if (period_array == null || period_array.Count == 0)
                fill_period_array();
            temporary_list_array.Clear();
            for (int i = 0; i < period_array.Count; i++)
            {
                var cellArray = period_array[i].Split(new[] { ',' });
                emerg_prd = cellArray[0].ToString();
                temp_word = emerg_prd + " ,";
                temp_word2 = Convert.ToString(get_account_balance_from_51(emerg_prd, "2001", "@@@"));
                if (temp_word2.Contains("."))
                {
                    if (temp_word2.Substring(temp_word2.Length - 2, 1) == ".")
                        temp_word2 = temp_word2 + "0";
                }
                else
                    temp_word2 = temp_word2 + ".00";
                temp_word = temp_word + temp_word2 + " ,";
                temp_word2 = Convert.ToString(get_account_balance_from_51(emerg_prd, "7000", "@@@"));
                if (temp_word2.Contains("."))
                {
                    if (temp_word2.Substring(temp_word2.Length - 2, 1) == ".")
                        temp_word2 = temp_word2 + "0";
                }
                else
                    temp_word2 = temp_word2 + ".00";
                temp_word = temp_word + temp_word2 + " ,";
                temp_word2 = Convert.ToString(get_account_balance_from_51(emerg_prd, "6000", "@@@"));
                if (temp_word2.Contains("."))
                {
                    if (temp_word2.Substring(temp_word2.Length - 2, 1) == ".")
                        temp_word2 = temp_word2 + "0";
                }
                else
                    temp_word2 = temp_word2 + ".00";
                temp_word = temp_word + temp_word2 + " ,";
                temp_word2 = Convert.ToString(get_account_balance_from_51(emerg_prd, "6000R1", "@@@"));
                if (temp_word2.Contains("."))
                {
                    if (temp_word2.Substring(temp_word2.Length - 2, 1) == ".")
                        temp_word2 = temp_word2 + "0";
                }
                else
                    temp_word2 = temp_word2 + ".00";
                temp_word = temp_word + temp_word2 + " ,";
                temp_word2 = Convert.ToString(get_account_balance_from_51(emerg_prd, "719999", "@@@"));
                if (temp_word2.Contains("."))
                {
                    if (temp_word2.Substring(temp_word2.Length - 2, 1) == ".")
                        temp_word2 = temp_word2 + "0";
                }
                else
                    temp_word2 = temp_word2 + ".00";
                temp_word = temp_word + temp_word2 + " ,";
                temp_word2 = Convert.ToString(get_account_balance_from_51(emerg_prd, "7998", "@@@"));
                if (temp_word2.Contains("."))
                {
                    if (temp_word2.Substring(temp_word2.Length - 2, 1) == ".")
                        temp_word2 = temp_word2 + "0";
                }
                else
                    temp_word2 = temp_word2 + ".00";
                temp_word = temp_word + temp_word2 + " ,";
                temp_word2 = Convert.ToString(get_gp_percent_from_file_fifty(emerg_prd));
                if (temp_word2.Contains("."))
                {
                    if (temp_word2.Substring(temp_word2.Length - 2, 1) == ".")
                        temp_word2 = temp_word2 + "0";
                }
                else
                    temp_word2 = temp_word2 + ".00";
                temp_word = temp_word + temp_word2 + " ,";
                temporary_list_array.Add(temp_word.Trim());
            }
            print_balance_sheet_summary();
            //doc.SetPageSize(iTextSharp.text.PageSize.A4.Rotate()); // for horizontal layout
        }

        private void print_balance_sheet_summary()
        {
            report_filetype = cbBalShAc.Text + "_";
            trading_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
            if (chb_add_datetime_in_output.Checked)
                trading_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            trading_filename += ".pdf";
            doc1 = new Document(PageSize.A4.Rotate(), 10, 10, 35, 20);
            FileStream FS1 = File.Create(trading_filename);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            add_header_footer = true;
            header_text_message = report_filetype + " " + " From : " + RepFrom.Text + " to " + RepTo.Text;
            pdf_top_heading = "Period   Open. Stock          Purchase                  Sales                  Repairs               Gross.Profit                 Net.Profit                Gp.Per";
            Paragraph para = new Paragraph();
            basicamount = 0; taxamount = 0; grossamount = 0;
            for (int i = 0; i < temporary_list_array.Count; i++)
            {
                var cellArray = temporary_list_array[i].Split(new[] { ',' });
                temp_word = cellArray[0];
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(-20, temp_word, "cour_9"), -9);
                temp_word = cellArray[1];
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(40, temp_word, "cour_9"), -15);
                temp_word = cellArray[2];
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(120, temp_word, "cour_9"), -15);
                temp_word = cellArray[3];
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -15);
                temp_word = cellArray[4];
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(280, temp_word, "cour_9"), -15);
                temp_word = cellArray[5];
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(360, temp_word, "cour_9"), -15);
                temp_word = cellArray[6];
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(440, temp_word, "cour_9"), -15);
                temp_word = cellArray[7];
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(520, temp_word, "cour_9"), -15);
            }
            print_footer();
            doc1.Close();
        }

        private double get_gp_percent_from_file_fifty(string mprd)
        {
            ConnectionWithAccess.gp_percent = 0;
            temp_double = 0;
            ConnectionWithAccess.query = "select gp from " + ConnectionWithAccess.tablename[50] + " where prd = '" + mprd + "' and gp <> 0";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                    ConnectionWithAccess.gp_percent = Convert.ToDouble(dtData1.Rows[0][0].ToString()) * -1;
                temp_double = ConnectionWithAccess.gp_percent;
            }
            if (cb_emerg_full_period.Checked)
                blstgp_per.Text = Convert.ToString(ConnectionWithAccess.gp_percent);
            return temp_double;
        }

        private void cbBalShPer_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (maintab.SelectedIndex == 3)
            {
                if (subtabreports.SelectedIndex == 2)
                    trading_report_generate.Visible = true;
                if (cbBalShAc != null)
                {
                    if (cbBalShAc.SelectedItem.Equals("GP/NP Calculation"))
                    {
                        gp_percentage_change = true;
                        gb_tradingacc.Visible = true;
                        gb_profit_loss.Visible = true;
                        trading_report_generate.Visible = false;
                        get_gp_percent_from_file_fifty(cbBalShPer.Text);
                        blstgp_per.Text = Convert.ToString(ConnectionWithAccess.gp_percent);
                        calculate_gross_profit_using_gp_per(cbBalShPer.Text);
                    }
                    else
                    {
                        ConnectionWithAccess.query = "select prd, start, [end], lock, gp from " + ConnectionWithAccess.tablename[50] + " where prd = '" + cbBalShPer.Text + "'";
                        DataTable dtData1 = ConnectionCommand.fGetDataTable();
                        if (dtData1 != null && dtData1.Rows.Count > 0)
                        {
                            if (dtData1.Rows[0][0] != null)
                            {
                                dtBalShFrom.Text = dtData1.Rows[0][1].ToString();
                                dtBalShTo.Text = dtData1.Rows[0][2].ToString();
                            }
                        }
                    }
                }
                BalShDGV.Visible = false;
                pdf_viewer3.Visible = false;
                ConnectionWithAccess.temp_prd = cbBalShPer.Text;
                ConnectionWithAccess.temp_old_prd = (ConnectionWithAccess.temp_prd);
            }
        }

        private void pb_rep_ana_printer_Click(object sender, EventArgs e)
        {
            //PrintDocument document = new PrintDocument();
            //document.PrinterSettings.PrintFileName = FileName;
            //document.Print();
        }

        private void print_pdf_line(iTextSharp.text.Font pdf_font, string temp_word, int indentation_left, int spacingbefore)
        {
            if (maintab.SelectedIndex != 1 && subtabDataEntry.SelectedIndex != 1)
            {
                var current_print_line_position = writer.GetVerticalPosition(false);
                if (current_print_line_position < 80 && spacingbefore <= 0 && spacingbefore > -10)
                {
                    para = new Paragraph();
                    para.Font = cour_7;
                    para.Add("Page # " + current_pdf_page_number.ToString());
                    para.IndentationLeft = 480;
                    para.SpacingBefore = 0;
                    doc1.Add(para);
                    spacingbefore += 40;
                    current_pdf_page_number++;
                    //add_header_footer = true;
                }
                if (add_header_footer == true && require_header_footer == true)
                {
                    temp_int = indentation_left;
                    if (pdf_top_heading != null && pdf_top_heading != "")
                    {
                        temp_word1 = "-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
                        print_pdf_line_inside_another_line(cour_9, temp_word1, 32, spacingbefore);
                        print_pdf_line_inside_another_line(cour_9, pdf_top_heading, 48, -5);
                        temp_word1 = "-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
                        print_pdf_line_inside_another_line(cour_9, temp_word1, 32, -8);
                    }
                    print_header_footer();
                    add_header_footer = false;
                    indentation_left = temp_int;
                    spacingbefore = -9;
                }
            }
            temp_word = temp_word.Trim();
            if (temp_word == "" || temp_word == null) { temp_word = " "; }
            para = new Paragraph();
            para.Font = pdf_font;
            para.Add(temp_word);
            para.IndentationLeft = indentation_left;
            para.SpacingBefore = spacingbefore;
            doc1.Add(para);
            if (spacingbefore >= 0)
                actual_line_number_of_page++;
        }

        private void print_pdf_line_inside_another_line(iTextSharp.text.Font pdf_font, string temp_word, int indentation_left, int spacingbefore)
        {
            temp_word = temp_word.Trim();
            if (temp_word == "" || temp_word == null) { temp_word = " "; }
            para = new Paragraph();
            para.Font = pdf_font;
            para.Add(temp_word);
            para.IndentationLeft = indentation_left;
            para.SpacingBefore = spacingbefore;
            doc1.Add(para);
            if (spacingbefore >= 0)
                actual_line_number_of_page++;
        }

        private void print_pdf_line_at_center(iTextSharp.text.Font pdf_font, string temp_word, int spacingbefore, string font_type)
        {
            var current_print_line_position = writer.GetVerticalPosition(false);
            if (current_print_line_position < 90)
            {
                para = new Paragraph();
                para.Font = cour_7;
                // para.Add("For " +  + ConnectionWithAccess.company_details[1]);
                para.Add("Page # " + current_pdf_page_number.ToString());
                para.IndentationLeft = 480;
                para.SpacingBefore = 0;
                doc1.Add(para);
                spacingbefore += 40;
                current_pdf_page_number++;
                add_header_footer = true;
                //print_header_footer();
                //add_header_footer = false;
            }
            else
                if (add_header_footer == true && require_header_footer == true)
                {
                    print_header_footer();
                    add_header_footer = false;
                }

            if (temp_word != null)
                temp_word = temp_word.Trim();
            if (temp_word == "" || temp_word == null) { temp_word = " "; }
            para = new Paragraph();
            para.Font = pdf_font;
            para.Add(temp_word);
            para.SpacingBefore = spacingbefore;
            para.Alignment = iTextSharp.text.Image.ALIGN_CENTER;
            doc1.Add(para);
            actual_line_number_of_page++;
        }

        private void add_logo_image_in_pdf()
        {
            ////Company Logo
            //cell = ImageCell("~/images/northwindlogo.gif", 30f, PdfPCell.ALIGN_CENTER);
            //table.AddCell(cell);
        }

        private void print_header_footer()
        {
            //PdfContentByte cb;
            cb = writer.DirectContent;
            //PdfTemplate headerTemplate, footerTemplate;
            //BaseFont bf = BaseFont.CreateFont(Environment.GetEnvironmentVariable("windir") + @"\fonts\cour.ttf", BaseFont.IDENTITY_H, true);
            headerTemplate = cb.CreateTemplate(10, 10);
            footerTemplate = cb.CreateTemplate(50, 50);

            //Add paging to header
            cb.BeginText();
            cb.SetFontAndSize(bf, 9);
            cb.SetTextMatrix(doc1.PageSize.GetLeft(header_position), doc1.PageSize.GetTop(header_top_location));

            cb.ShowText(ConnectionWithAccess.company_details[1]);
            cb.SetTextMatrix(doc1.PageSize.GetLeft(header_position), doc1.PageSize.GetTop(header_top_location + 15));
            para.Font = arial_12;

            if (header_text_message != null && header_text_message != "")
                cb.ShowText(header_text_message);
            cb.EndText();
            //float len = bf.GetWidthPoint(headertext, 12);
            //cb.AddTemplate(headerTemplate, doc1.PageSize.GetRight(200) + len, doc1.PageSize.GetTop(45));

            //Add paging to footer

            cb.BeginText();
            cb.SetFontAndSize(bf, 7);
            temp_word = "For " + ConnectionWithAccess.company_details[1];
            cb.SetTextMatrix(doc1.PageSize.GetRight(footer_position), doc1.PageSize.GetBottom(footer_bottom_location));
            cb.ShowText(temp_word);
            cb.EndText();
            //float length = bf.GetWidthPoint(footertext, 12);
            //cb.AddTemplate(footerTemplate, doc1.PageSize.GetRight(180) + length, doc1.PageSize.GetBottom(30));
        }

        private void print_header_footer_with_top_contains(string heading_contains)
        {
            cb = writer.DirectContent;
            headerTemplate = cb.CreateTemplate(10, 10);
            footerTemplate = cb.CreateTemplate(50, 50);

            //Add paging to header
            cb.BeginText();
            cb.SetFontAndSize(bf, 12);
            cb.SetTextMatrix(doc1.PageSize.GetLeft(header_position), doc1.PageSize.GetTop(header_top_location));

            cb.ShowText(ConnectionWithAccess.company_details[1]);
            cb.SetTextMatrix(doc1.PageSize.GetLeft(header_position), doc1.PageSize.GetTop(header_top_location + 15));
            para.Font = cour_11;
            cb.ShowText(header_text_message);

            temp_word = "------------------------------------------------------------------------------------------------------------------------------------------";
            cb.SetTextMatrix(doc1.PageSize.GetLeft(header_position), doc1.PageSize.GetTop(header_top_location + 25));
            cb.ShowText(temp_word);
            cb.SetTextMatrix(doc1.PageSize.GetLeft(header_position), doc1.PageSize.GetTop(header_top_location + 35));
            cb.ShowText(heading_contains);
            cb.SetTextMatrix(doc1.PageSize.GetLeft(header_position), doc1.PageSize.GetTop(header_top_location + 45));
            cb.ShowText(temp_word);
            cb.EndText();

            //Add paging to footer
            cb.BeginText();
            cb.SetFontAndSize(bf, 7);
            temp_word = "------------------------------------------------------------------------------------------------------------------------------------------";
            cb.SetTextMatrix(doc1.PageSize.GetLeft(header_position), doc1.PageSize.GetBottom(footer_bottom_location + 20));
            cb.ShowText(temp_word);
            temp_word = "For " + ConnectionWithAccess.company_details[1];
            cb.SetTextMatrix(doc1.PageSize.GetRight(footer_position), doc1.PageSize.GetBottom(footer_bottom_location));
            cb.ShowText(temp_word);
            cb.EndText();
        }

        private void print_header()
        {
            cb = writer.DirectContent;
            headerTemplate = cb.CreateTemplate(10, 10);
            footerTemplate = cb.CreateTemplate(50, 50);
            cb.BeginText();
            cb.SetFontAndSize(bf, 12);
            cb.SetTextMatrix(doc1.PageSize.GetLeft(header_position), doc1.PageSize.GetTop(header_top_location));
            cb.ShowText(ConnectionWithAccess.company_details[1]);
            cb.SetTextMatrix(doc1.PageSize.GetLeft(header_position), doc1.PageSize.GetTop(header_top_location + 15));
            para.Font = cour_11;
            temp_word = report_filetype + " " + " From : " + RepFrom.Text + " to " + RepTo.Text;
            cb.ShowText(temp_word);
            cb.EndText();
        }

        private void print_footer()
        {
            cb = writer.DirectContent;
            headerTemplate = cb.CreateTemplate(10, 10);
            footerTemplate = cb.CreateTemplate(50, 50);
            cb.BeginText();
            cb.SetFontAndSize(bf, 7);
            temp_word = "For " + ConnectionWithAccess.company_details[1];
            cb.SetTextMatrix(doc1.PageSize.GetRight(footer_position), doc1.PageSize.GetBottom(footer_bottom_location));
            cb.ShowText(temp_word);
            cb.EndText();
        }

        private void sale_purchase_report_list()
        {
            if (gdvreport.ColumnCount > 0)
            {
                report_filetype = cbRepType.Text + "_" + cbRepSubType.Text + "_" + cbRepFormat.Text;
                report_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
                if (chb_add_datetime_in_output.Checked)
                    report_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                report_filename += ".pdf";
                doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
                FileStream FS1 = File.Create(report_filename);
                writer = PdfWriter.GetInstance(doc1, FS1);
                doc1.Open();
                current_pdf_page_number = 1;
                add_header_footer = true;
                header_text_message = report_filetype + " " + " From : " + RepFrom.Text + " to " + RepTo.Text;
                pdf_top_heading = "Date            Invoice       Name                                                             City                             Basic                 Tax              Gross";
                Paragraph para = new Paragraph();
                basicamount = 0; taxamount = 0; grossamount = 0;
                int lineno = 0;
                for (row_pointer = 0; row_pointer < gdvreport.RowCount - 2; row_pointer++)
                {
                    if (gdvreport.Rows[row_pointer].Cells[1].Value != null && gdvreport.Rows[row_pointer].Cells[1].Value.ToString() != "")
                    {
                        temp_word = gdvreport.Rows[row_pointer].Cells[1].Value.ToString();
                        print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(9, temp_word, "cour_9"), -9);
                        temp_word = gdvreport.Rows[row_pointer].Cells[2].Value.ToString();
                        print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(40, temp_word, "cour_9"), -15);
                        print_pdf_line(cour_9, gdvreport.Rows[row_pointer].Cells[3].Value.ToString(), 130, -15);
                        print_pdf_line(cour_9, gdvreport.Rows[row_pointer].Cells[4].Value.ToString(), 320, -15);

                        temp_word = gdvreport.Rows[row_pointer].Cells[6].Value.ToString();
                        print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(365, temp_word, "cour_9"), -15);

                        temp_word = gdvreport.Rows[row_pointer].Cells[7].Value.ToString();
                        print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(420, temp_word, "cour_9"), -15);

                        temp_word = gdvreport.Rows[row_pointer].Cells[8].Value.ToString();
                        print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(480, temp_word, "cour_9"), -15);

                        basicamount = basicamount + Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[6].Value.ToString());
                        taxamount = taxamount + Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[7].Value.ToString());
                        grossamount = grossamount + Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[8].Value.ToString());

                        lineno++;
                    }
                }
                print_pdf_line(cour_9, "----------------", 395, -7);
                print_pdf_line(cour_9, "----------------", 450, -17);
                print_pdf_line(cour_9, "----------------", 510, -17);
                print_pdf_line(cour_9, basicamount.ToString(), para_IndentationLeft_position(365, basicamount.ToString(), "cour_9"), -7);
                print_pdf_line(cour_9, taxamount.ToString(), para_IndentationLeft_position(420, taxamount.ToString(), "cour_9"), -17);
                print_pdf_line(cour_9, grossamount.ToString(), para_IndentationLeft_position(480, grossamount.ToString(), "cour_9"), -17);
                print_pdf_line(cour_9, "=========", 395, -7);
                print_pdf_line(cour_9, "=========", 450, -17);
                print_pdf_line(cour_9, "=========", 510, -17);
                doc1.Close();
            }
        }

        private void sale_purchase_report_list_mini()
        {
            report_filetype = cbRepType.Text + " " + cbRepSubType.Text + " " + cbRepFormat.Text;
            pdf_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
            if (chb_add_datetime_in_output.Checked)
                pdf_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            pdf_filename += ".pdf";
            pdf_filename = ConnectionWithAccess.remove_filename_error(pdf_filename);
            doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
            FileStream FS1 = File.Create(pdf_filename);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            add_header_footer = true;
            header_text_message = report_filetype + " " + " From : " + RepFrom.Text + " to " + RepTo.Text;

            print_pdf_line(cour_9, " ", 38, -9);
            //pdf_top_heading = "Date           Invoice      Name                                                                      City                           G.S.T. Number          Amount";
            Paragraph para = new Paragraph();
            basicamount = 0; taxamount = 0; grossamount = 0;
            int lineno = 0;

            PdfPTable itemTable = new PdfPTable(6);
            itemTable.HorizontalAlignment = 0;
            itemTable.WidthPercentage = 100;
            itemTable.SetWidths(new float[] { 10, 10, 30, 15, 20, 15 });  // then set the column's __relative__ widths
            itemTable.SpacingAfter = 40;
            itemTable.DefaultCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
            PdfPCell cell1 = new PdfPCell(new Phrase("Date", cour_9));
            cell1.HorizontalAlignment = 1;
            cell1.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER | iTextSharp.text.Rectangle.TOP_BORDER;
            itemTable.AddCell(cell1);
            PdfPCell cell2 = new PdfPCell(new Phrase("Invoice", cour_9));
            cell2.HorizontalAlignment = 1;
            cell2.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER | iTextSharp.text.Rectangle.TOP_BORDER;
            itemTable.AddCell(cell2);
            PdfPCell cell3 = new PdfPCell(new Phrase("Name", cour_9));
            cell3.HorizontalAlignment = 1;
            cell3.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER | iTextSharp.text.Rectangle.TOP_BORDER;
            itemTable.AddCell(cell3);
            PdfPCell cell4 = new PdfPCell(new Phrase("City", cour_9));
            cell4.HorizontalAlignment = 1;
            cell4.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER | iTextSharp.text.Rectangle.TOP_BORDER;
            itemTable.AddCell(cell4);
            PdfPCell cell5 = new PdfPCell(new Phrase("G.S.T. Number", cour_9));
            cell5.HorizontalAlignment = 1;
            cell5.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER | iTextSharp.text.Rectangle.TOP_BORDER;
            itemTable.AddCell(cell5);
            PdfPCell cell6 = new PdfPCell(new Phrase("Amount", cour_9));
            cell6.HorizontalAlignment = 1;
            cell6.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER | iTextSharp.text.Rectangle.TOP_BORDER;
            itemTable.AddCell(cell6);

            for (row_pointer = 0; row_pointer < gdvreport.RowCount - 1; row_pointer++)
            {
                if (gdvreport.Rows[row_pointer].Cells[1].Value != null && gdvreport.Rows[row_pointer].Cells[1].Value.ToString() != "")
                {
                    temp_word = gdvreport.Rows[row_pointer].Cells[0].Value.ToString();
                    if (temp_word.Contains(" "))
                        temp_word = temp_word.Substring(0, temp_word.IndexOf(" "));

                    PdfPCell dateCell = new PdfPCell(new Phrase(temp_word, cour_9));
                    dateCell.HorizontalAlignment = 0;
                    dateCell.PaddingLeft = 10f;
                    dateCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    itemTable.AddCell(dateCell);

                    PdfPCell invoiceCell = new PdfPCell(new Phrase(gdvreport.Rows[row_pointer].Cells[1].Value.ToString(), cour_9));
                    invoiceCell.HorizontalAlignment = 2;
                    invoiceCell.PaddingLeft = 10f;
                    invoiceCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    itemTable.AddCell(invoiceCell);

                    PdfPCell nameCell = new PdfPCell(new Phrase(gdvreport.Rows[row_pointer].Cells[2].Value.ToString(), cour_9));
                    nameCell.HorizontalAlignment = 0;
                    nameCell.PaddingLeft = 10f;
                    nameCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    itemTable.AddCell(nameCell);

                    PdfPCell cityCell = new PdfPCell(new Phrase(gdvreport.Rows[row_pointer].Cells[3].Value.ToString(), cour_9));
                    cityCell.HorizontalAlignment = 0;
                    cityCell.PaddingLeft = 10f;
                    cityCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    itemTable.AddCell(cityCell);

                    PdfPCell GSTCell = new PdfPCell(new Phrase(gdvreport.Rows[row_pointer].Cells[4].Value.ToString(), cour_9));
                    GSTCell.HorizontalAlignment = 0;
                    GSTCell.PaddingLeft = 10f;
                    GSTCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    itemTable.AddCell(GSTCell);

                    PdfPCell amountCell = new PdfPCell(new Phrase(gdvreport.Rows[row_pointer].Cells[5].Value.ToString(), cour_9));
                    amountCell.HorizontalAlignment = 2;
                    amountCell.PaddingLeft = 10f;
                    amountCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    itemTable.AddCell(amountCell);

                    grossamount = grossamount + Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[5].Value.ToString());
                    lineno++;
                }
            }
            grossamount = Math.Round(grossamount, 2);

            AddGrossAmountCell(itemTable, grossamount);
            doc1.Add(itemTable);

            doc1.Close();
        }

        private void AddGrossAmountCell(PdfPTable itemTable, double amount)
        {
            PdfPCell dateCell = new PdfPCell(new Phrase("", cour_9));
            dateCell.HorizontalAlignment = 0;
            dateCell.PaddingLeft = 10f;
            dateCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
            itemTable.AddCell(dateCell);

            PdfPCell invoiceCell = new PdfPCell(new Phrase("", cour_9));
            invoiceCell.HorizontalAlignment = 2;
            invoiceCell.PaddingLeft = 10f;
            invoiceCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
            itemTable.AddCell(invoiceCell);

            PdfPCell nameCell = new PdfPCell(new Phrase("", cour_9));
            nameCell.HorizontalAlignment = 0;
            nameCell.PaddingLeft = 10f;
            nameCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
            itemTable.AddCell(nameCell);

            PdfPCell cityCell = new PdfPCell(new Phrase("", cour_9));
            cityCell.HorizontalAlignment = 0;
            cityCell.PaddingLeft = 10f;
            cityCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
            itemTable.AddCell(cityCell);

            PdfPCell GSTCell = new PdfPCell(new Phrase("", cour_9));
            GSTCell.HorizontalAlignment = 0;
            GSTCell.PaddingLeft = 10f;
            GSTCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
            itemTable.AddCell(GSTCell);

            PdfPCell amountCell = new PdfPCell(new Phrase(amount.ToString(), cour_9));
            amountCell.HorizontalAlignment = 2;
            amountCell.PaddingLeft = 10f;
            amountCell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER | iTextSharp.text.Rectangle.TOP_BORDER;
            itemTable.AddCell(amountCell);

        }

        private void sale_purchase_report_list_mini_old()
        {
            report_filetype = cbRepType.Text + " " + cbRepSubType.Text + " " + cbRepFormat.Text;
            pdf_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
            if (chb_add_datetime_in_output.Checked)
                pdf_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            pdf_filename += ".pdf";
            pdf_filename = ConnectionWithAccess.remove_filename_error(pdf_filename);
            doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
            FileStream FS1 = File.Create(pdf_filename);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            add_header_footer = true;
            header_text_message = report_filetype + " " + " From : " + RepFrom.Text + " to " + RepTo.Text;
            pdf_top_heading = "Date           Invoice      Name                                                                      City                           G.S.T. Number          Amount";
            Paragraph para = new Paragraph();
            basicamount = 0; taxamount = 0; grossamount = 0;
            int lineno = 0;
            for (row_pointer = 0; row_pointer < gdvreport.RowCount - 1; row_pointer++)
            {
                if (gdvreport.Rows[row_pointer].Cells[1].Value != null && gdvreport.Rows[row_pointer].Cells[1].Value.ToString() != "")
                {
                    temp_word = gdvreport.Rows[row_pointer].Cells[0].Value.ToString();
                    if (temp_word.Contains(" "))
                        temp_word = temp_word.Substring(0, temp_word.IndexOf(" "));
                    print_pdf_line(cour_9, temp_word, 38, -9);
                    temp_word = gdvreport.Rows[row_pointer].Cells[1].Value.ToString();
                    print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(44, temp_word, "cour_9"), -15);
                    print_pdf_line(cour_9, gdvreport.Rows[row_pointer].Cells[2].Value.ToString(), 130, -15);
                    print_pdf_line(cour_9, gdvreport.Rows[row_pointer].Cells[3].Value.ToString(), 330, -15);
                    print_pdf_line(cour_9, gdvreport.Rows[row_pointer].Cells[4].Value.ToString(), 410, -15);
                    temp_word = gdvreport.Rows[row_pointer].Cells[5].Value.ToString();
                    print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -15);
                    grossamount = grossamount + Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[5].Value.ToString());
                    lineno++;
                }
            }
            grossamount = Math.Round(grossamount, 2);
            print_pdf_line(cour_9, "----------------", 500, -7);
            print_pdf_line(cour_9, grossamount.ToString(), para_IndentationLeft_position(470, grossamount.ToString(), "cour_9"), -10);
            print_pdf_line(cour_9, "==========", 494, -7);
            doc1.Close();
        }

        private void add_shaded_line(int start_point, int length)
        {
            if (shade_pdf_line == true)
            {
                temp_word = string.Concat(Enumerable.Repeat("A", length));
                para = new Paragraph();
                para.Add(temp_word);
                para.IndentationLeft = start_point;
                para.SpacingBefore = 0;
                doc1.Add(para);
                shade_pdf_line = false;
            }
            else
                shade_pdf_line = true;
        }

        private void generate_bank_report()
        {
            if (cbRepSubType.Text != "All")
                report_filetype = cbRepType.Text + " " + cbRepSubType.Text + " " + cbRepFormat.Text;
            else
                report_filetype = cbRepType.Text + " List ";
            pdf_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
            if (chb_add_datetime_in_output.Checked)
                pdf_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            pdf_filename += ".pdf";
            pdf_filename = ConnectionWithAccess.remove_filename_error(pdf_filename);
            doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
            FileStream FS1 = File.Create(pdf_filename);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            add_header_footer = true;
            header_text_message = report_filetype + " " + " From : " + RepFrom.Text + " to " + RepTo.Text;
            pdf_top_heading = "Date            Doc.          Name                                                                                Debit                      Credit                  Balance";
            Paragraph para = new Paragraph();
            int lineno = 0;
            debitamount = 0;
            creditamount = 0;
            for (row_pointer = 0; row_pointer < gdvreport.RowCount - 2; row_pointer++)
            {
                if (gdvreport.Rows[row_pointer].Cells[0].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[0].Value != null)
                {
                    temp_word = gdvreport.Rows[row_pointer].Cells[0].Value.ToString();
                    if (temp_word.Contains(" "))
                        temp_word = temp_word.Substring(0, temp_word.IndexOf(" "));
                    print_pdf_line(cour_9, temp_word, 38, -9);
                }
                if (gdvreport.Rows[row_pointer].Cells[1].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[1].Value != null)
                {
                    temp_word = gdvreport.Rows[row_pointer].Cells[1].Value.ToString();
                    print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(44, temp_word, "cour_9"), -15);
                }
                if (gdvreport.Rows[row_pointer].Cells[2].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[2].Value != null)
                    print_pdf_line(cour_9, gdvreport.Rows[row_pointer].Cells[2].Value.ToString(), 130, -15);

                if (gdvreport.Rows[row_pointer].Cells[4].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[4].Value != "")
                {
                    if (Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[4].Value) != 0.00)
                    {
                        temp_word = add_comma_to_number(gdvreport.Rows[row_pointer].Cells[4].Value.ToString());
                        print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(320, temp_word, "cour_9_bold"), -15);
                        debitamount += Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[4].Value.ToString());
                    }
                }
                if (gdvreport.Rows[row_pointer].Cells[5].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[5].Value != "")
                {
                    if (Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[5].Value) != 0.00)
                    {
                        temp_word = add_comma_to_number(gdvreport.Rows[row_pointer].Cells[5].Value.ToString());
                        print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(400, temp_word, "cour_9_bold"), -15);
                        creditamount += Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[5].Value.ToString());
                    }
                }
                if (gdvreport.Rows[row_pointer].Cells[6].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[6].Value != null)
                {
                    temp_word = add_comma_to_number(gdvreport.Rows[row_pointer].Cells[6].Value.ToString());
                    print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(480, temp_word, "cour_9_bold"), -15);
                }

                //print_pdf_line(cour_9, gdvreport.Rows[row_pointer].Cells[3].Value.ToString(), 330, -15);
                //temp_word = gdvreport.Rows[row_pointer].Cells[4].Value.ToString();
                //print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(390, temp_word, "cour_9"), -15);
                //temp_word = gdvreport.Rows[row_pointer].Cells[5].Value.ToString();
                //print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -15);
                //if (gdvreport.Rows[row_pointer].Cells[4].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[4].Value != null && gdvreport.Rows[row_pointer].Cells[4].Value.ToString() != "")
                //    debitamount += Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[4].Value.ToString());
                //if (gdvreport.Rows[row_pointer].Cells[5].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[5].Value != null && gdvreport.Rows[row_pointer].Cells[5].Value.ToString() != "")
                //    creditamount += Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[5].Value.ToString());
                lineno++;
            }
            print_pdf_line(cour_9, "----------------             ----------------", 420, -7);
            temp_word = add_comma_to_number(debitamount.ToString());
            print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(320, temp_word, "cour_9_bold"), -15);
            temp_word = add_comma_to_number(creditamount.ToString());
            print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(400, temp_word, "cour_9_bold"), -15);
            print_pdf_line(cour_9, "==========          ==========", 419, -7);
            doc1.Close();
        }

        private void generate_cash_report()
        {
            if (cbRepSubType.Text != "All")
                report_filetype = cbRepType.Text + " " + cbRepSubType.Text + " " + cbRepFormat.Text;
            else
                report_filetype = cbRepType.Text + " List ";
            pdf_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
            if (chb_add_datetime_in_output.Checked)
                pdf_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            pdf_filename += ".pdf";
            pdf_filename = ConnectionWithAccess.remove_filename_error(pdf_filename);
            doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
            FileStream FS1 = File.Create(pdf_filename);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            add_header_footer = true;
            header_text_message = report_filetype + " " + " From : " + RepFrom.Text + " to " + RepTo.Text;
            pdf_top_heading = "Date            Doc.          Name                                                                                Debit                      Credit                  Balance";
            Paragraph para = new Paragraph();
            int lineno = 0;
            debitamount = 0;
            creditamount = 0;
            for (row_pointer = 0; row_pointer < gdvreport.RowCount - 2; row_pointer++)
            {
                if (gdvreport.Rows[row_pointer].Cells[0].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[0].Value != null)
                {
                    temp_word = gdvreport.Rows[row_pointer].Cells[0].Value.ToString();
                    if (temp_word.Contains(" "))
                        temp_word = temp_word.Substring(0, temp_word.IndexOf(" "));
                    print_pdf_line(cour_9, temp_word, 38, -9);
                }
                if (gdvreport.Rows[row_pointer].Cells[1].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[1].Value != null)
                {
                    temp_word = gdvreport.Rows[row_pointer].Cells[1].Value.ToString();
                    print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(44, temp_word, "cour_9"), -15);
                }
                if (gdvreport.Rows[row_pointer].Cells[2].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[2].Value != null)
                    print_pdf_line(cour_9, gdvreport.Rows[row_pointer].Cells[2].Value.ToString(), 130, -15);

                if (gdvreport.Rows[row_pointer].Cells[4].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[4].Value != "")
                {
                    if (Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[4].Value) != 0.00)
                    {
                        temp_word = add_comma_to_number(gdvreport.Rows[row_pointer].Cells[4].Value.ToString());
                        print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(320, temp_word, "cour_9_bold"), -15);
                        debitamount += Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[4].Value.ToString());
                    }
                }
                if (gdvreport.Rows[row_pointer].Cells[5].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[5].Value != "")
                {
                    if (Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[5].Value) != 0.00)
                    {
                        temp_word = add_comma_to_number(gdvreport.Rows[row_pointer].Cells[5].Value.ToString());
                        print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(400, temp_word, "cour_9_bold"), -15);
                        creditamount += Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[5].Value.ToString());
                    }
                }
                if (gdvreport.Rows[row_pointer].Cells[6].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[6].Value != null)
                {
                    temp_word = add_comma_to_number(gdvreport.Rows[row_pointer].Cells[6].Value.ToString());
                    print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(480, temp_word, "cour_9_bold"), -15);
                }

                //print_pdf_line(cour_9, gdvreport.Rows[row_pointer].Cells[3].Value.ToString(), 330, -15);
                //temp_word = gdvreport.Rows[row_pointer].Cells[4].Value.ToString();
                //print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(390, temp_word, "cour_9"), -15);
                //temp_word = gdvreport.Rows[row_pointer].Cells[5].Value.ToString();
                //print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -15);
                //if (gdvreport.Rows[row_pointer].Cells[4].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[4].Value != null && gdvreport.Rows[row_pointer].Cells[4].Value.ToString() != "")
                //    debitamount += Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[4].Value.ToString());
                //if (gdvreport.Rows[row_pointer].Cells[5].Value != System.DBNull.Value && gdvreport.Rows[row_pointer].Cells[5].Value != null && gdvreport.Rows[row_pointer].Cells[5].Value.ToString() != "")
                //    creditamount += Convert.ToDouble(gdvreport.Rows[row_pointer].Cells[5].Value.ToString());
                lineno++;
            }
            print_pdf_line(cour_9, "----------------             ----------------", 420, -7);
            temp_word = add_comma_to_number(debitamount.ToString());
            print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(320, temp_word, "cour_9_bold"), -15);
            temp_word = add_comma_to_number(creditamount.ToString());
            print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(400, temp_word, "cour_9_bold"), -15);
            print_pdf_line(cour_9, "==========          ==========", 419, -7);
            doc1.Close();
        }

        private void generate_general_report()
        {
            if (gdvreport.ColumnCount > 0)
            {
                report_filetype = cbRepType.Text + "_" + cbRepSubType.Text + "_" + cbRepFormat.Text;
                pdf_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
                if (chb_add_datetime_in_output.Checked)
                    pdf_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                pdf_filename += ".pdf";
                pdf_filename = ConnectionWithAccess.remove_filename_error(pdf_filename);
                doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
                FileStream FS1 = File.Create(pdf_filename);
                writer = PdfWriter.GetInstance(doc1, FS1);
                doc1.Open();
                current_pdf_page_number = 1;
                add_header_footer = true;
                header_text_message = report_filetype + " " + " From : " + RepFrom.Text + " to " + RepTo.Text;
                pdf_top_heading = "Date            Doc.          Name                                                             City                             Debit                Credit          Balance";
                Paragraph para = new Paragraph();
                int lineno = 0;
                for (row_pointer = 0; row_pointer < gdvreport.RowCount; row_pointer++)
                {
                    if (gdvreport.Rows[row_pointer].Cells[1].Value != null && gdvreport.Rows[row_pointer].Cells[1].Value.ToString() != "")
                    {
                        temp_word = gdvreport.Rows[row_pointer].Cells[3].Value.ToString();
                        print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(9, temp_word, "cour_9"), -9);

                        temp_word = gdvreport.Rows[row_pointer].Cells[4].Value.ToString();
                        print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(40, temp_word, "cour_9"), -15);
                        print_pdf_line(cour_9, gdvreport.Rows[row_pointer].Cells[5].Value.ToString(), 130, -15);
                        print_pdf_line(cour_9, gdvreport.Rows[row_pointer].Cells[6].Value.ToString(), 320, -15);

                        temp_word = gdvreport.Rows[row_pointer].Cells[7].Value.ToString().Trim();
                        if (temp_word != "" && temp_word != null)
                        {
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(365, temp_word, "cour_9"), -15);
                        }
                        temp_word = gdvreport.Rows[row_pointer].Cells[8].Value.ToString().Trim();
                        if (temp_word != "" && temp_word != null)
                        {
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(420, temp_word, "cour_9"), -15);
                        }
                        temp_word = gdvreport.Rows[row_pointer].Cells[9].Value.ToString().Trim();
                        if (temp_word != "" && temp_word != null)
                        {
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(480, temp_word, "cour_9"), -15);
                        }
                        lineno++;
                    }
                }
                temp_word = "-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
                print_pdf_line(cour_9, temp_word, 20, 0);
                doc1.Close();
            }
        }

        private void generate_Debitors_creditors_report()
        {
            if (gdvreport.ColumnCount > 0)
            {
                report_filetype = cbRepType.Text + "_" + cbRepSubType.Text + "_" + cbRepFormat.Text;
                pdf_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
                if (chb_add_datetime_in_output.Checked)
                    pdf_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                pdf_filename += ".pdf";
                pdf_filename = ConnectionWithAccess.remove_filename_error(pdf_filename);
                doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
                FileStream FS1 = File.Create(pdf_filename);
                writer = PdfWriter.GetInstance(doc1, FS1);
                doc1.Open();
                current_pdf_page_number = 1;
                add_header_footer = true;
                header_text_message = report_filetype + " " + " From : " + RepFrom.Text + " to " + RepTo.Text;
                pdf_top_heading = "Sr No.           Name                                 City                             Balance";
                temp_double = 0;
                Paragraph para = new Paragraph();
                int lineno = 0;
                for (row_pointer = 0; row_pointer < gdvreport.RowCount; row_pointer++)
                {
                    if (gdvreport.Rows[row_pointer].Cells[3].Value != null && gdvreport.Rows[row_pointer].Cells[3].Value.ToString() != "")
                    {
                        print_pdf_line(cour_9, gdvreport.Rows[row_pointer].Cells[3].Value.ToString(), 80, -9);
                        print_pdf_line(cour_9, gdvreport.Rows[row_pointer].Cells[4].Value.ToString(), 280, -15);
                        if (gdvreport.Rows[row_pointer].Cells[5].Value != null && gdvreport.Rows[row_pointer].Cells[5].Value.ToString() != "")
                        {
                            temp_word = gdvreport.Rows[row_pointer].Cells[5].Value.ToString();
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(409, temp_word, "cour_9"), -15);
                            temp_double = temp_double + Convert.ToDouble(temp_word);
                        }
                        lineno++;
                    }
                }
                print_pdf_line(cour_9, "----------------", 439, -5);
                print_pdf_line(cour_9, temp_double.ToString(), para_IndentationLeft_position(409, temp_double.ToString(), "cour_9"), -7);
                print_pdf_line(cour_9, "=========", 439, -7);
                temp_word = "-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
                print_pdf_line(cour_9, temp_word, 20, 0);
                doc1.Close();
            }
        }

        private void add_pdf_top_heading(string pdf_top_heading)
        {
            temp_word = "-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_9, temp_word, 32, 0);
            print_pdf_line(cour_9, pdf_top_heading, 48, -5);
            temp_word = "-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
            print_pdf_line(cour_9, temp_word, 32, -8);
        }

        private void generate_ledger_report()
        {
            if (LedDGV.ColumnCount > 0)
            {
                get_account_details_from_01(rla_n.Text, rls_a.Text);
                get_account_details_from_04(rla_n.Text, rls_a.Text);
                report_filetype = lbl_ledger_master_account_name.Text.Trim();
                ledger_filename = ConnectionWithAccess.report_file_location + "Ledger of_" + tb_ledger_account_name.Text.Trim() + "_" + rla_n.Text + "_" + rls_a.Text + "_as on_" + ConnectionWithAccess.mprd;
                if (chb_add_datetime_in_output.Checked)
                    ledger_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                ledger_filename += ".pdf";
                doc1 = new Document(PageSize.A4, 5, 5, 5, 5);
                // left margin,right margin, top margin, bottom margin
                ledger_filename = ConnectionWithAccess.remove_filename_error(ledger_filename);
                FileStream FS1 = File.Create(ledger_filename);
                writer = PdfWriter.GetInstance(doc1, FS1);
                doc1.Open();
                current_pdf_page_number = 1;
                pdf_top_heading = null;
                require_header_footer = false;
                Paragraph para = new Paragraph();
                temp_word = ConnectionWithAccess.company_details[1];
                print_pdf_line_at_center(cour_9, temp_word, 0, "cour_9");
                temp_word = ConnectionWithAccess.company_details[2];
                temp_word += ConnectionWithAccess.company_details[3];
                print_pdf_line_at_center(cour_9, temp_word, 0, "cour_9");
                temp_word = ConnectionWithAccess.company_details[4];
                if (ConnectionWithAccess.company_details[6].Length > 2)
                    temp_word += "-" + ConnectionWithAccess.company_details[6];
                if (ConnectionWithAccess.company_details[5].Length > 2)
                    temp_word += " " + ConnectionWithAccess.company_details[5];
                print_pdf_line_at_center(cour_9, temp_word, 0, "cour_9");
                temp_word = account_detail_from_01[4];
                print_pdf_line_at_center(cour_9_bold, temp_word, 0, "cour_9_bold");
                print_pdf_line_at_center(cour_9, "Ledger Account", 0, "cour_9");
                temp_word = account_detail_from_04[4];
                if (account_detail_from_04[5].Length > 2)
                    temp_word += account_detail_from_04[5];
                if (account_detail_from_04[6].Length > 2)
                    temp_word = account_detail_from_04[6];
                if (account_detail_from_04[7].Length > 2)
                    temp_word += " " + account_detail_from_04[7];
                print_pdf_line_at_center(cour_9, temp_word, 0, "cour_9");
                temp_word = RepFrom.Value.Date.ToString("dd-MMM-yyyy") + " to " + RepTo.Value.Date.ToString("dd-MMM-yyyy");
                print_pdf_line_at_center(cour_9, temp_word, 0, "cour_9");

                pdf_top_heading = "Date                     Particulars                                  Vch Type                                   Vch No.                Debit                Credit";
                add_pdf_top_heading(pdf_top_heading);
                int lineno = 0;
                debitamount = 0;
                creditamount = 0;
                for (row_pointer = 0; row_pointer < LedDGV.RowCount; row_pointer++)
                {
                    if (LedDGV.Rows[row_pointer].Cells[1].Value != null && LedDGV.Rows[row_pointer].Cells[1].Value.ToString() != "")
                    {
                        if (LedDGV.Rows[row_pointer].Cells[6].Value != System.DBNull.Value && LedDGV.Rows[row_pointer].Cells[7].Value != System.DBNull.Value && LedDGV.Rows[row_pointer].Cells[8].Value != System.DBNull.Value)
                        {
                            if ((LedDGV.Rows[row_pointer].Cells[6].Value != null && Convert.ToDouble(LedDGV.Rows[row_pointer].Cells[6].Value) != 0.00) || (LedDGV.Rows[row_pointer].Cells[7].Value != null && Convert.ToDouble(LedDGV.Rows[row_pointer].Cells[7].Value) != 0.00) || (LedDGV.Rows[row_pointer].Cells[8].Value != null && Convert.ToDouble(LedDGV.Rows[row_pointer].Cells[8].Value) != 0.00))
                            {
                                if (LedDGV.Rows[row_pointer].Cells[4].Value.ToString() != "")
                                {
                                    if (LedDGV.Rows[row_pointer].Cells[4].Value.ToString() == "Open")
                                    {
                                        temp_double = Convert.ToDouble(LedDGV.Rows[row_pointer].Cells[8].Value.ToString());
                                        if (temp_double > 0)
                                            debitamount += Convert.ToDouble(LedDGV.Rows[row_pointer].Cells[8].Value.ToString());
                                        else
                                            creditamount -= Convert.ToDouble(LedDGV.Rows[row_pointer].Cells[8].Value.ToString());
                                    }
                                }
                                temp_word = LedDGV.Rows[row_pointer].Cells[3].Value.ToString();
                                temp_word = temp_word.Substring(0, temp_word.IndexOf(" "));
                                print_pdf_line(cour_9, temp_word, 30, -9);
                                if (LedDGV.Rows[row_pointer].Cells[6].Value != null && Convert.ToDouble(LedDGV.Rows[row_pointer].Cells[6].Value) != 0.00)
                                    print_pdf_line(cour_9, "To", 80, -15);
                                else
                                    print_pdf_line(cour_9, "By", 80, -15);
                                print_pdf_line(cour_9_bold, LedDGV.Rows[row_pointer].Cells[5].Value.ToString(), 100, -15);
                                temp_word = LedDGV.Rows[row_pointer].Cells[4].Value.ToString();
                                print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(120, temp_word, "cour_9_bold"), -15);
                                if (LedDGV.Rows[row_pointer].Cells[6].Value != null && Convert.ToDouble(LedDGV.Rows[row_pointer].Cells[6].Value) != 0.00)
                                {
                                    temp_word = add_comma_to_number(LedDGV.Rows[row_pointer].Cells[6].Value.ToString());
                                    print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(320, temp_word, "cour_9_bold"), -15);
                                    debitamount += Convert.ToDouble(LedDGV.Rows[row_pointer].Cells[6].Value.ToString());
                                }
                                if (LedDGV.Rows[row_pointer].Cells[7].Value != null && Convert.ToDouble(LedDGV.Rows[row_pointer].Cells[7].Value) != 0.00)
                                {
                                    temp_word = add_comma_to_number(LedDGV.Rows[row_pointer].Cells[7].Value.ToString());
                                    print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(400, temp_word, "cour_9_bold"), -15);
                                    creditamount += Convert.ToDouble(LedDGV.Rows[row_pointer].Cells[7].Value.ToString());
                                }
                                if (LedDGV.Rows[row_pointer].Cells[8].Value != null)
                                {
                                    temp_word = add_comma_to_number(LedDGV.Rows[row_pointer].Cells[8].Value.ToString());
                                    print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(480, temp_word, "cour_9_bold"), -15);
                                }
                                if (cb_add_purchase_items_in_ledger.Checked == true && LedDGV.Rows[row_pointer].Cells[5].Value.ToString() == "Purc")
                                {
                                    create_list_for_sale_purchase_items("P", LedDGV.Rows[row_pointer].Cells[10].Value.ToString(), Convert.ToInt32(LedDGV.Rows[row_pointer].Cells[9].Value.ToString()), rla_n.Text, rls_a.Text, LedDGV.Rows[row_pointer].Cells[4].Value.ToString());
                                    if (temporary_list_array.Count > 0)
                                    {
                                        mqty = 0;
                                        for (int i = 0; i < temporary_list_array.Count; i++)
                                        {
                                            var cellArray = temporary_list_array[i].Split(new[] { ',' });
                                            //temp_word = temporary_list_array[i];
                                            print_pdf_line(cour_7, cellArray[2], 120, -7);
                                            print_pdf_line(cour_7, cellArray[5], para_IndentationLeft_position(180, cellArray[5], "cour_7"), -16);
                                            print_pdf_line(cour_7, cellArray[8], 262, -16);
                                            print_pdf_line(cour_7, "@", 280, -16);
                                            print_pdf_line(cour_7, cellArray[6], para_IndentationLeft_position(250, cellArray[6], "cour_7"), -16);
                                            print_pdf_line(cour_7, "=", 330, -16);
                                            temp_word = add_comma_to_number(cellArray[7]);
                                            print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(310, temp_word, "cour_7"), -16);
                                            mqty += Convert.ToDouble(cellArray[5]);
                                            //print_pdf_line(cour_9, temp_word, 20, 0);
                                        }
                                        ConnectionWithAccess.query = "select tpt, bamt, tamt, rund_amt, gamt, tx_code, d_d,freight_AMT,packing_AMT,insurance_AMT,other_AMT from " + ConnectionWithAccess.tablename[22] + " f22 where d_n = " + LedDGV.Rows[row_pointer].Cells[4].Value.ToString() + " and prd = '" + LedDGV.Rows[row_pointer].Cells[10].Value.ToString() + "' and d_c = " + Convert.ToInt32(LedDGV.Rows[row_pointer].Cells[9].Value.ToString()) + " and s_a = '" + rls_a.Text + "'";
                                        DataTable dtData1 = ConnectionCommand.fGetDataTable();
                                        if (dtData1 != null && dtData1.Rows.Count > 0)
                                        {
                                            if (dtData1.Rows[0][2].ToString() != "0.00")
                                            {
                                                print_pdf_line(cour_7, "VAT", 140, -7);
                                                print_pdf_line(cour_7, "=", 350, -16);
                                                temp_word = add_comma_to_number(dtData1.Rows[0][2].ToString());
                                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(330, temp_word, "cour_7"), -16);
                                            }
                                            if (dtData1.Rows[0][3].ToString() != "0.00")
                                            {
                                                print_pdf_line(cour_7, "Rounded Off ", 140, -7);
                                                print_pdf_line(cour_7, "=", 350, -16);
                                                temp_word = add_comma_to_number(dtData1.Rows[0][3].ToString());
                                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(330, temp_word, "cour_7"), -16);
                                            }
                                        }
                                        if (mqty != 0)
                                        {
                                            print_pdf_line(cour_7, "******* Total Qty. = " + mqty.ToString() + " Pcs : Amt = ", 140, -7);
                                            temp_word = add_comma_to_number(dtData1.Rows[0][4].ToString());
                                            print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(330, temp_word, "cour_7"), -16);
                                        }
                                    }
                                }
                                if (cb_add_sale_items_in_ledger.Checked == true && LedDGV.Rows[row_pointer].Cells[5].Value.ToString() == "Sale")
                                {
                                    create_list_for_sale_purchase_items("S", LedDGV.Rows[row_pointer].Cells[10].Value.ToString(), Convert.ToInt32(LedDGV.Rows[row_pointer].Cells[9].Value.ToString()), rla_n.Text, rls_a.Text, LedDGV.Rows[row_pointer].Cells[4].Value.ToString());
                                    if (temporary_list_array.Count > 0)
                                    {
                                        mqty = 0;
                                        for (int i = 0; i < temporary_list_array.Count; i++)
                                        {
                                            var cellArray = temporary_list_array[i].Split(new[] { ',' });
                                            //temp_word = temporary_list_array[i];
                                            print_pdf_line(cour_7, cellArray[2], 120, -7);
                                            print_pdf_line(cour_7, cellArray[5], para_IndentationLeft_position(180, cellArray[5], "cour_7"), -16);
                                            print_pdf_line(cour_7, cellArray[8], 262, -16);
                                            print_pdf_line(cour_7, "@", 280, -16);
                                            print_pdf_line(cour_7, cellArray[6], para_IndentationLeft_position(250, cellArray[6], "cour_7"), -16);
                                            print_pdf_line(cour_7, "=", 330, -16);
                                            temp_word = add_comma_to_number(cellArray[7]);
                                            print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(310, temp_word, "cour_7"), -16);
                                            mqty += Convert.ToDouble(cellArray[5]);
                                            //print_pdf_line(cour_9, temp_word, 20, 0);
                                        }
                                        ConnectionWithAccess.query = "select tpt, bamt, tamt, rund_amt, gamt, tx_code, d_d,freight_AMT,packing_AMT,insurance_AMT,other_AMT from " + ConnectionWithAccess.tablename[21] + " 21 where d_n = " + LedDGV.Rows[row_pointer].Cells[4].Value.ToString() + " and prd = '" + LedDGV.Rows[row_pointer].Cells[10].Value.ToString() + "' and d_c = " + Convert.ToInt32(LedDGV.Rows[row_pointer].Cells[9].Value.ToString());
                                        DataTable dtData1 = ConnectionCommand.fGetDataTable();
                                        if (dtData1 != null && dtData1.Rows.Count > 0)
                                        {
                                            if (dtData1.Rows[0][2].ToString() != "0.00")
                                            {
                                                print_pdf_line(cour_7, "VAT", 140, -7);
                                                print_pdf_line(cour_7, "=", 350, -16);
                                                temp_word = add_comma_to_number(dtData1.Rows[0][2].ToString());
                                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(330, temp_word, "cour_7"), -16);
                                            }
                                            if (dtData1.Rows[0][3].ToString() != "0.00")
                                            {
                                                print_pdf_line(cour_7, "Rounded Off ", 140, -7);
                                                print_pdf_line(cour_7, "=", 350, -16);
                                                temp_word = add_comma_to_number(dtData1.Rows[0][3].ToString());
                                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(330, temp_word, "cour_7"), -16);
                                            }

                                            if (mqty != 0)
                                            {
                                                print_pdf_line(cour_7, "******* Total Qty. = " + mqty.ToString() + " Pcs : Amt = ", 140, -7);
                                                temp_word = add_comma_to_number(dtData1.Rows[0][4].ToString());
                                                print_pdf_line(cour_7, temp_word, para_IndentationLeft_position(330, temp_word, "cour_7"), -16);
                                            }
                                        }
                                    }
                                }
                                //(string book, string mprd, int md_c, string ma_n, string ms_a, string md_n)
                                lineno++;
                            }
                        }
                        if (lineno >= 60)
                        {
                            temp_word = "-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
                            print_pdf_line(cour_9, temp_word, 20, -12);
                            print_pdf_line(cour_9, " ", 50, 5);
                            temp_word = ConnectionWithAccess.company_details[1];
                            print_pdf_line_at_center(cour_9_bold, temp_word, 0, "cour_9_bold");
                            temp_word = ConnectionWithAccess.company_details[2];
                            if (ConnectionWithAccess.company_details[3].Length > 2)
                                temp_word += ConnectionWithAccess.company_details[3];
                            print_pdf_line_at_center(cour_9, temp_word, 0, "cour_9");
                            temp_word = ConnectionWithAccess.company_details[4];
                            if (ConnectionWithAccess.company_details[6].Length > 2)
                                temp_word += "-" + ConnectionWithAccess.company_details[6];
                            if (ConnectionWithAccess.company_details[5].Length > 2)
                                temp_word += " " + ConnectionWithAccess.company_details[5];
                            print_pdf_line_at_center(cour_9, temp_word, 0, "cour_9");
                            temp_word = account_detail_from_01[4];
                            print_pdf_line_at_center(cour_9_bold, temp_word, 0, "cour_9_bold");
                            print_pdf_line_at_center(cour_9, "Ledger Account", 0, "cour_9");
                            temp_word = account_detail_from_04[4];
                            if (account_detail_from_04[5].Length > 2)
                                temp_word += account_detail_from_04[5];
                            if (account_detail_from_04[6].Length > 2)
                                temp_word = account_detail_from_04[6];
                            if (account_detail_from_04[7].Length > 2)
                                temp_word += " " + account_detail_from_04[7];
                            print_pdf_line_at_center(cour_9, temp_word, 0, "cour_9");
                            temp_word = RepFrom.Value.Date.ToString("dd-MMM-yyyy") + " to " + RepTo.Value.Date.ToString("dd-MMM-yyyy");
                            print_pdf_line_at_center(cour_9, temp_word, 0, "cour_9");

                            pdf_top_heading = "Date                     Particulars                                  Vch Type                                   Vch No.                Debit                Credit";
                            add_pdf_top_heading(pdf_top_heading);
                            lineno = 0;
                            print_footer();
                        }
                    }
                }
                temp_word = "----------------------------------------------";
                print_pdf_line(cour_9, temp_word, 340, -10);
                temp_word = add_comma_to_number(debitamount.ToString());
                print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(320, temp_word, "cour_9_bold"), -8);
                temp_word = add_comma_to_number(creditamount.ToString());
                print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(400, temp_word, "cour_9_bold"), -16);
                if (debitamount < creditamount)
                {
                    print_pdf_line(cour_9, "By Closing Balance", 150, -6);
                    temp_word = add_comma_to_number(Math.Round((creditamount - debitamount), 2).ToString());
                    print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(320, temp_word, "cour_9_bold"), -16);
                    debitamount = creditamount;
                }
                else
                {
                    print_pdf_line(cour_9, "By Closing Balance", 150, -6);
                    temp_word = add_comma_to_number(Math.Round((debitamount - creditamount), 2).ToString());
                    print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(400, temp_word, "cour_9_bold"), -16);
                    creditamount = debitamount;
                }
                temp_word = "----------------------------------------------";
                print_pdf_line(cour_9, temp_word, 340, -10);
                temp_word = add_comma_to_number(debitamount.ToString());
                print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(320, temp_word, "cour_9_bold"), -8);
                print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(400, temp_word, "cour_9_bold"), -16);
                temp_word = "----------------------------------------------";
                print_pdf_line(cour_9, temp_word, 340, -10);
                print_footer();
                doc1.Close();
                require_header_footer = true;
            }
        }

        private void generate_full_balance_sheet_report(string mprd)
        {
            debitamount = 0;
            creditamount = 0;
            report_filetype = cbBalShAc.Text + "_" + mprd;
            trading_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
            if (chb_add_datetime_in_output.Checked)
                trading_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            trading_filename += ".pdf";
            doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
            FileStream FS1 = File.Create(trading_filename);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            pdf_top_heading = null;
            require_header_footer = false;
            Paragraph para = new Paragraph();
            for (int i = 0; i < 6; i++)
            {
                temp_word = ConnectionWithAccess.company_details[i + 1];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            }
            temp_word = "-------------------------------------------------------";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShFrom.Text).Substring(dtBalShFrom.Text.Length - 4, 4)) + 1);
            temp_word2 = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShTo.Text).Substring(dtBalShTo.Text.Length - 4, 4)) + 1);
            temp_word = "Assesment Year   #   " + temp_word + " - " + temp_word2;
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "-------------------------------------------------------";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Status : " + ConnectionWithAccess.company_details[24];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Source of Income : " + ConnectionWithAccess.company_details[14];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = ConnectionWithAccess.company_details[15];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = ConnectionWithAccess.company_details[16];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Period :" + dtBalShFrom.Text + "   -   " + dtBalShTo.Text;
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Books of Account's  : Regular Books of Account's";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "************************";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Trading Account";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "************************";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");

            StringBuilder strQuery = new StringBuilder();
            ConnectionWithAccess.query = query_contains_for_trading_account_union(mprd); ;// strQuery.ToString();
            DataTable dtNewTable = ConnectionCommand.fGetDataTable();
            if (dtNewTable != null)
            {
                move_records_upward_to_empty_places(dtNewTable);
                for (int i = 0; i < dtNewTable.Rows.Count; i++)
                {
                    if (dtNewTable.Rows[i][3].ToString() != null && dtNewTable.Rows[i][3].ToString() != "")
                    {
                        temp_word = dtNewTable.Rows[i][3].ToString();
                        print_pdf_line(cour_9, temp_word, 15, 0);
                        temp_word = dtNewTable.Rows[i][5].ToString();
                        print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -17);
                        debitamount = debitamount + Convert.ToDouble(temp_word);
                    }
                    if (dtNewTable.Rows[i][6].ToString() != null && dtNewTable.Rows[i][6].ToString() != "")
                    {
                        temp_word = dtNewTable.Rows[i][6].ToString();
                        print_pdf_line(cour_9, temp_word, 290, -17);
                        if (dtNewTable.Rows[i][8].ToString() != "")
                        {
                            temp_word = dtNewTable.Rows[i][8].ToString();
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -17);
                            creditamount = creditamount + Convert.ToDouble(temp_word);
                        }
                    }
                }
                debitamount = Math.Round(debitamount, 2);
                creditamount = Math.Round(creditamount, 2);
                if (debitamount != creditamount)
                {
                    if (debitamount > creditamount)
                    {
                        temp_word = "Gross Profit";
                        print_pdf_line(cour_9, temp_word, 15, 0);
                        temp_word = Convert.ToString(debitamount - creditamount);
                        //insertGrossAmount("719999", " ", "Gross Profit", (debitamount - creditamount));
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -17);
                        debitamount = creditamount;
                    }
                    else if (creditamount > debitamount)
                    {
                        temp_word = "Gross Loss";
                        print_pdf_line(cour_9, temp_word, 290, 0);
                        temp_word = Convert.ToString(creditamount - debitamount);
                        //insertGrossAmount(creditamount - debitamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -17);
                        creditamount = debitamount;
                    }
                }
                temp_word = "----------------";
                print_pdf_line(cour_9, temp_word, 230, -10);
                print_pdf_line(cour_9, temp_word, 500, -15);
                if (debitamount > 0)
                {
                    temp_word = Convert.ToString(debitamount);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                }
                else if (creditamount > 0)
                {
                    temp_word = Convert.ToString(creditamount);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                }
                temp_word = "=========";
                print_pdf_line(cour_9, temp_word, 230, -10);
                print_pdf_line(cour_9, temp_word, 500, -15);
            }
            skip_balance_page_in_pdf();

            // trading account finish from hear proift and loss account
            debitamount = 0;
            creditamount = 0;
            for (int i = 0; i < 6; i++)
            {
                temp_word = ConnectionWithAccess.company_details[i + 1];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            }
            temp_word = "-------------------------------------------------------";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShFrom.Text).Substring(dtBalShFrom.Text.Length - 4, 4)) + 1);
            temp_word2 = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShTo.Text).Substring(dtBalShTo.Text.Length - 4, 4)) + 1);
            temp_word = "Assesment Year   #   " + temp_word + " - " + temp_word2;
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "-------------------------------------------------------";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Status : " + ConnectionWithAccess.company_details[24];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Source of Income : " + ConnectionWithAccess.company_details[14];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = ConnectionWithAccess.company_details[15];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = ConnectionWithAccess.company_details[16];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Period :" + dtBalShFrom.Text + "   -   " + dtBalShTo.Text;
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Books of Account's  : Regular Books of Account's";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "************************";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Profit & Loss Account";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "************************";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");

            strQuery = new StringBuilder();
            ConnectionWithAccess.query = query_contains_for_profit_and_loss_account_union(mprd); ;// strQuery.ToString();
            dtNewTable = ConnectionCommand.fGetDataTable();
            if (dtNewTable != null)
            {
                move_records_upward_to_empty_places(dtNewTable);
                for (int i = 0; i < dtNewTable.Rows.Count; i++)
                {
                    if (dtNewTable.Rows[i][3].ToString() != null && dtNewTable.Rows[i][3].ToString() != "")
                    {
                        temp_word = dtNewTable.Rows[i][3].ToString();
                        print_pdf_line(cour_9, temp_word, 15, 0);
                        temp_word = dtNewTable.Rows[i][5].ToString();
                        print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -17);
                        debitamount = debitamount + Convert.ToDouble(temp_word);
                    }
                    if (dtNewTable.Rows[i][6].ToString() != null && dtNewTable.Rows[i][6].ToString() != "")
                    {
                        temp_word = dtNewTable.Rows[i][6].ToString();
                        print_pdf_line(cour_9, temp_word, 290, -17);
                        if (dtNewTable.Rows[i][8].ToString() != "")
                        {
                            temp_word = dtNewTable.Rows[i][8].ToString();
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -17);
                            creditamount = creditamount + Convert.ToDouble(temp_word);
                        }
                    }
                }
                debitamount = Math.Round(debitamount, 2);
                creditamount = Math.Round(creditamount, 2);
                if (debitamount != creditamount)
                {
                    if (debitamount > creditamount)
                    {
                        temp_word = "Net Profit";
                        print_pdf_line(cour_9, temp_word, 15, 0);
                        temp_word = Convert.ToString(debitamount - creditamount);
                        //insertGrossAmount("719999", " ", "Gross Profit", (debitamount - creditamount));
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -17);
                        debitamount = creditamount;
                    }
                    else if (creditamount > debitamount)
                    {
                        temp_word = "Net Loss";
                        print_pdf_line(cour_9, temp_word, 290, 0);
                        temp_word = Convert.ToString(creditamount - debitamount);
                        //insertGrossAmount(creditamount - debitamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -17);
                        creditamount = debitamount;
                    }
                }
                temp_word = "----------------";
                print_pdf_line(cour_9, temp_word, 230, -10);
                print_pdf_line(cour_9, temp_word, 500, -15);
                if (debitamount > 0)
                {
                    temp_word = Convert.ToString(debitamount);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                }
                else if (creditamount > 0)
                {
                    temp_word = Convert.ToString(creditamount);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                }
                temp_word = "=========";
                print_pdf_line(cour_9, temp_word, 230, -10);
                print_pdf_line(cour_9, temp_word, 500, -15);
            }
            skip_balance_page_in_pdf();
            debitamount = 0;
            creditamount = 0;
            for (int i = 0; i < 6; i++)
            {
                temp_word = ConnectionWithAccess.company_details[i + 1];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            }
            temp_word = "-------------------------------------------------------";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShFrom.Text).Substring(dtBalShFrom.Text.Length - 4, 4)) + 1);
            temp_word2 = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShTo.Text).Substring(dtBalShTo.Text.Length - 4, 4)) + 1);
            temp_word = "Assesment Year   #   " + temp_word + " - " + temp_word2;
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "-------------------------------------------------------";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Status : " + ConnectionWithAccess.company_details[24];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Source of Income : " + ConnectionWithAccess.company_details[14];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = ConnectionWithAccess.company_details[15];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = ConnectionWithAccess.company_details[16];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Period :" + dtBalShFrom.Text + "   -   " + dtBalShTo.Text;
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Books of Account's  : Regular Books of Account's";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "************************";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Capital Account";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "************************";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");

            strQuery = new StringBuilder();
            ConnectionWithAccess.query = query_contains_for_capital_account_union(mprd); ;// strQuery.ToString();
            dtNewTable = ConnectionCommand.fGetDataTable();
            if (dtNewTable != null)
            {
                move_records_upward_to_empty_places(dtNewTable);
                for (int i = 0; i < dtNewTable.Rows.Count; i++)
                {
                    if (dtNewTable.Rows[i][3].ToString() != null && dtNewTable.Rows[i][3].ToString() != "")
                    {
                        temp_word = dtNewTable.Rows[i][3].ToString();
                        print_pdf_line(cour_9, temp_word, 15, 0);
                        temp_word = dtNewTable.Rows[i][5].ToString();
                        print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -17);
                        debitamount = debitamount + Convert.ToDouble(temp_word);
                    }
                    if (dtNewTable.Rows[i][6].ToString() != null && dtNewTable.Rows[i][6].ToString() != "")
                    {
                        temp_word = dtNewTable.Rows[i][6].ToString();
                        print_pdf_line(cour_9, temp_word, 290, -17);
                        if (dtNewTable.Rows[i][8].ToString() != "")
                        {
                            temp_word = dtNewTable.Rows[i][8].ToString();
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -17);
                            creditamount = creditamount + Convert.ToDouble(temp_word);
                        }
                    }
                }
                debitamount = Math.Round(debitamount, 2);
                creditamount = Math.Round(creditamount, 2);
                if (debitamount != creditamount)
                {
                    if (debitamount > creditamount)
                    {
                        temp_word = "Difference";
                        print_pdf_line(cour_9, temp_word, 15, 0);
                        temp_word = Convert.ToString(debitamount - creditamount);
                        //insertGrossAmount("719999", " ", "Gross Profit", (debitamount - creditamount));
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -17);
                        debitamount = creditamount;
                    }
                    else if (creditamount > debitamount)
                    {
                        temp_word = "Difference";
                        print_pdf_line(cour_9, temp_word, 290, 0);
                        temp_word = Convert.ToString(creditamount - debitamount);
                        //insertGrossAmount(creditamount - debitamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -17);
                        creditamount = debitamount;
                    }
                }
                temp_word = "----------------";
                print_pdf_line(cour_9, temp_word, 230, -10);
                print_pdf_line(cour_9, temp_word, 500, -15);
                if (debitamount > 0)
                {
                    temp_word = Convert.ToString(debitamount);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                }
                else if (creditamount > 0)
                {
                    temp_word = Convert.ToString(creditamount);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                }
                temp_word = "=========";
                print_pdf_line(cour_9, temp_word, 230, -10);
                print_pdf_line(cour_9, temp_word, 500, -15);
            }
            skip_balance_page_in_pdf();
            // Capital account finish from hear Balance Sheet
            debitamount = 0;
            creditamount = 0;
            for (int i = 0; i < 6; i++)
            {
                temp_word = ConnectionWithAccess.company_details[i + 1];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            }
            temp_word = "-------------------------------------------------------";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShFrom.Text).Substring(dtBalShFrom.Text.Length - 4, 4)) + 1);
            temp_word2 = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShTo.Text).Substring(dtBalShTo.Text.Length - 4, 4)) + 1);
            temp_word = "Assesment Year   #   " + temp_word + " - " + temp_word2;
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "-------------------------------------------------------";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Status : " + ConnectionWithAccess.company_details[24];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Source of Income : " + ConnectionWithAccess.company_details[14];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = ConnectionWithAccess.company_details[15];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = ConnectionWithAccess.company_details[16];
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Period :" + dtBalShFrom.Text + "   -   " + dtBalShTo.Text;
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Books of Account's  : Regular Books of Account's";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "************************";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "Balance Sheet";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
            temp_word = "************************";
            print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");

            strQuery = new StringBuilder();
            ConnectionWithAccess.query = query_contains_for_balance_sheet_union(mprd); ;// strQuery.ToString();
            dtNewTable = ConnectionCommand.fGetDataTable();
            move_assets_inner_value_outside(dtNewTable);
            if (dtNewTable != null)
            {
                move_records_upward_to_empty_places(dtNewTable);
                for (int i = 0; i < dtNewTable.Rows.Count; i++)
                {
                    if (dtNewTable.Rows[i][3].ToString() != "")
                    {
                        temp_word = dtNewTable.Rows[i][3].ToString();
                        print_pdf_line(cour_7_bold, temp_word, 15, 0);
                        temp_word = dtNewTable.Rows[i][5].ToString();
                        print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -17);
                        debitamount = debitamount + Convert.ToDouble(temp_word);
                    }
                    if (dtNewTable.Rows[i][6].ToString() != "")
                    {
                        if (dtNewTable.Rows[i][7].ToString() != "" && dtNewTable.Rows[i][8].ToString() != "")
                        {
                            if (Convert.ToDouble(dtNewTable.Rows[i][7].ToString()) == 0 && Convert.ToDouble(dtNewTable.Rows[i][8].ToString()) == 0)
                            {
                                temp_word = dtNewTable.Rows[i][7].ToString();
                                temp_word = dtNewTable.Rows[i][8].ToString();
                            }
                            else
                            {
                                temp_word = dtNewTable.Rows[i][7].ToString();
                                temp_word = dtNewTable.Rows[i][8].ToString();
                                temp_word = dtNewTable.Rows[i][6].ToString();
                                if (dtNewTable.Rows[i][3].ToString() != "")
                                    print_pdf_line(cour_7_bold, temp_word, 290, -17);
                                else
                                    print_pdf_line(cour_7_bold, temp_word, 290, 0);
                            }
                        }
                        if (dtNewTable.Rows[i][7].ToString() != "" && dtNewTable.Rows[i][8].ToString() != "")
                        {
                            if (Convert.ToDouble(dtNewTable.Rows[i][7].ToString()) != Convert.ToDouble(dtNewTable.Rows[i][8].ToString()))
                            {
                                if (dtNewTable.Rows[i][7].ToString() != "0.00")
                                {
                                    temp_word = dtNewTable.Rows[i][7].ToString();
                                    print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(410, temp_word, "cour_9"), -17);
                                }
                            }
                        }
                        if (dtNewTable.Rows[i][8].ToString() != "" && dtNewTable.Rows[i][8].ToString() != "0")
                        {
                            temp_word = dtNewTable.Rows[i][8].ToString();
                            print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -17);
                            creditamount = creditamount + Convert.ToDouble(temp_word);
                        }
                    }
                    if (dtNewTable.Rows[i][1].ToString() != null && dtNewTable.Rows[i][1].ToString() != "")
                    {
                        if (dtNewTable.Rows[i][1].ToString() == "719999")
                        {
                            temp_int = i;
                            i = dtNewTable.Rows.Count;
                        }
                    }
                }
                debitamount = Math.Round(debitamount, 2);
                creditamount = Math.Round(creditamount, 2);
                if (debitamount != creditamount)
                {
                    if (debitamount > creditamount)
                    {
                        temp_word = "difference";
                        print_pdf_line(cour_9, temp_word, 15, 0);
                        temp_word = Convert.ToString(debitamount - creditamount);
                        //insertGrossAmount("719999", " ", "Gross Profit", (debitamount - creditamount));
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -17);
                        debitamount = creditamount;
                    }
                    else if (creditamount > debitamount)
                    {
                        temp_word = "difference";
                        print_pdf_line(cour_9, temp_word, 290, 0);
                        temp_word = Convert.ToString(creditamount - debitamount);
                        //insertGrossAmount(creditamount - debitamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -17);
                        creditamount = debitamount;
                    }
                }
                temp_word = "----------------";
                print_pdf_line(cour_9, temp_word, 230, -10);
                print_pdf_line(cour_9, temp_word, 500, -15);
                if (debitamount > 0)
                {
                    temp_word = Convert.ToString(debitamount);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                }
                else if (creditamount > 0)
                {
                    temp_word = Convert.ToString(creditamount);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                    print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                }
                temp_word = "=========";
                print_pdf_line(cour_9, temp_word, 230, -10);
                print_pdf_line(cour_9, temp_word, 500, -15);
            }
            doc1.Close();
            require_header_footer = true;
        }

        private DataTable move_records_upward_to_empty_places(DataTable dtTable)
        {
            DataTable dtTable_new = new DataTable();
            if (dtTable.Rows.Count > 0)
            {
                int temp_row_posi = 0;
                temp_int = 0;
                temp_int2 = 0;
                dtTable_new = dtTable;
                for (int i = 0; i < dtTable_new.Rows.Count; i++)
                {
                    if (dtTable_new.Rows[i][3].ToString() == "")
                    {
                        temp_int = i;
                        for (row_counter = i; row_counter < dtTable_new.Rows.Count; row_counter++)
                        {
                            if (dtTable_new.Rows[row_counter][3].ToString() != "")
                            {
                                dtTable_new.Rows[i][3] = dtTable.Rows[row_counter][3].ToString();
                                dtTable_new.Rows[i][4] = dtTable.Rows[row_counter][4].ToString();
                                dtTable_new.Rows[i][5] = dtTable.Rows[row_counter][5].ToString();
                                dtTable_new.Rows[row_counter][3] = "";
                                dtTable_new.Rows[row_counter][4] = 0;
                                dtTable_new.Rows[row_counter][5] = 0;
                                row_counter = dtTable_new.Rows.Count;
                            }
                        }
                    }
                }
                for (int i = 0; i < dtTable_new.Rows.Count; i++)
                {
                    if (dtTable_new.Rows[i][6].ToString() == "")
                    {
                        temp_int = i;
                        for (row_counter = i; row_counter < dtTable_new.Rows.Count; row_counter++)
                        {
                            if (dtTable_new.Rows[row_counter][6].ToString() != "")
                            {
                                dtTable_new.Rows[i][6] = dtTable.Rows[row_counter][6].ToString();
                                dtTable_new.Rows[i][7] = dtTable.Rows[row_counter][7].ToString();
                                dtTable_new.Rows[i][8] = dtTable.Rows[row_counter][8].ToString();
                                dtTable_new.Rows[row_counter][6] = "";
                                dtTable_new.Rows[row_counter][7] = 0;
                                dtTable_new.Rows[row_counter][8] = 0;
                                row_counter = dtTable_new.Rows.Count;
                            }
                        }
                    }
                }
                //for (int i = 0; i < dtTable_new.Rows.Count; i++)
                //{
                //    if (dtTable_new.Rows[i][4].ToString() != "")
                //        dtTable_new.Rows[i][4] =(int)Convert.ToDouble(dtTable_new.Rows[i][4].ToString()); // Math.Round(Convert.ToDouble(dtTable_new.Rows[i][4].ToString()), 0);
                //    if (dtTable_new.Rows[i][5].ToString() != "")
                //        dtTable_new.Rows[i][5] = (int)Convert.ToDouble(dtTable_new.Rows[i][5].ToString());
                //    if (dtTable_new.Rows[i][7].ToString() != "")
                //        dtTable_new.Rows[i][7] = (int)Convert.ToDouble(dtTable_new.Rows[i][7].ToString());
                //    if (dtTable_new.Rows[i][8].ToString() != "")
                //        dtTable_new.Rows[i][8] = (int)Convert.ToDouble(dtTable_new.Rows[i][8].ToString());
                //}
                //for (int i = 0; i < dtTable_new.Rows.Count; i++)
                //{
                //    if (dtTable_new.Rows[i][4].ToString() != "")
                //        dtTable_new.Rows[i][4] = Math.Floor(Convert.ToDouble(dtTable_new.Rows[i][4].ToString()));
                //    if (dtTable_new.Rows[i][5].ToString() != "")
                //        dtTable_new.Rows[i][5] = Math.Floor(Convert.ToDouble(dtTable_new.Rows[i][5].ToString()));
                //    if (dtTable_new.Rows[i][7].ToString() != "")
                //        dtTable_new.Rows[i][7] = Math.Floor(Convert.ToDouble(dtTable_new.Rows[i][7].ToString()));
                //    if (dtTable_new.Rows[i][8].ToString() != "")
                //        dtTable_new.Rows[i][8] = Math.Floor(Convert.ToDouble(dtTable_new.Rows[i][8].ToString()));
                //}
            }
            return dtTable;
        }

        private DataTable move_assets_inner_value_outside(DataTable dtTable)
        {
            DataTable dtTable_new = new DataTable();
            if (dtTable.Rows.Count != null)
            {
                temp_double = 0;
                dtTable_new = dtTable;
                for (int i = 0; i < dtTable_new.Rows.Count; i++)
                {
                    if (dtTable_new.Rows[i][1].ToString() != null)
                    {
                        if (dtTable_new.Rows[i][1].ToString().Trim() != "")
                        {
                            if (dtTable_new.Rows[i][1].ToString().Substring(0, 1) == "1")
                            {
                                if (temp_word == null && temp_word != "")
                                    temp_word = dtTable_new.Rows[i][1].ToString();
                                if (dtTable_new.Rows[i][1].ToString().Trim() != temp_word)
                                {
                                    if (i > 0)
                                    {
                                        dtTable_new.Rows[i - 1][8] = Math.Round(temp_double, 2);
                                        temp_word = dtTable_new.Rows[i][1].ToString();
                                        temp_double = Convert.ToDouble(dtTable_new.Rows[i][7].ToString());
                                        //dtNewTable.Rows[i - 1][8] = (Convert.ToDouble(dtNewTable.Rows[i + 1][7].ToString())) + temp_double;
                                    }
                                    else
                                    {
                                        dtTable_new.Rows[0][8] = Math.Round(temp_double, 2);
                                        temp_word = dtTable_new.Rows[0][1].ToString();
                                        temp_double = Convert.ToDouble(dtTable_new.Rows[i][7].ToString());
                                    }
                                }
                                else
                                {
                                    temp_double = temp_double + Convert.ToDouble(dtTable_new.Rows[i][7].ToString());
                                }
                            }
                            else if (temp_double != 0)
                            {
                                if (i > 0)
                                    dtTable_new.Rows[i - 1][8] = Math.Round(temp_double, 2);
                                temp_double = 0;
                            }
                        }
                    }
                }
            }
            dtTable = dtTable_new; ;
            return dtTable;
        }

        private void create_list_for_sale_purchase_items(string book, string mprd, int md_c, string ma_n, string ms_a, string md_n)
        {
            temporary_list_array.Clear();
            if (book == "S")
                ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd= '" + mprd + "' and d_c = " + md_c + " and d_n = " + md_n + " and amount > 0";
            else if (book == "P")
                ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " f3 where d_n = " + md_n + " and prd = '" + mprd + "' and d_c = " + md_c + " and s_a = '" + ms_a + "'";
            //ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd= '" + mprd + "' and d_c = " + md_c + " and d_n " + (md_n == string.Empty ? "is not null" : "= " + md_n) + " and a_n = '" + ma_n + "', and s_a = '" + ms_a + "' and amount > 0";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                int mcolumncount = dtData1.Columns.Count;
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temp_word = "";
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        temp_word += dtData1.Rows[iRowCount][i].ToString() + " ,";
                    }
                    temp_word = temp_word.Substring(0, temp_word.Length - 1);
                    temporary_list_array.Add(temp_word);
                }
            }
        }

        private DataTable fGetSaleDetails(string book, string mprd, int md_c, string ma_n, string ms_a, string md_n)
        {
            if (book == "S")
                ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd= '" + mprd + "' and d_c = " + md_c + " and d_n = " + md_n + " and amount > 0";
            else if (book == "P")
                ConnectionWithAccess.query = "select [type], item_code, [title], q_cs, [box], qty, price, amount,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " f3 where d_n = " + md_n + " and prd = '" + mprd + "' and d_c = " + md_c + " and s_a = '" + ms_a + "'";
            return ConnectionCommand.fGetDataTable();
        }

        private void skip_balance_page_in_pdf()
        {
            temp_int = 1000;
            var current_print_line_position = writer.GetVerticalPosition(false);
            if (current_print_line_position > 30)
            {
                for (row_counter = 0; row_counter < 100; row_counter++)
                {
                    current_print_line_position = writer.GetVerticalPosition(false);
                    if (current_print_line_position > temp_int)
                        row_counter = 100;
                    //if (current_print_line_position < 33)
                    //    row_counter = 100;
                    temp_int = Convert.ToInt32(current_print_line_position);
                    //if (row_counter != 100)
                    //{
                    para = new Paragraph();
                    para.Font = cour_7;
                    para.Add(" ");
                    para.SpacingBefore = 0;
                    doc1.Add(para);
                    //}
                }
                para = new Paragraph();
                para.Font = cour_7;
                para.Add(" ");
                para.SpacingBefore = -32;
                doc1.Add(para);
            }
        }

        private void generate_trial_balance()
        {
            if (BalShDGV.ColumnCount > 0)
            {
                report_filetype = cbBalShAc.Text + "_" + cbBalShPer.Text;
                trading_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
                if (chb_add_datetime_in_output.Checked)
                    trading_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                trading_filename += ".pdf";
                doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
                FileStream FS1 = File.Create(trading_filename);
                writer = PdfWriter.GetInstance(doc1, FS1);
                doc1.Open();
                current_pdf_page_number = 1;
                add_header_footer = true;
                header_text_message = report_filetype + " " + " From : " + dtBalShFrom.Text + " to " + dtBalShTo.Text + " (" + cbBalShPer.Text + ")";
                pdf_top_heading = ".          Discription                                                                                                 Debit                        Credit";
                Paragraph para = new Paragraph();
                int lineno = 0;
                debitamount = 0;
                creditamount = 0;
                for (row_pointer = 0; row_pointer < BalShDGV.RowCount - 1; row_pointer++)
                {
                    if (BalShDGV.Rows[row_pointer].Cells[3].Value != null && BalShDGV.Rows[row_pointer].Cells[3].Value.ToString() != "0" && BalShDGV.Rows[row_pointer].Cells[3].Value.ToString() != "")
                    {
                        temp_word = BalShDGV.Rows[row_pointer].Cells[2].Value.ToString();
                        print_pdf_line(cour_10, temp_word, 54, -5);

                        temp_word = BalShDGV.Rows[row_pointer].Cells[3].Value.ToString();
                        print_pdf_line(cour_10, temp_word, para_IndentationLeft_position(300, temp_word, "cour_10"), -15);
                        debitamount = debitamount + Convert.ToDouble(temp_word);
                        temp_word = BalShDGV.Rows[row_pointer].Cells[4].Value.ToString();
                        print_pdf_line(cour_10, temp_word, para_IndentationLeft_position(380, temp_word, "cour_10"), -15);
                        if (temp_word != "")
                            creditamount = creditamount + Convert.ToDouble(temp_word);
                    }
                    lineno++;
                }
                print_pdf_line(cour_10, "----------------", 330, -7);
                print_pdf_line(cour_10, "----------------", 410, -17);
                print_pdf_line(cour_10, debitamount.ToString(), para_IndentationLeft_position(300, debitamount.ToString(), "cour_10"), -7);
                print_pdf_line(cour_10, creditamount.ToString(), para_IndentationLeft_position(380, creditamount.ToString(), "cour_10"), -17);
                print_pdf_line(cour_10, "=========", 330, -7);
                print_pdf_line(cour_10, "=========", 410, -17);
                print_footer();
                doc1.Close();
            }
        }

        private void generate_trading_account()
        {
            if (BalShDGV.ColumnCount > 0)
            {
                report_filetype = cbBalShAc.Text + "_" + cbBalShPer.Text;
                trading_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
                if (chb_add_datetime_in_output.Checked)
                    trading_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                trading_filename += ".pdf";
                doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
                FileStream FS1 = File.Create(trading_filename);
                writer = PdfWriter.GetInstance(doc1, FS1);
                doc1.Open();
                current_pdf_page_number = 1;
                pdf_top_heading = null;
                require_header_footer = false;
                Paragraph para = new Paragraph();
                for (int i = 0; i < 6; i++)
                {
                    temp_word = ConnectionWithAccess.company_details[i + 1];
                    print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                }
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShFrom.Text).Substring(dtBalShFrom.Text.Length - 4, 4)) + 1);
                temp_word2 = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShTo.Text).Substring(dtBalShTo.Text.Length - 4, 4)) + 1);
                temp_word = "Assesment Year   #   " + temp_word + " - " + temp_word2;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Status : " + ConnectionWithAccess.company_details[24];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Source of Income : " + ConnectionWithAccess.company_details[14];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[15];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[16];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Period :" + dtBalShFrom.Text + "   -   " + dtBalShTo.Text;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Books of Account's  : Regular Books of Account's";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Trading Account";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                debitamount = 0;
                creditamount = 0;
                if (BalShDGV.Rows.Count > 0)
                {
                    for (int i = 0; i < BalShDGV.Rows.Count - 1; i++)
                    {
                        if (BalShDGV.Rows[i].Cells[3].Value != null && BalShDGV.Rows[i].Cells[3].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[3].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = BalShDGV.Rows[i].Cells[5].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -17);
                            debitamount = debitamount + Convert.ToDouble(temp_word);
                        }
                        if (BalShDGV.Rows[i].Cells[6].Value != null && BalShDGV.Rows[i].Cells[6].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[6].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            temp_word = BalShDGV.Rows[i].Cells[8].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -17);
                            creditamount = creditamount + Convert.ToDouble(temp_word);
                        }
                    }
                    debitamount = Math.Round(debitamount, 2);
                    creditamount = Math.Round(creditamount, 2);
                    if (debitamount == creditamount)
                    {
                    }
                    else
                    {
                        if (debitamount > creditamount)
                        {
                            temp_word = "Gross Profit";
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = Convert.ToString(debitamount - creditamount);
                            //insertGrossAmount("719999", " ", "Gross Profit", (debitamount - creditamount));
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -17);
                            debitamount = creditamount;
                        }
                        else if (creditamount > debitamount)
                        {
                            temp_word = "Gross Loss";
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            temp_word = Convert.ToString(creditamount - debitamount);
                            //insertGrossAmount(creditamount - debitamount);
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -17);
                            creditamount = debitamount;
                        }
                    }
                    temp_word = "----------------";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                    if (debitamount > 0)
                    {
                        temp_word = Convert.ToString(debitamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    else if (creditamount > 0)
                    {
                        temp_word = Convert.ToString(creditamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    temp_word = "=========";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                }
                doc1.Close();
                require_header_footer = true;
            }
        }

        private void generate_profit_and_loss_account()
        {
            if (BalShDGV.ColumnCount > 0)
            {
                report_filetype = cbBalShAc.Text + "_" + cbBalShPer.Text;
                trading_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
                if (chb_add_datetime_in_output.Checked)
                    trading_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                trading_filename += ".pdf";
                doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
                FileStream FS1 = File.Create(trading_filename);
                writer = PdfWriter.GetInstance(doc1, FS1);
                doc1.Open();
                current_pdf_page_number = 1;
                pdf_top_heading = null;
                require_header_footer = false;
                Paragraph para = new Paragraph();
                for (int i = 0; i < 6; i++)
                {
                    temp_word = ConnectionWithAccess.company_details[i + 1];
                    print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                }
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShFrom.Text).Substring(dtBalShFrom.Text.Length - 4, 4)) + 1);
                temp_word2 = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShTo.Text).Substring(dtBalShTo.Text.Length - 4, 4)) + 1);
                temp_word = "Assesment Year   #   " + temp_word + " - " + temp_word2;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Status : " + ConnectionWithAccess.company_details[24];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Source of Income : " + ConnectionWithAccess.company_details[14];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[15];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[16];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Period :" + dtBalShFrom.Text + "   -   " + dtBalShTo.Text;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Books of Account's  : Regular Books of Account's";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Profit & Loss Account's";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                debitamount = 0;
                creditamount = 0;
                if (BalShDGV.Rows.Count > 0)
                {
                    for (int i = 0; i < BalShDGV.Rows.Count - 1; i++)
                    {
                        if (BalShDGV.Rows[i].Cells[3].Value != null && BalShDGV.Rows[i].Cells[3].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[3].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = BalShDGV.Rows[i].Cells[5].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -17);
                            debitamount = debitamount + Convert.ToDouble(temp_word);
                        }
                        if (BalShDGV.Rows[i].Cells[6].Value != null && BalShDGV.Rows[i].Cells[6].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[6].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            temp_word = BalShDGV.Rows[i].Cells[8].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -17);
                            creditamount = creditamount + Convert.ToDouble(temp_word);
                        }
                    }
                    if (debitamount == creditamount)
                    {
                    }
                    else
                    {
                        if (debitamount == creditamount)
                        {
                            temp_word = "Net Profit";
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = Convert.ToString(debitamount - creditamount);
                            //insertGrossAmount("719999", " ", "Gross Profit", (debitamount - creditamount));
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -17);
                            debitamount = creditamount;
                        }
                        else
                        {
                            temp_word = "Net Loss";
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            temp_word = Convert.ToString(creditamount - debitamount);
                            //insertGrossAmount(creditamount - debitamount);
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -17);
                            creditamount = debitamount;
                        }
                    }
                    temp_word = "----------------";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                    if (debitamount > 0)
                    {
                        temp_word = Convert.ToString(debitamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    else if (creditamount > 0)
                    {
                        temp_word = Convert.ToString(creditamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    temp_word = "=========";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                }
                doc1.Close();
                require_header_footer = true;
            }
        }

        private void generate_capital_account()
        {
            if (BalShDGV.ColumnCount > 0)
            {
                report_filetype = cbBalShAc.Text + "_" + cbBalShPer.Text;
                trading_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
                if (chb_add_datetime_in_output.Checked)
                    trading_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                trading_filename += ".pdf";
                doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
                FileStream FS1 = File.Create(trading_filename);
                writer = PdfWriter.GetInstance(doc1, FS1);
                doc1.Open();
                current_pdf_page_number = 1;
                pdf_top_heading = null;
                require_header_footer = false;
                Paragraph para = new Paragraph();
                for (int i = 0; i < 6; i++)
                {
                    temp_word = ConnectionWithAccess.company_details[i + 1];
                    print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                }
                temp_word = "-------------------------------------------------------";
                print_pdf_line(cour_11, temp_word, 200, 0);
                temp_word = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShFrom.Text).Substring(dtBalShFrom.Text.Length - 4, 4)) + 1);
                temp_word2 = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShTo.Text).Substring(dtBalShTo.Text.Length - 4, 4)) + 1);
                temp_word = "Assesment Year   #   " + temp_word + " - " + temp_word2;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Status : " + ConnectionWithAccess.company_details[24];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Source of Income : " + ConnectionWithAccess.company_details[14];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[15];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[16];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Period :" + dtBalShFrom.Text + "   -   " + dtBalShTo.Text;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Books of Account's  : Regular Books of Account's";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Capital Account";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                debitamount = 0;
                creditamount = 0;
                if (BalShDGV.Rows.Count > 0)
                {
                    for (int i = 0; i < BalShDGV.Rows.Count; i++)
                    {
                        if (BalShDGV.Rows[i].Cells[3].Value != null)
                        {
                            if (BalShDGV.Rows[i].Cells[3].Value.ToString().Trim() != "")
                            {
                                temp_word = BalShDGV.Rows[i].Cells[3].Value.ToString().Trim();
                                print_pdf_line(cour_9, temp_word, 15, 0);
                                temp_word = BalShDGV.Rows[i].Cells[5].Value.ToString().Trim();
                                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -17);
                                debitamount = debitamount + Convert.ToDouble(temp_word);
                            }
                        }
                        if (BalShDGV.Rows[i].Cells[6].Value != null)
                        {
                            if (BalShDGV.Rows[i].Cells[6].Value.ToString().Trim() != "")
                            {
                                temp_word = BalShDGV.Rows[i].Cells[6].Value.ToString().Trim();
                                print_pdf_line(cour_9, temp_word, 290, 0);
                                temp_word = BalShDGV.Rows[i].Cells[8].Value.ToString().Trim();
                                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -17);
                                creditamount = creditamount + Convert.ToDouble(temp_word);
                            }
                        }
                    }
                    if (debitamount == creditamount)
                    {
                    }
                    else
                    {
                        if (debitamount == creditamount)
                        {
                            temp_word = "Difference";
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = Convert.ToString(debitamount - creditamount);
                            //insertGrossAmount("719999", " ", "Gross Profit", (debitamount - creditamount));
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -17);
                            debitamount = creditamount;
                        }
                        else
                        {
                            temp_word = "Difference";
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            temp_word = Convert.ToString(creditamount - debitamount);
                            //insertGrossAmount(creditamount - debitamount);
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -17);
                            creditamount = debitamount;
                        }
                    }
                    temp_word = "----------------";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                    if (debitamount > 0)
                    {
                        temp_word = Convert.ToString(debitamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    else if (creditamount > 0)
                    {
                        temp_word = Convert.ToString(creditamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    temp_word = "=========";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                }
                doc1.Close();
                require_header_footer = true;
            }
        }

        private void generate_balance_sheet_account()
        {
            if (BalShDGV.ColumnCount > 0)
            {
                report_filetype = cbBalShAc.Text + "_" + cbBalShPer.Text;
                trading_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
                if (chb_add_datetime_in_output.Checked)
                    trading_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                trading_filename += ".pdf";
                doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
                FileStream FS1 = File.Create(trading_filename);
                writer = PdfWriter.GetInstance(doc1, FS1);
                doc1.Open();
                current_pdf_page_number = 1;
                pdf_top_heading = null;
                require_header_footer = false;
                Paragraph para = new Paragraph();
                for (int i = 0; i < 6; i++)
                {
                    temp_word = ConnectionWithAccess.company_details[i + 1];
                    print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                }
                temp_word = "-------------------------------------------------------";
                print_pdf_line(cour_11, temp_word, 200, 0);
                temp_word = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShFrom.Text).Substring(dtBalShFrom.Text.Length - 4, 4)) + 1);
                temp_word2 = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShTo.Text).Substring(dtBalShTo.Text.Length - 4, 4)) + 1);
                temp_word = "Assesment Year   #   " + temp_word + " - " + temp_word2;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Status : " + ConnectionWithAccess.company_details[24];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Source of Income : " + ConnectionWithAccess.company_details[14];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[15];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[16];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Period :" + dtBalShFrom.Text + "   -   " + dtBalShTo.Text;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Books of Account's  : Regular Books of Account's";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Balance Sheet";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                debitamount = 0;
                creditamount = 0;
                if (BalShDGV.Rows.Count > 0)
                {
                    for (int i = 0; i < BalShDGV.Rows.Count; i++)
                    {
                        temp_word = null;
                        if (BalShDGV.Rows[i].Cells[3].Value != null && BalShDGV.Rows[i].Cells[3].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[3].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = BalShDGV.Rows[i].Cells[5].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -17);
                            debitamount = debitamount + Convert.ToDouble(temp_word);
                        }
                        if (BalShDGV.Rows[i].Cells[6].Value != null && BalShDGV.Rows[i].Cells[6].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[6].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            if (BalShDGV.Rows[i].Cells[7].Value != null)
                            {
                                if (BalShDGV.Rows[i].Cells[7].Value.ToString().Trim() != "")
                                {
                                    temp_word = BalShDGV.Rows[i].Cells[7].Value.ToString().Trim();
                                    print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(420, temp_word, "cour_9"), -14);
                                    //creditamount = creditamount + Convert.ToDouble(temp_word);
                                }
                            }
                            if (BalShDGV.Rows[i].Cells[8].Value != null)
                            {
                                if (BalShDGV.Rows[i].Cells[8].Value.ToString().Trim() != "")
                                {
                                    temp_word = BalShDGV.Rows[i].Cells[8].Value.ToString().Trim();
                                    print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -17);
                                    creditamount = creditamount + Convert.ToDouble(temp_word);
                                }
                            }
                        }
                    }
                    if (debitamount == creditamount)
                    {
                    }
                    else
                    {
                        if (debitamount == creditamount)
                        {
                            temp_word = "Difference";
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = Convert.ToString(debitamount - creditamount);
                            //insertGrossAmount("719999", " ", "Gross Profit", (debitamount - creditamount));
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -17);
                            debitamount = creditamount;
                        }
                        else
                        {
                            temp_word = "Difference";
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            temp_word = Convert.ToString(creditamount - debitamount);
                            //insertGrossAmount(creditamount - debitamount);
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -17);
                            creditamount = debitamount;
                        }
                    }
                    temp_word = "----------------";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                    if (debitamount > 0)
                    {
                        temp_word = Convert.ToString(debitamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    else if (creditamount > 0)
                    {
                        temp_word = Convert.ToString(creditamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    temp_word = "=========";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                }
                doc1.Close();
                require_header_footer = true;
            }
        }

        private void generate_tr_pl_capital_balance_sheet_together()
        {
            if (BalShDGV.ColumnCount > 0)
            {
                report_filetype = cbBalShAc.Text + "_" + cbBalShPer.Text;
                trading_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
                if (chb_add_datetime_in_output.Checked)
                    trading_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                trading_filename += ".pdf";
                doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
                FileStream FS1 = File.Create(trading_filename);
                writer = PdfWriter.GetInstance(doc1, FS1);
                doc1.Open();
                current_pdf_page_number = 1;
                pdf_top_heading = null;
                require_header_footer = false;
                Paragraph para = new Paragraph();
                for (int i = 0; i < 6; i++)
                {
                    temp_word = ConnectionWithAccess.company_details[i + 1];
                    print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                }
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShFrom.Text).Substring(dtBalShFrom.Text.Length - 4, 4)) + 1);
                temp_word2 = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShTo.Text).Substring(dtBalShTo.Text.Length - 4, 4)) + 1);
                temp_word = "Assesment Year   #   " + temp_word + " - " + temp_word2;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Status : " + ConnectionWithAccess.company_details[24];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Source of Income : " + ConnectionWithAccess.company_details[14];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[15];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[16];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Period :" + dtBalShFrom.Text + "   -   " + dtBalShTo.Text;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Books of Account's  : Regular Books of Account's";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Trading Account";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                debitamount = 0;
                creditamount = 0;
                if (BalShDGV.Rows.Count > 0)
                {
                    for (int i = 0; i < BalShDGV.Rows.Count - 1; i++)
                    {
                        if (BalShDGV.Rows[i].Cells[3].Value != null && BalShDGV.Rows[i].Cells[3].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[3].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = BalShDGV.Rows[i].Cells[5].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -17);
                            debitamount = debitamount + Convert.ToDouble(temp_word);
                        }
                        if (BalShDGV.Rows[i].Cells[6].Value != null && BalShDGV.Rows[i].Cells[6].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[6].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            if (BalShDGV.Rows[i].Cells[8].Value != "")
                            {
                                temp_word = BalShDGV.Rows[i].Cells[8].Value.ToString().Trim();
                                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -17);
                                creditamount = creditamount + Convert.ToDouble(temp_word);
                            }
                        }
                        if (BalShDGV.Rows[i].Cells[1].Value != null && BalShDGV.Rows[i].Cells[1].Value != "")
                        {
                            if (BalShDGV.Rows[i].Cells[1].Value.ToString() == "719999")
                            {
                                temp_int = i;
                                i = BalShDGV.Rows.Count;
                            }
                        }
                    }
                    debitamount = Math.Round(debitamount, 2);
                    creditamount = Math.Round(creditamount, 2);
                    if (debitamount == creditamount)
                    {
                    }
                    else
                    {
                        if (debitamount > creditamount)
                        {
                            temp_word = "Gross Profit";
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = Convert.ToString(debitamount - creditamount);
                            //insertGrossAmount("719999", " ", "Gross Profit", (debitamount - creditamount));
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -17);
                            debitamount = creditamount;
                        }
                        else if (creditamount > debitamount)
                        {
                            temp_word = "Gross Loss";
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            temp_word = Convert.ToString(creditamount - debitamount);
                            //insertGrossAmount(creditamount - debitamount);
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -17);
                            creditamount = debitamount;
                        }
                    }
                    temp_word = "----------------";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                    if (debitamount > 0)
                    {
                        temp_word = Convert.ToString(debitamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    else if (creditamount > 0)
                    {
                        temp_word = Convert.ToString(creditamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    temp_word = "=========";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                }

                skip_balance_page_in_pdf();
                // trading account finish from hear proift and loss account

                for (int i = 0; i < 6; i++)
                {
                    temp_word = ConnectionWithAccess.company_details[i + 1];
                    print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                }
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShFrom.Text).Substring(dtBalShFrom.Text.Length - 4, 4)) + 1);
                temp_word2 = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShTo.Text).Substring(dtBalShTo.Text.Length - 4, 4)) + 1);
                temp_word = "Assesment Year   #   " + temp_word + " - " + temp_word2;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Status : " + ConnectionWithAccess.company_details[24];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Source of Income : " + ConnectionWithAccess.company_details[14];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[15];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[16];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Period :" + dtBalShFrom.Text + "   -   " + dtBalShTo.Text;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Books of Account's  : Regular Books of Account's";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Profit & Loss Account";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                debitamount = 0;
                creditamount = 0;
                if (BalShDGV.Rows.Count > 0)
                {
                    for (int i = temp_int + 1; i < BalShDGV.Rows.Count - 1; i++)
                    {
                        if (BalShDGV.Rows[i].Cells[3].Value != null && BalShDGV.Rows[i].Cells[3].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[3].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = BalShDGV.Rows[i].Cells[5].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -17);
                            debitamount = debitamount + Convert.ToDouble(temp_word);
                        }
                        if (BalShDGV.Rows[i].Cells[6].Value != null && BalShDGV.Rows[i].Cells[6].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[6].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            if (BalShDGV.Rows[i].Cells[8].Value != "")
                            {
                                temp_word = BalShDGV.Rows[i].Cells[8].Value.ToString().Trim();
                                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -17);
                                creditamount = creditamount + Convert.ToDouble(temp_word);
                            }
                        }
                        if (BalShDGV.Rows[i].Cells[1].Value != null && BalShDGV.Rows[i].Cells[1].Value != "")
                        {
                            if (BalShDGV.Rows[i].Cells[1].Value.ToString() == "7998")
                            {
                                temp_int = i;
                                i = BalShDGV.Rows.Count;
                            }
                        }
                    }
                    debitamount = Math.Round(debitamount, 2);
                    creditamount = Math.Round(creditamount, 2);
                    if (debitamount == creditamount)
                    {
                    }
                    else
                    {
                        if (debitamount > creditamount)
                        {
                            temp_word = "Net Profit";
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = Convert.ToString(debitamount - creditamount);
                            //insertGrossAmount("719999", " ", "Gross Profit", (debitamount - creditamount));
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -17);
                            debitamount = creditamount;
                        }
                        else if (creditamount > debitamount)
                        {
                            temp_word = "Net Loss";
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            temp_word = Convert.ToString(creditamount - debitamount);
                            //insertGrossAmount(creditamount - debitamount);
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -17);
                            creditamount = debitamount;
                        }
                    }
                    temp_word = "----------------";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                    if (debitamount > 0)
                    {
                        temp_word = Convert.ToString(debitamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    else if (creditamount > 0)
                    {
                        temp_word = Convert.ToString(creditamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    temp_word = "=========";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                }
                skip_balance_page_in_pdf();
                // profit & loss Account finish from hear capital account


                for (int i = 0; i < 6; i++)
                {
                    temp_word = ConnectionWithAccess.company_details[i + 1];
                    print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                }
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShFrom.Text).Substring(dtBalShFrom.Text.Length - 4, 4)) + 1);
                temp_word2 = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShTo.Text).Substring(dtBalShTo.Text.Length - 4, 4)) + 1);
                temp_word = "Assesment Year   #   " + temp_word + " - " + temp_word2;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Status : " + ConnectionWithAccess.company_details[24];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Source of Income : " + ConnectionWithAccess.company_details[14];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[15];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[16];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Period :" + dtBalShFrom.Text + "   -   " + dtBalShTo.Text;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Books of Account's  : Regular Books of Account's";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Capital Account";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                debitamount = 0;
                creditamount = 0;
                if (BalShDGV.Rows.Count > 0)
                {
                    for (int i = temp_int + 1; i < BalShDGV.Rows.Count - 1; i++)
                    {
                        if (BalShDGV.Rows[i].Cells[3].Value != null && BalShDGV.Rows[i].Cells[3].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[3].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = BalShDGV.Rows[i].Cells[5].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -17);
                            debitamount = debitamount + Convert.ToDouble(temp_word);
                        }
                        if (BalShDGV.Rows[i].Cells[6].Value != null && BalShDGV.Rows[i].Cells[6].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[6].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            if (BalShDGV.Rows[i].Cells[8].Value != "")
                            {
                                temp_word = BalShDGV.Rows[i].Cells[8].Value.ToString().Trim();
                                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -17);
                                creditamount = creditamount + Convert.ToDouble(temp_word);
                            }
                        }
                        if (BalShDGV.Rows[i].Cells[1].Value != null && BalShDGV.Rows[i].Cells[1].Value != "")
                        {
                            if (BalShDGV.Rows[i].Cells[1].Value.ToString() == "3001" && BalShDGV.Rows[i].Cells[2].Value.ToString() == "@@@")
                            {
                                temp_int = i;
                                i = BalShDGV.Rows.Count;
                            }
                        }
                    }
                    debitamount = Math.Round(debitamount, 2);
                    creditamount = Math.Round(creditamount, 2);
                    if (debitamount == creditamount)
                    {
                    }
                    else
                    {
                        if (debitamount > creditamount)
                        {
                            temp_word = "Difference";
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = Convert.ToString(debitamount - creditamount);
                            //insertGrossAmount("719999", " ", "Gross Profit", (debitamount - creditamount));
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -17);
                            debitamount = creditamount;
                        }
                        else if (creditamount > debitamount)
                        {
                            temp_word = "Difference";
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            temp_word = Convert.ToString(creditamount - debitamount);
                            //insertGrossAmount(creditamount - debitamount);
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -17);
                            creditamount = debitamount;
                        }
                    }
                    temp_word = "----------------";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                    if (debitamount > 0)
                    {
                        temp_word = Convert.ToString(debitamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    else if (creditamount > 0)
                    {
                        temp_word = Convert.ToString(creditamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    temp_word = "=========";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                }

                skip_balance_page_in_pdf();
                //capital account account finish from hear Balance Sheet


                for (int i = 0; i < 6; i++)
                {
                    temp_word = ConnectionWithAccess.company_details[i + 1];
                    print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                }
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShFrom.Text).Substring(dtBalShFrom.Text.Length - 4, 4)) + 1);
                temp_word2 = Convert.ToString(Convert.ToInt32(Convert.ToString(dtBalShTo.Text).Substring(dtBalShTo.Text.Length - 4, 4)) + 1);
                temp_word = "Assesment Year   #   " + temp_word + " - " + temp_word2;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "-------------------------------------------------------";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Status : " + ConnectionWithAccess.company_details[24];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Source of Income : " + ConnectionWithAccess.company_details[14];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[15];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = ConnectionWithAccess.company_details[16];
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Period :" + dtBalShFrom.Text + "   -   " + dtBalShTo.Text;
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Books of Account's  : Regular Books of Account's";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "Balance Sheet Account";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                temp_word = "************************";
                print_pdf_line_at_center(cour_11, temp_word, 0, "cour_11");
                debitamount = 0;
                creditamount = 0;
                if (BalShDGV.Rows.Count > 0)
                {
                    for (int i = temp_int + 1; i < BalShDGV.Rows.Count - 1; i++)
                    {
                        if (BalShDGV.Rows[i].Cells[3].Value != null && BalShDGV.Rows[i].Cells[3].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[3].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = BalShDGV.Rows[i].Cells[5].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -17);
                            debitamount = debitamount + Convert.ToDouble(temp_word);
                        }
                        if (BalShDGV.Rows[i].Cells[6].Value != null && BalShDGV.Rows[i].Cells[6].Value.ToString() != "")
                        {
                            temp_word = BalShDGV.Rows[i].Cells[6].Value.ToString().Trim();
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            if (BalShDGV.Rows[i].Cells[8].Value != "")
                            {
                                temp_word = BalShDGV.Rows[i].Cells[8].Value.ToString().Trim();
                                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9"), -17);
                                creditamount = creditamount + Convert.ToDouble(temp_word);
                            }
                        }
                        //if (BalShDGV.Rows[i].Cells[1].Value != null && BalShDGV.Rows[i].Cells[1].Value != "")
                        //{
                        //    if (BalShDGV.Rows[i].Cells[1].Value.ToString() == "3001" && BalShDGV.Rows[i].Cells[2].Value.ToString() == "@@@")
                        //    {
                        //        temp_int = i;
                        //        i = BalShDGV.Rows.Count;
                        //    }
                        //}
                    }
                    debitamount = Math.Round(debitamount, 2);
                    creditamount = Math.Round(creditamount, 2);
                    if (debitamount == creditamount)
                    {
                    }
                    else
                    {
                        if (debitamount > creditamount)
                        {
                            temp_word = "Difference";
                            print_pdf_line(cour_9, temp_word, 15, 0);
                            temp_word = Convert.ToString(debitamount - creditamount);
                            //insertGrossAmount("719999", " ", "Gross Profit", (debitamount - creditamount));
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -17);
                            debitamount = creditamount;
                        }
                        else if (creditamount > debitamount)
                        {
                            temp_word = "Difference";
                            print_pdf_line(cour_9, temp_word, 290, 0);
                            temp_word = Convert.ToString(creditamount - debitamount);
                            //insertGrossAmount(creditamount - debitamount);
                            print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -17);
                            creditamount = debitamount;
                        }
                    }
                    temp_word = "----------------";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                    if (debitamount > 0)
                    {
                        temp_word = Convert.ToString(debitamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    else if (creditamount > 0)
                    {
                        temp_word = Convert.ToString(creditamount);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9_red"), -10);
                        print_pdf_line(cour_9_red, temp_word, para_IndentationLeft_position(470, temp_word, "cour_9_red"), -15);
                    }
                    temp_word = "=========";
                    print_pdf_line(cour_9, temp_word, 230, -10);
                    print_pdf_line(cour_9, temp_word, 500, -15);
                }
                doc1.Close();
                require_header_footer = true;
            }
        }

        public static int para_IndentationLeft_position(int position, string value, string font)
        {
            //if (Convert.ToDouble(value) == 0.00)
            //    position += 0;
            //  we have to add 75 in all position to make it in correct position.
            if (value == "" || value == null) { value = " "; }
            if (font.Substring(0, 6) == "cour_7")
            {
                var cellArray = ("80,74,69,65,61,57,53,50,46,42,38,34,30,26,22,18,14,4,-1,-6,-11,-16,-21,-26,-31,-39,-48").Split(new[] { ',' });
                position = position + Convert.ToInt32(cellArray[value.Length]);
            }
            else if (font.Substring(0, 6) == "cour_9")
            {
                var cellArray = ("80,74,69,64,59,54,49,45,39,34,29,24,19,14,9,4,-1,-6,-11,-16,-21,-26,-31, -40").Split(new[] { ',' });
                position = position + Convert.ToInt32(cellArray[value.Length]);
            }
            else if (font.Substring(0, 7) == "cour_10")
            {
                var cellArray = ("80,74,69,64,58,52,47,41,36,30,25,19,14,8,7,4,-1,-6,-11,-16,-21,-26,-31").Split(new[] { ',' });
                position = position + Convert.ToInt32(cellArray[value.Length]);
            }
            else if (font.Substring(0, 7) == "cour_11")
            {
                var cellArray = ("0,74,68,62,56,50,44,37,31,25,19,13,6,0,-5,-12,-18, -24, -30 , -36").Split(new[] { ',' });
                position = position + Convert.ToInt32(cellArray[value.Length]);
            }
            else if (font.Substring(0, 7) == "cour_15")
            {
                var cellArray = ("0,72,61,53,45,36,29,20,11,4,-5,-14,-22,-31,-39,-48").Split(new[] { ',' });
                position = position + Convert.ToInt32(cellArray[value.Length]);
            }
            else if (font.Substring(0, 7) == "cour_20")
            {
                var cellArray = ("0,67,56,45,35,24,13,1,-11,-22,-33,-44,-55,-66,-77,-88").Split(new[] { ',' });
                position = position + Convert.ToInt32(cellArray[value.Length]);
            }
            return position;
        }
        # endregion

        private void atbexport_Click(object sender, EventArgs e)
        {
            function_working = "export";
            export.email_subject = null;
            if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
            {
                print_sale_invoice();
                pdf_invoice.BringToFront();
                pdf_invoice.Visible = true;
                pdf_filename = msalepdf;
                export.email_subject = "Sale Invoice";
            }
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 1)
            {
                pdf_filename = ledger_filename;
                export.email_subject = "Ledger Report";
                export.email_id = account_detail_from_04[10];
            }
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Trial Balance Report")
                pdf_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Trading Account")
                pdf_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Profit and Loss Account")
                pdf_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Capital Account")
                pdf_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Balance Sheet")
                pdf_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Tr_Pl_Ca_Blst")
                pdf_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "GP/NP Calculation")
                pdf_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Balance sheet Summary")
                pdf_filename = trading_filename;
            if (pdf_filename != null && pdf_filename != "")
            {
                export exportscreen = new export();
                exportscreen.Show();
                Application.DoEvents();
                pdf_filename = null;
                if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
                    pdf_filename = msalepdf;
                else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 1)
                    pdf_filename = ledger_filename;
                else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Trial Balance Report")
                    pdf_filename = trading_filename;
                else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Trading Account")
                    pdf_filename = trading_filename;
                else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Profit and Loss Account")
                    pdf_filename = trading_filename;
                else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Capital Account")
                    pdf_filename = trading_filename;
                else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Balance Sheet")
                    pdf_filename = trading_filename;
                else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Tr_Pl_Ca_Blst")
                    pdf_filename = trading_filename;
                else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "GP/NP Calculation")
                    pdf_filename = trading_filename;
                else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Balance sheet Summary")
                    pdf_filename = trading_filename;
            }
            else
                MessageBox.Show("No Report Selected for Display");
            pdf_filename = ConnectionWithAccess.remove_filename_error(pdf_filename);
        }

        private void atbpreview_Click(object sender, EventArgs e)
        {
            //          PrintController = New StandardPrintController

            //printDocument1.PrintController = new System.Drawing.Printing.StandardPrintController();
            function_working = "Preview";
            if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
            {
                print_sale_invoice();
                report_filename = msalepdf;
            }
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 0)
                report_filename = pdf_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 1)
                report_filename = ledger_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Trial Balance Report")
                report_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Trading Account")
                report_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Profit and Loss Account")
                report_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Capital Account")
                report_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Balance Sheet")
                report_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Tr_Pl_Ca_Blst")
                report_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "GP/NP Calculation")
                report_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2 && cbBalShAc.Text == "Balance sheet Summary")
                report_filename = trading_filename;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 7)
                report_filename = pdf_filename;
            else if (maintab.SelectedIndex == 4 && subtabsettings.SelectedIndex == 2)
            {
                generate_company_details_pdf();
                report_filename = pdf_filename;
            }
            if (report_filename != null && File.Exists(report_filename))
            {
                if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
                {
                    //print_sale_invoice();
                }
                else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 0)
                {
                    Generate.Visible = false;
                    pdf_viewer1.Visible = true;
                    pdf_viewer2.Visible = false;
                    pdf_viewer3.Visible = false;
                    pdf_viewer1.BringToFront();
                    pdf_viewer1.LoadFile(report_filename);
                }
                else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 1)
                {
                    btn_gen_ledg.Visible = false;
                    pdf_viewer1.Visible = false;
                    pdf_viewer2.Visible = true;
                    pdf_viewer3.Visible = false;
                    pdf_viewer2.BringToFront();
                    pdf_viewer2.LoadFile(report_filename);
                }
                else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2)
                {
                    trading_report_generate.Visible = false;
                    pdf_viewer1.Visible = false;
                    pdf_viewer2.Visible = false;
                    pdf_viewer3.Visible = true;
                    pdf_viewer3.BringToFront();
                    pdf_viewer3.LoadFile(report_filename);
                }
                else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 7)
                {
                    pdf_viewer_report_outstanding.Visible = true;
                    pdf_viewer_report_outstanding.BringToFront();
                    pdf_viewer_report_outstanding.LoadFile(report_filename);
                }
                else if (maintab.SelectedIndex == 4 && subtabsettings.SelectedIndex == 2)
                {
                    pdf_viewer_company_details.Location = new System.Drawing.Point(0, 0);
                    pdf_viewer_company_details.Size = new System.Drawing.Size(1300, 500);
                    pdf_viewer_company_details.Visible = true;
                    pdf_viewer_company_details.BringToFront();
                    pdf_viewer_company_details.LoadFile(report_filename);
                }
                else
                    MessageBox.Show("No Report Selected for Display");
            }
            else
                MessageBox.Show("No Report Selected for Display");
        }

        private void atbcancel_Click(object sender, EventArgs e)
        {
            if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
                msalepdf = null;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 0)
                pdf_filename = null;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 1)
                ledger_filename = null;
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2)
                trading_filename = null;
            report_filename = null;
            pdf_filename = null;
            pdf_viewer1.Visible = false;
            pdf_viewer2.Visible = false;
            pdf_viewer3.Visible = false;
            pdf_viewer_report_outstanding.Visible = false;
            pdf_invoice.Visible = false;
            Generate.Visible = true;
            btn_gen_ledg.Visible = true;
            trading_report_generate.Visible = true;
            btn_gen_ledg.Visible = true;
            btnGenerateOutstandingReport.Visible = true;
            cb_all_sale_item_list.Visible = true;
            cb_all_sale_invoice_list.Visible = true;
            cb_all_sale_invoice_ledger.Visible = true;
            if (maintab.SelectedIndex == 2 && subtabMasters.SelectedIndex == 0)
                vDeleteAccount(); //Delete Account
            else if (maintab.SelectedIndex == 2 && subtabMasters.SelectedIndex == 1)
                vDeleteItem(); //Delete Item
            else if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 3)
                gst_report_pdf_viewer.Visible = false;
            else if (maintab.SelectedIndex == 4 && subtabsettings.SelectedIndex == 0)
            {
                if (tbUserName.Text.ToLower() != "admin")
                {
                    ConnectionWithAccess.query = "Delete from " + ConnectionWithAccess.tablename[52] + " where [f1] = '" + tbUserName.Text.Trim() + "' ";
                    ConnectionCommand.fUpdateInsertDeleteData();
                    refresh_UserListDG();
                }
            }
            else if (maintab.SelectedIndex == 4 && subtabsettings.SelectedIndex == 2)
                pdf_viewer_company_details.Visible = false;
        }

        private double get_account_balance_from_51(string prd, string a_n, string s_a)
        {
            temp_double = 0;
            isRecord = 0;
            if (a_n.Length > 1)
            {
                if (a_n.Substring(0, 1) == "%")
                {
                    list_of_balance_amount.Clear();
                    a_n = a_n.Substring(1, a_n.Length - 1);
                    if (s_a == "@@@")
                        ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + prd + "' and a_n like '" + a_n + "%' and s_a = '@@@'";
                    else
                        ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + prd + "' and a_n = '" + a_n + "' and s_a like '" + s_a + "%'";
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                        {
                            list_of_balance_amount.Add(dtData1.Rows[iRowCount][0].ToString());
                        }
                        temp_double = 0;
                        for (int i = 0; i < list_of_balance_amount.Count; i++)
                        {
                            temp_double = temp_double + Convert.ToDouble(list_of_balance_amount[i]);
                        }
                    }
                }
                else
                {
                    if (s_a == "@@@")
                        ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + prd + "' and a_n = '" + a_n + "' and s_a = '@@@'";
                    else
                        ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + prd + "' and a_n = '" + a_n + "' and s_a = '" + s_a + "'";
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        if (dtData1.Rows[0][0] != null)
                        {
                            temp_double = Convert.ToDouble(dtData1.Rows[0][0].ToString());
                        }
                    }
                }
            }
            return temp_double;
        }

        private double get_current_period_opening_balance_from_51(string a_n, string s_a)
        {
            temp_double = 0;
            isRecord = 0;
            if (a_n.Length > 1)
            {
                if (s_a == "@@@")
                    ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + ConnectionWithAccess.moprd + "' and a_n = '" + a_n + "' and s_a='@@@'";
                else
                    ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + ConnectionWithAccess.moprd + "' and a_n = '" + a_n + "' and s_a = '" + s_a + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        temp_double = Convert.ToDouble(dtData1.Rows[0][0].ToString());
                    }
                }
            }
            return temp_double;
        }

        private double calculate_account_balance(string ma_n, string ms_a, string menddateitme)
        {
            if (ma_n != "" && ms_a != "" && menddateitme != "")
            {
                temp_word = "";
                //LedDGV.Visible = true;
                ConnectionWithAccess.query = query_contains_for_ledger_account_union(ma_n, ms_a, menddateitme);
                DataTable dtNewTable = ConnectionCommand.fGetDataTable();
                //contains_for_ledger_account_union(ma_n, ms_a, menddateitme);

                if (dtNewTable != null)
                {
                    if (dtNewTable.Rows.Count == 1)
                    {
                        if (dtNewTable.Rows[0][6].ToString() != "0.00")
                            temp_double = Convert.ToDouble(dtNewTable.Rows[0][6].ToString());
                        else if (dtNewTable.Rows[0][7].ToString() != "0.00")
                            temp_double = Convert.ToDouble(dtNewTable.Rows[0][7].ToString());
                        else if (dtNewTable.Rows[0][8].ToString() != "0.00")
                            temp_double = Convert.ToDouble(dtNewTable.Rows[0][8].ToString());
                    }
                    else
                    {
                        //if (cb_ledger_full_period.Checked == false)
                        //{
                        //    if (Convert.ToDateTime(Ledfrom.Text) > Convert.ToDateTime(ConnectionWithAccess.com_start_date))
                        //        delete_old_date_record_datatable(dtNewTable, 3, menddateitme);
                        //}

                        DataView view = new DataView(dtNewTable);
                        view.Sort = "[Date] asc";
                        DataTable dtNewTable1 = view.ToTable();

                        DataTable sortedTable = update_datatable_balances(dtNewTable1, 6, 7, 8);

                        string strTotalCol1 = getTotal_Datatable(sortedTable, 6);
                        string strTotalCol2 = getTotal_Datatable(sortedTable, 7);

                        if (!string.IsNullOrEmpty(strTotalCol1) && !string.IsNullOrEmpty(strTotalCol2))
                        {
                            DataRow drTotalRow = sortedTable.NewRow();
                            drTotalRow[6] = strTotalCol1;
                            drTotalRow[7] = strTotalCol2;
                            sortedTable.Rows.Add(drTotalRow);
                        }

                        if (sortedTable.Rows.Count > 2)
                        {
                            temp_double = Convert.ToDouble(sortedTable.Rows[sortedTable.Rows.Count - 2][8].ToString());
                        }
                    }
                }
            }
            return temp_double;
        }

        private string query_contains_for_bank_balance_union(int md_c, string ma_n, string end_date)
        {
            StringBuilder strQuery = new StringBuilder();
            strQuery.Append(" select #" + ConnectionWithAccess.msdate + "# as [PASS_DATE],0 as [d_n],  'Opening Balance' as [desc], '' as [city], f51.amt as [amt], 0 as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[51] + " f51 where f51.prd = '" + ConnectionWithAccess.moprd + "' and f51.a_n = '" + ma_n + "' and d_d = #01-01-1901# and f51.s_a = '@@@' union all");
            strQuery.Append(" select f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt as [amt], 0 as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt > 0 and r_p = '1' and f23.d_c = " + md_c + " and f23.a_n <> '7999' union all ");
            strQuery.Append(" select f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city, f23.bamt as [amt], 0 as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt > 0 and r_p = '2' and f23.d_c = " + md_c + " and f23.a_n <> '7999' union all ");
            strQuery.Append(" select f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city,  0 as [amt], (f23.bamt * -1) as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt < 0 and r_p = '3' and f23.d_c = " + md_c + " and f23.a_n <> '7999' union all ");
            strQuery.Append(" select f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city,  0 as [amt], (f23.bamt * -1) as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt < 0 and r_p = '4' and f23.d_c = " + md_c + " and f23.a_n <> '7999' union all ");
            strQuery.Append(" select f23.PASS_DATE, f23.D_N, 'CASH DEPOSITED IN BANK' as [Desc], '',  f23.bamt as [amt], 0 as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt > 0 and r_p = '1' and f23.d_c = " + md_c + " and f23.a_n = '7999' and f23.s_a = 'DEP' union all ");
            strQuery.Append(" select f23.PASS_DATE, f23.D_N, 'CASH WITHDRAWN FROM BANK' as [Desc], '',  0 as [amt], (f23.bamt * -1) as [pay_amt], 0 as [balance_amt] from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and f23.bamt < 0 and r_p = '3' and f23.d_c = " + md_c + " and f23.a_n = '7999' and f23.s_a = 'WIT' union all ");
            strQuery.Append(" select f23.PASS_DATE, f23.D_N, f1.[desc] as [Desc], f1.city, (f23.bamt * -1) as [amt], 0 as [pay_amt], 0 as [balance_amt] from  " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[23] + " f23 where f1.a_n = f23.a_n and f1.s_a = f23.s_a and f23.b_t = '3' and f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.pass_date >= @From and f23.pass_date <= @To and r_p = '4' and f23.tran_d_c = " + md_c);
            List<ConnectionWithAccess.QueryParams> objParams = new List<ConnectionWithAccess.QueryParams>();
            ConnectionWithAccess.QueryParams ParamFrom = new ConnectionWithAccess.QueryParams();
            ParamFrom.paramName = "@From";
            ParamFrom.paramValue = Convert.ToDateTime(end_date);
            objParams.Add(ParamFrom);
            ConnectionWithAccess.QueryParamList = objParams;
            //add_user_date_time_function_compulsory_program();
            return strQuery.ToString();
        }

        private double calculate_bank_balance(int md_c, string ma_n, string menddateitme)
        {
            if (ma_n != "" && menddateitme != "")
            {
                if (menddateitme.Contains(" "))
                    menddateitme = menddateitme.Substring(0, menddateitme.IndexOf(" "));
                temp_word = "";
                //LedDGV.Visible = true;
                ConnectionWithAccess.query = query_contains_for_bank_balance_union(md_c, ma_n, menddateitme);
                DataTable dtNewTable = ConnectionCommand.fGetDataTable();
                //contains_for_ledger_account_union(ma_n, ms_a, menddateitme);

                if (dtNewTable != null)
                {
                    if (dtNewTable.Rows.Count == 1)
                    {
                        if (dtNewTable.Rows[0][6].ToString() != "0.00")
                            temp_double = Convert.ToDouble(dtNewTable.Rows[0][6].ToString());
                        else if (dtNewTable.Rows[0][7].ToString() != "0.00")
                            temp_double = Convert.ToDouble(dtNewTable.Rows[0][7].ToString());
                        else if (dtNewTable.Rows[0][8].ToString() != "0.00")
                            temp_double = Convert.ToDouble(dtNewTable.Rows[0][8].ToString());
                    }
                    //    else
                    //    {
                    //        if (cb_ledger_full_period.Checked == false)
                    //        {
                    //            if (Convert.ToDateTime(Ledfrom.Text) > Convert.ToDateTime(ConnectionWithAccess.com_start_date))
                    //                delete_old_date_record_datatable(dtNewTable, 3, menddateitme);
                    //        }

                    //        DataView view = new DataView(dtNewTable);
                    //        view.Sort = "[Date] asc";
                    //        DataTable dtNewTable1 = view.ToTable();

                    //        DataTable sortedTable = update_datatable_balances(dtNewTable1, 6, 7, 8);

                    //        string strTotalCol1 = getTotal_Datatable(sortedTable, 6);
                    //        string strTotalCol2 = getTotal_Datatable(sortedTable, 7);

                    //        if (!string.IsNullOrEmpty(strTotalCol1) && !string.IsNullOrEmpty(strTotalCol2))
                    //        {
                    //            DataRow drTotalRow = sortedTable.NewRow();
                    //            drTotalRow[6] = strTotalCol1;
                    //            drTotalRow[7] = strTotalCol2;
                    //            sortedTable.Rows.Add(drTotalRow);
                    //        }

                    //        if (sortedTable.Rows.Count > 2)
                    //        {
                    //            temp_double = Convert.ToDouble(sortedTable.Rows[sortedTable.Rows.Count - 2][8].ToString());
                    //        }
                    //    }
                }
            }
            return temp_double;
        }

        private void btn_gen_ledg_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data");
            objPleaseWait.Show();
            Application.DoEvents();
            if (function_working != "Item Ledger")
            {
                LedDGV.Visible = true;
                contains_for_ledger_account_union(rla_n.Text, rls_a.Text, (LedTo.Value).ToString());
                if (LedDGV.Columns.Count > 1)
                {
                    if (LedDGV.Rows.Count > 0)
                    {
                        if (cmbDateRangeLedger.Text != "Full Period")
                        {
                            if (Convert.ToDateTime(Ledfrom.Text) > Convert.ToDateTime(ConnectionWithAccess.com_start_date))
                            {
                                LedDGV.Visible = false;
                                delete_old_date_record(LedDGV, 3, Ledfrom.Text);
                            }
                        }
                        DataTable dtNewTable = ((DataTable)LedDGV.DataSource).Clone();

                        dtNewTable = ((DataTable)LedDGV.DataSource);

                        //DataTable selected = view.ToTable(false, "amt");

                        if (dtNewTable != null)
                        {
                            DataView view = new DataView(dtNewTable);
                            view.Sort = "[Date] asc";
                            DataTable dtNewTable1 = view.ToTable();
                            for (int i = dtNewTable1.Rows.Count - 1; i >= 0; i--)
                            {
                                DataRow dr = dtNewTable1.Rows[i];
                                if (dr["debit"].ToString() == "0" && dr["credit"].ToString() == "0" && dr["balance"].ToString() == "0")
                                    dr.Delete();
                            }


                            //DataTable dtNewTable1 = ((DataTable)LedDGV.DataSource).Clone();

                            DataTable sortedTable = update_datatable_balances(dtNewTable1, 6, 7, 8);

                            string strTotalCol1 = getTotal_Datatable(sortedTable, 6);
                            string strTotalCol2 = getTotal_Datatable(sortedTable, 7);

                            if (!string.IsNullOrEmpty(strTotalCol1) && !string.IsNullOrEmpty(strTotalCol2))
                            {
                                DataRow drTotalRow = sortedTable.NewRow();
                                drTotalRow[6] = strTotalCol1;
                                drTotalRow[7] = strTotalCol2;
                                sortedTable.Rows.Add(drTotalRow);
                            }

                            LedDGV.DataSource = null;
                            LedDGV.DataSource = sortedTable;// dtNewTable.DefaultView;
                        }
                        ConnectionCommand.hide_columns_of_datagridview(LedDGV, "0,1,2");
                        LedDGV.FirstDisplayedScrollingRowIndex = LedDGV.Rows.Count - 2;
                        LedDGV.Visible = true;
                        excel_filename = "Ledger of_" + tb_ledger_account_name.Text.Trim() + "_" + rla_n.Text + "_" + rls_a.Text + "_as on_" + ConnectionWithAccess.mprd;
                        ledger_filename = excel_filename;
                        ConnectionWithAccess.export(LedDGV, excel_filename);
                        generate_ledger_report();
                    }
                }
                tb_ledger_account_name.Focus();
            }
            else
            {
                LedDGV.Visible = true;
                contains_for_ledger_item_union(ledger_type.Text, ledger_item_code.Text, (LedTo.Value).ToString());
                if (LedDGV.Columns.Count > 1)
                {
                    if (LedDGV.Rows.Count > 0)
                    {
                        if (cmbDateRangeLedger.Text != "Full Period")
                        {
                            if (Convert.ToDateTime(Ledfrom.Text) > Convert.ToDateTime(ConnectionWithAccess.com_start_date))
                                delete_old_date_record(LedDGV, 3, Ledfrom.Text);
                        }
                        DataTable dtNewTable = ((DataTable)LedDGV.DataSource).Clone();

                        dtNewTable = ((DataTable)LedDGV.DataSource);

                        //DataTable selected = view.ToTable(false, "amt");

                        if (dtNewTable != null)
                        {
                            DataView view = new DataView(dtNewTable);
                            view.Sort = "[Date] asc";
                            DataTable dtNewTable1 = view.ToTable();

                            //DataTable dtNewTable1 = ((DataTable)LedDGV.DataSource).Clone();

                            DataTable sortedTable = update_datatable_balances(dtNewTable1, 6, 7, 8);

                            string strTotalCol1 = getTotal_Datatable(sortedTable, 6);
                            string strTotalCol2 = getTotal_Datatable(sortedTable, 7);

                            if (!string.IsNullOrEmpty(strTotalCol1) && !string.IsNullOrEmpty(strTotalCol2))
                            {
                                DataRow drTotalRow = sortedTable.NewRow();
                                drTotalRow[6] = strTotalCol1;
                                drTotalRow[7] = strTotalCol2;
                                sortedTable.Rows.Add(drTotalRow);
                            }

                            LedDGV.DataSource = null;
                            LedDGV.DataSource = sortedTable;// dtNewTable.DefaultView;
                        }
                        ConnectionCommand.hide_columns_of_datagridview(LedDGV, "0,1,2");
                        LedDGV.FirstDisplayedScrollingRowIndex = LedDGV.Rows.Count - 2;
                        excel_filename = "Ledger of_" + tb_ledger_account_name.Text.Trim() + "_" + rla_n.Text + "_" + rls_a.Text + "_as on_" + ConnectionWithAccess.mprd;
                        ledger_filename = excel_filename;
                        ConnectionWithAccess.export(LedDGV, excel_filename);
                        //generate_ledger_report();
                    }
                }
            }

            objPleaseWait.Close();
        }

        //private void contains_for_ledger_account_union()
        //{
        //    StringBuilder strQuery = new StringBuilder();
        //    strQuery.Append("select distinct '' as [DATE_SORT],f51.a_n as [ACC_NAME], f51.s_a as [SUB_ACC_NAME, f51.d_d as 'DATE', 'Open' as 'DOCUMENTS', 'O'    as 'ACC_TYPE', f51.amt as 'DEBIT', 0 as 'CREDIT', f51.amt as 'BALANCE' from " + ConnectionWithAccess.tablename[51] + " f51 where f51.prd = '@' and f51.a_n = '" + rla_n.Text + "' and f51.s_a = '" + rls_a.Text + "' and d_d = #01-01-1901# UNION ALL ");
        //    strQuery.Append("select '' as [DATE_SORT],f21.a_n as 'ACC_NAME', f21.s_a as 'SUB_ACC_NAME, f21.d_d as 'DATE' ,f21.d_n as 'DOCUMENTS','Sale' as 'ACC_TYPE', f21.gamt as 'DEBIT',0 as 'CREDIT',0 as 'BALANCE' from " + ConnectionWithAccess.tablename[21] + " f21 where f21.a_n = '" + rla_n.Text + "' and f21.s_a = '" + rls_a.Text + "' and f21.d_d <= #" + LedTo.Text + "# UNION ALL ");
        //    strQuery.Append("select '' as [DATE_SORT],f22.a_n as 'ACC_NAME', f22.s_a as 'SUB_ACC_NAME, f22.d_d as 'DATE', f22.d_n as 'DOCUMENTS','Purc' as 'ACC_TYPE', 0 as 'DEBIT', f22.gamt as 'CREDIT' ,0 as 'BALANCE' from " + ConnectionWithAccess.tablename[22] + " f22 where f22.a_n = '" + rla_n.Text + "' and f22.s_a = '" + rls_a.Text + "' and f22.d_d <= #" + LedTo.Text + "# UNION ALL ");
        //    strQuery.Append("select '' as [DATE_SORT],f23.a_n as 'ACC_NAME', f23.s_a as 'SUB_ACC_NAME, f23.d_d as 'DATE', f23.d_n as 'DOCUMENTS','Bank' as 'ACC_TYPE', 0 as 'DEBIT', f23.bamt as 'CREDIT',0 as 'BALANCE' from " + ConnectionWithAccess.tablename[23] + " f23 where f23.a_n = '" + rla_n.Text + "' and f23.s_a = '" + rls_a.Text + "'" + " and f23.b_t = '3' and f23.bamt > 0  and f23.d_d <= #" + LedTo.Text + "# UNION ALL ");
        //    strQuery.Append("select '' as [DATE_SORT],f23.a_n as 'ACC_NAME', f23.s_a as 'SUB_ACC_NAME, f23.d_d as 'DATE', f23.d_n as 'DOCUMENTS','Bank' as 'ACC_TYPE', (f23.bamt * -1) as 'DEBIT', 0 as 'CREDIT',0 as 'BALANCE' from " + ConnectionWithAccess.tablename[23] + " f23 where f23.a_n = '" + rla_n.Text + "' and f23.s_a = '" + rls_a.Text + "'" + " and f23.b_t = '3' and f23.bamt < 0  and f23.d_d <= #" + LedTo.Text + "# UNION ALL ");
        //    strQuery.Append("select '' as [DATE_SORT],f24.a_n as 'ACC_NAME', f24.s_a as 'SUB_ACC_NAME, f24.d_d as 'DATE', f24.d_n as 'DOCUMENTS','Cash' as 'ACC_TYPE', 0 as 'DEBIT', f24.Camt as 'CREDIT',0 as 'BALANCE' from " + ConnectionWithAccess.tablename[24] + " f24 where f24.a_n = '" + rla_n.Text + "' and f24.s_a = '" + rls_a.Text + "' and f24.camt > 0  and f24.d_d <= #" + LedTo.Text + "# UNION ALL ");
        //    strQuery.Append("select '' as [DATE_SORT],f24.a_n as 'ACC_NAME', f24.s_a as 'SUB_ACC_NAME, f24.d_d as 'DATE', f24.d_n as 'DOCUMENTS','Cash' as 'ACC_TYPE', (f24.Camt * -1) as 'DEBIT',0 as 'CREDIT', 0 as 'BALANCE'  from " + ConnectionWithAccess.tablename[24] + " f24 where f24.a_n = '" + rla_n.Text + "' and f24.s_a = '" + rls_a.Text + "' and f24.camt < 0  and f24.d_d <= #" + LedTo.Text + "# UNION ALL ");
        //    strQuery.Append("select '' as [DATE_SORT],f25.a_n as 'ACC_NAME', f25.s_a as 'SUB_ACC_NAME, f25.d_d as 'DATE', f25.d_n as 'DOCUMENTS','Jour' as 'ACC_TYPE', f25.jamt as 'DEBIT', 0 as 'CREDIT', 0 as 'BALANCE' from " + ConnectionWithAccess.tablename[25] + " f25 where f25.a_n = '" + rla_n.Text + "' and f25.s_a = '" + rls_a.Text + "'  and f25.d_d <= #" + LedTo.Text + "# UNION ALL ");
        //    strQuery.Append("select '' as [DATE_SORT],f25.a_n as 'ACC_NAME', f25.s_a as 'SUB_ACC_NAME, f25.d_d as 'DATE', f25.d_n as 'DOCUMENTS','Jour' as 'ACC_TYPE', 0 as 'DEBIT', f25.jamt as 'CREDIT', 0 as 'BALANCE' from " + ConnectionWithAccess.tablename[25] + " f25 where f25.na_n = '" + rla_n.Text + "' and f25.ns_a = '" + rls_a.Text + "' and f25.d_d <= #" + LedTo.Text + "# UNION ALL ");
        //    strQuery.Append("select '' as [DATE_SORT],f30.a_n as 'ACC_NAME', f30.s_a as 'SUB_ACC_NAME, f30.d_d as 'DATE', f30.d_n as 'DOCUMENTS','Repl' as 'ACC_TYPE', 0 as 'DEBIT', f30.gamt as 'CREDIT', 0 as 'BALANCE' from " + ConnectionWithAccess.tablename[30] + " f30 where f30.a_n = '" + rla_n.Text + "' and f30.s_a = '" + rls_a.Text + "' and f30.d_d <= #" + LedTo.Text + "# ");
        //    ConnectionWithAccess.query = strQuery.ToString();
        //    ConnectionCommand.accountHelp_datatable(LedDGV, "LEDGER");

        //}

        public void delete_old_date_record_datatable(DataTable mDataGridView, int column_pointer, string before_date)
        {
            temp_double = 0;
            temp_int = 0;
            for (row_pointer = 0; row_pointer < mDataGridView.Rows.Count; row_pointer++)
            {
                if (mDataGridView.Rows[row_pointer][column_pointer] != null)
                {
                    temp_word = mDataGridView.Rows[row_pointer][3].ToString().Trim();
                    if (temp_word != null && temp_word != "")
                    {
                        if (Convert.ToDateTime(temp_word) < Convert.ToDateTime(before_date))
                        {
                            //mDataGridView.Rows.RemoveAt(mDataGridView.SelectedRows[0].Index);
                            if (mDataGridView.Rows[row_pointer][6] != null && mDataGridView.Rows[row_pointer][6].ToString() != "")
                            {
                                temp_double = temp_double + Convert.ToDouble(mDataGridView.Rows[row_pointer][6].ToString());
                                mDataGridView.Rows[row_pointer][6] = 0;
                                mDataGridView.Rows[row_pointer][0] = "";
                            }
                            if (mDataGridView.Rows[row_pointer][7] != null && mDataGridView.Rows[row_pointer][7].ToString() != "")
                            {
                                temp_double = temp_double - Convert.ToDouble(mDataGridView.Rows[row_pointer][7].ToString());
                                mDataGridView.Rows[row_pointer][7] = 0;
                            }
                            if (mDataGridView.Rows[row_pointer][8] != null && mDataGridView.Rows[row_pointer][8].ToString() != "")
                                mDataGridView.Rows[row_pointer][8] = 0;
                            temp_int = row_pointer;
                        }
                    }
                }
            }
            mDataGridView.Rows[temp_int][0] = "1";
            mDataGridView.Rows[temp_int][3] = Ledfrom.Text.ToString();
            mDataGridView.Rows[temp_int][4] = "Open";
            mDataGridView.Rows[temp_int][5] = "";
            mDataGridView.Rows[temp_int][8] = Convert.ToString(temp_double);
            foreach (DataRow dr in mDataGridView.Rows)
            {
                if (dr[8].ToString() == "")
                    mDataGridView.Rows.Remove(dr);
            }
        }

        public void delete_old_date_record(DataGridView mDataGridView, int column_pointer, string before_date)
        {
            temp_double = 0;
            temp_int = 0;
            for (row_pointer = 0; row_pointer < mDataGridView.RowCount; row_pointer++)
            {
                if (mDataGridView.Rows[row_pointer].Cells[column_pointer].Value != null)
                {
                    temp_word = mDataGridView.Rows[row_pointer].Cells[column_pointer].Value.ToString().Trim();
                    if (temp_word != null && temp_word != "")
                    {
                        if (Convert.ToDateTime(temp_word) < Convert.ToDateTime(before_date))
                        {
                            //mDataGridView.Rows.RemoveAt(mDataGridView.SelectedRows[0].Index);
                            if (mDataGridView.Rows[row_pointer].Cells[6].Value != null && mDataGridView.Rows[row_pointer].Cells[6].Value.ToString() != "")
                            {
                                temp_double = temp_double + Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[6].Value);
                                mDataGridView.Rows[row_pointer].Cells[6].Value = 0;
                                mDataGridView.Rows[row_pointer].Cells[0].Value = "";
                            }
                            if (mDataGridView.Rows[row_pointer].Cells[7].Value != null && mDataGridView.Rows[row_pointer].Cells[7].Value.ToString() != "")
                            {
                                temp_double = temp_double - Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[7].Value);
                                mDataGridView.Rows[row_pointer].Cells[7].Value = 0;
                            }
                            if (mDataGridView.Rows[row_pointer].Cells[8].Value != null && mDataGridView.Rows[row_pointer].Cells[8].Value.ToString() != "")
                                mDataGridView.Rows[row_pointer].Cells[8].Value = 0;
                            temp_int = row_pointer;
                        }
                    }
                }
            }
            mDataGridView.Rows[temp_int].Cells[0].Value = "1";
            mDataGridView.Rows[temp_int].Cells[column_pointer].Value = before_date;
            mDataGridView.Rows[temp_int].Cells[4].Value = "Open";
            mDataGridView.Rows[temp_int].Cells[5].Value = "";
            mDataGridView.Rows[temp_int].Cells[8].Value = Convert.ToString(temp_double);
            //for (row_pointer = 0; row_pointer < mDataGridView.RowCount; row_pointer++)
            //{
            //    if (mDataGridView.Rows[row_pointer].Cells[8].Value != null)
            //    {
            //        temp_word = mDataGridView.Rows[row_pointer].Cells[6].Value.ToString();
            //        temp_word1 = mDataGridView.Rows[row_pointer].Cells[7].Value.ToString();
            //        temp_word2 = mDataGridView.Rows[row_pointer].Cells[8].Value.ToString();
            //        if (temp_word == "0" && temp_word1 == "0" && temp_word2 == "0")
            //        {
            //            //mDataGridView.Rows.RemoveAt(mDataGridView.Rows[row_pointer].Index);
            //            mDataGridView.Rows.RemoveAt(row_pointer);
            //        }
            //    }
            //}
            mDataGridView.Refresh();
        }

        public void delete_new_date_record(DataGridView mDataGridView, int column_pointer, string on_date)
        {
            temp_double = 0;
            temp_int = 0;
            for (row_pointer = 0; row_pointer < mDataGridView.RowCount; row_pointer++)
            {
                if (mDataGridView.Rows[row_pointer].Cells[column_pointer].Value != null)
                {
                    temp_word = mDataGridView.Rows[row_pointer].Cells[3].Value.ToString().Trim();
                    if (temp_word != null && temp_word != "")
                    {
                        if (Convert.ToDateTime(temp_word) > Convert.ToDateTime(on_date))
                        {
                            //mDataGridView.Rows.RemoveAt(mDataGridView.SelectedRows[0].Index);
                            if (mDataGridView.Rows[row_pointer].Cells[6].Value != null && mDataGridView.Rows[row_pointer].Cells[6].Value.ToString() != "")
                            {
                                temp_double = temp_double + Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[6].Value);
                                mDataGridView.Rows[row_pointer].Cells[6].Value = 0;
                                mDataGridView.Rows[row_pointer].Cells[0].Value = "";
                            }
                            if (mDataGridView.Rows[row_pointer].Cells[7].Value != null && mDataGridView.Rows[row_pointer].Cells[7].Value.ToString() != "")
                            {
                                temp_double = temp_double - Convert.ToDouble(mDataGridView.Rows[row_pointer].Cells[7].Value);
                                mDataGridView.Rows[row_pointer].Cells[7].Value = 0;
                            }
                            if (mDataGridView.Rows[row_pointer].Cells[8].Value != null && mDataGridView.Rows[row_pointer].Cells[8].Value.ToString() != "")
                                mDataGridView.Rows[row_pointer].Cells[8].Value = 0;
                            temp_int = row_pointer;
                        }
                    }
                }
            }
            //mDataGridView.Rows[temp_int].Cells[0].Value = "1";
            //mDataGridView.Rows[temp_int].Cells[3].Value = Ledfrom.Text.ToString();
            //mDataGridView.Rows[temp_int].Cells[4].Value = "Open";
            //mDataGridView.Rows[temp_int].Cells[5].Value = "";
            //mDataGridView.Rows[temp_int].Cells[8].Value = Convert.ToString(temp_double);
        }

        public static string NumberToWords(int number)
        {
            if (number == 0)
                return "zero";

            if (number < 0)
                return "minus " + NumberToWords(Math.Abs(number));

            words = null;

            //if ((number / 1000000) > 0)
            //{
            //    words += NumberToWords(number / 1000000) + " million ";
            //    number %= 1000000;
            //}
            if ((number / 99999) > 0)
            {
                words += NumberToagainWords(number / 100000) + " Lakhs ";
                number %= 100000;
            }

            if ((number / 1000) > 0)
            {
                words = NumberToagainWords(number / 1000) + " thousand ";
                number %= 1000;
            }

            if ((number / 100) > 0)
            {
                words = NumberToagainWords(number / 100) + " hundred ";
                number %= 100;
            }

            if (number > 0)
            {
                if (words != "")
                    words += "and ";

                var unitsMap = new[] { "zero", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", "nineteen" };
                var tensMap = new[] { "zero", "ten", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety" };

                if (number < 20)
                    words += unitsMap[number];
                else
                {
                    words += tensMap[number / 10];
                    if ((number % 10) > 0)
                        words += "-" + unitsMap[number % 10];
                }
            }
            return words.ToUpper();
        }

        public static string NumberToagainWords(int number)
        {
            if (number == 0)
                return "zero";

            if (number < 0)
                return "minus " + NumberToagainWords(Math.Abs(number));

            //string words  = "";

            //if ((number / 1000000) > 0)
            //{
            //    words += NumberToWords(number / 1000000) + " million ";
            //    number %= 1000000;
            //}
            if ((number / 99999) > 0)
            {
                words += NumberToagainWords(number / 100000) + " Lakhs ";
                number %= 100000;
            }

            if ((number / 1000) > 0)
            {
                words += NumberToagainWords(number / 1000) + " thousand ";
                number %= 1000;
            }

            if ((number / 100) > 0)
            {
                words += NumberToagainWords(number / 100) + " hundred ";
                number %= 100;
            }

            if (number > 0)
            {
                if (words != "" && words != null)
                    words += "and ";

                var unitsMap = new[] { "zero", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", "nineteen" };
                var tensMap = new[] { "zero", "ten", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety" };

                if (number < 20)
                    words += unitsMap[number];
                else
                {
                    words += tensMap[number / 10];
                    if ((number % 10) > 0)
                        words += "-" + unitsMap[number % 10];
                }
            }
            return words.ToUpper();
        }

        private void cbRepFormat_SelectedIndexChanged(object sender, EventArgs e)
        {
            pb_rep_ana_printer.Visible = false;
            pdf_viewer1.Visible = false;
            gdvreport.Visible = false;
            dgv_tax_report.Visible = false;
            Generate.Visible = true;
        }

        private void crtranlist_Click(object sender, EventArgs e)
        {
            cramt.ReadOnly = false;
            crdocno.Text = "";
            crdatetime.Value = Convert.ToDateTime(crtranlist.SelectedCells[0].Value);
            crdocno.Text = Convert.ToString(crtranlist.SelectedCells[1].Value);
            populate_screen();
        }

        private void subtabcash_Click(object sender, EventArgs e)
        {
            getdaybookcode();
        }

        private void pipurchaselist_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data");
            objPleaseWait.Show();
            Application.DoEvents();
            pidbc.Enabled = false;
            pidocno.Text = "";   // first reset docno is compulsory
            pdf_invoice.Visible = false;
            PopulatepurchaseDetails();
            pipartybalance.Text = Convert.ToString(calculate_account_balance(pia_n.Text, pis_a.Text, Convert.ToString(pidatetime.Text)));
            pipartycode.Enabled = false;
            picity.Enabled = false;
            objPleaseWait.Close();
        }

        private void picPartyList_Click(object sender, EventArgs e)
        {
            multiple_choice = "Party";
            chkpartyList.Visible = true;
            chkpartyList.Size = new System.Drawing.Size(342, 334);
            btnPartyListSelectAll.Visible = true;
            btncloseselection.Visible = true;
            fill_report_party_combobox(raa_n.Text);
            Generate.Visible = false;
        }

        private void oldpurcinvoicedetails()
        {
            ConnectionWithAccess.query = "select tpt, bamt, tamt, rund_amt, gamt, tx_code, d_d,freight_AMT,packing_AMT,insurance_AMT,other_AMT,cgst_amt, sgst_amt,igst_amt from " + ConnectionWithAccess.tablename[22] + " f22 where d_n " + (pidocno.Text.Trim() == string.Empty ? "is null" : "= " + pidocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(pidbc.Text) + " and s_a = '" + pis_a.Text + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                old_purchase_invoice_number = pidocno.Text.Trim();
                pitransport.Text = dtData1.Rows[0][0].ToString();
                pitaxamt.Text = dtData1.Rows[0][2].ToString();
                piroundoffamt.Text = dtData1.Rows[0][3].ToString();
                pigrossamt.Text = dtData1.Rows[0][4].ToString();
                old_purchase_invoice_amount = Convert.ToDouble(dtData1.Rows[0][4].ToString());
                pitaxcode.Text = dtData1.Rows[0][5].ToString();
                pitx_code.Text = dtData1.Rows[0][5].ToString();
                pidatetime.Text = dtData1.Rows[0][6].ToString();
                pi_frieght_amt.Text = dtData1.Rows[0][7].ToString();
                pi_frieght_amt.Text = string.Format("{0:0.00}", Convert.ToDouble(pi_frieght_amt.Text));
                pi_packing_amt.Text = dtData1.Rows[0][8].ToString();
                pi_packing_amt.Text = string.Format("{0:0.00}", Convert.ToDouble(pi_packing_amt.Text));
                pi_insurance_amt.Text = dtData1.Rows[0][9].ToString();
                pi_insurance_amt.Text = string.Format("{0:0.00}", Convert.ToDouble(pi_insurance_amt.Text));
                pi_other_amt.Text = dtData1.Rows[0][10].ToString();
                pi_other_amt.Text = string.Format("{0:0.00}", Convert.ToDouble(pi_other_amt.Text));
                pibasicamt.Text = dtData1.Rows[0][1].ToString();
                pibasicamt.Text = string.Format("{0:0.00}", Convert.ToDouble(pibasicamt.Text));
                if (dtData1.Rows[0][13].ToString() != "")
                    tb_pi_igst_tax_amount.Text = dtData1.Rows[0][13].ToString();
                else
                {
                    temp_double = 0;
                    if (dtData1.Rows[0][11].ToString() != "")
                        temp_double += (Convert.ToDouble(dtData1.Rows[0][11].ToString()));
                    if (dtData1.Rows[0][12].ToString() != "")
                        temp_double += (Convert.ToDouble(dtData1.Rows[0][11].ToString()));
                    tb_pi_igst_tax_amount.Text = temp_double.ToString();
                }
                tb_pi_igst_tax_amount.Text = string.Format("{0:0.00}", Convert.ToDouble(tb_pi_igst_tax_amount.Text));
                get_account_details_from_01(pia_n.Text, pis_a.Text);
                get_account_details_from_04(pia_n.Text, pis_a.Text);
                if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                    lbl_pi_message.Visible = true;
                else
                    lbl_pi_message.Visible = false;
                tb_pi_mobilenumber.Text = account_detail_from_04[17];
                fill_purchase_invoice_dg();
                purchase_invoice_item_filling();
                pipurchaselist.Enabled = true;
            }
            if (pitaxcode.Text != "")
                get_tax_desc_from_dc("P", pidbc.Text, Convert.ToInt32(pitaxcode.Text));
            show_invoice_image();
        }

        private void show_invoice_image()
        {
            if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 1 && subtabpurchase.SelectedIndex == 0)
            {
                if (cb_common_image.Checked == true)
                {
                    ConnectionWithAccess.query = "select location from " + ConnectionWithAccess.tablename[70] + " where prd = '" + ConnectionWithAccess.mprd + "' and a_n = '" + ConnectionWithAccess.ma_n + "' and s_a = '" + ConnectionWithAccess.ms_a + "' and d_n  " + (ConnectionWithAccess.md_n == null ? "is null" : (ConnectionWithAccess.md_n.Trim() == string.Empty ? "is null" : "= " + ConnectionWithAccess.md_n.Trim())) + "";
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        if (dtData1.Rows[0][0] != null)
                        {
                            image_filename = Convert.ToString(dtData1.Rows[0][0].ToString());
                            if (File.Exists(image_filename))
                                pb_common.Image = System.Drawing.Image.FromFile(image_filename);
                            else
                                image_filename = null;
                        }
                        else
                            image_filename = null;
                    }
                    else
                        image_filename = null;
                    pb_common.SizeMode = PictureBoxSizeMode.StretchImage;
                }
                else
                {
                    pb_common.Visible = false;
                    pb_common.Image = null;
                }
            }
        }

        public void purcitemfilling()
        {
            piitemlist.DataSource = null;
            piitemlist.Enabled = true;
            ConnectionWithAccess.query = "select [type], item_code, [title], packing, [box], qty, price, amount, cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where prd= '" + ConnectionWithAccess.mprd + "' and d_c = " + pidbc.Text + " and d_n " + (pidocno.Text.Trim() == string.Empty ? "is null" : "= " + pidocno.Text.Trim()) + " and s_a = '" + pis_a.Text + "'";
            ConnectionCommand.accountHelp_datatable_Seperate(piitemlist, "piitemlist");
            if (piitemlist.Rows.Count <= 1)
            {
                pibasicamt.ReadOnly = false;
                pibasicamt.Enabled = true;
            }
            else
            {
                piitemlist.Enabled = true;
                pibasicamt.ReadOnly = true;
                calculatepurcItemTotal();
            }
            show_images();
        }

        private void btnPartyListSelectAll_Click(object sender, EventArgs e)
        {
            for (int i = 0; i < chkpartyList.Items.Count - 1; i++)
            {
                if (btnPartyListSelectAll.Text == "Select All")
                    chkpartyList.SetItemCheckState(i, CheckState.Checked);
                else
                    chkpartyList.SetItemCheckState(i, CheckState.Unchecked);
            }
            if (btnPartyListSelectAll.Text == "Select All")
                btnPartyListSelectAll.Text = "UnSelect All";
            else
                btnPartyListSelectAll.Text = "Select All";
            tbselacc.Text = "0 Selected";
            selectedpartyname = null;
            Generate.Visible = true;
            gdvreport.Visible = false;
            dgv_tax_report.Visible = false;
            Generate.Visible = false;
        }

        private void btnclosePartyList_Click(object sender, EventArgs e)
        {
            Generate.Visible = true;
            chkpartyList.Visible = false;
            chkcityList.Visible = false;
            chktaxlist.Visible = false;
            btnPartyListSelectAll.Visible = false;
            btncloseselection.Visible = false;
            selectedpartyname = "";
            temp_int = 0;
            if (multiple_choice == "Party")
            {
                for (row_pointer = 0; row_pointer < chkpartyList.Items.Count - 1; row_pointer++)
                {
                    if (chkpartyList.GetItemCheckState(row_pointer) == CheckState.Checked)
                    {
                        selectedpartyname = selectedpartyname + "'" + chkpartyList.Items[row_pointer].ToString() + "',";
                        temp_int++;
                    }
                }
                if (temp_int > 0)
                    selectedpartyname = selectedpartyname.Substring(0, selectedpartyname.Length - 1);
                tbselacc.Text = Convert.ToString(temp_int) + " Selected";
            }
            else if (multiple_choice == "City")
            {
                for (row_pointer = 0; row_pointer < chkcityList.Items.Count - 1; row_pointer++)
                {
                    if (chkcityList.GetItemCheckState(row_pointer) == CheckState.Checked)
                    {
                        selectedcitylist = selectedcitylist + "'" + chkcityList.Items[row_pointer].ToString() + "',";
                        temp_int++;
                    }
                }
                if (temp_int > 0)
                    selectedcitylist = selectedcitylist.Substring(0, selectedcitylist.Length - 1);
                tbreportcity.Text = Convert.ToString(temp_int) + " Selected";
            }
            else if (multiple_choice == "Tax")
            {
                for (row_pointer = 0; row_pointer < chktaxlist.Items.Count - 1; row_pointer++)
                {
                    if (chktaxlist.GetItemCheckState(row_pointer) == CheckState.Checked)
                    {
                        temp_word = chktaxlist.Items[row_pointer].ToString().Substring(0, (chktaxlist.Items[row_pointer].ToString().IndexOf("-")) - 1);
                        selectedtaxlist = selectedtaxlist + "'" + temp_word + "',";
                        temp_int++;
                    }
                }
                if (temp_int > 0)
                    selectedtaxlist = selectedtaxlist.Substring(0, selectedtaxlist.Length - 1);
                tbreporttax.Text = Convert.ToString(temp_int) + " Selected";
            }
            Generate.Visible = true;
            gdvreport.Visible = false;
            dgv_tax_report.Visible = false;
        }

        private void PictureBox43_Click(object sender, EventArgs e)
        {
            report_keys_enable();
            if (multiple_choice == "Party")
            {
                for (row_pointer = 0; row_pointer < chkpartyList.Items.Count - 1; row_pointer++)
                {
                    if (chkpartyList.GetItemCheckState(row_pointer) == CheckState.Checked)
                        chkpartyList.SetItemCheckState(row_pointer, CheckState.Unchecked);
                }
                tbselacc.Text = "0 Selected";
                btnPartyListSelectAll.Text = "Select All";
            }
            else if (multiple_choice == "City")
            {
                for (row_pointer = 0; row_pointer < chkcityList.Items.Count - 1; row_pointer++)
                {
                    if (chkcityList.GetItemCheckState(row_pointer) == CheckState.Checked)
                        chkcityList.SetItemCheckState(row_pointer, CheckState.Unchecked);
                }
                tbreportcity.Text = "0 Selected";
                btnPartyListSelectAll.Text = "Select All";
            }
            else if (multiple_choice == "Tax")
            {
                for (row_pointer = 0; row_pointer < chktaxlist.Items.Count - 1; row_pointer++)
                {
                    if (chktaxlist.GetItemCheckState(row_pointer) == CheckState.Checked)
                        chktaxlist.SetItemCheckState(row_pointer, CheckState.Unchecked);
                }
                tbreporttax.Text = "0 Selected";
                btnPartyListSelectAll.Text = "Select All";
            }
            pb_rep_ana_printer.Visible = false;
            Generate.Visible = true;
            gdvreport.Visible = false;
            dgv_tax_report.Visible = false;
        }

        private void picpartycity_Click(object sender, EventArgs e)
        {
            multiple_choice = "City";
            chkcityList.Visible = true;
            chkcityList.Size = new System.Drawing.Size(342, 304);
            btnPartyListSelectAll.Visible = true;
            btncloseselection.Visible = true;
            fill_report_city_combobox(raa_n.Text);
        }

        private void btncityListSelectAll_Click(object sender, EventArgs e)
        {
            for (int i = 0; i < chkcityList.Items.Count - 1; i++)
            {
                chkcityList.SetItemCheckState(i, CheckState.Unchecked);
            }
            tbreportcity.Text = "0 Selected";
            selectedcitylist = null;
            Generate.Visible = true;
            gdvreport.Visible = false;
            dgv_tax_report.Visible = false;
        }

        private void pictaxList_Click(object sender, EventArgs e)
        {
            multiple_choice = "Tax";
            chktaxlist.Visible = true;
            chktaxlist.Size = new System.Drawing.Size(342, 294);
            btnPartyListSelectAll.Visible = true;
            btncloseselection.Visible = true;
            fill_report_tax_combobox(cbrep_ana_d_c.Text);
        }

        private void fill_report_party_combobox(string ma_n)
        {
            if (chkpartyList.Items.Count == 0)
            {
                //ConnectionWithAccess.query = "select [desc],city from " + ConnectionWithAccess.tablename[01] + " f1 where f1.a_n = '" + ma_n + "' and f1.s_a != '@@@'";
                ConnectionWithAccess.query = "select [desc],city,a_n,s_a from " + ConnectionWithAccess.tablename[01] + " f1 where f1.a_n = '" + ma_n + "' and f1.s_a <> '@@@'";
                ConnectionWithAccess.fillCheckListBox(chkpartyList);
            }
        }

        private void fill_report_city_combobox(string ma_n)
        {
            if (chkcityList.Items.Count == 0)
            {
                ConnectionWithAccess.query = "select distinct [city] from " + ConnectionWithAccess.tablename[01] + " f1 where f1.a_n = '" + ma_n + "' and f1.s_a <> '@@@'";
                ConnectionWithAccess.fillCheckListBox(chkcityList);
            }
        }

        private void fill_report_tax_combobox(string md_c)
        {
            if (chktaxlist.Items.Count == 0)
            {
                ConnectionWithAccess.query = "select distinct f6.tx_code, f6.[desc] from " + ConnectionWithAccess.tablename[06] + " f6 where f6.d_c = " + md_c;
                ConnectionWithAccess.fillCheckListBox(chktaxlist);
            }
        }

        private void btntaxListSelectAll_Click(object sender, EventArgs e)
        {
            for (int i = 0; i < chktaxlist.Items.Count - 1; i++)
            {
                chktaxlist.SetItemCheckState(i, CheckState.Unchecked);
            }
            tbreporttax.Text = "0 Selected";
            selectedtaxlist = null;
            Generate.Visible = true;
            gdvreport.Visible = false;
            dgv_tax_report.Visible = false;
        }

        private void btncloseselection_Click(object sender, EventArgs e)
        {
            Generate.Visible = true;
            chkpartyList.Visible = false;
            chkcityList.Visible = false;
            chktaxlist.Visible = false;
            btnPartyListSelectAll.Visible = false;
            btncloseselection.Visible = false;
            selectedpartyname = "";
            temp_int = 0;
            if (multiple_choice == "Party")
            {
                selectedpartyname = null;
                selectedpartycity = null;
                for (row_pointer = 0; row_pointer < chkpartyList.Items.Count; row_pointer++)
                {
                    if (chkpartyList.GetItemCheckState(row_pointer) == CheckState.Checked)
                    {
                        var cellArray = chkpartyList.Items[row_pointer].ToString().Trim().Split(new[] { ',' });
                        selectedpartyname = selectedpartyname + "'" + cellArray[0] + "',";
                        selectedpartycity = selectedpartycity + "'" + cellArray[1] + "',";
                        temp_int++;
                    }
                }
                if (temp_int > 0)
                {
                    selectedpartyname = selectedpartyname.Substring(0, selectedpartyname.Length - 1);
                    selectedpartycity = selectedpartycity.Substring(0, selectedpartycity.Length - 1);
                }
                tbselacc.Text = Convert.ToString(temp_int) + " Selected";
            }
            else if (multiple_choice == "City")
            {
                selectedcitylist = null;
                for (row_pointer = 0; row_pointer < chkcityList.Items.Count; row_pointer++)
                {
                    if (chkcityList.GetItemCheckState(row_pointer) == CheckState.Checked)
                    {
                        selectedcitylist = selectedcitylist + "'" + chkcityList.Items[row_pointer].ToString() + "',";
                        temp_int++;
                    }
                }
                if (temp_int > 0)
                    selectedcitylist = selectedcitylist.Substring(0, selectedcitylist.Length - 1);
                tbreportcity.Text = Convert.ToString(temp_int) + " Selected";
            }
            else if (multiple_choice == "Tax")
            {
                selectedtaxlist = null;
                for (row_pointer = 0; row_pointer < chktaxlist.Items.Count; row_pointer++)
                {
                    if (chktaxlist.GetItemCheckState(row_pointer) == CheckState.Checked)
                    {
                        temp_word = chktaxlist.Items[row_pointer].ToString().Substring(0, (chktaxlist.Items[row_pointer].ToString().IndexOf("-")) - 1);
                        selectedtaxlist = selectedtaxlist + "'" + temp_word + "',";
                        temp_int++;
                    }
                }
                if (temp_int > 0)
                    selectedtaxlist = selectedtaxlist.Substring(0, selectedtaxlist.Length - 1);
                tbreporttax.Text = Convert.ToString(temp_int) + " Selected";
            }
            Generate.Visible = true;
            gdvreport.Visible = false;
            dgv_tax_report.Visible = false;
        }

        private void cptranlist_Click(object sender, EventArgs e)
        {
            cpdatetime.Value = Convert.ToDateTime(cptranlist.SelectedCells[0].Value);
            cpdocno.Text = Convert.ToString(cptranlist.SelectedCells[1].Value);
        }

        private void cb_master_d_c_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (cbParent.SelectedItem.Equals("SUNDRY DEBTORS"))
                tbA_N.Text = get_a_n_from_d_c("S", Convert.ToInt32(cb_master_d_c.Text));
            else if (cbParent.SelectedItem.Equals("SUNDRY CREDITORS"))
                tbA_N.Text = get_a_n_from_d_c("P", Convert.ToInt32(cb_master_d_c.Text));
            else if (cbParent.SelectedItem.Equals("BANK ACCOUNT"))
                tbA_N.Text = get_a_n_from_d_c("B", Convert.ToInt32(cb_master_d_c.Text));
            else if (cbParent.SelectedItem.Equals("CASH IN HAND"))
                tbA_N.Text = get_a_n_from_d_c("C", Convert.ToInt32(cb_master_d_c.Text));
            tbS_A.Text = "@@@";
            tbd_y.Text = "@@@";
            get_account_details_from_01(tbA_N.Text, tbS_A.Text);
            tbDesc.Text = account_detail_from_01[4];
            fill_tax_description();
            //refresh_master_account();
        }

        private void cbrep_ana_d_c_SelectedIndexChanged(object sender, EventArgs e)
        {
            Generate.Visible = true;
            gdvreport.Visible = false;
            dgv_tax_report.Visible = false;
            chkpartyList.Items.Clear();
            chkcityList.Items.Clear();
            chktaxlist.Items.Clear();
            if (cbRepType.SelectedIndex == 0)
                raa_n.Text = get_a_n_from_d_c("S", Convert.ToInt32(cbrep_ana_d_c.Text));
            else if (cbRepType.SelectedIndex == 1)
                raa_n.Text = get_a_n_from_d_c("P", Convert.ToInt32(cbrep_ana_d_c.Text));
            else if (cbRepType.SelectedIndex == 2)
                if (cbrep_ana_d_c.Text == "0")
                    raa_n.Text = "2011";
                else
                    raa_n.Text = get_a_n_from_d_c("B", Convert.ToInt32(cbrep_ana_d_c.Text));
            else if (cbRepType.SelectedIndex == 3)
                raa_n.Text = get_a_n_from_d_c("C", Convert.ToInt32(cbrep_ana_d_c.Text));
            else if (cbRepType.SelectedIndex == 4)
                raa_n.Text = get_a_n_from_d_c("J", Convert.ToInt32(cbrep_ana_d_c.Text));
            break_point = "";
        }

        private void rb_yearly_Click(object sender, EventArgs e)
        {
            rb_monthly.Checked = false;
            rb_yearly.Checked = true;
        }

        private void rb_monthly_Click(object sender, EventArgs e)
        {
            rb_yearly.Checked = false;
            rb_monthly.Checked = true;
        }

        private void cbAction_SelectedIndexChanged(object sender, EventArgs e)
        {
            daybooklistmastertab();
        }

        private void brdbc_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (brdbc.Text != "")
            {
                ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[23] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and r_p = '2' and d_c = " + brdbc.Text;
                ConnectionCommand.ExportToText(brdbc, brdocno);
                brchkstatus.SelectedIndex = 1;
                //brtranlist.Rows.Clear();
                brtranlist.DataSource = null;
                fill_bank_trans_list();
                //brcurbankbal.Text = Convert.ToString(get_bank_balance(ConnectionWithAccess.mprd, get_a_n_from_d_c("B", Convert.ToInt32(brdbc.Text))));
                brcurbankbal.Text = Convert.ToString(get_bank_balance(get_a_n_from_d_c("B", Convert.ToInt32(brdbc.Text)), "@@@", DateTime.Today.ToShortDateString()));
                //brcurbankbal.Text = Convert.ToString(calculate_bank_balance(Convert.ToInt32(brdbc.Text),get_a_n_from_d_c("B", Convert.ToInt32(brdbc.Text)),brdatetime.Value.ToString()));
            }
        }

        //private Image Scan(string deviceName)
        //{
        //    WiaClass wiaManager = null;       // WIA manager COM object
        //    CollectionClass wiaDevs = null;   // WIA devices collection COM object
        //    ItemClass wiaRoot = null;         // WIA root device COM object
        //    CollectionClass wiaPics = null;   // WIA collection COM object
        //    ItemClass wiaItem = null;         // WIA image COM object

        //    try
        //    {
        //        // create COM instance of WIA manager
        //        wiaManager = new WiaClass();

        //        // call Wia.Devices to get all devices
        //        wiaDevs = wiaManager.Devices as CollectionClass;
        //        if ((wiaDevs == null) || (wiaDevs.Count == 0))
        //        {
        //            throw new Exception("No WIA devices found!");
        //        }

        //        object device = null;
        //        foreach (IWiaDeviceInfo currentDevice in wiaManager.Devices)
        //        {
        //            if (currentDevice.Name == deviceName)
        //            {
        //                device = currentDevice;
        //                break;
        //            }
        //        }

        //        if (device == null)
        //        {
        //            throw new Exception
        //            (
        //                "Device with name \"" +
        //                deviceName +
        //                "\" could not be found."
        //            );
        //        }

        //        // select device
        //        wiaRoot = (ItemClass)wiaManager.Create(ref device);

        //        // something went wrong
        //        if (wiaRoot == null)
        //        {
        //            throw new Exception
        //            (
        //                "Could not initialize device \"" +
        //                deviceName + "\"."
        //            );
        //        }

        //        wiaPics = wiaRoot.GetItemsFromUI
        //        (
        //            WiaFlag.SingleImage,
        //            WiaIntent.ImageTypeColor
        //        ) as CollectionClass;

        //        if (wiaPics == null || wiaPics.Count == 0)
        //        {
        //            throw new Exception("Could not scan image.");
        //        }

        //        Image image = null;

        //        // enumerate all the pictures the user selected
        //        foreach (object wiaObj in wiaPics)
        //        {
        //            if (image == null)
        //            {
        //                wiaItem = (ItemClass)Marshal.CreateWrapperOfType
        //                (
        //                    wiaObj, typeof(ItemClass)
        //                );

        //                // create temporary file for image
        //                string tempFile = Path.GetTempFileName();

        //                // transfer picture to our temporary file
        //                wiaItem.Transfer(tempFile, false);

        //                // create Image instance from file
        //                image = Image.FromFile(tempFile);
        //            }

        //            // release enumerated COM object
        //            Marshal.ReleaseComObject(wiaObj);
        //        }

        //        if (image == null)
        //        {
        //            throw new Exception("Error reading scanned image.");
        //        }

        //        return image;
        //    }
        //    finally
        //    {
        //        // release WIA image COM object
        //        if (wiaItem != null)
        //            Marshal.ReleaseComObject(wiaItem);

        //        // release WIA collection COM object
        //        if (wiaPics != null)
        //            Marshal.ReleaseComObject(wiaPics);

        //        // release WIA root device COM object
        //        if (wiaRoot != null)
        //            Marshal.ReleaseComObject(wiaRoot);

        //        // release WIA devices collection COM object
        //        if (wiaDevs != null)
        //            Marshal.ReleaseComObject(wiaDevs);

        //        // release WIA manager COM object
        //        if (wiaManager != null)
        //            Marshal.ReleaseComObject(wiaManager);
        //    }
        //}

        private void MainForm_KeyPress(object sender, KeyPressEventArgs e)
        {
            //MessageBox.Show("Keypress");

            //if (e.KeyCode == Keys.F12)

            //if (e.KeyChar == 28)
            //{
            //    extraform periodform = new extraform();
            //    periodform.Show();
            //}
            //if (e.KeyChar == 9)
            //{
            //    periodgridview.Visible = true;
            //    ConnectionWithAccess.query = "select prd, start, [end] from " + ConnectionWithAccess.tablename[50] + " order by prd desc";
            //    ConnectionCommand.accountHelp(periodgridview, "ChangePeriod");
            //}
        }

        private void select_party_for_sale()
        {
            fill_transport(sia_n.Text, sicity.Text, sitransport);
            sitransport.Enabled = true;
            if (subtabsale.SelectedIndex == 0)
            {
                if (Convert.ToString(si_party_help.CurrentRow.Cells[4].Value) != "")
                {
                    sipartycode.Enabled = false;
                    sicity.Enabled = false;
                    sideliverycode.Text = Convert.ToString(si_party_help.CurrentRow.Cells[0].Value);
                }
                else
                {
                    ConnectionWithAccess.mdesc = Convert.ToString(si_party_help.CurrentRow.Cells[0].Value);
                    sipartycode.Text = Convert.ToString(si_party_help.CurrentRow.Cells[0].Value);
                }
            }
            else if (subtabsale.SelectedIndex == 2)
            {
                soitemlist.ReadOnly = false;
                if (Convert.ToString(sale_order_dgv.CurrentRow.Cells[4].Value) != "")
                {
                    sopartycode.Enabled = false;
                    sodeliverycode.Text = Convert.ToString(sale_order_dgv.CurrentRow.Cells[0].Value);
                }
                else
                {
                    ConnectionWithAccess.mdesc = Convert.ToString(sale_order_dgv.CurrentRow.Cells[0].Value);
                    sopartycode.Text = Convert.ToString(sale_order_dgv.CurrentRow.Cells[0].Value);
                }
            }
            show_images();
            si_party_help.Visible = false;
            sale_order_dgv.Visible = false;
        }

        private void select_party_for_replacement()
        {
            if (sra_n.Text != null && srs_a.Text != "")
            {
                get_account_details_from_01(sra_n.Text, srs_a.Text);
                get_account_details_from_04(sra_n.Text, srs_a.Text);
                srpartycode.Text = account_detail_from_01[4];
                srpartyname.Text = srpartycode.Text;
                srpartyaddress.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[6] + " ," + account_detail_from_04[7];
                srcontactdetails.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20];
                srpartybalance.Text = Convert.ToString(calculate_account_balance(sra_n.Text, srs_a.Text, Convert.ToString(srdatetime.Text)));
            }
            //show_images();
            sr_party_help.Visible = false;
        }

        private void select_party_for_bank()
        {
            if (subtabbank.SelectedIndex == 0)
            {
                bra_n.Text = braccountdg.CurrentRow.Cells[2].Value.ToString();
                brs_a.Text = Convert.ToString(braccountdg.CurrentRow.Cells[3].Value);
                ConnectionWithAccess.mdesc = Convert.ToString(braccountdg.CurrentRow.Cells[0].Value);
                brpartycode.Text = Convert.ToString(braccountdg.CurrentRow.Cells[0].Value);
                brpartycity.Text = Convert.ToString(braccountdg.CurrentRow.Cells[1].Value);
                get_account_details_from_04(bra_n.Text, brs_a.Text);
                cbchqbank.Text = account_detail_from_04[33];
                show_images();
            }
            else if (subtabbank.SelectedIndex == 1)
            {
                bpa_n.Text = bp_datagridview.CurrentRow.Cells[2].Value.ToString();
                bps_a.Text = Convert.ToString(bp_datagridview.CurrentRow.Cells[3].Value);
                ConnectionWithAccess.mdesc = Convert.ToString(bp_datagridview.CurrentRow.Cells[0].Value);
                bppartycode.Text = Convert.ToString(bp_datagridview.CurrentRow.Cells[0].Value);
                bppartycity.Text = Convert.ToString(bp_datagridview.CurrentRow.Cells[1].Value);
                show_images();
                bp_datagridview.Visible = false;
            }
           
        }

        private void select_account_for_ledger()
        {

        }

        private void get_account_details_from_01(string ma_n, string ms_a)
        {
            if (ma_n != "")
            {
                account_detail_from_01.Clear();
                account_detail_from_01.Add(ma_n + " ," + ms_a);
                ConnectionWithAccess.query = "select A_N,S_A,D_Y,[DESC],[ALIASS],PROP,PAN,CITY,COUNTRY,PIN,DIST,STATE,BUDGET,DIS,CRE_DAYS,MRK,SUB_GROUP,BST,BST_DT,CST,CST_DT,REQ_LBT, LBT_RATE,MARK,[USER],[CURRENCY],aadhar_card,gst_number from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + ma_n + "' and s_a ='" + ms_a + "' and d_y = '@@@'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                int mcolumncount = dtData1.Columns.Count;
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {
                            temp_word = dtData1.Rows[iRowCount][i].ToString();
                            account_detail_from_01.Add(temp_word);
                        }
                    }
                }
                if (account_detail_from_01.Count() < mcolumncount)
                {
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        account_detail_from_01.Add("");
                    }
                }
            }
        }

        private void get_account_details_from_04(string ma_n, string ms_a)
        {
            if (ma_n != "")
            {
                account_detail_from_04.Clear();
                account_detail_from_04.Add(ma_n + " ," + ms_a);
                ConnectionWithAccess.query = "select A_N,S_A,D_Y,ADD1,ADD2,ADD3,CITY,COUNTRY,BANK_NAM,BANK_AC,BANK_IFC,IT_ACC,LBT_NUM,VAT_TIN,ISD,STD,O_MOB,R_MOB,PHONE1,PHONE12,PHONE2,PHONE22,FAX,EMAIL,WEB,CST,STBST,STBST_DT,TIN_NUM,TPT,BILLX2,TX_CODE from " + ConnectionWithAccess.tablename[04] + " where a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and d_y = '@@@'";
                DataTable dtAccountData = ConnectionCommand.fGetDataTable();
                int mcolumncount = dtAccountData.Columns.Count;
                if (dtAccountData != null && dtAccountData.Rows.Count > 0)
                {

                    for (int iRowCount = 0; iRowCount < dtAccountData.Rows.Count; iRowCount++)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {
                            account_detail_from_04.Add(dtAccountData.Rows[iRowCount][i].ToString());
                        }
                    }
                }
                if (account_detail_from_04.Count() < mcolumncount)
                {
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        account_detail_from_04.Add("");
                    }
                }
                temp_int = mcolumncount;
                ConnectionWithAccess.query = "select BANKNAME,BANKADDRESS,BANKCITY,BANKACCNO,BANKNEFT from " + ConnectionWithAccess.tablename[27] + " where a_n = '" + ma_n + "' and s_a = '" + ms_a + "'";
                dtAccountData = ConnectionCommand.fGetDataTable();
                mcolumncount = dtAccountData.Columns.Count;
                if (dtAccountData != null && dtAccountData.Rows.Count > 0)
                {

                    for (int iRowCount = 0; iRowCount < dtAccountData.Rows.Count; iRowCount++)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {
                            account_detail_from_04.Add(dtAccountData.Rows[iRowCount][i].ToString());
                        }
                    }
                }
                if (account_detail_from_04.Count() < mcolumncount + temp_int)
                {
                    for (int i = account_detail_from_04.Count(); i <= mcolumncount + temp_int - 1; i++)
                    {
                        account_detail_from_04.Add("");
                    }
                }


            }
        }

        private void get_account_details_with_d_y_from_01(string ma_n, string ms_a, string md_y)
        {
            if (ma_n != "")
            {
                account_detail_from_01.Clear();
                account_detail_from_01.Add(ma_n + " ," + ms_a);
                ConnectionWithAccess.query = "select A_N,S_A,D_Y,[DESC],[ALIASS],PROP,PAN,CITY,COUNTRY,PIN,DIST,STATE,BUDGET,DIS,CRE_DAYS,MRK,SUB_GROUP,BST,BST_DT,CST,CST_DT,REQ_LBT, LBT_RATE,MARK,[USER],[CURRENCY],aadhar_card,gst_number from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + ma_n + "' and s_a ='" + ms_a + "' and d_y = '" + md_y + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                int mcolumncount = dtData1.Columns.Count;
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {

                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {

                            temp_word = dtData1.Rows[iRowCount][i].ToString();
                            account_detail_from_01.Add(temp_word);
                        }
                    }
                }
                if (account_detail_from_01.Count() < mcolumncount)
                {
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        account_detail_from_01.Add("");
                    }
                }
            }
        }

        private void get_account_details_with_d_y_from_04(string ma_n, string ms_a, string md_y)
        {
            if (ma_n != "")
            {
                account_detail_from_04.Clear();
                account_detail_from_04.Add(ma_n + " ," + ms_a);
                ConnectionWithAccess.query = "select A_N,S_A,D_Y,ADD1,ADD2,ADD3,CITY,COUNTRY,BANK_NAM,BANK_AC,BANK_IFC,IT_ACC,LBT_NUM,VAT_TIN,ISD,STD,O_MOB,R_MOB,PHONE1,PHONE12,PHONE2,PHONE22,FAX,EMAIL,WEB,CST,STBST,STBST_DT,TIN_NUM,TPT,BILLX2,TX_CODE from " + ConnectionWithAccess.tablename[04] + " where a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and d_y = '" + md_y + "'";
                DataTable dtAccountData = ConnectionCommand.fGetDataTable();
                int mcolumncount = dtAccountData.Columns.Count;
                if (dtAccountData != null && dtAccountData.Rows.Count > 0)
                {

                    for (int iRowCount = 0; iRowCount < dtAccountData.Rows.Count; iRowCount++)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {
                            account_detail_from_04.Add(dtAccountData.Rows[iRowCount][i].ToString());
                        }
                    }
                }
                if (account_detail_from_04.Count() < mcolumncount)
                {
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        account_detail_from_04.Add("");
                    }
                }
                temp_int = mcolumncount;
                ConnectionWithAccess.query = "select BANKNAME,BANKADDRESS,BANKCITY,BANKACCNO,BANKNEFT from " + ConnectionWithAccess.tablename[27] + " where a_n = '" + ma_n + "' and s_a = '" + ms_a + "'";
                dtAccountData = ConnectionCommand.fGetDataTable();
                mcolumncount = dtAccountData.Columns.Count;
                if (dtAccountData != null && dtAccountData.Rows.Count > 0)
                {

                    for (int iRowCount = 0; iRowCount < dtAccountData.Rows.Count; iRowCount++)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {
                            account_detail_from_04.Add(dtAccountData.Rows[iRowCount][i].ToString());
                        }
                    }
                }
                if (account_detail_from_04.Count() < mcolumncount + temp_int)
                {
                    for (int i = account_detail_from_04.Count(); i <= mcolumncount + temp_int - 1; i++)
                    {
                        account_detail_from_04.Add("");
                    }
                }


            }
        }

        private void get_item_details_from_05_using_title(string mtitle)
        {
            if (mtitle != "")
            {
                item_details_from_05.Clear();
                item_details_from_05.Add(mtitle);
                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where [title] = '" + mtitle + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    int mcolumncount = dtData1.Columns.Count;
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {
                            temp_word = dtData1.Rows[iRowCount][i].ToString();
                            item_details_from_05.Add(temp_word);
                        }
                    }
                    if (account_detail_from_01.Count() < mcolumncount)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {
                            item_details_from_05.Add("");
                        }
                    }
                    if (item_details_from_05[8] == "")
                        item_details_from_05[8] = "0";
                    if (item_details_from_05[9] == "")
                        item_details_from_05[9] = "0";
                }
            }
        }

        private void get_item_details_from_05_using_type_item_code(string mtype, string mitem_code)
        {
            if (mtype != "" && mitem_code != "")
            {
                item_details_from_05.Clear();
                //item_details_from_05.Add(mtitle);
                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    int mcolumncount = dtData1.Columns.Count;
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {
                            temp_word = dtData1.Rows[iRowCount][i].ToString();
                            item_details_from_05.Add(temp_word);
                        }
                    }
                    if (account_detail_from_01.Count() < mcolumncount)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {
                            item_details_from_05.Add("");
                        }
                    }
                    if (item_details_from_05[8] == "")
                        item_details_from_05[8] = "0";
                    if (item_details_from_05[9] == "")
                        item_details_from_05[9] = "0";
                }
            }
        }

        private void get_item_list_from_sale_purchase_file(string mbook, string mprd, int md_c, string ma_n, string ms_a, int md_n)
        {
            if (mbook == "S")
            {
                invoice_item_list.Clear();
                ConnectionWithAccess.query = "select [type], item_code, [title],price,cat,qty,amount from " + ConnectionWithAccess.tablename[03] + " where [prd] = '" + mprd + "' and d_c = " + md_c + " and d_n = '" + md_n + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    int mcolumncount = dtData1.Columns.Count;
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {
                            temp_word = dtData1.Rows[iRowCount][i].ToString();
                            invoice_item_list.Add(temp_word);
                        }
                    }
                    if (account_detail_from_01.Count() < mcolumncount)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {
                            invoice_item_list.Add("");
                        }
                    }
                }
            }
            else if (mbook == "P")
            {
                invoice_item_list.Clear();
                ConnectionWithAccess.query = "select [type], item_code, [title],price,cat,qty,amount from " + ConnectionWithAccess.tablename[03] + " where [prd] = '" + mprd + "' and d_c = " + md_c + " and a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and d_n = '" + md_n + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    int mcolumncount = dtData1.Columns.Count;
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {
                            temp_word = dtData1.Rows[iRowCount][i].ToString();
                            invoice_item_list.Add(temp_word);
                        }
                    }
                    if (account_detail_from_01.Count() < mcolumncount)
                    {
                        for (int i = 0; i <= mcolumncount - 1; i++)
                        {
                            invoice_item_list.Add("");
                        }
                    }
                }
            }
        }

        private void get_tax_desc_from_dc(string book, string md_c, int mtx_code)
        {
            if (book != "" && md_c != "")
            {
                ConnectionWithAccess.sales_purchase_transfer = null;
                if (book == "S")
                    ConnectionWithAccess.query = "select tx_code,tax_rate, [desc],a_n from " + ConnectionWithAccess.tablename[06] + " where d_c = " + md_c + " and tx_code = " + mtx_code;
                else if (book == "P")
                    ConnectionWithAccess.query = "select tx_code,tax_rate, [desc],a_n from " + ConnectionWithAccess.tablename[06] + " where d_c = " + md_c + " and tx_code = " + mtx_code;
                else if (book == "R")
                    ConnectionWithAccess.query = "select tx_code,tax_rate, [desc],a_n from " + ConnectionWithAccess.tablename[06] + " where d_c = " + md_c + " and tx_code = " + mtx_code;
                DataTable dtData1 = ConnectionCommand.fGetDataTable();

                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        if (subtabDataEntry.SelectedIndex == 0)
                        {
                            sitaxrate.Text = dtData1.Rows[0][1].ToString();
                            sitaxdesc.Text = dtData1.Rows[0][2].ToString();
                            ConnectionWithAccess.sales_purchase_transfer = dtData1.Rows[0][3].ToString();
                        }
                        else if (subtabDataEntry.SelectedIndex == 1)
                        {
                            pitaxrate.Text = dtData1.Rows[0][1].ToString();
                            pitaxdesc.Text = dtData1.Rows[0][2].ToString();
                            ConnectionWithAccess.sales_purchase_transfer = dtData1.Rows[0][3].ToString();
                        }
                    }
                }
            }
        }

        private void brpartycode_TextChanged(object sender, EventArgs e)
        {
            if (braccountdg.Visible == true)
            {
                ConnectionWithAccess.data_entry_working = "Bank Receipt";
                ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[desc] like '%" + brpartycode.Text + "%'";
                ConnectionCommand.accountHelp_datatable_Seperate(braccountdg, "braccountdg");
                if (braccountdg.Rows.Count == 1)
                {
                    ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[city] like '%" + brpartycode.Text + "%'";
                    ConnectionCommand.accountHelp_datatable(braccountdg, "braccountdg");
                }
                if (braccountdg.Rows.Count > 1)
                {
                    common_account_head(braccountdg.CurrentRow.Cells[2].Value.ToString());
                    lbl_br_account_head.Text = ConnectionWithAccess.macc_desc;
                }
            }
        }

        private void braccountdg_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                ConnectionWithAccess.mdesc = braccountdg.CurrentRow.Cells[0].Value.ToString();
                ConnectionWithAccess.mcity = braccountdg.CurrentRow.Cells[1].Value.ToString();
                bra_n.Text = braccountdg.CurrentRow.Cells[2].Value.ToString();
                brs_a.Text = braccountdg.CurrentRow.Cells[3].Value.ToString();
                show_images();
                braccountdg.Visible = false;
                brpartycode.Text = ConnectionWithAccess.mdesc;
                brpartycity.Text = ConnectionWithAccess.mcity;
            }
        }

        private void RepFrom_ValueChanged(object sender, EventArgs e)
        {
            report_keys_enable();
        }

        private void btnbackup_Click(object sender, EventArgs e)
        {
            //BackupDatabase("Ap2_backup_Trial");
        }

        //public static void BackupDatabase(string backUpFile)
        //{
        //    ServerConnection con = new ServerConnection(@"xxxxx\SQLEXPRESS");
        //    Server server = new Server(con);
        //    Backup source = new Backup();
        //    source.Action = BackupActionType.Database;
        //    source.Database = "MyDataBaseName";
        //    BackupDeviceItem destination = new BackupDeviceItem(backUpFile, DeviceType.File);
        //    source.Devices.Add(destination);
        //    source.SqlBackup(server);
        //    con.Disconnect();
        //}

        //public static void RestoreDatabase(string backUpFile)
        //{
        //    ServerConnection con = new ServerConnection(@"xxxxx\SQLEXPRESS");
        //    Server server = new Server(con);
        //    Restore destination = new Restore();
        //    destination.Action = RestoreActionType.Database;
        //    destination.Database = "MyDataBaseName"; ;
        //    BackupDeviceItem source = new BackupDeviceItem(backUpFile, DeviceType.File);
        //    destination.Devices.Add(source);
        //    destination.ReplaceDatabase = true;
        //    destination.SqlRestore(server);
        //}

        public void common_account_help(string search_account_name)
        {
            function_working = "Account Ledger";
            dgv_ledger_acc_help.Visible = true;
            ledger_item_help.Visible = false;
            ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[desc] like '%" + search_account_name + "%'";
            ConnectionCommand.accountHelp_datatable_Seperate(dgv_ledger_acc_help, "dgv_ledger_acc_help");
            if (dgv_ledger_acc_help.Rows.Count == 1)
            {
                ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[city] like '%" + search_account_name + "%'";
                ConnectionCommand.accountHelp_datatable_Seperate(dgv_ledger_acc_help, "dgv_ledger_acc_help");
                if (dgv_ledger_acc_help.Rows.Count == 1)
                {
                    lbl_ledger_master_account_name.Visible = false;
                    dgv_ledger_acc_help.Visible = false;
                    ledger_item_help.Visible = true;
                    function_working = "Item Ledger";
                    ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where [title] like '%" + search_account_name + "%'";
                    ConnectionCommand.accountHelp_datatable_Seperate(ledger_item_help, "ledger_item_help", "[title] ASC");
                }
            }
        }

        private void get_common_account_head()
        {
            if (dgv_ledger_acc_help.CurrentRow != null)
            {
                if (dgv_ledger_acc_help.CurrentRow.Cells[2].Value != null && dgv_ledger_acc_help.CurrentRow.Cells[3].Value != null)
                {
                    ConnectionWithAccess.ma_n = dgv_ledger_acc_help.CurrentRow.Cells[2].Value.ToString();
                    ConnectionWithAccess.ms_a = dgv_ledger_acc_help.CurrentRow.Cells[3].Value.ToString();
                    ConnectionWithAccess.query = "select distinct [desc], city from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + ConnectionWithAccess.ma_n + "' and s_a ='@@@'";
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        if (dtData1.Rows[0][0] != null)
                        {
                            lbl_ledger_master_account_name.Text = dtData1.Rows[0][0].ToString();
                        }
                    }
                }
            }
        }

        private void common_account_head(string ma_n)
        {
            if (ma_n != null)
            {
                ConnectionWithAccess.macc_desc = null;
                ConnectionWithAccess.query = "select distinct [desc], city from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + ma_n + "' and s_a ='@@@'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();

                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        ConnectionWithAccess.macc_desc = dtData1.Rows[0][0].ToString();
                    }
                }
            }
        }

        private void CheckBox1_CheckedChanged(object sender, EventArgs e)
        {
            if (Convert.ToDateTime(ConnectionWithAccess.medate) >= DateTime.Today)
            {
                last_date = DateTime.Today;
                first_date = Convert.ToDateTime(ConnectionWithAccess.msdate);
            }
            else
            {
                first_date = Convert.ToDateTime(ConnectionWithAccess.msdate);
                last_date = Convert.ToDateTime(ConnectionWithAccess.medate);
            }
            //if (cb_ledger_full_period.Checked == true)
            //{
            //    Ledfrom.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            //    LedTo.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            //    LedTo.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
            //    Ledfrom.Value = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
            //}
            //else
            //    Ledfrom.Value = Convert.ToDateTime(ConnectionWithAccess.msdate);
            LedTo.Value = last_date;

        }

        private void brchkstatus_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (brchkstatus.SelectedIndex == 1)
            {
                brpassdate.Text = null;
                brpassdate.Visible = true;
            }
            else
            {
                brpassdate.Text = null;
                brpassdate.Visible = false;
            }
        }

        private void braccountdg_Click(object sender, EventArgs e)
        {
            select_party_for_bank();
            brpartyname.Text = ConnectionWithAccess.mdesc;
            brpartycontact.Text = ConnectionWithAccess.accountcontact;
            brpartyaddress.Text = ConnectionWithAccess.accountaddress;
            brpartyoverallbalance.Text = Convert.ToString(calculate_account_balance(bra_n.Text, brs_a.Text, Convert.ToString(brdatetime.Text)));
            if (braccountdg.CurrentRow != null)
            {
                common_account_head(bra_n.Text);
                lbl_br_account_head.Text = ConnectionWithAccess.macc_desc;
            }
            bramt.ReadOnly = false;
            brtranlist.Visible = true;
            braccountdg.Visible = false;
            bramt.Focus();
        }

        private void pipartycode_TextChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Purchase Party";
            ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[22] + " where d_c = " + Convert.ToInt32(pidbc.Text) + " and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[22] + " where d_c = " + Convert.ToInt32(pidbc.Text) + " and d_n = 999999) and s_a <> '@@@' and [desc] like '%" + pipartycode.Text + "%'";
            ConnectionCommand.accountHelp_datatable(pi_party_help, "pi_party_help");
            if (pi_party_help.Rows.Count == 1)
            {
                ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[22] + " where d_c = " + Convert.ToInt32(pidbc.Text) + " and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[22] + " where d_c = " + Convert.ToInt32(pidbc.Text) + " and d_n = 999999) and s_a <> '@@@' and [city] like '%" + pipartycode.Text + "%'";
                ConnectionCommand.accountHelp_datatable(pi_party_help, "pi_party_help");
                if (pi_party_help.Rows.Count == 1)
                {
                    pipartycode.Text = pipartycode.Text.Substring(0, pipartycode.Text.Length - 1);
                    pipartycode.SelectionStart = pipartycode.Text.Length;
                }
            }
        }

        private void pipartycode_KeyPress(object sender, KeyPressEventArgs e)
        {
            pi_party_help.Visible = true;
        }

        private void pi_party_help_Click(object sender, EventArgs e)
        {
            pipartycode.Text = Convert.ToString(pi_party_help.CurrentRow.Cells[0].Value);
            picity.Text = Convert.ToString(pi_party_help.CurrentRow.Cells[1].Value);
            pia_n.Text = Convert.ToString(pi_party_help.CurrentRow.Cells[2].Value);
            pis_a.Text = Convert.ToString(pi_party_help.CurrentRow.Cells[3].Value);
            if (pitaxcode.Text != "")
                get_tax_desc_from_dc("P", sidbc.Text, Convert.ToInt32(pitaxcode.Text));
            show_images();
            ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[22] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + pidbc.Text + " and a_n = '" + pia_n.Text + "' and s_a = '" + pis_a.Text + "'";
            ConnectionCommand.ExportToText(pidbc, pidocno);
            pi_party_help.Visible = false;
            //pidocno.ReadOnly = false;
            pitransport.Visible = true;
            piitemlist.Enabled = true;
            pibasicamt.ReadOnly = false;
            pidocno.Focus();
        }

        private void pi_party_help_KeyDown(object sender, KeyEventArgs e)
        {
            DispEmail.Clear();
            sipartyname.Clear();
            sipartyaddress.Clear();
            sicontactdetails.Clear();
            pitransport.Items.Clear();
            pibasicamt.Text = "0.00";
            pitaxamt.Text = "0.00";
            piroundoffamt.Text = "0.00";
            pigrossamt.Text = "0.00";
            pitaxcode.Text = "0";
            if (e.KeyCode == Keys.Enter)
            {
                ConnectionWithAccess.query = "select a_n, s_a, d_y, [desc], city from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + pidbc.Text + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='') and ([desc] like '%" + pi_party_help.SelectedCells[0].Value + "%')";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        pia_n.Text = dtData1.Rows[0][0].ToString();
                        pis_a.Text = dtData1.Rows[0][1].ToString();
                        show_images();
                    }
                }
                populate_screen();
                ConnectionWithAccess.query = "select tx_code,tax_rate, [desc] from " + ConnectionWithAccess.tablename[06] + " where d_c = " + Convert.ToInt32(pidbc.Text) + " and tx_code = " + pitaxcode.Text;
                dtData1 = ConnectionCommand.fGetDataTable();

                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        pitaxrate.Text = dtData1.Rows[0][1].ToString();
                        pitaxdesc.Text = dtData1.Rows[0][2].ToString();
                    }
                    else
                    {
                        pitaxdesc.Text = "";
                        pitaxrate.Text = "0.00";
                    }
                }
                else
                {
                    pitaxdesc.Text = "";
                    pitaxrate.Text = "0.00";
                }
                pi_party_help.Visible = false;
                pipartycode.Enabled = false;
                picity.Enabled = false;
            }
            else
            {
                if (e.KeyCode == Keys.Down)
                    rowIndex = pi_party_help.CurrentRow.Index + 1;
                else
                    if (e.KeyCode == Keys.Up)
                        rowIndex = pi_party_help.CurrentRow.Index - 1;
                ConnectionWithAccess.query = "select a_n, s_a, d_y, [desc], city from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[22] + " where d_c = " + pidbc.Text + " and d_n = 999999) and s_a <> '@@@' and ([desc] like '%" + pi_party_help.Rows[rowIndex].Cells[0].Value + "%')";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        pia_n.Text = dtData1.Rows[0][0].ToString();
                        pis_a.Text = dtData1.Rows[0][1].ToString();
                    }
                }
                show_images();
            }
        }

        private void master_account_help_dg_Click(object sender, EventArgs e)
        {
            select_account_for_master();
            get_bank_details();
            if (cbParent.SelectedItem.Equals("SUNDRY DEBTORS") && tbdelivery.Text == "")
                btn_add_delivery_account.Visible = true;
        }

        private void master_account_help_dg_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                ConnectionWithAccess.query = "select a_n, s_a, d_y, [desc], city from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + pidbc.Text + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='') and ([desc] like '%" + pi_party_help.SelectedCells[0].Value + "%')";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        tbA_N.Text = dtData1.Rows[0][0].ToString();
                        tbS_A.Text = dtData1.Rows[0][1].ToString();
                        tbd_y.Text = dtData1.Rows[0][2].ToString();
                    }
                }

                if (ConnectionWithAccess.md_y.Equals(""))
                    ConnectionWithAccess.query = "select phone1, f4.add1, f4.add2, f1.city, tpt, email, tx_code, bst, f4.cst from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4 where f1.a_n = f4.a_n and f1.s_a = f4.s_a and f1.d_y = f4.d_y and f1.a_n = '" + tbA_N.Text + "' and f1.s_a = '" + tbS_A.Text + "'";
                else
                    ConnectionWithAccess.query = "select phone1, f4.add1, f4.add2, f1.city, tpt, email, tx_code, bst, f4.cst from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[04] + " f4 where f1.a_n = f4.a_n and f1.s_a = f4.s_a and f1.d_y = f4.d_y and f1.a_n = '" + tbA_N.Text + "' and f1.s_a = '" + tbS_A.Text + "' and f1.d_y = '" + ConnectionWithAccess.md_y + "'";
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        sicontactdetails.Text = dtData1.Rows[0][0].ToString();
                        sipartyaddress.Text = dtData1.Rows[0][1].ToString() + ' ' + dtData1.Rows[0][2].ToString() + ' ' + dtData1.Rows[0][3].ToString();
                        pitransport.Text = dtData1.Rows[0][4].ToString();
                        DispEmail.Text = dtData1.Rows[0][5].ToString();
                        pitaxcode.Text = dtData1.Rows[0][6].ToString();
                        pitx_code.Text = dtData1.Rows[0][6].ToString();
                    }
                    else
                    {
                        pitaxdesc.Text = "";
                        pitaxrate.Text = "0.00";
                    }
                }
                ConnectionWithAccess.query = "select tx_code,tax_rate, [desc] from " + ConnectionWithAccess.tablename[06] + " where d_c = " + Convert.ToInt32(sidbc.Text) + " and tx_code = " + sitaxcode.Text;
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        pitaxrate.Text = dtData1.Rows[0][1].ToString();
                        pitaxdesc.Text = dtData1.Rows[0][2].ToString();
                    }
                    else
                    {
                        pitaxdesc.Text = "";
                        pitaxrate.Text = "0.00";
                    }
                }
                else
                {
                    pitaxdesc.Text = "";
                    pitaxrate.Text = "0.00";
                }
                pi_party_help.Visible = false;
                pipartycode.Enabled = false;
                picity.Enabled = false;
            }
            else
            {
                if (e.KeyCode == Keys.Down)
                {
                    rowIndex = pi_party_help.CurrentRow.Index + 1;
                }
                else
                    if (e.KeyCode == Keys.Up)
                    {
                        rowIndex = pi_party_help.CurrentRow.Index - 1;
                    }
                ConnectionWithAccess.query = "select a_n, s_a, d_y, [desc], city from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[22] + " where d_c = " + pidbc.Text + " and d_n = 999999) and s_a <> '@@@' and ([desc] like '%" + pi_party_help.Rows[rowIndex].Cells[0].Value + "%')";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        tbA_N.Text = dtData1.Rows[0][0].ToString();
                        tbS_A.Text = dtData1.Rows[0][1].ToString();
                        tbd_y.Text = dtData1.Rows[0][2].ToString();
                    }
                }
                show_images();
            }
        }

        private void select_account_for_master()
        {
            if (tbDesc.Enabled == true)
            {
                tbA_N.Text = master_account_help_dg.CurrentRow.Cells[2].Value.ToString();
                tbS_A.Text = Convert.ToString(master_account_help_dg.CurrentRow.Cells[3].Value);
                ConnectionWithAccess.mdesc = Convert.ToString(master_account_help_dg.CurrentRow.Cells[0].Value);
                tbCity.Text = master_account_help_dg.CurrentRow.Cells[1].Value.ToString();
                tbDesc.Text = ConnectionWithAccess.mdesc;
                fill_transport(tbA_N.Text, tbCity.Text, tbTPT);
                update_master_account_screen_details(tbA_N.Text, tbS_A.Text, tbd_y.Text);
                tbopenbalance.Enabled = true;
            }
            else
            {
                tbA_N.Text = master_account_help_dg.CurrentRow.Cells[2].Value.ToString();
                tbS_A.Text = Convert.ToString(master_account_help_dg.CurrentRow.Cells[3].Value);
                tbd_y.Text = master_account_help_dg.CurrentRow.Cells[4].Value.ToString();
                ConnectionWithAccess.mdesc = Convert.ToString(master_account_help_dg.CurrentRow.Cells[0].Value);
                tbdelivery_city.Text = master_account_help_dg.CurrentRow.Cells[1].Value.ToString();
                tbdelivery.Text = ConnectionWithAccess.mdesc;
                fill_transport(tbA_N.Text, tbCity.Text, tbTPT);
                update_master_account_screen_details(tbA_N.Text, tbS_A.Text, tbd_y.Text);
                tbopenbalance.Enabled = false;
            }
            show_images();
            master_account_help_dg.Visible = false;
            Bank_Details.Visible = true;
            tbDesc.Enabled = false;
            tbCity.Enabled = false;
        }

        private void si_item_help_Click(object sender, EventArgs e)
        {
            mtype = Convert.ToString(si_item_help.CurrentRow.Cells[0].Value);
            mitem_code = Convert.ToString(si_item_help.CurrentRow.Cells[1].Value);
            ConnectionWithAccess.query = "select [type], item_code, [title],price,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where a_n = '" + sia_n.Text + "' and s_a = '" + sis_a.Text + "' and [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    siitemlist.Rows[siitemlistrowindex].Cells[0].Value = dtData1.Rows[0][0].ToString();
                    siitemlist.Rows[siitemlistrowindex].Cells[1].Value = dtData1.Rows[0][1].ToString();
                    siitemlist.Rows[siitemlistrowindex].Cells[6].Value = dtData1.Rows[0][3].ToString();
                    if (dtData1.Rows[0][4].ToString() != "")
                        siitemlist.Rows[siitemlistrowindex].Cells[7].Value = dtData1.Rows[0][4].ToString();
                    if (dtData1.Rows[0][5].ToString() != "")
                        siitemlist.Rows[siitemlistrowindex].Cells[8].Value = dtData1.Rows[0][5].ToString();
                }
            }
            get_item_details_from_05_using_type_item_code(mtype, mitem_code);
            siitemlist.Rows[siitemlistrowindex].Cells[0].Value = item_details_from_05[0];
            siitemlist.Rows[siitemlistrowindex].Cells[1].Value = item_details_from_05[1];
            siitemlist.Rows[siitemlistrowindex].Cells[2].Value = item_details_from_05[2];
            mtitle = Convert.ToString(siitemlist.Rows[siitemlistrowindex].Cells[2].Value);
            mcase = 1;
            mbox = Convert.ToDouble(item_details_from_05[3]);
            mqty = Convert.ToDouble(item_details_from_05[4]);
            mprice = Convert.ToDouble(item_details_from_05[5]);
            siitemlist.Rows[siitemlistrowindex].Cells[3].Value = mcase;
            siitemlist.Rows[siitemlistrowindex].Cells[4].Value = mbox * mcase;
            siitemlist.Rows[siitemlistrowindex].Cells[5].Value = mbox * mcase * mqty;
            if (siitemlist.Rows[siitemlistrowindex].Cells[6].Value == null)
                siitemlist.Rows[siitemlistrowindex].Cells[6].Value = mprice;
            else
                if (siitemlist.Rows[siitemlistrowindex].Cells[6].Value == System.DBNull.Value)
                    siitemlist.Rows[siitemlistrowindex].Cells[6].Value = mprice.ToString();
            mamount = mcase * mbox * mqty * mprice;
            siitemlist.Rows[siitemlistrowindex].Cells[7].Value = Convert.ToString(mamount);
            siitemlist.Rows[siitemlistrowindex].Cells[8].Value = item_details_from_05[7];
            siitemlist.Rows[siitemlistrowindex].Cells[9].Value = item_details_from_05[8];
            siitemlist.Rows[siitemlistrowindex].Cells[10].Value = item_details_from_05[9];
            si_item_help.Visible = false;
            if (!chb_allow_stock_check_bypass.Checked)
            {
                double.TryParse(item_details_from_05[6].ToString(), out temp_double);
                if (temp_double == 0.0)
                    MessageBox.Show("Sorry, There is no Stock to Sell");
                else if (mqty > temp_double)
                {
                    MessageBox.Show("Sorry, Available Stock for sell Quantity is " + temp_double.ToString());
                    if (temp_double > 0)
                        mqty = temp_double;
                    else
                        mqty = 0;
                    siitemlist.Rows[siitemlistrowindex].Cells[4].Value = Convert.ToDouble(mqty / Convert.ToDouble(item_details_from_05[4]));
                    siitemlist.Rows[siitemlistrowindex].Cells[5].Value = mqty;
                    mamount = mcase * mbox * mqty * mprice;
                    siitemlist.Rows[siitemlistrowindex].Cells[7].Value = Convert.ToString(mamount);
                }
            }
            calculateSaleItemTotal();
            show_images();
        }

        private void dgv_ledger_acc_help_Click(object sender, EventArgs e)
        {
            rowIndex = dgv_ledger_acc_help.CurrentCell.RowIndex;
            rla_n.Text = dgv_ledger_acc_help.Rows[rowIndex].Cells[2].Value.ToString();
            rls_a.Text = dgv_ledger_acc_help.Rows[rowIndex].Cells[3].Value.ToString();
            tb_ledger_account_name.Text = dgv_ledger_acc_help.Rows[rowIndex].Cells[0].Value.ToString();
            tb_ledger_account_city.Text = dgv_ledger_acc_help.Rows[rowIndex].Cells[1].Value.ToString();
            show_images();
            dgv_ledger_acc_help.Visible = false;
            lbl_ledger_master_account_name.Visible = true;
            btn_gen_ledg.Visible = true;
            btn_gen_ledg.Focus();
        }

        private void dgv_ledger_acc_help_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyValue == 13)
            {
                if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 1)
                {
                    row_pointer = dgv_ledger_acc_help.CurrentCell.RowIndex;
                    tb_ledger_account_name.Text = dgv_ledger_acc_help.CurrentRow.Cells[0].Value.ToString();
                    tb_ledger_account_city.Text = dgv_ledger_acc_help.CurrentRow.Cells[1].Value.ToString();
                    dgv_ledger_acc_help.Visible = false;
                    lbl_ledger_master_account_name.Visible = false;
                    btn_gen_ledg.Visible = true;
                    //if (rla_n.Text == "4002")
                    //    cb_add_purchase_items_in_ledger.Visible = true;
                    //if (rla_n.Text == "2002")
                    //    cb_add_sale_items_in_ledger.Visible = true;
                }
            }
            else
            {
                get_common_account_head();
            }
        }

        private void dgv_ledger_acc_help_KeyPress(object sender, KeyPressEventArgs e)
        {
            get_common_account_head();
        }

        private void piitemlist_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                mRowIndex = piitemlist.SelectedCells[0].RowIndex;
                ConnectionWithAccess.query = "select type, item_code, title from " + ConnectionWithAccess.tablename[05] + " where (type = '" + mtype + "' and item_code = '" + mitem_code + "') or title = '" + mtitle + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        piitemlist.SelectedCells[0].Value = dtData1.Rows[0][0].ToString();
                        piitemlist.SelectedCells[1].Value = dtData1.Rows[0][1].ToString();
                        piitemlist.SelectedCells[2].Value = dtData1.Rows[0][2].ToString();
                    }
                }
            }
        }

        private void piitemlist_KeyPress(object sender, KeyPressEventArgs e)
        {
            if (e.KeyChar == 27)
            {
                piitemlist.BringToFront();
                pi_party_help.Visible = false;
            }
            else if (e.KeyChar == 9)
            {
                piitemlist.BringToFront();
                pi_party_help.Visible = false;
            }
            else if (e.KeyChar == 13)
            {
                piitemlist.BringToFront();
                pi_party_help.Visible = false;
                get_item_details_from_05_using_type_item_code(mtype, mitem_code);
                piitemlist.SelectedCells[2].Value = item_details_from_05[2];
                piitemlist.SelectedCells[3].Value = 1;
                piitemlist.SelectedCells[4].Value = item_details_from_05[3];
            }
        }

        private void piitemlist_SelectionChanged(object sender, EventArgs e)
        {
            if (Control.ModifierKeys == Keys.Down)
            {
                mRowIndex = piitemlist.SelectedCells[0].RowIndex;
                mtype = Convert.ToString(piitemlist.Rows[mRowIndex].Cells[0].Value);
                mitem_code = Convert.ToString(piitemlist.Rows[mRowIndex].Cells[1].Value);
                mtitle = Convert.ToString(piitemlist.Rows[mRowIndex].Cells[2].Value);
            }
            else
            {
                if (piitemlist.CurrentCell != null)
                {
                    columnIndex = piitemlist.CurrentCell.ColumnIndex;
                    if (columnIndex == 3)
                    {
                        mcase = 1;
                        mtype = Convert.ToString(piitemlist.Rows[piitemlistrowindex].Cells[0].Value);
                        mitem_code = Convert.ToString(piitemlist.Rows[piitemlistrowindex].Cells[1].Value);
                        mtitle = Convert.ToString(piitemlist.Rows[piitemlistrowindex].Cells[2].Value);
                        ConnectionWithAccess.query = "select packing, box from " + ConnectionWithAccess.tablename[05] + " where [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
                        DataTable dtData1 = ConnectionCommand.fGetDataTable();
                        if (dtData1 != null && dtData1.Rows.Count > 0)
                        {
                            if (dtData1.Rows[0][0] != null)
                            {
                                if (piitemlist.Rows[piitemlistrowindex].Cells[3].Value != System.DBNull.Value)
                                    mcase = Convert.ToDouble(piitemlist.Rows[piitemlistrowindex].Cells[3].Value);
                                mbox = Convert.ToDouble(dtData1.Rows[0][0].ToString());
                                mqty = Convert.ToDouble(dtData1.Rows[0][1].ToString());
                                piitemlist.Rows[piitemlistrowindex].Cells[4].Value = mbox * mcase;
                                piitemlist.Rows[piitemlistrowindex].Cells[5].Value = (Convert.ToDouble(piitemlist.Rows[piitemlistrowindex].Cells[4].Value)) * mqty;
                                piitemlist.Rows[piitemlistrowindex].Cells[7].Value = (Convert.ToDouble(piitemlist.Rows[piitemlistrowindex].Cells[5].Value)) * (Convert.ToDouble(piitemlist.Rows[piitemlistrowindex].Cells[6].Value));
                                calculatepurcItemTotal();
                            }
                        }
                    }
                    else if (columnIndex == 4)
                    {
                        if (piitemlist.Rows[piitemlistrowindex].Cells[3].Value == null || piitemlist.Rows[piitemlistrowindex].Cells[3].Value == System.DBNull.Value)
                            piitemlist.Rows[piitemlistrowindex].Cells[3].Value = "0";
                        if (piitemlist.Rows[piitemlistrowindex].Cells[4].Value == null || piitemlist.Rows[piitemlistrowindex].Cells[4].Value == System.DBNull.Value)
                            piitemlist.Rows[piitemlistrowindex].Cells[4].Value = "0";
                        piitemlist.Rows[piitemlistrowindex].Cells[5].Value = (Convert.ToDouble(piitemlist.Rows[piitemlistrowindex].Cells[4].Value)) * mqty;
                        piitemlist.Rows[piitemlistrowindex].Cells[7].Value = (Convert.ToDouble(piitemlist.Rows[piitemlistrowindex].Cells[5].Value)) * (Convert.ToDouble(piitemlist.Rows[piitemlistrowindex].Cells[6].Value));
                        calculatepurcItemTotal();
                    }
                    else if (columnIndex == 5 || columnIndex == 6)
                    {
                        mcase = Convert.ToDouble(piitemlist.Rows[piitemlistrowindex].Cells[3].Value);
                        mbox = Convert.ToDouble(piitemlist.Rows[piitemlistrowindex].Cells[4].Value);
                        mqty = Convert.ToDouble(piitemlist.Rows[piitemlistrowindex].Cells[5].Value);
                        mprice = Convert.ToDouble(piitemlist.Rows[piitemlistrowindex].Cells[6].Value);
                        mamount = mqty * mprice;
                        piitemlist.Rows[piitemlistrowindex].Cells[7].Value = Convert.ToString(mamount);
                        calculatepurcItemTotal();
                    }
                }
            }
            if (Control.ModifierKeys != Keys.None)
            {
                calculatepurcItemTotal();
            }
        }

        private void piitemlist_RowValidating(object sender, DataGridViewCellCancelEventArgs e)
        {
            calculatepurcItemTotal();
        }

        private void piitemlist_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
        {
            e.Control.TextChanged += new EventHandler(textBox_TextChanged);
            cntObject = e.Control;
            cntObject.TextChanged += textBox_TextChanged;
        }

        private void pi_item_help_Click(object sender, EventArgs e)
        {
            mtype = Convert.ToString(pi_item_help.CurrentRow.Cells[0].Value);
            mitem_code = Convert.ToString(pi_item_help.CurrentRow.Cells[1].Value);
            mtitle = Convert.ToString(pi_item_help.CurrentRow.Cells[2].Value);
            get_item_details_from_05_using_type_item_code(mtype, mitem_code);
            piitemlist.Rows[piitemlistrowindex].Cells[0].Value = item_details_from_05[0];
            piitemlist.Rows[piitemlistrowindex].Cells[1].Value = item_details_from_05[1];
            piitemlist.Rows[piitemlistrowindex].Cells[2].Value = item_details_from_05[2];
            mcase = 1;
            mbox = Convert.ToDouble(item_details_from_05[3]);
            mqty = Convert.ToDouble(item_details_from_05[4]);
            mprice = Convert.ToDouble(item_details_from_05[5]);
            piitemlist.Rows[piitemlistrowindex].Cells[3].Value = mcase;
            piitemlist.Rows[piitemlistrowindex].Cells[4].Value = mbox * mcase;
            piitemlist.Rows[piitemlistrowindex].Cells[5].Value = mbox * mqty;
            piitemlist.Rows[piitemlistrowindex].Cells[6].Value = mprice;
            mamount = mcase * mbox * mqty * mprice;
            piitemlist.Rows[piitemlistrowindex].Cells[7].Value = Convert.ToString(mamount);
            piitemlist.Rows[piitemlistrowindex].Cells[8].Value = item_details_from_05[7];
            piitemlist.Rows[piitemlistrowindex].Cells[9].Value = item_details_from_05[8];
            piitemlist.Rows[piitemlistrowindex].Cells[10].Value = item_details_from_05[9];
            pi_item_help.Visible = false;
            calculatepurcItemTotal();
        }

        private void pidbc_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (pidbc.Text != "")
            {
                pia_n.Text = get_a_n_from_d_c("P", Convert.ToInt32(pidbc.Text));
                //ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[22] + " where d_c = " + Convert.ToInt32(pidbc.Text) + " and d_n = 999999";
                //DataTable dtData1 = ConnectionCommand.fGetDataTable();
                //if (dtData1 != null && dtData1.Rows.Count > 0)
                //{
                //    if (dtData1.Rows[0][0] != null)
                //    {
                //        pia_n.Text = dtData1.Rows[0][0].ToString();
                //    }
                //}
                fillpipurclist();
            }
        }

        private void pitx_code_KeyPress(object sender, KeyPressEventArgs e)
        {
            pitaxlist_dgv.Visible = true;
        }

        private void pitx_code_TextChanged(object sender, EventArgs e)
        {
            if (pibasicamt.Text != "0")
            {
                ConnectionWithAccess.query = "select tx_code,tax_rate, [desc] from " + ConnectionWithAccess.tablename[06] + " where d_c = " + Convert.ToInt32(pidbc.Text) + " and tx_code like '" + pitaxcode.Text + "%'";
                ConnectionCommand.accountHelp(pitaxlist_dgv, "pitaxlist_dgv");
                pitaxlist_dgv.Sort(pitaxlist_dgv.Columns[0], ListSortDirection.Ascending);
            }
        }

        private void pitx_code_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Down)
            {
                pitaxlist_dgv.Focus();
            }
        }

        private void pitaxlist_dgv_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                mtx_code = Convert.ToString(pitaxlist_dgv.CurrentRow.Cells[0].Value);
                pitaxrate.Text = Convert.ToString(pitaxlist_dgv.CurrentRow.Cells[1].Value);
                pitaxdesc.Text = Convert.ToString(pitaxlist_dgv.CurrentRow.Cells[2].Value);
                pitx_code.Text = mtx_code;
                pitaxlist_dgv.Visible = false;
            }
        }

        private void pitaxlist_dgv_Click(object sender, EventArgs e)
        {
            pitx_code.Text = Convert.ToString(pitaxlist_dgv.CurrentRow.Cells[0].Value);
            ConnectionWithAccess.query = "select tx_code,tax_rate, [desc] from " + ConnectionWithAccess.tablename[06] + " where d_c = " + Convert.ToInt32(pidbc.Text) + " and tx_code like '" + pitx_code.Text + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    pitaxrate.Text = dtData1.Rows[0][1].ToString();
                    pitaxdesc.Text = dtData1.Rows[0][2].ToString();
                }
            }
            pitaxlist_dgv.Visible = false;
            calculatepurcItemTotal();
        }

        private void btnchangeperiod_Click(object sender, EventArgs e)
        {
            periodgridview.Visible = true;
            ConnectionWithAccess.query = "select prd, start, [end] from " + ConnectionWithAccess.tablename[50] + " order by prd desc";
            ConnectionCommand.accountHelp(periodgridview, "ChangePeriod");
        }

        private void bppartycode_TextChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Bank Payment";
            //ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where (d_y is null or d_y ='') and [desc] like '%" + bppartycode.Text + "%'";
            ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[desc] like '%" + bppartycode.Text + "%'";
            ConnectionCommand.accountHelp_datatable(bp_datagridview, "bp_datagridview");
            if (bp_datagridview.Rows.Count == 1)
            {
                ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[city] like '%" + bppartycode.Text + "%'";
                ConnectionCommand.accountHelp_datatable(bp_datagridview, "bp_datagridview");
            }
            if (bp_datagridview.CurrentRow != null)
            {
                common_account_head(bp_datagridview.CurrentRow.Cells[2].Value.ToString());
                lbl_bp_account_head.Text = ConnectionWithAccess.macc_desc;
            }
        }

        private void bp_datagridview_Click(object sender, EventArgs e)
        {

        }

        private void bp_datagridview_KeyDown(object sender, KeyEventArgs e)
        {

        }

        private void crpartycode_TextChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Cash Receipt";
            //ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where (d_y is null or d_y = ' ' or d_y ='')  and [desc] like '%" + crpartycode.Text + "%'";
            ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[desc] like '%" + crpartycode.Text + "%'";
            ConnectionCommand.accountHelp_datatable(cr_datagridview, "cr_datagridview");
            if (cr_datagridview.Rows.Count == 1)
            {
                ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[city] like '%" + crpartycode.Text + "%'";
                ConnectionCommand.accountHelp_datatable(cr_datagridview, "cr_datagridview");
            }
        }

        private void cr_datagridview_Click(object sender, EventArgs e)
        {
            cramt.ReadOnly = false;
            select_party_for_cash();
            crpartyname.Text = ConnectionWithAccess.mdesc;
            crpartycontact.Text = ConnectionWithAccess.accountcontact;
            crpartyaddress.Text = ConnectionWithAccess.accountaddress;
            crpartybalance.Text = Convert.ToString(calculate_account_balance(cra_n.Text, crs_a.Text, crdatetime.Text));
            if (cr_datagridview.CurrentRow != null)
            {
                common_account_head(cra_n.Text);
                lbl_bp_account_head.Text = ConnectionWithAccess.macc_desc;
            }
            crtranlist.Visible = true;
            cramt.Focus();
        }

        private void select_party_for_cash()
        {
            if (subtabcash.SelectedIndex == 0)
            {
                cra_n.Text = cr_datagridview.CurrentRow.Cells[2].Value.ToString();
                crs_a.Text = Convert.ToString(cr_datagridview.CurrentRow.Cells[3].Value);
                ConnectionWithAccess.mdesc = Convert.ToString(cr_datagridview.CurrentRow.Cells[0].Value);
                crpartycode.Text = Convert.ToString(cr_datagridview.CurrentRow.Cells[0].Value);
                crpartycity.Text = Convert.ToString(cr_datagridview.CurrentRow.Cells[1].Value);
                show_images();
                cr_datagridview.Visible = false;
            }
            else if (subtabcash.SelectedIndex == 1)
            {
                cpa_n.Text = cp_datagridview.CurrentRow.Cells[2].Value.ToString();
                cps_a.Text = Convert.ToString(cp_datagridview.CurrentRow.Cells[3].Value);
                ConnectionWithAccess.mdesc = Convert.ToString(cp_datagridview.CurrentRow.Cells[0].Value);
                cppartycode.Text = Convert.ToString(cp_datagridview.CurrentRow.Cells[0].Value);
                cppartycity.Text = Convert.ToString(cp_datagridview.CurrentRow.Cells[1].Value);
                show_images();
                cp_datagridview.Visible = false;
            }
        }

        private void cp_datagridview_Click(object sender, EventArgs e)
        {
            cpamt.ReadOnly = false;
            cp_igst_per.ReadOnly = false;
            cp_basicamt.ReadOnly = false;
            select_party_for_cash();
            cppartyname.Text = ConnectionWithAccess.mdesc;
            cppartycontact.Text = ConnectionWithAccess.accountcontact;
            cppartyaddress.Text = ConnectionWithAccess.accountaddress;
            cppartyoverallbalance.Text = Convert.ToString(calculate_account_balance(cpa_n.Text, cps_a.Text, cpdatetime.Text));
            if (cp_datagridview.CurrentRow != null)
            {
                common_account_head(cpa_n.Text);
                lbl_cp_account_head.Text = ConnectionWithAccess.macc_desc;
            }
            cptranlist.Visible = true;
            cpamt.Focus();
        }

        private void cp_datagridview_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                ConnectionWithAccess.mdesc = cp_datagridview.CurrentRow.Cells[0].Value.ToString();
                ConnectionWithAccess.mcity = cp_datagridview.CurrentRow.Cells[1].Value.ToString();
                cpa_n.Text = cp_datagridview.CurrentRow.Cells[2].Value.ToString();
                cps_a.Text = cp_datagridview.CurrentRow.Cells[3].Value.ToString();
                show_images();
                cp_datagridview.Visible = false;
                cppartycode.Text = cp_datagridview.CurrentRow.Cells[0].Value.ToString();
                cppartycity.Text = cp_datagridview.CurrentRow.Cells[1].Value.ToString();
                cpamt.ReadOnly = false;
            }
        }

        private void cr_datagridview_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                ConnectionWithAccess.mdesc = cr_datagridview.CurrentRow.Cells[0].Value.ToString();
                ConnectionWithAccess.mcity = cr_datagridview.CurrentRow.Cells[1].Value.ToString();
                cra_n.Text = cr_datagridview.CurrentRow.Cells[2].Value.ToString();
                crs_a.Text = cr_datagridview.CurrentRow.Cells[3].Value.ToString();
                show_images();
                cr_datagridview.Visible = false;
                crpartycode.Text = cr_datagridview.CurrentRow.Cells[0].Value.ToString();
                crpartycity.Text = cr_datagridview.CurrentRow.Cells[1].Value.ToString();
            }
        }

        private void cppartycode_TextChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Cash Payment";
            ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[desc] like '%" + cppartycode.Text + "%'";
            ConnectionCommand.accountHelp_datatable_Seperate(cp_datagridview, "cp_datagridview");
            if (cp_datagridview.Rows.Count == 1)
            {
                ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[city] like '%" + cppartycode.Text + "%'";
                ConnectionCommand.accountHelp_datatable(cp_datagridview, "cp_datagridview");
            }
        }

        private void tr_datagridview_Click(object sender, EventArgs e)
        {
            tr_datetime.Value = Convert.ToDateTime(tr_datagridview.SelectedCells[1].Value);
            tr_docno.Text = Convert.ToString(tr_datagridview.SelectedCells[2].Value);
            ConnectionWithAccess.md_n = Convert.ToString(tr_datagridview.SelectedCells[2].Value);
            tr_amt.Text = Convert.ToString(tr_datagridview.SelectedCells[5].Value);
            tr_comm.Text = Convert.ToString(tr_datagridview.SelectedCells[6].Value);
            cb_tr_from_dc.Text = Convert.ToString(tr_datagridview.SelectedCells[7].Value);
            tb_tr_from_bank.Text = get_account_name_from_d_c("B", Convert.ToInt32(cb_tr_from_dc.Text));
            cb_tr_to_dc.Text = Convert.ToString(tr_datagridview.SelectedCells[8].Value);
            tb_tr_to_bank.Text = get_account_name_from_d_c("B", Convert.ToInt32(cb_tr_to_dc.Text));
        }

        private Int32 get_d_c_from_a_n(string book, string ma_n)
        {
            temp_int = 0;
            if (book != "" && ma_n != "")
            {
                if (book == "S")
                    ConnectionWithAccess.query = "select d_c from " + ConnectionWithAccess.tablename[21] + " where a_n  = '" + ma_n + "' and d_n = 999999";
                else if (book == "P")
                    ConnectionWithAccess.query = "select d_c from " + ConnectionWithAccess.tablename[22] + " where a_n  = '" + ma_n + "' and d_n = 999999";
                else if (book == "B")
                    ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[23] + " where a_n  = '" + ma_n + "' and d_n = 999999";
                else if (book == "C")
                    ConnectionWithAccess.query = "select d_c from " + ConnectionWithAccess.tablename[24] + " where a_n  = '" + ma_n + "' and d_n = 999999";
                else if (book == "J")
                    ConnectionWithAccess.query = "select d_c from " + ConnectionWithAccess.tablename[25] + " where a_n  = '" + ma_n + "' and d_n = 999999";
                else if (book == "R")
                    ConnectionWithAccess.query = "select d_c from " + ConnectionWithAccess.tablename[30] + " where a_n  = '" + ma_n + "' and d_n = 999999";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();

                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                        temp_int = Convert.ToInt32(dtData1.Rows[0][0].ToString());
                }
                else
                    MessageBox.Show("Sorry get_d_c_from_a_n : " + book + ma_n);
            }
            return temp_int;
        }

        private string get_a_n_from_d_c(string book, int md_c)
        {
            temp_a_n = "";
            if (book != "" && md_c != 0)
            {
                if (book == "S")
                    ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[21] + " where d_c  = " + md_c + " and d_n = 999999";
                else if (book == "P")
                    ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[22] + " where d_c  = " + md_c + " and d_n = 999999";
                else if (book == "B")
                    ConnectionWithAccess.query = "select distinct a_n from " + ConnectionWithAccess.tablename[23] + " where d_c  = " + md_c + " and d_n = 999999";
                else if (book == "C")
                    ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[24] + " where d_c  = " + md_c + " and d_n = 999999";
                else if (book == "J")
                    ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[25] + " where d_c  = " + md_c + " and d_n = 999999";
                else if (book == "R")
                    ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[30] + " where d_c  = " + md_c + " and d_n = 999999";
                else if (book == "O")
                    ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[7] + " where d_c  = " + md_c + " and d_n = 999999";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();

                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        temp_a_n = dtData1.Rows[0][0].ToString();
                        if (book == "S" || book == "P" || book == "J" || book == "R" || book == "O")
                            ConnectionWithAccess.ma_n = dtData1.Rows[0][0].ToString();
                        else if (book == "B")
                            ConnectionWithAccess.bank_a_n = dtData1.Rows[0][0].ToString();
                        else if (book == "C")
                            ConnectionWithAccess.cash_a_n = dtData1.Rows[0][0].ToString();
                    }
                }
                else
                    MessageBox.Show("Sorry get_a_n_from_d_c : " + book + md_c.ToString());
            }
            return temp_a_n;
        }

        private string get_account_name_from_d_c(string book, int md_c)
        {
            temp_a_n = get_a_n_from_d_c(book, md_c);
            ConnectionWithAccess.mdesc = null;
            if (temp_a_n != "")
            {
                if (book == "S")
                    ConnectionWithAccess.query = "select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + temp_a_n + "' and s_a ='@@@'";
                else if (book == "P")
                    ConnectionWithAccess.query = "select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + temp_a_n + "' and s_a ='@@@'";
                else if (book == "B")
                    ConnectionWithAccess.query = "select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + temp_a_n + "' and s_a ='@@@'";
                else if (book == "C")
                    ConnectionWithAccess.query = "select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + temp_a_n + "' and s_a ='@@@'";
                else if (book == "J")
                    ConnectionWithAccess.query = "select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + temp_a_n + "' and s_a ='@@@'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        ConnectionWithAccess.mdesc = dtData1.Rows[0][0].ToString();
                    }
                }
            }
            return ConnectionWithAccess.mdesc;
        }

        private void get_tx_code_from_tax_name(string book, string mtx_desc, string md_c)
        {
            if (book == "S")
                ConnectionWithAccess.query = "select tx_code from " + ConnectionWithAccess.tablename[06] + " where d_c = " + md_c + " and [desc] = '" + mtx_desc + "'";
            else
                ConnectionWithAccess.query = "select tx_code from " + ConnectionWithAccess.tablename[06] + " where d_c = " + md_c + " and [desc] = '" + mtx_desc + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    if (dtData1.Rows[0][0].ToString().Contains("."))
                    {
                        temp_word = dtData1.Rows[0][0].ToString().Substring(0, dtData1.Rows[0][0].ToString().IndexOf("."));
                        ConnectionWithAccess.mtx_code = Convert.ToInt32(temp_word);
                    }
                    else
                        ConnectionWithAccess.mtx_code = Convert.ToInt32(dtData1.Rows[0][0].ToString());
                }
                else
                    ConnectionWithAccess.mtx_code = 0;
            }
            else
                ConnectionWithAccess.mtx_code = 0;
        }

        private void cb_tr_from_dc_SelectedIndexChanged(object sender, EventArgs e)
        {
            tb_tr_from_bank.Text = get_account_name_from_d_c("B", Convert.ToInt32(cb_tr_from_dc.Text));
            btfroma_n.Text = get_a_n_from_d_c("B", Convert.ToInt32(cb_tr_from_dc.Text));
            tr_from_bank_curr_bal.Text = Convert.ToString(get_bank_balance(get_a_n_from_d_c("B", Convert.ToInt32(cb_tr_from_dc.Text)), "@@@", DateTime.Today.ToShortDateString()));
        }

        private void cb_tr_to_dc_SelectedIndexChanged(object sender, EventArgs e)
        {
            tb_tr_to_bank.Text = get_account_name_from_d_c("B", Convert.ToInt32(cb_tr_to_dc.Text));
            bttoa_n.Text = get_a_n_from_d_c("B", Convert.ToInt32(cb_tr_to_dc.Text));
            get_account_name_from_d_c("B", Convert.ToInt32(cb_tr_to_dc.Text));
            tr_to_bank_curr_bal.Text = Convert.ToString(get_bank_balance(get_a_n_from_d_c("B", Convert.ToInt32(cb_tr_to_dc.Text)), "@@@", DateTime.Today.ToShortDateString()));
        }

        private void atbprint_Click(object sender, EventArgs e)
        {
            report_filename = null;
            if (maintab.SelectedIndex == 1)
            {
                if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
                {
                    print_sale_invoice();
                }
            }
            else if (maintab.SelectedIndex == 2)
            {
                if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
                {
                }
            }
            else if (maintab.SelectedIndex == 3)
            {
                if (subtabreports.SelectedIndex == 0)
                {
                    report_filename = pdf_filename;
                }
                else if (subtabreports.SelectedIndex == 1)
                {
                    report_filename = ledger_filename;
                }
                else if (subtabreports.SelectedIndex == 2)
                {
                    report_filename = trading_filename;
                }
            }
            SendToPrinter(report_filename);
        }

        private void SendToPrinter(string report_filename)
        {
            if (File.Exists(report_filename))
            {
                var pi = new ProcessStartInfo(report_filename);
                pi.UseShellExecute = true;
                pi.Verb = "print";
                var process = System.Diagnostics.Process.Start(pi);
            }
            else
                MessageBox.Show("Sorry Report File Not Found : " + report_filename);
        }

        private void generate_company_details_pdf()
        {
            pdf_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\company_details";
            if (chb_add_datetime_in_output.Checked)
                pdf_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            pdf_filename += ".pdf";
            doc1 = new Document(PageSize.A4, 25, 25, 10, 20);
            FileStream FS1 = File.Create(pdf_filename);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            Paragraph para = new Paragraph("");
            para.Font.Size = 25;
            temp_word = "01. Name";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[1] + "     {" + ConnectionWithAccess.mNIK + "}";
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);
            temp_word = "02. Address1";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[2];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);
            temp_word = "03. Address2";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[3];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);
            temp_word = "04. City                                                               Pincode";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[4];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);
            temp_word = ConnectionWithAccess.company_details[6];
            print_pdf_line(cour_11_bold_red, temp_word, 300, -16);
            temp_word = "05. State";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[5];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);
            temp_word = "06. Phone Off.";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[7];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);
            temp_word = "07. Phone Resi1.";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[8];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);
            temp_word = "08. Phone Mob1.";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[9];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);
            temp_word = "09. Phone Mob2.";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[10];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "10.A.Email Id.";
            print_pdf_line(cour_11, temp_word, 25, 0);
            if (ConnectionWithAccess.company_details[11].Contains("["))
                temp_word = ConnectionWithAccess.company_details[11].Substring(0, ConnectionWithAccess.company_details[11].IndexOf("["));
            else
                temp_word = ConnectionWithAccess.company_details[11];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "11. Properitor";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[12];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "12. Pan Card. #";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[13];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "13. Type of Busi.1";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[14];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "14. Type of Busi.2";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[15];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);
            temp_word = "15. Type of Busi.3";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[16];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "16. B.S.T. #";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[17];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "17. T.I.N. #";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[18];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "18. L.B.T. #";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[19];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "19.Aadhar Card";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[20];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);
            temp_word = "20. Bank A/c. #";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[21];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);
            temp_word = "21.Comments";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[22];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "22.Date of Birth";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[23];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "23.Induvisal/Part.";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[24];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "24.Extra";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[25];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "25.C.S.T. Num ";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[26];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "26.C.S.T. Tin ";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[27];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "27.Website ";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[28];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "28.I.F.C. Code ";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[29];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "29.Bank Name ";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[30];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "30.S.Inv.Print";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[31];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "31.G.S.T. #";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[32];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "32.Bypass Pass.";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[33];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "33. STD.";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[34];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "34.Company font";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[35];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "35.Print Dist. ";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[36];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            temp_word = "36.Backup. E.Id.";
            print_pdf_line(cour_11, temp_word, 25, 0);
            temp_word = ConnectionWithAccess.company_details[37];
            print_pdf_line(cour_11_bold_red, temp_word, 130, -16);

            doc1.Close();
            pdf_invoice.BringToFront();
            pdf_invoice.Visible = true;
            pdf_invoice.LoadFile(pdf_filename);
        }

        private void jour_datagridview_Click(object sender, EventArgs e)
        {
            select_party_for_jour();
            if (jour_datagridview.CurrentRow != null)
            {
                common_account_head(ja_n.Text);
                lbl_cp_account_head.Text = ConnectionWithAccess.macc_desc;
            }
            jjtranlist.Visible = true;
        }

        private void jour_datagridview_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                if (jjpartycode1.Enabled == true)
                {
                    ConnectionWithAccess.mdesc = jour_datagridview.CurrentRow.Cells[0].Value.ToString();
                    ConnectionWithAccess.mcity = jour_datagridview.CurrentRow.Cells[1].Value.ToString();
                    ja_n.Text = jour_datagridview.CurrentRow.Cells[2].Value.ToString();
                    js_a.Text = jour_datagridview.CurrentRow.Cells[3].Value.ToString();
                    show_images();
                    jour_datagridview.Visible = false;
                    jjpartycode1.Text = ConnectionWithAccess.mdesc;
                    jour_datagridview.Visible = false;
                    jjpartycode2.Enabled = true;
                }
                else if (jjpartycode2.Enabled == true)
                {
                    ConnectionWithAccess.mdesc = jour_datagridview.CurrentRow.Cells[0].Value.ToString();
                    ConnectionWithAccess.mcity = jour_datagridview.CurrentRow.Cells[1].Value.ToString();
                    jna_n.Text = jour_datagridview.CurrentRow.Cells[2].Value.ToString();
                    jns_a.Text = jour_datagridview.CurrentRow.Cells[3].Value.ToString();
                    show_images();
                    jour_datagridview.Visible = false;
                    jjpartycode1.Text = ConnectionWithAccess.mdesc;
                    jour_datagridview.Visible = false;
                    jjpartycode1.Enabled = true;
                }
            }
        }

        private void jjpartycode1_TextChanged(object sender, EventArgs e)
        {
            //ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where s_a <> '@@@' and (d_y is null or d_y ='') and [desc] like '%" + jjpartycode1.Text + "%'";
            //ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where [desc] like '%" + jjpartycode1.Text + "%'";
            ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[desc] like '%" + jjpartycode1.Text + "%'";
            ConnectionCommand.accountHelp_datatable(jour_datagridview, "jour_datagridview");
            if (jour_datagridview.CurrentRow != null)
            {
                common_account_head(jour_datagridview.CurrentRow.Cells[2].Value.ToString());
            }
        }

        private void jjpartycode2_TextChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[desc] like '%" + jjpartycode2.Text + "%'";
            ConnectionCommand.accountHelp_datatable(jour_datagridview, "jour_datagridview");
            if (jour_datagridview.CurrentRow != null)
            {
                lbl_jour_payer_acc_head.Visible = true;
                common_account_head(jour_datagridview.CurrentRow.Cells[2].Value.ToString());
                lbl_jour_payer_acc_head.Text = ConnectionWithAccess.macc_desc;
            }
        }

        private void select_party_for_jour()
        {
            if (working_journal_payer_payee == "payee")
            {
                ja_n.Text = jour_datagridview.CurrentRow.Cells[2].Value.ToString();
                js_a.Text = Convert.ToString(jour_datagridview.CurrentRow.Cells[3].Value);
                ConnectionWithAccess.mdesc = Convert.ToString(jour_datagridview.CurrentRow.Cells[0].Value);
                jjpartycode1.Text = Convert.ToString(jour_datagridview.CurrentRow.Cells[0].Value);
                get_account_details_from_01(ja_n.Text, js_a.Text);
                get_account_details_from_04(ja_n.Text, js_a.Text);
                lbl_payee_name.Text = account_detail_from_01[4];
                lbl_payee_con_details.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20] + " ," + account_detail_from_04[21];
                lbl_payee_address.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[7];
                show_images();
                jjpartycode2.Enabled = true;
            }
            else if (working_journal_payer_payee == "payer")
            {
                jna_n.Text = jour_datagridview.CurrentRow.Cells[2].Value.ToString();
                jns_a.Text = Convert.ToString(jour_datagridview.CurrentRow.Cells[3].Value);
                ConnectionWithAccess.mdesc = Convert.ToString(jour_datagridview.CurrentRow.Cells[0].Value);
                jjpartycode2.Text = Convert.ToString(jour_datagridview.CurrentRow.Cells[0].Value);
                get_account_details_from_01(jna_n.Text, jns_a.Text);
                get_account_details_from_04(jna_n.Text, jns_a.Text);
                lbl_payer_name.Text = account_detail_from_01[4];
                lbl_payer_con_details.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20] + " ," + account_detail_from_04[21];
                lbl_payer_address.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[7];
                show_images();
                if (jour_datagridview.CurrentRow != null)
                {
                    lbl_jour_payer_acc_head.Visible = true;
                    common_account_head(jna_n.Text);
                    lbl_jour_payer_acc_head.Text = ConnectionWithAccess.macc_desc;
                }
                jjpartycode1.Enabled = true;
                jjamt.ReadOnly = false;
                jjbamt.ReadOnly = false;
                jjigst_per.ReadOnly = false;
                jj_dgv_gst_tax_brief.Visible = true;
            }
            jour_datagridview.Visible = false;
        }

        private void jjtranlist_Click(object sender, EventArgs e)
        {
            lbl_jour_payer_acc_head.Visible = true;
            gb_payer_details.Visible = true;
            gb_payee_details.Visible = true;
            jj_dgv_gst_tax_brief.DataSource = null;
            jj_dgv_gst_tax_brief.Visible = true;
            //jjdatetime.Value = Convert.ToDateTime(jjtranlist.SelectedCells[1].Value);
            jjdocno.Text = Convert.ToString(jjtranlist.SelectedCells[1].Value);
            jjamt.Text = Convert.ToString(jjtranlist.SelectedCells[4].Value);
            old_journal_amount = Convert.ToDouble(jjtranlist.SelectedCells[4].Value);
            jjcomm.Text = Convert.ToString(jjtranlist.SelectedCells[6].Value);
            ja_n.Text = Convert.ToString(jjtranlist.SelectedCells[7].Value);
            js_a.Text = Convert.ToString(jjtranlist.SelectedCells[8].Value);
            jna_n.Text = Convert.ToString(jjtranlist.SelectedCells[9].Value);
            jns_a.Text = Convert.ToString(jjtranlist.SelectedCells[10].Value);
            jjbamt.Text = Convert.ToString(jjtranlist.SelectedCells[11].Value);
            jjigst_per.Text = Convert.ToString(jjtranlist.SelectedCells[12].Value);
            jjigst_amt.Text = Convert.ToString(jjtranlist.SelectedCells[13].Value);
            jjamt.ReadOnly = false;
            jjbamt.ReadOnly = false;
            jjigst_per.ReadOnly = false;
            populate_screen();
        }

        private void jjpartycode1_KeyPress(object sender, KeyPressEventArgs e)
        {
            working_journal_payer_payee = "payee";
            jour_datagridview.Visible = true;
            ConnectionWithAccess.j1a_n = null;
            ConnectionWithAccess.j1s_a = null;
        }

        private void jjpartycode2_KeyPress(object sender, KeyPressEventArgs e)
        {
            working_journal_payer_payee = "payer";
            jour_datagridview.Visible = true;
            ConnectionWithAccess.j2a_n = null;
            ConnectionWithAccess.j2s_a = null;
        }

        private void crpartycode_KeyPress(object sender, KeyPressEventArgs e)
        {
            cr_datagridview.Visible = true;
        }

        private void cppartycode_KeyPress(object sender, KeyPressEventArgs e)
        {
            cp_datagridview.Visible = true;
        }

        private void brpartycode_KeyPress(object sender, KeyPressEventArgs e)
        {
            braccountdg.Visible = true;
        }

        private void bppartycode_KeyPress(object sender, KeyPressEventArgs e)
        {
            bp_datagridview.Visible = true;
            bp_datagridview.BringToFront();
        }

        private void cb_common_image_Click(object sender, EventArgs e)
        {
            if (cb_common_image.Checked == true)
                show_images();
            else
                invisible_all_image();
        }

        //public static string get_old_prd_name(string prd)
        //{
        //    char c = Convert.ToChar(prd.ToUpper());
        //    asc_value = Convert.ToInt32(c);
        //    emerg_oprd = Convert.ToString(Convert.ToChar(asc_value - 1));
        //    return emerg_oprd;
        //}

        //public static string get_next_prd_name(string prd)
        //{
        //    char c = Convert.ToChar(prd.ToUpper());
        //    asc_value = Convert.ToInt32(c);
        //    emerg_nprd = Convert.ToString(Convert.ToChar(asc_value + 1));
        //    return emerg_nprd;
        //}

        #region emerg

        private void emerg_balance_Click(object sender, EventArgs e)
        {
            disable_all_keys();
            if (ConnectionWithAccess.mNIK == "AP2")
                update_gp_per_of_ap2();
            if (cb_emerg_full_period.Checked == true)
            {
                list_of_period_array.Clear();
                ConnectionWithAccess.query = "select prd from " + ConnectionWithAccess.tablename[50] + " order by prd";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    int mcolumncount = dtData1.Columns.Count;
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        list_of_period_array.Add(dtData1.Rows[iRowCount][0].ToString());
                    }
                }
                if (list_of_period_array.Count > 1)
                {
                    temp_int = 1;
                    for (int array_count = 1; array_count < list_of_period_array.Count(); array_count++)
                    {
                        if (list_of_period_array[array_count] == ConnectionWithAccess.mprd)
                        {
                            temp_int = array_count;
                            array_count = list_of_period_array.Count();
                        }
                    }
                    for (int array_count = temp_int; array_count < list_of_period_array.Count(); array_count++)
                    {
                        emerg_prd = list_of_period_array[array_count];
                        emerg_oprd = ConnectionWithAccess.get_old_prd_name(emerg_prd);
                        emerg_nprd = ConnectionWithAccess.get_next_prd_name(emerg_prd);
                        ConnectionWithAccess.query = "select [lock],[start],[end] from " + ConnectionWithAccess.tablename[50] + " where prd = '" + emerg_prd + "'";
                        dtData1 = ConnectionCommand.fGetDataTable();

                        if (dtData1 != null && dtData1.Rows.Count > 0)
                        {
                            if (dtData1.Rows[0][0] != null)
                            {
                                ConnectionWithAccess.prd_lock = dtData1.Rows[0][0].ToString();
                                start_date = dtData1.Rows[0][1].ToString();
                                end_date = dtData1.Rows[0][2].ToString();
                                start_date = start_date.Substring(0, start_date.IndexOf(" "));
                                end_date = end_date.Substring(0, end_date.IndexOf(" "));
                            }
                        }
                        if (ConnectionWithAccess.prd_lock != "Y")
                        {
                            emerg_balance_process(emerg_prd, emerg_oprd);
                            emerg_opening_balance_from_old_closing_balance(emerg_prd, emerg_oprd);
                            update_at_the_rate_of_customers_and_suppliers(emerg_prd);
                            get_gp_percent_from_file_fifty(emerg_prd);
                            calculate_gross_profit_using_gp_per(emerg_prd);
                            //calculate_gross_profit_using_closing_stock(emerg_prd);
                            if (emerg_prd != "@")
                                save_balance_sheet_gp_values(emerg_prd);
                            calculate_closing_capital_balance_and_add_in_new_period(emerg_prd, emerg_oprd);
                            add_contains_of_balance_sheet_in_gridview(emerg_prd, false);
                            if (!balance_sheet_tally && cb_emerg_stop.Checked)
                            {
                                MessageBox.Show("Balance Sheet Not Tally " + emerg_prd);
                                array_count = list_of_period_array.Count();
                                go_to_selected_period(emerg_prd);
                            }
                        }
                    }
                }
            }
            else
            {
                emerg_prd = ConnectionWithAccess.mprd;
                emerg_oprd = ConnectionWithAccess.get_old_prd_name(emerg_prd);
                emerg_nprd = ConnectionWithAccess.get_next_prd_name(emerg_prd);
                ConnectionWithAccess.query = "select [lock],[start],[end] from " + ConnectionWithAccess.tablename[50] + " where prd = '" + emerg_prd + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();

                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        ConnectionWithAccess.prd_lock = dtData1.Rows[0][0].ToString();
                        start_date = dtData1.Rows[0][1].ToString();
                        end_date = dtData1.Rows[0][2].ToString();
                        start_date = start_date.Substring(0, start_date.IndexOf(" "));
                        end_date = end_date.Substring(0, end_date.IndexOf(" "));
                    }
                }
                if (ConnectionWithAccess.prd_lock != "Y")
                {
                    emerg_balance_process(emerg_prd, emerg_oprd);
                    //generate_temporary_pdf_file_for_testing();
                    emerg_opening_balance_from_old_closing_balance(emerg_prd, emerg_oprd);
                    update_at_the_rate_of_customers_and_suppliers(emerg_prd);
                    get_gp_percent_from_file_fifty(emerg_prd);
                    calculate_gross_profit_using_gp_per(emerg_prd);
                    //calculate_gross_profit_using_closing_stock(emerg_prd);
                    if (emerg_prd != "@")
                        save_balance_sheet_gp_values(emerg_prd);
                    calculate_closing_capital_balance_and_add_in_new_period(emerg_prd, emerg_oprd);
                    add_contains_of_balance_sheet_in_gridview(emerg_prd, false);
                    if (!balance_sheet_tally)
                        MessageBox.Show("Balance Sheet Not Tally " + emerg_prd);
                }
            }
            this.Text = text_to_display_on_top;
            enable_all_keys();
        }

        private void generate_temporary_pdf_file_for_testing()
        {
            pdf_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\Temporary_pdf_file_for_testing.pdf";
            pdf_filename = ConnectionWithAccess.remove_filename_error(pdf_filename);
            doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
            FileStream FS1 = File.Create(pdf_filename);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            add_header_footer = true;
            pdf_top_heading = null;
            require_header_footer = false;
            Paragraph para = new Paragraph();
            temp_double = 0;
            temp_word = ".";
            int position = 0;
            print_pdf_line(cour_9_bold, " ", 0, 0);
            for (int i = 0; i < list_of_temporary_emerg_data.Count; i++)
            {
                if (position == 0)
                {
                    print_pdf_line(cour_9_bold, list_of_temporary_emerg_data[i], 0, 0);
                    position++;
                }
                else if (position == 1)
                {
                    print_pdf_line(cour_9_bold, list_of_temporary_emerg_data[i], 200, -16);
                    position++;
                }
                else if (position == 2)
                {
                    print_pdf_line(cour_9_bold, list_of_temporary_emerg_data[i], 400, -16);
                    position = 0;
                }
            }
            doc1.Close();
            require_header_footer = true;
        }

        private void check_for_difference_in_balance_sheet(string emerg_prd)
        {
            //DataTable balsheet = new DataTable();
            //string strQuery = "select prd,[start],[end],gp,[lock] from " + ConnectionWithAccess.tablename[50] + " where prd = '" + e.KeyChar.ToString() + "' ";
            //ConnectionWithAccess.connection.Open();

            //try
            //{
            //    var adapter = new OleDbDataAdapter(strQuery, ConnectionWithAccess.connection);
            //    adapter.Fill(balsheet);
            //}
            //catch (Exception ex)
            //{ }
            cbBalShPer.Text = emerg_prd;
            StringBuilder strQuery = new StringBuilder();
            strQuery.Append("select '', f1.a_n, f1.s_a, '','' , '' , f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '2%' and f51.a_n <> '2001' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '','' , '' , f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '3%' and f51.a_n <> '3001'and f51.a_n <> '3500' and f51.a_n <> '3501' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '','' , ''  , f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a <> '@@@' and f51.a_n LIKE '35%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '','' , ''  , f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '4%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] , '', f51.AMT, '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n = '3001' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, '','' , ''  , f1.[DESC], '', (f51.AMT * -1) from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '5%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '2%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '3%' and f51.a_n <> '3000' and f51.a_n <> '3500' and f51.a_n <> '3501' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '2%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and (f51.s_a <> '@@@' and f51.s_a <> '') and f51.a_n LIKE '35%' and f51.a_n <> '3500' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '2%' UNION ALL ");
            strQuery.Append("select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '4%'");
            ConnectionWithAccess.query = strQuery.ToString();
            dataset.Clear();
            dataadapter = new OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
            dataadapter.Fill(dataset);


            //ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '','' , '' , f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '2%' and f51.a_n <> '2001'";
            //dataadapter = new OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
            //dataadapter.Fill(dataset);
            //ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '','' , '' , f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '3%' and f51.a_n <> '3001'and f51.a_n <> '3500' and f51.a_n <> '3501'";
            ////dataadapter = new OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
            //dataadapter.Fill(dataset);
            //ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '','' , ''  , f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a <> '@@@' and f51.a_n LIKE '35%'";
            ////dataadapter = new OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
            //dataadapter.Fill(dataset);
            //ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '','' , ''  , f1.[DESC], '', f51.AMT from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n like '4%'";
            ////dataadapter = new OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
            //dataadapter.Fill(dataset);
            //ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC] , '', f51.AMT, '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt > 0 and f51.s_a = '@@@' and f51.a_n = '3001'";
            ////dataadapter = new OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
            //dataadapter.Fill(dataset);
            //ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, '','' , ''  , f1.[DESC], '', (f51.AMT * -1) from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '5%'";
            ////dataadapter = new OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
            //dataadapter.Fill(dataset);
            //ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '2%'";
            ////dataadapter = new OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
            //dataadapter.Fill(dataset);
            //ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '3%' and f51.a_n <> '3000' and f51.a_n <> '3500' and f51.a_n <> '3501'";
            ////dataadapter = new OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
            //dataadapter.Fill(dataset);
            //ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and (f51.s_a <> '@@@' and f51.s_a <> '') and f51.a_n LIKE '35%' and f51.a_n <> '3500'";
            ////dataadapter = new OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
            //dataadapter.Fill(dataset);
            //ConnectionWithAccess.query = "select '', f1.a_n, f1.s_a, f1.[DESC] , '', (f51.AMT * -1), '', '','' from " + ConnectionWithAccess.tablename[51] + " f51 left outer join " + ConnectionWithAccess.tablename[01] + " f1 on f51.A_N = f1.A_N and f51.S_A = f1.S_A where f51.prd = '" + cbBalShPer.Text + "' and f51.D_D = #01-01-1901# and f51.amt < 0 and f51.s_a = '@@@' and f51.a_n like '4%'";
            ////dataadapter = new OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
            //dataadapter.Fill(dataset);
        }

        private void emerg_balance_process(string emerg_prd, string emerg_oprd)
        {
            ConnectionWithAccess.closing_stock = 0;
            list_of_emerg_data.Clear();

            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[51] + " where prd >= '" + emerg_prd + "'";
            ConnectionCommand.fUpdateInsertDeleteData();
            if (cb_emerg_old.Checked == true)
            {
                this.Text = "Please wait Emerging " + ConnectionWithAccess.tablename[51];
                ConnectionWithAccess.query = "select prd,a_n,s_a,amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_oprd + "' and a_n like '1%' and d_d = #01/01/1901# and amt <> 0 order by a_n,s_a";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    temp_word1 = dtData1.Rows[0][1].ToString().Trim();
                    temp_double = 0;
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][0] != null)
                        {
                            check_data_type(dtData1.Rows[iRowCount][3].ToString());
                            if (data_type == "Numeric")
                            {
                                if (dtData1.Rows[iRowCount][1].ToString().Trim() == temp_word1)
                                    temp_double += Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString());
                                else
                                {
                                    //temp_word1 = dtData1.Rows[iRowCount][1].ToString();
                                    temp_word = emerg_prd + " ," + temp_word1 + " ," + "@@@" + "," + Convert.ToString(temp_double) + " ,O, 0";
                                    list_of_emerg_data.Add(temp_word);
                                    temp_word1 = dtData1.Rows[iRowCount][1].ToString().Trim();
                                    temp_double = Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString());
                                }
                            }
                        }
                    }
                    temp_word = emerg_prd + " ," + temp_word1 + " ," + "@@@" + "," + Convert.ToString(temp_double) + " ,O, 0";
                    list_of_emerg_data.Add(temp_word);
                }
                ConnectionWithAccess.query = "select prd,a_n,s_a,amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_oprd + "' and a_n not like '1%' and a_n not like '30%' and a_n not like '7%' and d_d = #01/01/1901# and a_n not like '6000%' and a_n not like '65%' and a_n not like '7998%' and amt <> 0";
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][0] != null)
                        {
                            temp_word = emerg_prd + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + dtData1.Rows[iRowCount][3].ToString() + " ,O, 0";
                            list_of_emerg_data.Add(temp_word);
                        }
                    }
                }
                ConnectionWithAccess.query = "select prd,a_n,s_a,amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_oprd + "' and a_n like '3%' and a_n <> '3000' and a_n <> '3001' and s_a ='@@@' and d_d = #01/01/1901# and a_n not like '6000%' and a_n not like '7998%' and amt <> 0";
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][0] != null)
                        {
                            temp_word = emerg_prd + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + dtData1.Rows[iRowCount][3].ToString() + " ,O, 0";
                            list_of_emerg_data.Add(temp_word);
                        }
                    }
                }
            }
            if (cb_emerg_sale.Checked == true)
            {
                this.Text = "Please wait Emerging " + ConnectionWithAccess.tablename[21];
                ConnectionWithAccess.query = "select prd,a_n,s_a,gamt,d_c,tamt,tx_code from " + ConnectionWithAccess.tablename[21] + " where prd = '" + emerg_prd + "' and s_a <> '@@@' and gamt <> 0";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][0] != null)
                        {
                            temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + dtData1.Rows[iRowCount][3].ToString() + " ,S" + "," + dtData1.Rows[iRowCount][5].ToString() + " ," + dtData1.Rows[iRowCount][4].ToString() + " ," + dtData1.Rows[iRowCount][6].ToString();
                            list_of_emerg_data.Add(temp_word);
                        }
                    }
                }
                else
                    update_amount_in_51(ConnectionWithAccess.mprd, "2002", "@@@", 0);
                temporary_array = new string[0];
                for (int i = 0; i < list_of_emerg_data.Count(); i++)
                {
                    if (i == 29)
                        temp_word = "";
                    var cellArray = list_of_emerg_data[i].Split(new[] { ',' });
                    if (cellArray[4].ToString() == "S")
                    {
                        if (cellArray[7].ToString() != "7")
                            temp_word = cellArray[0] + " ," + "6000" + "," + "@@@" + "," + (Convert.ToDouble(cellArray[3]) * -1) + " ,E" + "," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[7];
                        else
                            temp_word = cellArray[0] + " ," + "6000R1" + "," + "@@@" + "," + (Convert.ToDouble(cellArray[3]) * -1) + " ,E" + "," + cellArray[5] + " ," + cellArray[6] + " ," + cellArray[7];
                        list_of_emerg_data.Add(temp_word);
                    }
                }
                this.Text = "Please wait Emerging " + ConnectionWithAccess.tablename[30];
                ConnectionWithAccess.query = "select prd,a_n,s_a,gamt,d_c,tamt,tx_code from " + ConnectionWithAccess.tablename[30] + " where prd = '" + emerg_prd + "'";
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][3] != null)
                        {
                            if (Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) != 0)  // check for only b_t = 3 (means bank cheque passed)
                            {
                                temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) * -1.00 + " ,R" + "," + dtData1.Rows[iRowCount][5].ToString() + " ," + dtData1.Rows[iRowCount][4].ToString() + " ," + dtData1.Rows[iRowCount][6].ToString();
                                list_of_emerg_data.Add(temp_word);
                                temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + "@@@" + "," + Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) * -1.00 + " ,R" + "," + dtData1.Rows[iRowCount][5].ToString() + " ," + dtData1.Rows[iRowCount][4].ToString() + " ," + dtData1.Rows[iRowCount][6].ToString();
                                list_of_emerg_data.Add(temp_word);
                                temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + "7001" + "," + "@@@" + "," + Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) + " ,R" + "," + dtData1.Rows[iRowCount][5].ToString() + " ," + dtData1.Rows[iRowCount][4].ToString() + " ," + dtData1.Rows[iRowCount][6].ToString();
                                list_of_emerg_data.Add(temp_word);
                            }
                        }
                    }
                }
            }
            if (cb_emerg_purchase.Checked == true)
            {
                this.Text = "Please wait Emerging " + ConnectionWithAccess.tablename[22];
                ConnectionWithAccess.query = "select prd,a_n,s_a,gamt,d_c from " + ConnectionWithAccess.tablename[22] + " where prd = '" + emerg_prd + "'and s_a <> '@@@'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][3] != null)
                        {
                            temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + (Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) * -1) + " ,P" + "," + dtData1.Rows[iRowCount][4].ToString();
                            list_of_emerg_data.Add(temp_word);
                            temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + "@@@" + "," + (Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) * -1) + " ,P" + "," + dtData1.Rows[iRowCount][4].ToString();
                            list_of_emerg_data.Add(temp_word);
                            temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + "7000" + "," + "@@@" + "," + dtData1.Rows[iRowCount][3].ToString() + " ,E" + "," + dtData1.Rows[iRowCount][4].ToString();
                            list_of_emerg_data.Add(temp_word);
                        }
                    }
                }
            }
            if (cb_emerg_bank.Checked == true)
            {
                this.Text = "Please wait Emerging " + ConnectionWithAccess.tablename[23];
                //ConnectionWithAccess.query = "select prd,a_n,s_a,(bamt * -1),d_c,b_t,tran_d_c from " + ConnectionWithAccess.tablename[23] + " where prd = '" + emerg_prd + "' and b_t = '3' and tran_d_c = 9 and r_p = '4'";
                ConnectionWithAccess.query = "select prd,a_n,s_a,(bamt * -1),d_c,b_t,tran_d_c from " + ConnectionWithAccess.tablename[23] + " where prd = '" + emerg_prd + "' and b_t = '3' and tran_d_c <= 1 order by pass_date";
                //ConnectionWithAccess.command.CommandText = "select prd,a_n,s_a,(bamt * -1),d_c,b_t,tran_d_c from " + ConnectionWithAccess.tablename[23] + " where pass_date <= @To and b_t = '3'";
                //ConnectionWithAccess.command.Parameters.Clear();
                //ConnectionWithAccess.command.Parameters.AddWithValue("@To", Convert.ToDateTime(end_date));
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][3] != null)
                        {
                            if (dtData1.Rows[iRowCount][5].ToString() == "3")  // check for only b_t = 3 (means bank cheque passed)
                            {
                                temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + dtData1.Rows[iRowCount][3].ToString() + " ,B" + "," + dtData1.Rows[iRowCount][4].ToString() + " ," + dtData1.Rows[iRowCount][5].ToString() + " ," + dtData1.Rows[iRowCount][6].ToString();
                                list_of_emerg_data.Add(temp_word);
                                temp_a_n = get_a_n_from_d_c("B", Convert.ToInt32(dtData1.Rows[iRowCount][4].ToString()));
                                temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + temp_a_n + " ," + "@@@" + "," + (Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) * -1).ToString() + " ,B" + "," + dtData1.Rows[iRowCount][4].ToString() + " ," + dtData1.Rows[iRowCount][5].ToString() + " ," + dtData1.Rows[iRowCount][6].ToString();
                                list_of_emerg_data.Add(temp_word);
                                if (dtData1.Rows[iRowCount][1].ToString() == "7999")
                                {
                                    if (dtData1.Rows[iRowCount][2].ToString() == "WIT")
                                    {
                                        temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + "2010" + " ," + "@@@" + "," + (Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) * 1).ToString() + " ,C" + "," + dtData1.Rows[iRowCount][4].ToString() + " ," + dtData1.Rows[iRowCount][5].ToString() + " ," + dtData1.Rows[iRowCount][6].ToString();
                                        list_of_emerg_data.Add(temp_word);
                                    }
                                    else if (dtData1.Rows[iRowCount][2].ToString() == "DEP")
                                    {
                                        temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + "2010" + " ," + "@@@" + "," + (Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) * 1).ToString() + " ,C" + "," + dtData1.Rows[iRowCount][4].ToString() + " ," + dtData1.Rows[iRowCount][5].ToString() + " ," + dtData1.Rows[iRowCount][6].ToString();
                                        list_of_emerg_data.Add(temp_word);
                                    }
                                }
                            }
                        }
                    }
                }
                ConnectionWithAccess.query = "select prd,a_n,s_a,bamt,d_c,b_t,tran_d_c from " + ConnectionWithAccess.tablename[23] + " where prd = '" + emerg_prd + "' and b_t = '3' and tran_d_c <> 0 order by pass_date";
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][3] != null)
                        {
                            if (dtData1.Rows[iRowCount][5].ToString() == "3")  // check for only b_t = 3 (means bank cheque passed)
                            {
                                temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + dtData1.Rows[iRowCount][3].ToString() + " ,B" + "," + dtData1.Rows[iRowCount][4].ToString() + " ," + dtData1.Rows[iRowCount][5].ToString() + " ," + dtData1.Rows[iRowCount][6].ToString();
                                list_of_emerg_data.Add(temp_word);
                                temp_a_n = get_a_n_from_d_c("B", Convert.ToInt32(dtData1.Rows[iRowCount][6].ToString()));
                                temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + temp_a_n + " ," + "@@@" + "," + (Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) * -1).ToString() + " ,B" + "," + dtData1.Rows[iRowCount][4].ToString() + " ," + dtData1.Rows[iRowCount][5].ToString() + " ," + dtData1.Rows[iRowCount][6].ToString();
                                list_of_emerg_data.Add(temp_word);

                            }
                        }
                    }
                }
            }
            if (cb_emerg_cash.Checked == true)
            {
                this.Text = "Please wait Emerging " + ConnectionWithAccess.tablename[24];
                ConnectionWithAccess.query = "select prd,a_n,s_a,(camt *-1),d_c from " + ConnectionWithAccess.tablename[24] + " where prd = '" + emerg_prd + "' and camt <> 0 and a_n <> '7999' order by d_d";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][3] != null)
                        {
                            if (Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) != 0)  // check for only b_t = 3 (means bank cheque passed)
                            {
                                temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + dtData1.Rows[iRowCount][3].ToString() + " ,C" + "," + dtData1.Rows[iRowCount][4].ToString();
                                list_of_emerg_data.Add(temp_word);
                                temp_a_n = get_a_n_from_d_c("C", Convert.ToInt32(dtData1.Rows[iRowCount][4].ToString()));
                                temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + temp_a_n + " ," + "@@@" + "," + (Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) * -1).ToString() + " ," + ",C" + "," + dtData1.Rows[iRowCount][4].ToString();
                                list_of_emerg_data.Add(temp_word);
                            }
                        }
                    }
                }
            }
            if (cb_emerg_journal.Checked == true)
            {
                this.Text = "Please wait Emerging " + ConnectionWithAccess.tablename[25];
                ConnectionWithAccess.query = "select prd,a_n,s_a,jamt,d_c,na_n,ns_a from " + ConnectionWithAccess.tablename[25] + " where prd = '" + emerg_prd + "' and jamt > 0.00";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][3] != null)
                        {
                            if (Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) != 0)  // check for only b_t = 3 (means bank cheque passed)
                            {
                                temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + dtData1.Rows[iRowCount][3].ToString() + " ,J" + "," + dtData1.Rows[iRowCount][4].ToString();
                                temp_word2 = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][5].ToString() + " ," + dtData1.Rows[iRowCount][6].ToString() + " ," + Convert.ToDouble(dtData1.Rows[iRowCount][3].ToString()) * -1 + " ,J" + "," + dtData1.Rows[iRowCount][4].ToString();
                                list_of_emerg_data.Add(temp_word);
                                list_of_emerg_data.Add(temp_word2);
                            }
                        }
                    }
                }
            }
            temporary_array = new string[0];
            temp_count = list_of_emerg_data.Count();
            for (int i = 0; i < list_of_emerg_data.Count(); i++)
            {
                if (i == 29)
                    temp_word = "";
                var cellArray = list_of_emerg_data[i].Split(new[] { ',' });
                if (cellArray[1].ToString().Trim() != "")
                {
                    if (cellArray[1].ToString().Trim() == "2011")
                        temp_temp_emerg_data.Add(list_of_emerg_data[i]);
                    if (cellArray[1].ToString().Trim() == "2010")
                        temp_word = "";
                    if (cellArray[4].ToString() == "O")
                    {
                        temp_word = cellArray[1].ToString();
                        update_amount_in_51(cellArray[0].ToString(), cellArray[1].ToString(), cellArray[2].ToString(), Convert.ToDouble(cellArray[3]));
                    }
                    else

                        if ((cellArray[1].ToString().Substring(0, 2) == "65" || cellArray[1].ToString().Substring(0, 2) == "70" || cellArray[1].ToString().Substring(0, 2) == "75") && cellArray[1].ToString() != "7000" && cellArray[1].ToString() != "7001")
                        {
                            if (cellArray[2].ToString() != "@@@")
                                add_amount_in_51(cellArray[0].ToString(), cellArray[1].ToString(), "@@@", Convert.ToDouble(cellArray[3]));
                            else

                                add_amount_in_51(cellArray[0].ToString(), cellArray[1].ToString(), cellArray[2].ToString(), Convert.ToDouble(cellArray[3]));
                        }
                        else
                            add_amount_in_51(cellArray[0].ToString(), cellArray[1].ToString(), cellArray[2].ToString(), Convert.ToDouble(cellArray[3]));
                }
                else
                    temp_word = "sanjay";
                this.Text = "Please wait Emerging " + list_of_emerg_data[i];
            }
        }

        private void emerg_opening_balance_from_old_closing_balance(string emerg_prd, string emerg_oprd)
        {
            this.Text = "Please wait Emerging Opening Stock";
            ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_oprd + "' and a_n = '5000' and s_a = '@@@' and d_d = #01/01/1901#";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    if (dtData1.Rows[iRowCount][0] != null)
                    {
                        if (Convert.ToDouble(dtData1.Rows[iRowCount][0].ToString()) != 0)  // check for only b_t = 3 (means bank cheque passed)
                        {
                            temp_double = Convert.ToDouble(dtData1.Rows[iRowCount][0].ToString());
                            update_amount_in_51(emerg_prd, "2001", "@@@", (temp_double * -1));
                        }
                    }
                }
            }
            temp_double = 0;
        }

        bool gp_percentage_change = true;
        private void calculate_gross_profit_using_gp_per(string emerg_prd)
        {
            if ((cb_emerg_sale.Checked == true || cb_emerg_purchase.Checked == true || cb_emerg_bank.Checked == true || cb_emerg_cash.Checked == true || cb_emerg_journal.Checked == true))
            {
                double mTAMT, mSAMT, mRSAMT, mGP_AMT, mOSAMT, mPAMT, mTRAMT, mGP, mpl_exp;
                mGP = ConnectionWithAccess.gp_percent * -1;
                this.Text = "Please wait Emerging Gross Profit and Closing Stock";
                balance_amount = new string[0];
                list_of_balance_amount.Clear();
                ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n >= '61' and a_n <= '65ZZZZ' and s_a ='@@@'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][0] != null)
                        {
                            list_of_balance_amount.Add(dtData1.Rows[iRowCount][0].ToString());
                        }
                    }
                }
                ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n >= '7001' and a_n <= '70ZZZZ' and s_a ='@@@'";
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][0] != null)
                        {
                            list_of_balance_amount.Add(dtData1.Rows[iRowCount][0].ToString());
                        }
                    }
                }
                mTRAMT = 0;
                for (int i = 0; i < list_of_balance_amount.Count; i++)
                {
                    mTRAMT = mTRAMT + Convert.ToDouble(list_of_balance_amount[i]);
                }
                mSAMT = Math.Round(get_account_balance_from_51(emerg_prd, "6000", "@@@"), 2);
                mRSAMT = Math.Round(get_account_balance_from_51(emerg_prd, "6000R1", "@@@"), 2);
                mGP_AMT = mSAMT * ConnectionWithAccess.gp_percent / 100;
                mOSAMT = Math.Round(get_account_balance_from_51(emerg_prd, "2001", "@@@"), 2);
                mPAMT = Math.Round(get_account_balance_from_51(emerg_prd, "7000", "@@@"), 2);
                //mTAMT = ((mSAMT + mRSAMT + mGP_AMT + mOSAMT + mPAMT + mTRAMT) * -1);
                //mTAMT = Math.Round(mTAMT, 2);
                if (mSAMT == 0 && mRSAMT == 0 && mOSAMT == 0 && mTRAMT == 0)
                    mTAMT = mPAMT;
                else
                    mTAMT = (-mSAMT - mRSAMT - mOSAMT - mPAMT - mTRAMT) - ((mSAMT + mRSAMT) * mGP / 100 * -1);
                mTAMT = Math.Round(mTAMT, 2);
                mGP_AMT = mTAMT - mSAMT - mRSAMT - mOSAMT - mPAMT - mTRAMT;
                mGP_AMT = Math.Round(mGP_AMT, 2);
                ConnectionWithAccess.gross_profit = mGP_AMT;
                ConnectionWithAccess.closing_stock = mTAMT;
                balance_amount = new string[0];
                list_of_balance_amount.Clear();
                ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n >= '75A' and a_n <= '75ZZZZ' and s_a ='@@@'";
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][0] != null)
                        {
                            list_of_balance_amount.Add(dtData1.Rows[iRowCount][0].ToString());
                        }
                    }
                }
                this.Text = "Please wait Emerging Gross Profit and Closing Stock";
                mpl_exp = 0;
                for (int i = 0; i < list_of_balance_amount.Count; i++)
                {
                    mpl_exp = mpl_exp + Convert.ToDouble(list_of_balance_amount[i]);
                }
                blstsales.Text = mSAMT.ToString();
                blstrepairs.Text = mRSAMT.ToString();
                blstgp.Text = mGP_AMT.ToString();
                blstopenstock.Text = mOSAMT.ToString();
                blstpurchase.Text = mPAMT.ToString();
                blsttradexp.Text = mTRAMT.ToString();
                blstplexpense.Text = mpl_exp.ToString();
                blstgp.Text = Convert.ToString(ConnectionWithAccess.gross_profit);
                blstplgp.Text = Convert.ToString(ConnectionWithAccess.gross_profit);
                blstclosingstock.Text = Convert.ToString(ConnectionWithAccess.closing_stock);
                ConnectionWithAccess.net_profit = Math.Round((Convert.ToDouble(blstgp.Text) - Convert.ToDouble(blstplexpense.Text)), 2);
                blstnetprofit.Text = Convert.ToString(ConnectionWithAccess.net_profit);
                //blstgp_per.Text = Convert.ToString(Convert.ToSingle((((-mSAMT - mRSAMT - mOSAMT - mPAMT - mTRAMT) - mTAMT) * 1) * 100) / (mSAMT + mRSAMT));
            }
            else
            {
                if (cb_emerg_full_period.Checked)
                    ConnectionWithAccess.closing_stock = Math.Round(get_account_balance_from_51(emerg_prd, "2001", "@@@"), 2);
                ConnectionWithAccess.gross_profit = 0;
            }
        }

        private void calculate_gross_profit_using_closing_stock(string emerg_prd)
        {
            if ((cb_emerg_sale.Checked == true || cb_emerg_purchase.Checked == true || cb_emerg_bank.Checked == true || cb_emerg_cash.Checked == true || cb_emerg_journal.Checked == true))
            {
                double mTAMT, mSAMT, mRSAMT, mGP_AMT, mOSAMT, mPAMT, mTRAMT, mGP, mpl_exp;
                mGP = ConnectionWithAccess.gp_percent * -1;
                this.Text = "Please wait Emerging Gross Profit and Closing Stock";
                balance_amount = new string[0];
                list_of_balance_amount.Clear();
                ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n >= '61' and a_n <= '65ZZZZ' and s_a ='@@@'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][0] != null)
                        {
                            list_of_balance_amount.Add(dtData1.Rows[iRowCount][0].ToString());
                        }
                    }
                }
                ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n >= '7001' and a_n <= '70ZZZZ' and s_a ='@@@'";
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][0] != null)
                        {
                            list_of_balance_amount.Add(dtData1.Rows[iRowCount][0].ToString());
                        }
                    }
                }
                mTRAMT = 0;
                for (int i = 0; i < list_of_balance_amount.Count; i++)
                {
                    mTRAMT = mTRAMT + Convert.ToDouble(list_of_balance_amount[i]);
                }
                mSAMT = Math.Round(get_account_balance_from_51(emerg_prd, "6000", "@@@"), 2);
                mRSAMT = Math.Round(get_account_balance_from_51(emerg_prd, "6000R1", "@@@"), 2);
                mGP_AMT = mSAMT * ConnectionWithAccess.gp_percent / 100;
                mOSAMT = Math.Round(get_account_balance_from_51(emerg_prd, "2001", "@@@"), 2);
                mPAMT = Math.Round(get_account_balance_from_51(emerg_prd, "7000", "@@@"), 2);
                //mTAMT = ((mSAMT + mRSAMT + mGP_AMT + mOSAMT + mPAMT + mTRAMT) * -1);
                //mTAMT = Math.Round(mTAMT, 2);
                mTAMT = (-mSAMT - mRSAMT - mOSAMT - mPAMT - mTRAMT) - ((mSAMT + mRSAMT) * mGP / 100 * -1);
                mTAMT = Math.Round(mTAMT, 2);
                mGP_AMT = mTAMT - mSAMT - mRSAMT - mOSAMT - mPAMT - mTRAMT;
                ConnectionWithAccess.gross_profit = mGP_AMT;
                ConnectionWithAccess.closing_stock = mTAMT;
                balance_amount = new string[0];
                list_of_balance_amount.Clear();
                ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n >= '75A' and a_n <= '75ZZZZ' and s_a ='@@@'";
                dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                    {
                        if (dtData1.Rows[iRowCount][0] != null)
                        {
                            list_of_balance_amount.Add(dtData1.Rows[iRowCount][0].ToString());
                        }
                    }
                }
                this.Text = "Please wait Emerging Gross Profit and Closing Stock";
                mpl_exp = 0;
                for (int i = 0; i < list_of_balance_amount.Count; i++)
                {
                    mpl_exp = mpl_exp + Convert.ToDouble(list_of_balance_amount[i]);
                }
                blstsales.Text = mSAMT.ToString();
                blstrepairs.Text = mRSAMT.ToString();
                blstgp.Text = mGP_AMT.ToString();
                blstopenstock.Text = mOSAMT.ToString();
                blstpurchase.Text = mPAMT.ToString();
                blsttradexp.Text = mTRAMT.ToString();
                blstplexpense.Text = mpl_exp.ToString();
                blstgp.Text = Convert.ToString(ConnectionWithAccess.gross_profit);
                blstplgp.Text = Convert.ToString(ConnectionWithAccess.gross_profit);
                blstclosingstock.Text = Convert.ToString(ConnectionWithAccess.closing_stock);
                ConnectionWithAccess.net_profit = Math.Round((ConnectionWithAccess.gross_profit - Convert.ToDouble(blstplexpense.Text)), 2);
                blstnetprofit.Text = Convert.ToString(ConnectionWithAccess.net_profit);
                //blstgp_per.Text = Convert.ToString(Convert.ToSingle((((-mSAMT - mRSAMT - mOSAMT - mPAMT - mTRAMT) - mTAMT) * 1) * 100) / (mSAMT + mRSAMT));
            }
            else
            {
                if (cb_emerg_full_period.Checked)
                    ConnectionWithAccess.closing_stock = Math.Round(get_account_balance_from_51(emerg_prd, "2001", "@@@"), 2);
                ConnectionWithAccess.gross_profit = 0;
            }
        }

        private void save_balance_sheet_gp_values(string emerg_prd)
        {
            if (cb_emerg_sale.Checked == true && cb_emerg_purchase.Checked == true && cb_emerg_bank.Checked == true && cb_emerg_cash.Checked == true && cb_emerg_journal.Checked == true)
            {
                update_amount_in_51(emerg_prd, "5000", "@@@", (Convert.ToDouble(ConnectionWithAccess.closing_stock) * -1));
                update_amount_in_51(ConnectionWithAccess.get_next_prd_name(emerg_prd), "2001", "@@@", (Convert.ToDouble(ConnectionWithAccess.closing_stock)));
                update_amount_in_51(emerg_prd, "719999", "@@@", (Convert.ToDouble(ConnectionWithAccess.gross_profit)));
                update_amount_in_51(emerg_prd, "7998", "@@@", (Convert.ToDouble(ConnectionWithAccess.net_profit)));
                ConnectionWithAccess.query = "select gp from " + ConnectionWithAccess.tablename[50] + " where prd = '" + emerg_prd + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {

                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[50] + " set gp = " + (ConnectionWithAccess.gp_percent * -1) + " where prd ='" + emerg_prd + "'";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }
            else
            {
                update_amount_in_51(emerg_prd, "5000", "@@@", (Convert.ToDouble(ConnectionWithAccess.closing_stock) * -1));
                update_amount_in_51(ConnectionWithAccess.get_next_prd_name(emerg_prd), "2001", "@@@", (Convert.ToDouble(ConnectionWithAccess.closing_stock)));
            }
        }

        private void calculate_closing_capital_balance_and_add_in_new_period(string emerg_prd, string emerg_oprd)
        {
            if (cb_emerg_sale.Checked == true && cb_emerg_purchase.Checked == true && cb_emerg_bank.Checked == true && cb_emerg_cash.Checked == true && cb_emerg_journal.Checked == true)
            {
                temp_double = get_account_balance_from_51(emerg_oprd, "3001", "@@@");
                update_amount_in_51(emerg_prd, "3000", "@@@", temp_double * -1);
                temp_double = 0;
                update_amount_in_51(emerg_prd, "3001", "@@@", 0);
                //add_contains_of_capital_account_in_gridview(emerg_prd);
                //debitamount = 0;
                //creditamount = 0;
                //for (int i = 0; i < BalShDGV.Rows.Count; i++)
                //{
                //    if (BalShDGV.Rows[i].Cells[5].Value != null)
                //    {
                //        if (BalShDGV.Rows[i].Cells[5].Value.ToString() != "")
                //        {
                //            if (Convert.ToDouble(BalShDGV.Rows[i].Cells[5].Value.ToString()) > 0)
                //                debitamount += Convert.ToDouble(BalShDGV.Rows[i].Cells[5].Value.ToString());
                //        }
                //    }
                //    if (BalShDGV.Rows[i].Cells[8].Value != null)
                //    {
                //        if (BalShDGV.Rows[i].Cells[8].Value.ToString() != "")
                //        {
                //            if (Convert.ToDouble(BalShDGV.Rows[i].Cells[8].Value.ToString()) > 0)
                //                creditamount += Convert.ToDouble(BalShDGV.Rows[i].Cells[8].Value.ToString());
                //        }
                //    }
                //}
                //temp_double = creditamount - debitamount;


                ConnectionWithAccess.query = query_contains_for_capital_account_union(emerg_prd);
                DataTable dtNewTable = ConnectionCommand.fGetDataTable();

                if (dtNewTable != null)
                {
                    debitamount = 0;
                    creditamount = 0;
                    for (int i = 0; i < dtNewTable.Rows.Count; i++)
                    {
                        if (dtNewTable.Rows[i][5].ToString() != null)
                        {
                            if (dtNewTable.Rows[i][5].ToString() != "")
                            {
                                if (Convert.ToDouble(dtNewTable.Rows[i][5].ToString()) > 0)
                                    debitamount += Convert.ToDouble(dtNewTable.Rows[i][5].ToString());
                            }
                        }
                        if (dtNewTable.Rows[i][8].ToString() != null)
                        {
                            if (dtNewTable.Rows[i][8].ToString() != "")
                            {
                                if (Convert.ToDouble(dtNewTable.Rows[i][8].ToString()) > 0)
                                    creditamount += Convert.ToDouble(dtNewTable.Rows[i][8].ToString());
                            }
                        }
                    }
                    temp_double = creditamount - debitamount;
                }
                update_amount_in_51(emerg_prd, "3001", "@@@", temp_double);
                update_amount_in_51(ConnectionWithAccess.get_next_prd_name(emerg_prd), "3000", "@@@", temp_double * -1);
            }
            else
            {
                temp_double = get_account_balance_from_51(emerg_oprd, "3001", "@@@");
                update_amount_in_51(emerg_prd, "3000", "@@@", temp_double * -1);
                update_amount_in_51(emerg_prd, "3001", "@@@", temp_double);
                temp_double = get_account_balance_from_51(emerg_prd, "2001", "@@@");
                update_amount_in_51(emerg_prd, "5000", "@@@", temp_double * -1);
            }
        }

        private void update_advances_from_customers_and_suppliers(string emerg_prd)
        {
            temp_double = get_account_balance_from_51(emerg_oprd, "2004", "@@@");
            if (temp_double != 0.0)
            {
                add_amount_in_51(emerg_prd, "4002", "@@@", temp_double);
                //update_amount_in_51(emerg_prd, "2004", "@@@", 0.00);
            }
            temp_double = get_account_balance_from_51(emerg_oprd, "2003", "@@@");
            if (temp_double != 0.0)
            {
                add_amount_in_51(emerg_prd, "2002", "@@@", temp_double);
                update_amount_in_51(emerg_prd, "2003", "@@@", 0.00);
            }
            balance_amount = new string[0];
            this.Text = "Please wait Emerging " + ConnectionWithAccess.tablename[51];
            list_of_balance_amount.Clear();
            ConnectionWithAccess.query = "select prd,a_n,s_a,amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n = '2002' and amt < 0 order by a_n,s_a";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    if (dtData1.Rows[iRowCount][0] != null)
                    {
                        list_of_balance_amount.Add(dtData1.Rows[iRowCount][0].ToString());
                    }
                }
            }
            temp_double = 0;
            for (int i = 0; i < list_of_balance_amount.Count; i++)
            {
                var cellArray = list_of_balance_amount[i].Split(new[] { ',' });
                if (cellArray[4].ToString() == "AR")
                    temp_double += Convert.ToDouble(cellArray[3]);
            }
            if (temp_double != 0.0)
            {
                update_amount_in_51(emerg_prd, "2003", "@@@", temp_double);
                add_amount_in_51(emerg_prd, "2002", "@@@", temp_double * -1);
            }
            balance_amount = new string[0];
            list_of_balance_amount.Clear();
            this.Text = "Please wait Emerging " + ConnectionWithAccess.tablename[51];
            ConnectionWithAccess.query = "select prd,a_n,s_a,amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n = '4002' and s_a <> '@@@' and amt > 0.00 order by a_n,s_a";
            dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    if (dtData1.Rows[iRowCount][0] != null)
                    {
                        list_of_balance_amount.Add(dtData1.Rows[iRowCount][0].ToString());
                    }
                }
            }
            temp_double = 0;
            for (int i = 0; i < list_of_balance_amount.Count; i++)
            {
                var cellArray = list_of_balance_amount[i].Split(new[] { ',' });
                if (cellArray[4].ToString() == "AP")
                    temp_double += Convert.ToDouble(cellArray[3]);
            }
            if (temp_double != 0.0)
            {
                update_amount_in_51(emerg_prd, "2004", "@@@", temp_double);
                add_amount_in_51(emerg_prd, "4002", "@@@", temp_double * -1);
            }
        }

        private void update_at_the_rate_of_customers_and_suppliers(string emerg_prd)
        {
            this.Text = "Please wait Emerging " + ConnectionWithAccess.tablename[51];
            update_amount_in_51(emerg_prd, "2002", "@@@", 0.00);
            update_amount_in_51(emerg_prd, "2003", "@@@", 0.00);
            update_amount_in_51(emerg_prd, "2004", "@@@", 0.00);
            update_amount_in_51(emerg_prd, "4002", "@@@", 0.00);
            balance_amount = new string[0];
            list_of_balance_amount.Clear();
            ConnectionWithAccess.query = "select prd,a_n,s_a,amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n = '2002' and amt > 0 order by a_n,s_a";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    if (dtData1.Rows[iRowCount][3] != null)
                    {
                        temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + dtData1.Rows[iRowCount][3].ToString() + " ,CO";
                        list_of_balance_amount.Add(temp_word);
                    }
                }
            }
            this.Text = "Please wait Emerging " + ConnectionWithAccess.tablename[51];
            ConnectionWithAccess.query = "select prd,a_n,s_a,amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n = '2002' and amt < 0 order by a_n,s_a";
            dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    if (dtData1.Rows[iRowCount][3] != null)
                    {
                        temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + dtData1.Rows[iRowCount][3].ToString() + " ,AR";
                        list_of_balance_amount.Add(temp_word);
                    }
                }
            }
            this.Text = "Please wait Emerging " + ConnectionWithAccess.tablename[51];
            ConnectionWithAccess.query = "select prd,a_n,s_a,amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n = '4002' and amt < 0 order by a_n,s_a";
            dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    if (dtData1.Rows[iRowCount][3] != null)
                    {
                        temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + dtData1.Rows[iRowCount][3].ToString() + " ,SO";
                        list_of_balance_amount.Add(temp_word);
                    }
                }
            }
            ConnectionWithAccess.query = "select prd,a_n,s_a,amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n = '4002' and amt > 0 order by a_n,s_a";
            this.Text = "Please wait Emerging " + ConnectionWithAccess.tablename[51];
            dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    if (dtData1.Rows[iRowCount][3] != null)
                    {
                        temp_word = dtData1.Rows[iRowCount][0].ToString() + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + dtData1.Rows[iRowCount][3].ToString() + " ,AP";
                        list_of_balance_amount.Add(temp_word);
                    }
                }
            }
            temp_double = 0;
            for (int i = 0; i < list_of_balance_amount.Count; i++)
            {
                var cellArray = list_of_balance_amount[i].Split(new[] { ',' });
                if (cellArray[4].ToString() == "CO")
                    temp_double += Convert.ToDouble(cellArray[3]);
            }
            if (temp_double != 0.0)
                update_amount_in_51(emerg_prd, "2002", "@@@", temp_double);
            temp_double = 0;
            for (int i = 0; i < list_of_balance_amount.Count; i++)
            {
                var cellArray = list_of_balance_amount[i].Split(new[] { ',' });
                if (cellArray[4].ToString() == "AR")
                    temp_double += Convert.ToDouble(cellArray[3]);
            }
            if (temp_double != 0.0)
                update_amount_in_51(emerg_prd, "2003", "@@@", temp_double);
            temp_double = 0;
            for (int i = 0; i < list_of_balance_amount.Count; i++)
            {
                var cellArray = list_of_balance_amount[i].Split(new[] { ',' });
                if (cellArray[4].ToString() == "SO")
                    temp_double += Convert.ToDouble(cellArray[3]);
            }
            if (temp_double != 0.0)
                update_amount_in_51(emerg_prd, "4002", "@@@", temp_double);
            temp_double = 0;
            for (int i = 0; i < list_of_balance_amount.Count; i++)
            {
                var cellArray = list_of_balance_amount[i].Split(new[] { ',' });
                if (cellArray[4].ToString() == "AP")
                    temp_double += Convert.ToDouble(cellArray[3]);
            }
            if (temp_double != 0.0)
                update_amount_in_51(emerg_prd, "2004", "@@@", temp_double);
        }

        private void update_emerg_amount_in_51(string mprd, string ma_n, string ms_a, double mamount, string book, int d_c)
        {
            ma_n = ma_n.Trim();
            ms_a = ms_a.Trim();
            if (ms_a == "@@@")
                temp_word = "";
            if (ma_n == "70ICC")
                temp_word = "sanjay";
            if (ma_n == "2010")
                temp_word = "sanjay";
            if (book == "B")
            {
                mold_amount = 0;
                if (ms_a == "@@@")
                {
                    add_amount_in_51(mprd, ma_n, "@@@", mamount);
                }
                else
                {
                    add_amount_in_51(mprd, ma_n, ms_a, mamount);
                    get_a_n_from_d_c("B", d_c);
                    add_amount_in_51(mprd, ma_n, "@@@", mamount);
                }
            }
            else if (book == "C")
            {
                mold_amount = 0;
                if (ms_a == "@@@")
                {
                    add_amount_in_51(mprd, ma_n, "@@@", mamount);
                }
                else
                {
                    add_amount_in_51(mprd, ma_n, ms_a, mamount);
                    get_a_n_from_d_c("C", d_c);
                    add_amount_in_51(mprd, ma_n, "@@@", mamount);
                }
            }
            else
            {
                add_amount_in_51(mprd, ma_n, ms_a, mamount);
            }
        }

        # endregion

        private void add_amount_in_51(string mprd, string ma_n, string ms_a, double mamount)
        {
            if (mamount != 0.00)
            {
                ma_n = ma_n.Trim();
                ms_a = ms_a.Trim();
                if (ma_n == "7001")
                    temp_word = "sanjay";
                if (ma_n == "2002" && ms_a == "@@@")
                    temp_word = "sanjay";
                if (ma_n == "70ICC")
                    temp_word = "sanjay";
                if (mamount == 4368.00)
                    temp_word = "sanjay";
                if (ms_a == "MZ1")
                    temp_word = "sanjay";
                isRecord = 0;
                mold_amount = 0;
                //if (ms_a = '@@@')
                //    ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + mprd + "' and a_n = '" + ma_n + "' and s_a = '@@@'";
                //else
                //    ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + mprd + "' and a_n = '" + ma_n + "' and (s_a = '" + ms_a + "' or s_a = '@@@')";

                ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + mprd + "' and a_n = '" + ma_n + "' and s_a = '" + ms_a + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();

                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    isRecord = 1;
                    mold_amount = Convert.ToDouble(dtData1.Rows[0][0]);
                }
                if (ma_n == "2010")
                    temp_word = "";
                if (isRecord == 0)
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[51] + " (prd, a_n, s_a, amt, d_d, [user], insert_dt_tm) values('" + mprd + "', '" + ma_n + "', '" + ms_a + "' , " + mamount + " , '01/01/1901'" + " , '" + ConnectionWithAccess.muser + "', @currDate )";
                else
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[51] + " set amt = " + Math.Round((mamount + mold_amount), 2) + " where prd = '" + mprd + "' and a_n = '" + ma_n + "' and s_a = '" + ms_a + "' and [user] = '" + ConnectionWithAccess.muser + "' and insert_dt_tm = @currDate";
                //if (ma_n == "2011")
                //    list_of_temporary_emerg_data.Add(mprd + " ," + ma_n + " ," + ms_a + " ," + Convert.ToString(mamount) + " ," + Convert.ToString(mold_amount));
                add_user_date_time_function_compulsory_program();
                ConnectionCommand.fUpdateInsertDeleteData();
            }
        }

        private void update_amount_in_51(string mprd, string ma_n, string ms_a, double mamount)
        {
            ma_n = ma_n.Trim();
            ms_a = ms_a.Trim();
            if (ma_n == "2010")
                temp_word = "sanjay";
            if (ma_n == "7001")
                temp_word = "sanjay";
            if (ma_n == "2002" && ms_a == "@@@")
                temp_word = "sanjay";
            if (ma_n == "5000")
                temp_word = "sanjay";
            if (ms_a == "@@@")
                temp_word = "";
            if (ms_a == "MZ1")
                temp_word = "sanjay";
            isRecord = 0;
            ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + mprd + "' and a_n = '" + ma_n + "' and s_a = '" + ms_a + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                isRecord = 1;
            }

            if (isRecord == 0)
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[51] + " (prd, a_n, s_a, amt, d_d, [user], insert_dt_tm) values('" + mprd + "', '" + ma_n + "', '" + ms_a + "' , " + mamount + " , '01/01/1901'" + " , '" + ConnectionWithAccess.muser + "', @currDate )";
            else
                ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[51] + " set amt = " + mamount + " where prd = '" + mprd + "' and a_n = '" + ma_n + "' and s_a = '" + ms_a + "'";
            //if (ma_n == "2011")
            //    list_of_temporary_emerg_data.Add(mprd + " ," + ma_n + " ," + ms_a + " ," + Convert.ToString(mamount));
            add_user_date_time_function_compulsory_program();
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void update_item_stock_in_o5_using_type_item_code(string mtype, string mitem_code, double mqty)
        {
            if (mtype != "" && mitem_code != "" && mqty != 0.0)
            {
                temp_double = 0.0;
                isRecord = 0;
                ConnectionWithAccess.query = "select CLO_STK from " + ConnectionWithAccess.tablename[05] + " where [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();

                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[05] + " set clo_stk = " + Math.Round((mqty), 2) + " where [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }
        }

        private void disable_all_keys()
        {
            maintab.Enabled = false;
            subtabDataEntry.Enabled = false;
            subtabMasters.Enabled = false;
            subtabsettings.Enabled = false;
            subtabsale.Enabled = false;
            subtabpurchase.Enabled = false;
            subtabbank.Enabled = false;
            subtabcash.Enabled = false;
            subtabhelp.Enabled = false;
        }

        private void enable_all_keys()
        {
            maintab.Enabled = true;
            subtabDataEntry.Enabled = true;
            subtabMasters.Enabled = true;
            subtabsettings.Enabled = true;
            subtabsale.Enabled = true;
            subtabpurchase.Enabled = true;
            subtabbank.Enabled = true;
            subtabcash.Enabled = true;
            subtabhelp.Enabled = true;
            this.Text = text_to_display_on_top;
        }

        private void bpdbc_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (bpdbc.Text != "")
            {
                //bptranlist.Rows.Clear();
                bptranlist.DataSource = null;
                fill_bank_trans_list();
                refresh_bank_document_number();
                bpcurbankbal.Text = Convert.ToString(get_bank_balance(get_a_n_from_d_c("B", Convert.ToInt32(bpdbc.Text)), "@@@", DateTime.Today.ToShortDateString()));
                bpamt.Focus();
            }
        }

        private void bddbc_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (bddbc.Text != "")
            {
                // bdtranlist.Rows.Clear();
                bdtranlist.DataSource = null;
                fill_bank_trans_list();
                refresh_bank_document_number();
                bdcurbankbal.Text = Convert.ToString(get_bank_balance(get_a_n_from_d_c("B", Convert.ToInt32(bddbc.Text)), "@@@", DateTime.Today.ToShortDateString()));
                bdcurcashbal.Text = Convert.ToString(get_cash_balance("2010", "@@@", DateTime.Today.ToShortDateString()));
                bdamt.Focus();
            }
        }

        private void bwdbc_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (bwdbc.Text != "")
            {
                // bwtranlist.Rows.Clear();
                //bwtranlist.Rows.Clear();
                bwtranlist.DataSource = null;
                fill_bank_trans_list();
                refresh_bank_document_number();
                get_account_name_from_d_c("B", Convert.ToInt32(bwdbc.Text));
                bwa_n.Text = get_a_n_from_d_c("B", Convert.ToInt32(bwdbc.Text));
                bwcurbankbal.Text = Convert.ToString(get_bank_balance(bwa_n.Text, "@@@", DateTime.Today.ToShortDateString()));
                bwcurcashbal.Text = Convert.ToString(get_cash_balance("2010", "@@@", DateTime.Today.ToShortDateString()));
                bdamt.Focus();
            }
        }

        private void bp_datagridview_Click_1(object sender, EventArgs e)
        {
            select_party_for_bank();
            bp_dgv_gst_tax_brief.Visible = true;
            bp_basicamt.ReadOnly = false;
            bp_igst_per.ReadOnly = false;
            bpamt.ReadOnly = false;
            bppartyname.Text = ConnectionWithAccess.mdesc;
            bppartycontact.Text = ConnectionWithAccess.accountcontact;
            bppartyaddress.Text = ConnectionWithAccess.accountaddress;
            bppartyoverallbalance.Text = Convert.ToString(calculate_account_balance(bpa_n.Text, bps_a.Text, Convert.ToString(bpdatetime.Text)));
            if (bp_datagridview.CurrentRow != null)
            {
                common_account_head(bpa_n.Text);
                lbl_bp_account_head.Text = ConnectionWithAccess.macc_desc;
            }
            bptranlist.Visible = true;
            bp_dgv_gst_tax_brief.DataSource = null;
            ConnectionWithAccess.query = "select f8.bamt, f8.igst_per, f8.igst_amt, f8.gamt from " + ConnectionWithAccess.tablename[8] + " f8 where f8.book = 'b' and f8.prd = '" + ConnectionWithAccess.mprd + "' and f8.d_c = " + bpdbc.Text + " and f8.r_p = '4' and F8.d_n = " + bpdocno.Text;
            ConnectionCommand.accountHelp_datatable_Seperate(bp_dgv_gst_tax_brief, "bp_dgv_gst_tax_brief");
            bpamt.Focus();
        }

        private void bp_datagridview_KeyDown_1(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                ConnectionWithAccess.mdesc = bp_datagridview.CurrentRow.Cells[0].Value.ToString();
                ConnectionWithAccess.mcity = bp_datagridview.CurrentRow.Cells[1].Value.ToString();
                bpa_n.Text = bp_datagridview.CurrentRow.Cells[2].Value.ToString();
                bps_a.Text = bp_datagridview.CurrentRow.Cells[3].Value.ToString();
                show_images();
                bp_datagridview.Visible = false;
                bppartycode.Text = ConnectionWithAccess.mdesc;
                bppartycity.Text = ConnectionWithAccess.mcity;
            }
        }

        private void tbTitle_KeyPress(object sender, KeyPressEventArgs e)
        {
            if (!cb_change_item_name.Checked)
            {
                if (tbTitle.Text != "")
                {
                    master_item_help.Visible = true;
                    master_item_help.BringToFront();
                    ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where title like '%" + tbTitle.Text + "%'";
                    ConnectionCommand.accountHelp_datatable_Seperate(master_item_help, "master_item_help");
                    if (master_item_help.CurrentRow != null)
                    {
                        master_item_help.Columns[0].Visible = false;
                        master_item_help.Columns[1].Visible = false;
                        master_item_help.Columns[2].Width = 300;
                    }
                    else
                        master_item_help.Visible = false;
                }
            }
        }

        private void master_item_help_Click(object sender, EventArgs e)
        {
            tbTitle.Text = Convert.ToString(master_item_help.SelectedCells[2].Value);

            update_masters_items_screen_details(tbTitle.Text);
        }

        private void sitaxlist_Click(object sender, EventArgs e)
        {
            sitaxcode.Text = Convert.ToString(sitaxlist.CurrentRow.Cells[0].Value);
            sitaxrate.Text = Convert.ToString(sitaxlist.CurrentRow.Cells[1].Value);
            sitaxdesc.Text = Convert.ToString(sitaxlist.CurrentRow.Cells[2].Value);
            sitaxlist.Visible = false;
            cb_all_sale_invoice_ledger.Visible = true;
            cb_all_sale_invoice_list.Visible = true;
            cb_all_sale_item_list.Visible = true;
        }

        private void tbDesc_KeyPress(object sender, KeyPressEventArgs e)
        {
            if (!cb_change_master_account_name.Checked)
            {
                master_account_help_dg.Visible = true;
                Bank_Details.Visible = false;
            }
        }

        private void update_masters_items_screen_details(string mtitle)
        {
            if (maintab.SelectedIndex == 2)
            {
                if (mtitle != "")
                {
                    //tbTitle.ReadOnly = true;
                    master_item_help.Visible = false;
                    ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,p_price,price,cat,opn_stk,clo_stk,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where title like '%" + tbTitle.Text + "'";
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        if (dtData1.Rows[0][0] != null)
                        {
                            tbItemType.Text = dtData1.Rows[0][0].ToString();
                            tbItemCode.Text = dtData1.Rows[0][1].ToString();
                            tbCB.Text = dtData1.Rows[0][3].ToString();
                            tbBQ.Text = dtData1.Rows[0][4].ToString();
                            tb_purc_price.Text = dtData1.Rows[0][5].ToString();
                            tbItemRate.Text = dtData1.Rows[0][6].ToString();
                            cbItemUnit.Text = dtData1.Rows[0][7].ToString();
                            tb_item_open_stock.Text = dtData1.Rows[0][8].ToString();
                            tbCurStock.Text = dtData1.Rows[0][9].ToString();
                            tb_igst_tax_rate.Text = dtData1.Rows[0][10].ToString();
                            tb_hsn_code.Text = dtData1.Rows[0][11].ToString();
                            temp_double = Convert.ToDouble(dtData1.Rows[0][8].ToString());
                        }
                    }
                    cb_change_item_name.Visible = true;
                }
            }
        }

        private void ItemListDG_Click(object sender, EventArgs e)
        {
            tbTitle.Text = ItemListDG.CurrentRow.Cells[2].Value.ToString();
            update_masters_items_screen_details(tbTitle.Text);
        }

        private void btn_create_sqllite_file_Click(object sender, EventArgs e)
        {
            sqlite_filename = "F:\\ACC\\AP2\\AP2";
            SQLiteConnection.CreateFile(sqlite_filename);
            SQLiteConnection m_dbConnection = new SQLiteConnection("Data Source=" + sqlite_filename + ";Version=3;");
            m_dbConnection.Open();
            string mDRIVE = "F";
            //ConnectionWithAccess.mtextfilename = mDRIVE + ":\\" + "acc\\table_structure.txt";
            //ConnectionWithAccess.mtextfilename = mDRIVE + ":\\" + "visual studio\\projects\\sharp\\table_structure.txt";
            ConnectionWithAccess.mtextfilename = mDRIVE + ":\\ACC\\table_structure.txt";
            var lines = File.ReadAllLines(ConnectionWithAccess.mtextfilename);
            for (int i = 0; i < lines.Count(); i++)
            {
                if (lines[i] != null)
                {
                    temp_word = lines[i];
                    if (temp_word.Substring(0, 1) == "_")
                    {
                        string struction_sintex, query;
                        mtbname = ConnectionWithAccess.mNIK + temp_word;
                        struction_sintex = lines[i + 1];
                        query = "create table " + mtbname + "(" + struction_sintex + ")";
                        SQLiteCommand command = new SQLiteCommand(query, m_dbConnection);
                        command.ExecuteNonQuery();
                    }
                }
            }
            m_dbConnection.Close();
            MessageBox.Show("Sqlite File Generated Sucessfully");
        }

        private void pibasicamt_TextChanged(object sender, EventArgs e)
        {
            if (pibasicamt.Text != "0.00")
            {
                pi_frieght_amt.ReadOnly = false;
                pi_packing_amt.ReadOnly = false;
                pi_insurance_amt.ReadOnly = false;
                pi_other_amt.ReadOnly = false;
                if (periodofgst)
                {
                    //tb_pi_igst_tax_amount.Text = "0.00";
                    //pi_invoice_tax_amount = 0;
                    //int totalrowcount = piitemlist.Rows.Count;
                    //purchase_invoice_amount = 0;
                    //for (int i = 0; i < totalrowcount; i++)
                    //{
                    //    if (piitemlist.Rows[i].Cells[7].Value != System.DBNull.Value && piitemlist.Rows[i].Cells[7].Value != null)
                    //        purchase_invoice_amount = purchase_invoice_amount + Convert.ToDouble(piitemlist.Rows[i].Cells[7].Value);
                    //    if (piitemlist.Rows[i].Cells[9].Value != System.DBNull.Value && piitemlist.Rows[i].Cells[9].Value != null)
                    //        pi_invoice_tax_amount += (Convert.ToDouble(piitemlist.Rows[i].Cells[7].Value) * Convert.ToDouble(piitemlist.Rows[i].Cells[9].Value) / 100);
                    //}
                    //if (purchase_invoice_amount == 0 && pibasicamt.Text != "" && pibasicamt.Text != "0.00")
                        purchase_invoice_amount = Convert.ToDouble(pibasicamt.Text);
                    tb_pi_igst_tax_amount.Text = Convert.ToString(pi_invoice_tax_amount);
                    purchase_invoice_amount += Convert.ToDouble(tb_pi_igst_tax_amount.Text);
                    if (pi_frieght_amt.Text != "")
                        purchase_invoice_amount += Convert.ToDouble(pi_frieght_amt.Text);
                    if (pi_packing_amt.Text != "")
                        purchase_invoice_amount += Convert.ToDouble(pi_packing_amt.Text);
                    if (pi_insurance_amt.Text != "")
                        purchase_invoice_amount += Convert.ToDouble(pi_insurance_amt.Text);
                    if (pi_other_amt.Text != "")
                        purchase_invoice_amount += Convert.ToDouble(pi_other_amt.Text);
                    calculate_roundoff();
                    purchase_invoice_amount += Convert.ToDouble(piroundoffamt.Text);
                    pigrossamt.Text = Convert.ToString(purchase_invoice_amount);
                }
                else
                {
                    if (pitaxrate.Text != "")
                        pitaxamt.Text = Convert.ToString(Convert.ToDouble(pibasicamt.Text) * Convert.ToDouble(pitaxrate.Text) / 100);
                    else
                        pitaxamt.Text = "";
                    if (tb_pi_igst_tax_amount.Text != "")
                        purchase_invoice_amount += Convert.ToDouble(tb_pi_igst_tax_amount.Text);
                    if (pi_frieght_amt.Text != "")
                        purchase_invoice_amount += Convert.ToDouble(pi_frieght_amt.Text);
                    if (pi_packing_amt.Text != "")
                        purchase_invoice_amount += Convert.ToDouble(pi_packing_amt.Text);
                    if (pi_insurance_amt.Text != "")
                        purchase_invoice_amount += Convert.ToDouble(pi_insurance_amt.Text);
                    if (pi_other_amt.Text != "")
                        purchase_invoice_amount += Convert.ToDouble(pi_other_amt.Text);
                    calculate_roundoff();
                    purchase_invoice_amount += Convert.ToDouble(piroundoffamt.Text);
                    pigrossamt.Text = Convert.ToString(purchase_invoice_amount);
                }
            }
            else
            {
                pi_frieght_amt.Text = "0.00";
                pi_packing_amt.Text = "0.00";
                pi_insurance_amt.Text = "0.00";
                pi_other_amt.Text = "0.00";
                pigrossamt.Text = "0.00";
                pi_frieght_amt.ReadOnly = true;
                pi_packing_amt.ReadOnly = true;
                pi_insurance_amt.ReadOnly = true;
                pi_other_amt.ReadOnly = true;
            }
        }

        private void sibasicamt_TextChanged(object sender, EventArgs e)
        {
            if (sibasicamt.Text != "0")
            {
                si_cash_received.Visible = true;
                lbl_si_cash_received.Visible = true;
                si_frieght_amt.ReadOnly = false;
                si_packing_amt.ReadOnly = false;
                si_insurance_amt.ReadOnly = false;
                si_other_amt.ReadOnly = false;
                if (periodofgst)
                {
                    tb_si_igst_tax_amount.Text = "0.00";
                    si_invoice_tax_amount = 0;
                    int totalrowcount = siitemlist.Rows.Count;
                    sale_invoice_amount = 0;
                    for (int i = 0; i < totalrowcount; i++)
                    {
                        if (siitemlist.Rows[i].Cells[7].Value != System.DBNull.Value)
                            sale_invoice_amount = sale_invoice_amount + Convert.ToDouble(siitemlist.Rows[i].Cells[7].Value);
                        if (siitemlist.Rows[i].Cells[9].Value != System.DBNull.Value && siitemlist.Rows[i].Cells[9].Value != "" && siitemlist.Rows[i].Cells[9].Value != System.DBNull.Value && siitemlist.Rows[i].Cells[9].Value != "")
                            si_invoice_tax_amount += (Convert.ToDouble(siitemlist.Rows[i].Cells[7].Value) * Convert.ToDouble(siitemlist.Rows[i].Cells[9].Value) / 100);
                    }
                    tb_si_igst_tax_amount.Text = string.Format("{0:0.00}", Convert.ToDouble(si_invoice_tax_amount));
                    sale_invoice_amount += Convert.ToDouble(tb_si_igst_tax_amount.Text);
                    if (si_frieght_amt.Text != "" && si_frieght_amt.Text != "0.00")
                        sale_invoice_amount += Convert.ToDouble(si_frieght_amt.Text);
                    if (si_packing_amt.Text != "" && si_packing_amt.Text != "0.00")
                        sale_invoice_amount += Convert.ToDouble(si_packing_amt.Text);
                    if (si_insurance_amt.Text != "" && si_insurance_amt.Text != "0.00")
                        sale_invoice_amount += Convert.ToDouble(si_insurance_amt.Text);
                    if (si_other_amt.Text != "" && si_other_amt.Text != "0.00")
                        sale_invoice_amount += Convert.ToDouble(si_other_amt.Text);
                    calculate_roundoff();
                    sale_invoice_amount += Convert.ToDouble(siroundoffamt.Text);
                    sigrossamt.Text = string.Format("{0:0.00}", Convert.ToDouble(sale_invoice_amount));
                }
                else
                {
                    sitaxamt.Text = Convert.ToString(Convert.ToDouble(sibasicamt.Text) * Convert.ToDouble(sitaxrate.Text) / 100);
                    sale_invoice_amount += Convert.ToDouble(sitaxamt.Text);
                    if (si_frieght_amt.Text != "" && si_frieght_amt.Text != "0.00")
                        sale_invoice_amount += Convert.ToDouble(si_frieght_amt.Text);
                    if (si_packing_amt.Text != "" && si_packing_amt.Text != "0.00")
                        sale_invoice_amount += Convert.ToDouble(si_packing_amt.Text);
                    if (si_insurance_amt.Text != "" && si_insurance_amt.Text != "0.00")
                        sale_invoice_amount += Convert.ToDouble(si_insurance_amt.Text);
                    if (si_other_amt.Text != "" && si_other_amt.Text != "0.00")
                        sale_invoice_amount += Convert.ToDouble(si_other_amt.Text);
                    calculate_roundoff();
                    sigrossamt.Text = Convert.ToString(sale_invoice_amount);
                }
            }
            else
            {
                tb_si_igst_tax_amount.Text = "0.00";
                si_frieght_amt.Text = "0.00";
                si_packing_amt.Text = "0.00";
                si_insurance_amt.Text = "0.00";
                si_other_amt.Text = "0.00";
                siroundoffamt.Text = "0.00";
                sigrossamt.Text = "0.00";
                si_frieght_amt.ReadOnly = true;
                si_packing_amt.ReadOnly = true;
                si_insurance_amt.ReadOnly = true;
                si_other_amt.ReadOnly = true;
            }
        }

        private void sidocno_TextChanged(object sender, EventArgs e)
        {
            if (ConnectionWithAccess.company_details[31] == "1")
            {
                cb_print_Tpt_copy.Visible = true;
                cb_print_chit_copy.Visible = true;
            }
            oldsaleinvoicedetails();
            sale_invoice_item_filling();
            sicity.Enabled = false;
            set_invoice_date(21, sidocno.Text, Convert.ToInt32(sidbc.Text));
        }

        private void pidocno_TextChanged(object sender, EventArgs e)
        {
            if (pidocno.Text != "")
            {
                oldpurcinvoicedetails();
                populate_screen();
                pipartycode.Enabled = false;
                picity.Enabled = false;
            }
        }

        private void load_bank_names()
        {
            if (bankname != null)
            {
                //ConnectionWithAccess.mtextfilename = ConnectionWithAccess.data_drive + "visual studio\\projects\\sharp\\bank_list.txt";
                ConnectionWithAccess.mtextfilename = ConnectionWithAccess.setup_drive + "sharp\\bank_list.txt";
                if (File.Exists(ConnectionWithAccess.mtextfilename))
                {
                    temporary_array = File.ReadAllLines(ConnectionWithAccess.mtextfilename);
                    for (int i = 0; i < temporary_array.Length; i++)
                    {
                        bankname.Items.Add(temporary_array[i]);
                    }
                }
                else
                    MessageBox.Show("Bank List File Not Found");
            }
        }

        private void save_bank_details()
        {
            if (maintab.SelectedIndex == 2 && subtabMasters.SelectedIndex == 0)
            {
                isRecord = 0;
                ConnectionWithAccess.query = "select 1 from " + ConnectionWithAccess.tablename[27] + " where a_n = '" + tbA_N.Text + "' and s_a = '" + tbS_A.Text + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    isRecord = 1;
                }
                if (isRecord == 1)
                    ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[27] + " set bankname = '" + bankname.Text + "', bankaddress = '" + BANKADDRESS.Text + "', bankcity = '" + BANKCITY.Text + "', bankaccno = '" + BANKACCNUMBER.Text + "' , bankneft = '" + BANKNEFTIFSC.Text + "' where a_n = '" + tbA_N.Text + "' and s_a = '" + tbS_A.Text + "'";
                else
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[27] + " (a_n,s_a,bankname,bankaddress,bankcity,bankaccno,bankneft) values('" + tbA_N.Text + "','" + tbS_A.Text + "','" + bankname.Text + "','" + BANKADDRESS.Text + "','" + BANKCITY.Text + "','" + BANKACCNUMBER.Text + "' ,'" + BANKNEFTIFSC.Text + "')";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
        }

        private void get_bank_details()
        {
            if (maintab.SelectedIndex == 2 && subtabMasters.SelectedIndex == 0)
            {
                ConnectionWithAccess.query = "select a_n,s_a,bankname,bankaddress,bankcity,bankaccno,bankneft from " + ConnectionWithAccess.tablename[27] + " where a_n = '" + tbA_N.Text + "' and s_a = '" + tbS_A.Text + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();

                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        bankname.Text = dtData1.Rows[0][2].ToString();
                        BANKADDRESS.Text = dtData1.Rows[0][3].ToString();
                        BANKCITY.Text = dtData1.Rows[0][4].ToString();
                        BANKACCNUMBER.Text = dtData1.Rows[0][5].ToString();
                        BANKNEFTIFSC.Text = dtData1.Rows[0][6].ToString();
                        if (BANKACCNUMBER.Text.Contains("."))
                            BANKACCNUMBER.Text = BANKACCNUMBER.Text.Replace(".", "");
                    }
                    if (bankname.Text == "")
                    {
                        get_account_details_from_04(tbA_N.Text, tbS_A.Text);
                        bankname.Text = account_detail_from_04[9];
                        if (bankname.Text != "")
                            save_bank_details();
                    }
                }
            }
        }

        private void blstgp_per_TextChanged(object sender, EventArgs e)
        {
            if (blstgp_per.Text != "")
            {
                try
                {
                    if (blstgp_per.Text != "-")
                    {
                        ConnectionWithAccess.gp_percent = Convert.ToDouble(blstgp_per.Text);
                        //if (cb_emerg_full_period.Checked = false && gp_percentage_change == true)
                        if (maintab.SelectedIndex == 3 && gp_percentage_change == true)
                            calculate_gross_profit_using_gp_per(cbBalShPer.Text);
                    }
                }
                catch (Exception ex)
                { }
            }
        }

        private void srdbc_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 1)
            {
                ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[30] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + Convert.ToInt32(srdbc.Text);
                //DataTable dtData1 = ConnectionCommand.fGetDataTable();
                //if (dtData1 != null && dtData1.Rows.Count > 0)
                //{
                //    int mcolumncount = dtData1.Columns.Count;
                //    for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                //    {
                //        for (int i = 0; i <= mcolumncount - 1; i++)
                //        {
                //            srdocno.Text = (Convert.ToInt32(dtData1.Rows[iRowCount][0].ToString()) + 1).ToString();
                //        }
                //    }
                //}
                //else
                //    srdocno.Text = "1";
                ConnectionCommand.ExportToText(srdbc, srdocno);
                ConnectionWithAccess.md_n = srdocno.Text;
                sra_n.Text = get_a_n_from_d_c("R", Convert.ToInt32(srdbc.Text));
                //ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[30] + " where d_c = " + Convert.ToInt32(srdbc.Text) + " and d_n = 999999";
                //DataTable dtData1 = ConnectionCommand.fGetDataTable();

                //if (dtData1 != null && dtData1.Rows.Count > 0)
                //{
                //    if (dtData1.Rows[0][0] != null)
                //    {
                //        sra_n.Text = dtData1.Rows[0][0].ToString();
                //    }
                //}
                set_invoice_date(30, srdocno.Text, Convert.ToInt32(srdbc.Text));
                if (srdatetime.Value <= Convert.ToDateTime(ConnectionWithAccess.medate))
                {
                    if (srdatetime.Value <= DateTime.Now)
                    {
                        if (srdatetime.MinDate <= DateTime.Now)
                        {
                            srdatetime.MaxDate = DateTime.Today;
                            srdatetime.Value = DateTime.Today;
                        }
                    }
                }
                refresh_data_entry_sale_for_new_record();
                srsalelistdg.DataSource = null;
                fillsrreplamentlist();
                //ConnectionWithAccess.query = "select type, item_code, title, packing, box, qty,price, amount, cat from " + ConnectionWithAccess.tablename[03] + " where prd= '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(srdbc.Text) + " and d_n  " + (srdocno.Text.Trim() == string.Empty ? "is null" : "= " + srdocno.Text.Trim()) + "";
                //ConnectionCommand.accountHelp_datatable_Seperate(sritemlist, "sritemlist");
            }
        }

        private void srdocno_TextChanged(object sender, EventArgs e)
        {
            if (ConnectionWithAccess.company_details[31] == "1")
            {
                cb_print_Tpt_copy.Visible = true;
                cb_print_chit_copy.Visible = true;
            }
            oldsalereplacementdetails();
            sale_replacement_item_filling();
            srpartybalance.Text = Convert.ToString(calculate_account_balance(sra_n.Text, srs_a.Text, Convert.ToString(srdatetime.Text)));
        }

        private void srpartycode_TextChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Replacement";
            if (!bsrPartyChangeIgnore && sr_party_help.Visible == true)
            {
                ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[30] + " where d_c = " + Convert.ToInt32(srdbc.Text) + " and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[30] + " where d_c = " + Convert.ToInt32(srdbc.Text) + " and d_n = 999999) and s_a <> '@@@' and [desc] like '%" + srpartycode.Text + "%'";
                ConnectionCommand.accountHelp_datatable(sr_party_help, "sr_party_help");
                if (sr_party_help.Rows.Count == 1)
                {
                    ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[30] + " where d_c = " + Convert.ToInt32(srdbc.Text) + " and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[30] + " where d_c = " + Convert.ToInt32(srdbc.Text) + " and d_n = 999999) and s_a <> '@@@' and [city] like '%" + srpartycode.Text + "%'";
                    ConnectionCommand.accountHelp_datatable(sr_party_help, "sr_party_help");
                    if (sr_party_help.Rows.Count == 1)
                    {
                        if (srpartycode.Text.Length > 1)
                            srpartycode.Text = srpartycode.Text.Substring(0, srpartycode.Text.Length - 1);
                        srpartycode.SelectionStart = srpartycode.Text.Length;
                    }
                }
            }
        }

        private void srpartycode_KeyPress(object sender, KeyPressEventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Replacement";
            sr_party_help.Visible = true;
        }

        private void fill_tax_d_c()
        {
            if (rb_sale_tax.Checked == true)
            {
                ConnectionWithAccess.query = "select d_c from " + ConnectionWithAccess.tablename[21] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_tax_d_c);
            }
            else
            {
                ConnectionWithAccess.query = "select d_c from " + ConnectionWithAccess.tablename[22] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_tax_d_c);
            }
        }

        private void rb_sale_tax_Click(object sender, EventArgs e)
        {
            rb_sale_tax.Checked = true;
            rb_purchase_tax.Checked = false;
            taxlistmatertab();
        }

        private void rb_purchase_tax_Click(object sender, EventArgs e)
        {
            rb_sale_tax.Checked = false;
            rb_purchase_tax.Checked = true;
            taxlistmatertab();
        }

        private void TaxListDG_Click(object sender, EventArgs e)
        {
            tbTaxCode.Text = Convert.ToString(TaxListDG.SelectedCells[1].Value);
            tbTaxRate.Text = Convert.ToString(TaxListDG.SelectedCells[2].Value);
            tbTaxDesc.Text = Convert.ToString(TaxListDG.SelectedCells[3].Value);
        }

        private void periodgridview_Click(object sender, EventArgs e)
        {
            ConnectionWithAccess.mprd = Convert.ToString(periodgridview.CurrentRow.Cells[0].Value);
            ConnectionWithAccess.msdate = Convert.ToString(periodgridview.CurrentRow.Cells[1].Value);
            ConnectionWithAccess.medate = Convert.ToString(periodgridview.CurrentRow.Cells[2].Value);
            if (DateTime.Today > Convert.ToDateTime(ConnectionWithAccess.msdate))
            {
                if (DateTime.Today <= Convert.ToDateTime(ConnectionWithAccess.medate))
                {
                    ConnectionWithAccess.medate = (DateTime.Today.ToShortDateString()).ToString();
                }
            }
            try
            {
                ConnectionWithAccess.moprd = ConnectionWithAccess.get_old_prd_name(ConnectionWithAccess.mprd);
                ConnectionWithAccess.mnew_prd = ConnectionWithAccess.get_next_prd_name(ConnectionWithAccess.mprd);
                RepFrom.Value = Convert.ToDateTime(ConnectionWithAccess.msdate);
                RepTo.Value = Convert.ToDateTime(ConnectionWithAccess.medate);
            }
            catch (Exception ex)
            { }
            periodgridview.Visible = false;
            load_all_period_values();
            ToolStripStatusPeriod.Text = ConnectionWithAccess.mprd.ToString() + "  " + ConnectionWithAccess.msdate + "  To  " + ConnectionWithAccess.medate.ToString();
        }

        private void cb_all_sale_item_list_CheckedChanged(object sender, EventArgs e)
        {
            if (cb_all_sale_item_list.Checked == true)
            {
                cb_all_sale_invoice_list.Checked = false;
                cb_all_sale_invoice_ledger.Checked = false;
                fill_all_sale_item_list();
            }
            else
            {
                sale_invoice_dgv.Visible = false;
            }
        }

        private void cb_all_sale_invoice_list_CheckedChanged(object sender, EventArgs e)
        {
            if (cb_all_sale_invoice_list.Checked == true)
            {
                cb_all_sale_item_list.Checked = false;
                cb_all_sale_invoice_ledger.Checked = false;
                fill_all_sale_invoice_list();
            }
            else
            {
                sale_invoice_dgv.Visible = false;
            }
        }

        private void fill_sale_invoice_dg()
        {
            if (sia_n.Text != "" && sis_a.Text != "")
            {
                if (cb_all_sale_item_list.Checked == true)
                {
                    fill_all_sale_item_list();
                }
                else if (cb_all_sale_invoice_list.Checked == true)
                {
                    fill_all_sale_invoice_list();
                }
                else if (cb_all_sale_invoice_ledger.Checked == true)
                {
                    fill_all_sale_invoice_ledger();
                }
            }
        }

        private void fill_all_sale_item_list()
        {
            sale_invoice_dgv.Visible = true;
            sale_invoice_dgv.Rows.Clear();
            ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N,f5.title,f3.qty,f3.price,f3.amount from " + ConnectionWithAccess.tablename[1] + " f1, " + ConnectionWithAccess.tablename[3] + " f3, " + ConnectionWithAccess.tablename[5] + " f5, " + ConnectionWithAccess.tablename[21] + " f21 where f1.a_n = f21.a_n and f1.s_a = f21.s_a  and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_c = " + Convert.ToInt32(sidbc.Text) + " and f3.prd = f21.prd and f3.d_c = f21.d_c and f3.d_n = f21.d_n and f21.a_n = '" + sia_n.Text + "' and f21.s_a = '" + sis_a.Text + "' and f3.item_code = f5.item_code order by f21.d_n desc";
            ConnectionCommand.accountHelp_datatable(sale_invoice_dgv, "sale_invoice_dgv");
            sale_invoice_dgv.Columns[0].HeaderText = "Date";
            sale_invoice_dgv.Columns[1].HeaderText = "Inv.num";
            sale_invoice_dgv.Columns[2].HeaderText = "Title";
            sale_invoice_dgv.Columns[3].HeaderText = "Quantity";
            sale_invoice_dgv.Columns[4].HeaderText = "Price";
            sale_invoice_dgv.Columns[5].HeaderText = "Amount";
            sale_invoice_dgv.Columns[0].Width = 75;
            sale_invoice_dgv.Columns[1].Width = 60;
            sale_invoice_dgv.Columns[2].Width = 280;
            sale_invoice_dgv.Columns[3].Width = 90;
            sale_invoice_dgv.Columns[4].Width = 90;
            sale_invoice_dgv.Columns[5].Width = 120;
            sale_invoice_dgv.Columns[0].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            sale_invoice_dgv.Columns[1].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            sale_invoice_dgv.Columns[2].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleLeft;
            sale_invoice_dgv.Columns[3].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            sale_invoice_dgv.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            sale_invoice_dgv.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            if (sale_invoice_dgv.Rows.Count <= 1)
            {
                ConnectionWithAccess.mDateTime = Convert.ToDateTime(ConnectionWithAccess.msdate);
            }
        }

        private void fill_all_sale_invoice_list()
        {
            sale_invoice_dgv.Visible = true;
            sale_invoice_dgv.Rows.Clear();
            ConnectionWithAccess.query = "select distinct f21.D_D, f21.D_N, f21.bamt, f21.tamt, f21.gamt from " + ConnectionWithAccess.tablename[1] + " f1, " + ConnectionWithAccess.tablename[21] + " f21 where f21.a_n = f1.a_n and f1.s_a = f21.s_a  and f21.prd = '" + ConnectionWithAccess.mprd + "' and f21.d_c = " + Convert.ToInt32(sidbc.Text) + " and f21.a_n = '" + sia_n.Text + "' and f21.s_a = '" + sis_a.Text + "' order by f21.d_n desc";
            ConnectionCommand.accountHelp_datatable(sale_invoice_dgv, "sale_invoice_dgv");
            sale_invoice_dgv.Columns[0].HeaderText = "Date";
            sale_invoice_dgv.Columns[1].HeaderText = "Inv.num";
            sale_invoice_dgv.Columns[2].HeaderText = "Basic";
            sale_invoice_dgv.Columns[3].HeaderText = "Tax";
            sale_invoice_dgv.Columns[4].HeaderText = "Gross";
            sale_invoice_dgv.Columns[0].Width = 75;
            sale_invoice_dgv.Columns[1].Width = 60;
            sale_invoice_dgv.Columns[2].Width = 120;
            sale_invoice_dgv.Columns[3].Width = 120;
            sale_invoice_dgv.Columns[4].Width = 120;
            sale_invoice_dgv.Columns[0].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            sale_invoice_dgv.Columns[1].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            sale_invoice_dgv.Columns[2].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            sale_invoice_dgv.Columns[3].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            sale_invoice_dgv.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            //getTotal(sale_invoice_dgv, 2);
            //getTotal(sale_invoice_dgv, 3);
            //getTotal(sale_invoice_dgv, 4);
            if (sale_invoice_dgv.Rows.Count <= 1)
            {
                ConnectionWithAccess.mDateTime = Convert.ToDateTime(ConnectionWithAccess.msdate);
            }
        }

        private void fill_all_sale_invoice_ledger()
        {
            //sale_invoice_dgv.Visible = true;
            //sale_invoice_dgv.Rows.Clear();
            //sale_invoice_dgv.Columns[0].HeaderText = "DATE SORT";
            //sale_invoice_dgv.Columns[1].HeaderText = "A_N";
            //sale_invoice_dgv.Columns[2].HeaderText = "S_A";
            //sale_invoice_dgv.Columns[3].HeaderText = "Date";
            //sale_invoice_dgv.Columns[4].HeaderText = "Document";
            //sale_invoice_dgv.Columns[5].HeaderText = "Type";
            //sale_invoice_dgv.Columns[6].HeaderText = "Debit";
            //sale_invoice_dgv.Columns[7].HeaderText = "Credit";
            //sale_invoice_dgv.Columns[8].HeaderText = "Balance";
            //sale_invoice_dgv.Columns[0].Width = 75;
            //sale_invoice_dgv.Columns[1].Width = 60;
            //sale_invoice_dgv.Columns[2].Width = 60;
            //sale_invoice_dgv.Columns[3].Width = 75;
            //sale_invoice_dgv.Columns[4].Width = 75;
            //sale_invoice_dgv.Columns[5].Width = 15;
            //sale_invoice_dgv.Columns[6].Width = 120;
            //sale_invoice_dgv.Columns[7].Width = 120;
            //sale_invoice_dgv.Columns[8].Width = 120;
            //if (sale_invoice_dgv.Columns.Count > 1)
            //{
            //    if (sale_invoice_dgv.Rows.Count > 0)
            //    {
            //        update_gridview_balances(sale_invoice_dgv, 6, 7, 8);
            //        //getTotal(sale_invoice_dgv, 6);
            //        //getTotal(sale_invoice_dgv, 7);
            //    }
            //}
        }

        private void cb_all_sale_invoice_ledger_CheckedChanged(object sender, EventArgs e)
        {
            if (cb_all_sale_invoice_ledger.Checked == true)
            {
                cb_all_sale_invoice_list.Checked = false;
                cb_all_sale_item_list.Checked = false;
                fill_all_sale_invoice_ledger();
            }
            else
            {
                sale_invoice_dgv.Visible = false;
            }
        }

        private void pb_change_period_Click(object sender, EventArgs e)
        {
            disable_all_keys();
            dgv_period.Visible = true;
            dgv_period.EditMode = DataGridViewEditMode.EditProgrammatically;
            periodgridview.Visible = true;
            ConnectionWithAccess.query = "select prd, start, [end] from " + ConnectionWithAccess.tablename[50] + " order by prd desc";
            ConnectionCommand.accountHelp_datatable(dgv_period, "dgv_period");
            dgv_period.Columns[0].HeaderText = "Prd";
            dgv_period.Columns[1].HeaderText = "Start";
            dgv_period.Columns[2].HeaderText = "End";
            dgv_period.Columns[0].Width = 30;
            dgv_period.Columns[1].Width = 75;
            dgv_period.Columns[2].Width = 75;
            dgv_period.Focus();
        }

        private void dgv_period_Click(object sender, EventArgs e)
        {
            ConnectionWithAccess.mprd = Convert.ToString(dgv_period.CurrentRow.Cells[0].Value);
            ConnectionWithAccess.msdate = Convert.ToString(dgv_period.CurrentRow.Cells[1].Value);
            ConnectionWithAccess.medate = Convert.ToString(dgv_period.CurrentRow.Cells[2].Value);
            if (DateTime.Today > Convert.ToDateTime(ConnectionWithAccess.msdate))
            {
                if (DateTime.Today <= Convert.ToDateTime(ConnectionWithAccess.medate))
                {
                    ConnectionWithAccess.medate = (DateTime.Today.ToShortDateString()).ToString();
                }
            }
            try
            {
                RepFrom.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date).Date;
                RepFrom.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date).Date;
                RepTo.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date).Date;
                RepTo.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date).Date;

                ConnectionWithAccess.moprd = ConnectionWithAccess.get_old_prd_name(ConnectionWithAccess.mprd);
                ConnectionWithAccess.mnew_prd = ConnectionWithAccess.get_next_prd_name(ConnectionWithAccess.mprd);
                RepFrom.Value = Convert.ToDateTime(ConnectionWithAccess.msdate).Date;
                RepTo.Value = Convert.ToDateTime(ConnectionWithAccess.medate).Date;
            }
            catch (Exception ex)
            { }
            dgv_period.Visible = false;
            load_all_period_values();
            load_necessary_values();
            ToolStripStatusPeriod.Text = ConnectionWithAccess.mprd.ToString() + "  " + ConnectionWithAccess.msdate + "  To  " + ConnectionWithAccess.medate.ToString();
            text_to_display_on_top = ConnectionWithAccess.company_details[1] + " " + version + "ver                                                              " + ToolStripStatusPeriod.Text;
            this.Text = text_to_display_on_top;
            enable_all_keys();
            getdaybookcode();
            atbnew_Click(sender, e);
            fSetDateRangeOnPeriodChange();
        }

        private void additional_accounts_process()
        {
            cb_additional_a_n.Items.Clear();
            cb_additional_a_n.Enabled = true;
            if (additional_account.SelectedItem.Equals("BANK ACCOUNT"))
            {
                ConnectionWithAccess.fix_account_a_n = "2011";
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[23] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_master_d_c);
                if (cb_master_d_c.Items.Count == 1)
                {
                    cb_master_d_c.Enabled = false;
                    cb_master_d_c.SelectedIndex = 0;
                }
                get_a_n_from_d_c("B", Convert.ToInt32(cb_master_d_c.Text));
            }
            else if (additional_account.SelectedItem.Equals("OLD CAPITAL ACCOUNT"))
                ConnectionWithAccess.fix_account_a_n = "3000";
            else if (additional_account.SelectedItem.Equals("CAPITAL ACCOUNT"))
                ConnectionWithAccess.fix_account_a_n = "3001";
            else if (additional_account.SelectedItem.Equals("CASH IN HAND"))
            {
                ConnectionWithAccess.fix_account_a_n = "2010";
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[24] + " where d_n = 999999";
                ConnectionCommand.retrieval(cb_master_d_c);
                if (cb_master_d_c.Items.Count == 1)
                {
                    cb_master_d_c.Enabled = false;
                    cb_master_d_c.SelectedIndex = 0;
                }
                get_a_n_from_d_c("C", Convert.ToInt32(cb_master_d_c.Text));
            }
            else if (additional_account.SelectedItem.Equals("DIRECT EXPENSES(TRADING)"))
            {
                ConnectionWithAccess.fix_account_a_n = "70";
            }
            else if (additional_account.SelectedItem.Equals("DIRECT INCOMES(TRADING)"))
            {
                ConnectionWithAccess.fix_account_a_n = "70";
            }
            else if (additional_account.SelectedItem.Equals("FIXED ASSETS"))
            {
                ConnectionWithAccess.fix_account_a_n = "1";
            }
            else if (additional_account.SelectedItem.Equals("INDIRECT EXPENSES(P&L)") || additional_account.SelectedItem.Equals("INDIRECT INCOMES(P&L)"))
            {
                ConnectionWithAccess.fix_account_a_n = "75";
            }
            else if (additional_account.SelectedItem.Equals("LOAN GIVEN"))
            {
                ConnectionWithAccess.fix_account_a_n = "3501";
            }
            else if (additional_account.SelectedItem.Equals("LOAN RECEIVED"))
            {
                ConnectionWithAccess.fix_account_a_n = "3500";
            }
            else if (additional_account.SelectedItem.Equals("SUNDRY CREDITORS"))
            {
                ConnectionWithAccess.fix_account_a_n = "4002";
                ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[01] + " where a_n like '" + ConnectionWithAccess.fix_account_a_n + "%' and s_a ='@@@'";
                ConnectionCommand.retrieval(cb_additional_a_n);
                if (ConnectionWithAccess.fix_account_a_n == "")
                    cb_additional_a_n.Items.Add(ConnectionWithAccess.fix_account_a_n);
                if (cb_additional_a_n.Items.Count > 0)
                    cb_additional_a_n.SelectedIndex = 0;
                if (cb_additional_a_n.Items.Count == 1)
                    cb_additional_a_n.Enabled = false;
                get_account_details_from_01(cb_additional_a_n.Text, "@@@");
            }
            else if (additional_account.SelectedItem.Equals("SUNDRY DEBTORS"))
            {
                ConnectionWithAccess.fix_account_a_n = "2002";
                ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[01] + " where a_n like '" + ConnectionWithAccess.fix_account_a_n + "%' and s_a ='@@@'";
                ConnectionCommand.retrieval(cb_additional_a_n);
                if (ConnectionWithAccess.fix_account_a_n == "")
                    cb_additional_a_n.Items.Add(ConnectionWithAccess.fix_account_a_n);
                if (cb_additional_a_n.Items.Count > 0)
                    cb_additional_a_n.SelectedIndex = 0;
                if (cb_additional_a_n.Items.Count == 1)
                    cb_additional_a_n.Enabled = false;
                get_account_details_from_01(cb_additional_a_n.Text, "@@@");
            }
            //tb_additional_desc.Text = ConnectionWithAccess.accountname;
        }

        private void additional_account_SelectedIndexChanged(object sender, EventArgs e)
        {
            additional_accounts_process();
        }

        private void save_additional_account()
        {
            isRecord = 0;
            ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + cb_additional_a_n.Text + "' and [DESC] = '" + tb_additional_desc.Text + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                isRecord = 1;
            }

            if (isRecord == 0)
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[01] + " (a_n, s_a,d_y, [desc], city,pin) values('" + cb_additional_a_n.Text + "', '' , '' , '" + tb_additional_desc.Text + "', '" + tb_additional_city.Text + "', " + Convert.ToInt32(tb_additional_pincode.Text) + ")";
            else
                ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[01] + " set city = '" + tb_additional_city.Text + "', pin = " + tb_additional_pincode.Text + " where a_n = '" + cb_additional_a_n.Text + "' and [DESC] = '" + tb_additional_desc.Text + "' and city = '" + tb_additional_city.Text + "'";
            ConnectionCommand.fUpdateInsertDeleteData();
            isRecord = 0;
            ConnectionWithAccess.query = "select 1 from " + ConnectionWithAccess.tablename[04] + " where a_n = '" + cb_additional_a_n.Text + "' and s_a ='@@@'";
            dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                isRecord = 1;
            }

            if (isRecord == 0)
            {
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[4] + " (A_n, s_a,d_y,city,add1,add2,add3) values('" + cb_additional_a_n.Text + "', '', '', '" + tb_additional_city.Text + "', '" + tb_additional_add1.Text + "' , '" + tb_additional_add2.Text + "' , '" + tb_additional_add3.Text + "')";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
            else
            {
                ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[4] + " set city  = '" + tb_additional_city.Text + "', add1 = '" + tb_additional_add1.Text + "', add2 = '" + tb_additional_add2.Text + "', add3 = '" + tb_additional_add3.Text + "' where a_n = '" + cb_additional_a_n.Text + "' and s_a ='@@@'";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
        }

        private void cb_additional_a_n_SelectedIndexChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.query = "select [desc],city,pin from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + cb_additional_a_n.Text + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    tb_additional_desc.Text = dtData1.Rows[0][0].ToString();
                    tb_additional_city.Text = dtData1.Rows[0][1].ToString();
                    tb_additional_pincode.Text = dtData1.Rows[0][2].ToString();
                }
            }
            ConnectionWithAccess.query = "select add1,add2,add3 from " + ConnectionWithAccess.tablename[04] + " where a_n = '" + cb_additional_a_n.Text + "' and s_a ='@@@'";
            dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    tb_additional_add1.Text = dtData1.Rows[0][0].ToString();
                    tb_additional_add2.Text = dtData1.Rows[0][1].ToString();
                    tb_additional_add3.Text = dtData1.Rows[0][2].ToString();
                }
                else
                {
                    tb_additional_add1.Clear();
                    tb_additional_add2.Clear();
                    tb_additional_add3.Clear();
                }
            }
        }

        private void ToolStripMenuItem4_Click(object sender, EventArgs e)
        {
            atbsave_Click(sender, e);
        }

        private void cb_transfer_account_SelectedIndexChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.query = "select [desc],city,pin from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + cb_transfer_account.Text + "' and s_a ='@@@'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();

            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    tb_transfer_desc.Text = dtData1.Rows[0][0].ToString();
                    tb_transfer_city.Text = dtData1.Rows[0][1].ToString();
                }
            }
        }

        private void cb_tax_d_c_SelectedIndexChanged(object sender, EventArgs e)
        {
            TaxListDG.Rows.Clear();
            ConnectionWithAccess.query = "select d_c,tx_code,tax_rate, [desc],a_n from " + ConnectionWithAccess.tablename[06] + " where d_c = " + cb_tax_d_c.Text + " order by tx_code";
            ConnectionCommand.accountHelp(TaxListDG, "TaxListDG");
        }

        private void DBCListDG_Click(object sender, EventArgs e)
        {
            tbDBC.Text = Convert.ToString(DBCListDG.CurrentRow.Cells[0].Value);
            cb_transfer_account.Text = Convert.ToString(DBCListDG.CurrentRow.Cells[1].Value);
        }

        bool bsrPartyChangeIgnore = false;

        private void sritemlist_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
        {
            if (!issrTxtChangedAssigned)
            {
                ConnectionWithAccess.data_entry_working = "Sale Item";
                //e.Control.TextChanged += new EventHandler(textBox_TextChanged);
                cntObject = e.Control;
                cntObject.TextChanged += textBox_TextChanged;
                issrTxtChangedAssigned = true;
            }
        }

        private void sritemlist_SelectionChanged(object sender, EventArgs e)
        {
            if (sritemlist.CurrentCell != null)
            {
                ConnectionWithAccess.data_entry_working = "Sale Replacement Item";
                if (Control.ModifierKeys == Keys.Down)
                {
                    mRowIndex = sritemlist.SelectedCells[0].RowIndex;
                    mtype = Convert.ToString(sritemlist.Rows[mRowIndex].Cells[0].Value);
                    mitem_code = Convert.ToString(sritemlist.Rows[mRowIndex].Cells[1].Value);
                    mtitle = Convert.ToString(sritemlist.Rows[mRowIndex].Cells[2].Value);
                }
                else
                {
                    columnIndex = sritemlist.CurrentCell.ColumnIndex;
                    if (columnIndex == 2)
                    {

                    }
                    else if (columnIndex == 3)
                    {
                        mtype = Convert.ToString(sritemlist.Rows[sritemlistrowindex].Cells[0].Value);
                        mitem_code = Convert.ToString(sritemlist.Rows[sritemlistrowindex].Cells[1].Value);
                        mtitle = Convert.ToString(sritemlist.Rows[mRowIndex].Cells[2].Value);
                        ConnectionWithAccess.query = "select packing, box from " + ConnectionWithAccess.tablename[05] + " where [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
                        DataTable dtData1 = ConnectionCommand.fGetDataTable();
                        if (dtData1 != null && dtData1.Rows.Count > 0)
                        {
                            if (dtData1.Rows[0][0] != null)
                            {
                                mbox = Convert.ToDouble(dtData1.Rows[0][0].ToString());
                                mqty = Convert.ToDouble(dtData1.Rows[0][1].ToString());
                            }
                        }
                        temp_word = Convert.ToString(sritemlist.Rows[sritemlistrowindex].Cells[3].Value);
                        if (temp_word != "")
                        {
                            mcase = Convert.ToDouble(sritemlist.Rows[sritemlistrowindex].Cells[3].Value);
                            sritemlist.Rows[sritemlistrowindex].Cells[4].Value = mbox * mcase;
                            temp_word = Convert.ToString(sritemlist.Rows[sritemlistrowindex].Cells[4].Value);
                            //if (temp_word != "")
                            //    sritemlist.Rows[sritemlistrowindex].Cells[5].Value = (Convert.ToDouble(sritemlist.Rows[sritemlistrowindex].Cells[4].Value)) * mqty;
                            temp_word = Convert.ToString(sritemlist.Rows[sritemlistrowindex].Cells[5].Value);
                        }
                        calculateSalereplaceItemTotal();
                        show_images();
                    }
                    if (columnIndex == 4)
                    {
                        mtype = Convert.ToString(sritemlist.Rows[mRowIndex].Cells[0].Value);
                        mitem_code = Convert.ToString(sritemlist.Rows[mRowIndex].Cells[1].Value);
                        get_item_details_from_05_using_type_item_code(mtype, mitem_code);
                        temp_word = Convert.ToString(sritemlist.Rows[sritemlistrowindex].Cells[4].Value);
                        //if (temp_word != "")
                        //    sritemlist.Rows[sritemlistrowindex].Cells[5].Value = (Convert.ToDouble(sritemlist.Rows[sritemlistrowindex].Cells[4].Value)) * Convert.ToDouble(item_details_from_05[4].ToString());
                        //else
                        //    sritemlist.Rows[sritemlistrowindex].Cells[5].Value = "0";
                        if (sritemlist.Rows[sritemlistrowindex].Cells[5].Value != System.DBNull.Value)
                            mqty = Convert.ToDouble(sritemlist.Rows[sritemlistrowindex].Cells[5].Value);
                        mamount = mcase * mbox * mqty * mprice;
                        sritemlist.Rows[sritemlistrowindex].Cells[7].Value = Convert.ToString(mamount);
                        calculateSalereplaceItemTotal();
                        show_images();
                    }
                    if (columnIndex == 5 || columnIndex == 6)
                    {
                        try
                        {
                            //mqty = Convert.ToDouble(sritemlist.Rows[sritemlistrowindex].Cells[5].Value);
                            //update_item_stock_in_o5_using_type_item_code(mtype, mitem_code, mqty);
                            mtype = Convert.ToString(sritemlist.Rows[mRowIndex].Cells[0].Value);
                            mitem_code = Convert.ToString(sritemlist.Rows[mRowIndex].Cells[1].Value);
                            mqty = Convert.ToDouble(sritemlist.Rows[sritemlistrowindex].Cells[5].Value);
                            //sritemlist.Rows[sritemlistrowindex].Cells[5].Value = mbox * mqty;
                            mamount = mcase * mbox * mqty * mprice;
                            sritemlist.Rows[sritemlistrowindex].Cells[7].Value = Convert.ToString(mamount);
                        }
                        catch (Exception ex)
                        {
                        }
                        calculateSalereplaceItemTotal();
                        show_images();
                    }
                }
            }
        }

        private void sr_item_help_Click(object sender, EventArgs e)
        {
            sritemlistrowindex = sritemlist.CurrentCell.RowIndex;
            mtype = Convert.ToString(sr_item_help.CurrentRow.Cells[0].Value);
            mitem_code = Convert.ToString(sr_item_help.CurrentRow.Cells[1].Value);
            mtitle = Convert.ToString(sr_item_help.CurrentRow.Cells[2].Value);
            ConnectionWithAccess.query = "select [type], item_code, [title],price,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where a_n = '" + sra_n.Text + "' and s_a = '" + srs_a.Text + "' and [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    sritemlist.Rows[sritemlistrowindex].Cells[2].Value = dtData1.Rows[0][0].ToString();
                    sritemlist.Rows[sritemlistrowindex].Cells[3].Value = dtData1.Rows[0][1].ToString();
                    sritemlist.Rows[sritemlistrowindex].Cells[4].Value = dtData1.Rows[0][2].ToString();
                    sritemlist.Rows[sritemlistrowindex].Cells[6].Value = dtData1.Rows[0][3].ToString();
                }
            }
            ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
            dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    temp_word = dtData1.Rows[0][0].ToString();
                    sritemlist.Rows[sritemlistrowindex].Cells[0].Value = dtData1.Rows[0][0].ToString();
                    sritemlist.Rows[sritemlistrowindex].Cells[1].Value = dtData1.Rows[0][1].ToString();
                    sritemlist.Rows[sritemlistrowindex].Cells[2].Value = dtData1.Rows[0][2].ToString();
                    mcase = 1;
                    mbox = Convert.ToDouble(dtData1.Rows[0][3].ToString());
                    mqty = Convert.ToDouble(dtData1.Rows[0][4].ToString());
                    mprice = Convert.ToDouble(dtData1.Rows[0][5].ToString());
                    sritemlist.Rows[sritemlistrowindex].Cells[3].Value = mcase;
                    sritemlist.Rows[sritemlistrowindex].Cells[4].Value = Convert.ToDouble(dtData1.Rows[0][3].ToString());
                    //sritemlist.Rows[sritemlistrowindex].Cells[5].Value = Convert.ToDouble(dtData1.Rows[0][3].ToString()) * Convert.ToDouble(dtData1.Rows[0][4].ToString());
                    if (sritemlist.Rows[sritemlistrowindex].Cells[6].Value == null)
                        sritemlist.Rows[sritemlistrowindex].Cells[6].Value = mprice;
                    else
                        Double.TryParse(sritemlist.Rows[sritemlistrowindex].Cells[6].Value.ToString(), out mprice);
                    //mprice = Convert.ToDouble(sritemlist.Rows[sritemlistrowindex].Cells[6].Value);
                    mamount = mcase * mbox * mqty * mprice;
                    sritemlist.Rows[sritemlistrowindex].Cells[7].Value = Convert.ToString(mamount);
                    int totalrowcount = sritemlist.Rows.Count;
                    sale_replace_amount = 0;
                    for (int i = 0; i < totalrowcount; i++)
                    {
                        sale_replace_amount = sale_replace_amount + Convert.ToDouble(sritemlist.Rows[i].Cells[7].Value);
                    }
                    srbasicamt.Enabled = false;
                    srbasicamt.Text = string.Format("{0:0.00}", Convert.ToDouble(sale_replace_amount));
                }
            }
            sr_item_help.Visible = false;
        }

        private void srbasicamt_TextChanged(object sender, EventArgs e)
        {
            if (srbasicamt.Text != "")
            {
                srgrossamt.Text = Convert.ToString(Convert.ToDouble(srbasicamt.Text) + Convert.ToDouble(srtaxamt.Text));
            }
        }

        private void srsalelistdg_Click(object sender, EventArgs e)
        {
            srdatetime.Value = Convert.ToDateTime(srsalelistdg.SelectedCells[0].Value);
            srdocno.Text = Convert.ToString(srsalelistdg.SelectedCells[1].Value);
            oldsalereplacementdetails();
            //sale_replacement_item_filling();
            srpartycode.Enabled = false;
        }

        private void periodF10ToolStripMenuItem_Click(object sender, EventArgs e)
        {
            pb_change_period_Click(sender, e);
        }

        private void dgv_period_KeyPress(object sender, KeyPressEventArgs e)
        {
            isExists = 0;
            if (char.IsLetter(e.KeyChar))
            {
                DataTable dtPeriod = new DataTable();
                string strQuery = "select prd,[start],[end],gp,[lock] from " + ConnectionWithAccess.tablename[50] + " where prd = '" + e.KeyChar.ToString() + "' ";
                if (ConnectionWithAccess.connection.State == ConnectionState.Open) { ConnectionWithAccess.connection.Close(); }
                ConnectionWithAccess.connection.Open();
                try
                {

                    var adapter = new OleDbDataAdapter(strQuery, ConnectionWithAccess.connection);
                    adapter.Fill(dtPeriod);
                    if (dtPeriod != null && dtPeriod.Rows.Count > 0)
                        isExists = 1;
                }
                catch (Exception ex)
                { }
                if (isExists == 1)
                {
                    tbPrd.Text = Convert.ToString(dtPeriod.Rows[0][0].ToString());
                    dtPrdSD.Text = Convert.ToString(dtPeriod.Rows[0][1]);
                    dtPrdED.Text = Convert.ToString(dtPeriod.Rows[0][2]);
                    tbGP.Text = Convert.ToString(dtPeriod.Rows[0][4]);
                    if (Convert.ToString(dtPeriod.Rows[0][3]) == "Y")
                    {
                        cbprdlock.Checked = true;
                        tbGP.ReadOnly = true;
                    }
                    else
                    {
                        cbprdlock.Checked = false;
                        tbGP.ReadOnly = false;
                    }

                    ConnectionWithAccess.mprd = dtPeriod.Rows[0][0].ToString();// Convert.ToString(dgv_period.CurrentRow.Cells[0].Value);
                    ConnectionWithAccess.msdate = dtPeriod.Rows[0][1].ToString();// Convert.ToString(dgv_period.CurrentRow.Cells[1].Value);
                    ConnectionWithAccess.medate = dtPeriod.Rows[0][2].ToString();// Convert.ToString(dgv_period.CurrentRow.Cells[2].Value);
                    if (ConnectionWithAccess.msdate.Contains(" "))
                        ConnectionWithAccess.msdate = ConnectionWithAccess.msdate.Substring(0, ConnectionWithAccess.msdate.IndexOf(" "));
                    if (ConnectionWithAccess.medate.Contains(" "))
                        ConnectionWithAccess.medate = ConnectionWithAccess.medate.Substring(0, ConnectionWithAccess.medate.IndexOf(" "));
                    if (DateTime.Today > Convert.ToDateTime(ConnectionWithAccess.msdate))
                    {
                        if (DateTime.Today <= Convert.ToDateTime(ConnectionWithAccess.medate))
                        {
                            ConnectionWithAccess.medate = (DateTime.Today.ToShortDateString()).ToString();
                        }
                    }
                    try
                    {
                        RepFrom.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date).Date;
                        RepFrom.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date).Date;
                        RepTo.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date).Date;
                        RepTo.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date).Date;

                        ConnectionWithAccess.moprd = ConnectionWithAccess.get_old_prd_name(ConnectionWithAccess.mprd);
                        ConnectionWithAccess.mnew_prd = ConnectionWithAccess.get_next_prd_name(ConnectionWithAccess.mprd);
                        RepFrom.Value = Convert.ToDateTime(ConnectionWithAccess.msdate);
                        RepTo.Value = Convert.ToDateTime(ConnectionWithAccess.medate);
                    }
                    catch (Exception ex)
                    { }

                    dgv_period.Visible = false;
                    load_all_period_values();
                    load_necessary_values();
                    ToolStripStatusPeriod.Text = ConnectionWithAccess.mprd.ToString() + "  " + ConnectionWithAccess.msdate + "  To  " + ConnectionWithAccess.medate.ToString();
                    text_to_display_on_top = ConnectionWithAccess.company_details[1] + " " + version + "ver                                                              " + ToolStripStatusPeriod.Text;
                    this.Text = text_to_display_on_top;
                    enable_all_keys();
                    getdaybookcode();
                    atbnew_Click(sender, e);
                }
            }
        }

        private void dgv_dataentry_additional_item_Click(object sender, EventArgs e)
        {
            tb_dataentry_stock_item_type.Text = dgv_dataentry_additional_item.CurrentRow.Cells[0].Value.ToString();
            tb_dataentry_stock_item_code.Text = dgv_dataentry_additional_item.CurrentRow.Cells[1].Value.ToString();
            tb_dataentry_stock_item_name.Text = dgv_dataentry_additional_item.CurrentRow.Cells[2].Value.ToString();
            dgv_dataentry_additional_item.Visible = false;
            show_images();
        }

        private void tb_dataentry_stock_item_name_TextChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.query = "select [type], item_code, [title] from " + ConnectionWithAccess.tablename[05] + " where title like '" + tb_dataentry_stock_item_name.Text + "%'";
            ConnectionCommand.accountHelp(dgv_dataentry_additional_item, "dgv_dataentry_additional_item");
            if (dgv_dataentry_additional_item.CurrentRow != null)
            {
                tb_dataentry_stock_item_type.Text = Convert.ToString(dgv_dataentry_additional_item.CurrentRow.Cells[0].Value);
                tb_dataentry_stock_item_code.Text = Convert.ToString(dgv_dataentry_additional_item.CurrentRow.Cells[1].Value);
            }
            else
            {
                tb_dataentry_stock_item_name.Text = null;
                tb_dataentry_stock_item_code.Text = null;
            }
            tb_dataentry_stock_item_date_ValueChanged(sender, e);
        }

        private void tb_dataentry_stock_item_name_KeyPress(object sender, KeyPressEventArgs e)
        {
            dgv_dataentry_additional_item.Visible = true;
        }

        private void tb_dataentry_stock_item_date_ValueChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.query = "select qty from " + ConnectionWithAccess.tablename[57] + " where type = '" + tb_dataentry_stock_item_type.Text + "' and item_code = '" + tb_dataentry_stock_item_code.Text + "' and d_d = #" + tb_dataentry_stock_item_date.Text + "#";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    tb_dataentry_item_stock.Text = dtData1.Rows[0][0].ToString();
                }
                else
                    tb_dataentry_item_stock.Text = "0";
            }
            else
                tb_dataentry_item_stock.Text = "0";
        }

        private void sopartycode_TextChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Order";
            if (!bsoPartyChangeIgnore && so_party_help.Visible == true)
            {
                ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[7] + " where d_c = " + Convert.ToInt32(sodbc.Text) + " and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[7] + " where d_c = " + Convert.ToInt32(sodbc.Text) + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='' or d_y = '@@@') and [desc] like '%" + sopartycode.Text + "%'";
                ConnectionCommand.accountHelp_datatable(so_party_help, "so_party_help");
                if (so_party_help.Rows.Count == 1)
                {
                    ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[7] + " where d_c = " + Convert.ToInt32(sodbc.Text) + " and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[7] + " where d_c = " + Convert.ToInt32(sodbc.Text) + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='' or d_y = '@@@') and [city] like '%" + sopartycode.Text + "%'";
                    ConnectionCommand.accountHelp_datatable(so_party_help, "so_party_help");
                    if (so_party_help.Rows.Count == 1)
                    {
                        sopartycode.Text = sopartycode.Text.Substring(0, sopartycode.Text.Length - 1);
                        sopartycode.SelectionStart = sopartycode.Text.Length;
                    }
                }
            }
        }

        private void sodeliverycode_TextChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + Convert.ToInt32(sodbc.Text) + " and d_n = 999999) and s_a = '" + sos_a.Text + "' and [desc] like '%" + sodeliverycode.Text + "%'";
            ConnectionCommand.accountHelp(sale_order_dgv, "sale_order_dgv");
        }

        private void dgv_soitemhelp_Click(object sender, EventArgs e)
        {
            mtype = Convert.ToString(dgv_soitemhelp.CurrentRow.Cells[0].Value);
            mitem_code = Convert.ToString(dgv_soitemhelp.CurrentRow.Cells[1].Value);
            mtitle = Convert.ToString(dgv_soitemhelp.CurrentRow.Cells[2].Value);
            ConnectionWithAccess.query = "select [type], item_code, [title],price,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where a_n = '" + soa_n.Text + "' and s_a = '" + sos_a.Text + "' and [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    temp_word = dtData1.Rows[0][0].ToString();
                    soitemlist.Rows[soitemlistrowindex].Cells[0].Value = dtData1.Rows[0][0].ToString();
                    soitemlist.Rows[soitemlistrowindex].Cells[1].Value = dtData1.Rows[0][1].ToString();
                    soitemlist.Rows[soitemlistrowindex].Cells[6].Value = dtData1.Rows[0][3].ToString();
                }
            }
            ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
            dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    temp_word = dtData1.Rows[0][0].ToString();
                    soitemlist.Rows[soitemlistrowindex].Cells[0].Value = dtData1.Rows[0][0].ToString();
                    soitemlist.Rows[soitemlistrowindex].Cells[1].Value = dtData1.Rows[0][1].ToString();
                    soitemlist.Rows[soitemlistrowindex].Cells[2].Value = dtData1.Rows[0][2].ToString();
                    mcase = 1;
                    mbox = Convert.ToDouble(dtData1.Rows[0][3].ToString());
                    mqty = Convert.ToDouble(dtData1.Rows[0][4].ToString());
                    mprice = Convert.ToDouble(dtData1.Rows[0][5].ToString());
                    soitemlist.Rows[soitemlistrowindex].Cells[3].Value = mcase;
                    soitemlist.Rows[soitemlistrowindex].Cells[4].Value = mbox * mcase;
                    soitemlist.Rows[soitemlistrowindex].Cells[5].Value = mbox * mqty;
                    if (soitemlist.Rows[soitemlistrowindex].Cells[6].Value == null)
                        soitemlist.Rows[soitemlistrowindex].Cells[6].Value = mprice;
                    else
                        mprice = Convert.ToDouble(soitemlist.Rows[soitemlistrowindex].Cells[6].Value);
                    mamount = mcase * mbox * mqty * mprice;
                    soitemlist.Rows[soitemlistrowindex].Cells[7].Value = Convert.ToString(mamount);
                    soitemlist.Rows[soitemlistrowindex].Cells[8].Value = dtData1.Rows[0][6].ToString();
                    dgv_soitemhelp.Visible = false;
                    int totalrowcount = soitemlist.Rows.Count;
                    sale_order_amount = 0;
                    for (int i = 0; i < totalrowcount; i++)
                    {
                        sale_order_amount = sale_order_amount + Convert.ToDouble(soitemlist.Rows[i].Cells[7].Value);
                    }
                    sobasicamt.Enabled = false;
                    sobasicamt.Text = string.Format("{0:0.00}", Convert.ToDouble(sale_order_amount));
                }
            }
        }

        private void sale_order_dgv_Click(object sender, EventArgs e)
        {
            select_party_for_sale();
            soitemlist.Enabled = true;
            sobasicamt.Enabled = true;
        }

        private void sopartycode_KeyPress(object sender, KeyPressEventArgs e)
        {
            sale_order_dgv.Visible = true;
        }

        private void soitemlist_KeyPress(object sender, KeyPressEventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Item";
            if (e.KeyChar == 27)
            {
                soitemlist.BringToFront();
                dgv_soitemhelp.Visible = false;
            }
            else if (e.KeyChar == 9)
            {
                soitemlist.BringToFront();
                dgv_soitemhelp.Visible = false;
            }
            else if (e.KeyChar == 13)
            {
                soitemlist.BringToFront();
                dgv_soitemhelp.Visible = false;
                get_item_details_from_05_using_type_item_code(mtype, mitem_code);
                soitemlist.SelectedCells[2].Value = item_details_from_05[2];
                soitemlist.SelectedCells[3].Value = 1;
                soitemlist.SelectedCells[4].Value = item_details_from_05[3];
            }
        }

        private void soitemlist_KeyDown(object sender, KeyEventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Item";
            if (e.KeyCode == Keys.Enter)
            {
                mRowIndex = soitemlist.SelectedCells[0].RowIndex;
                ConnectionWithAccess.query = "select type, item_code, title from " + ConnectionWithAccess.tablename[05] + " where (type = '" + mtype + "' and item_code = '" + mitem_code + "') or title = '" + mtitle + "'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        temp_word = dtData1.Rows[0][0].ToString();
                        soitemlist.SelectedCells[0].Value = dtData1.Rows[0][0].ToString();
                        soitemlist.SelectedCells[1].Value = dtData1.Rows[0][1].ToString();
                        soitemlist.SelectedCells[2].Value = dtData1.Rows[0][2].ToString();
                    }
                }
            }
        }

        private void soitemlist_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Item";
            e.Control.TextChanged += new EventHandler(textBox_TextChanged);
            cntObject = e.Control;
            cntObject.TextChanged += textBox_TextChanged;
        }

        private void soitemlist_SelectionChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Item";
            if (Control.ModifierKeys == Keys.Down)
            {
                mRowIndex = soitemlist.SelectedCells[0].RowIndex;
                mtype = Convert.ToString(soitemlist.Rows[mRowIndex].Cells[0].Value);
                mitem_code = Convert.ToString(soitemlist.Rows[mRowIndex].Cells[1].Value);
                mtitle = Convert.ToString(soitemlist.Rows[mRowIndex].Cells[2].Value);
            }
            else
            {
                columnIndex = soitemlist.CurrentCell.ColumnIndex;
                if (columnIndex == 3)
                {
                    mcase = 1;
                    mtype = Convert.ToString(soitemlist.Rows[soitemlistrowindex].Cells[0].Value);
                    mitem_code = Convert.ToString(soitemlist.Rows[soitemlistrowindex].Cells[1].Value);
                    mtitle = Convert.ToString(soitemlist.Rows[soitemlistrowindex].Cells[2].Value);
                    ConnectionWithAccess.query = "select packing, box from " + ConnectionWithAccess.tablename[05] + " where [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        if (dtData1.Rows[0][0] != null)
                        {
                            temp_word = dtData1.Rows[0][0].ToString();
                            mcase = Convert.ToDouble(soitemlist.Rows[soitemlistrowindex].Cells[3].Value);
                            mbox = Convert.ToDouble(dtData1.Rows[0][0].ToString());
                            mqty = Convert.ToDouble(dtData1.Rows[0][1].ToString());
                            soitemlist.Rows[soitemlistrowindex].Cells[4].Value = mbox * mcase;
                            soitemlist.Rows[soitemlistrowindex].Cells[5].Value = (Convert.ToDouble(soitemlist.Rows[soitemlistrowindex].Cells[4].Value)) * mqty;
                            soitemlist.Rows[soitemlistrowindex].Cells[7].Value = (Convert.ToDouble(soitemlist.Rows[soitemlistrowindex].Cells[5].Value)) * (Convert.ToDouble(soitemlist.Rows[soitemlistrowindex].Cells[6].Value));
                            calculateSaleorderItemTotal();
                        }
                    }
                }
                else if (columnIndex == 4)
                {
                    soitemlist.Rows[soitemlistrowindex].Cells[5].Value = (Convert.ToDouble(soitemlist.Rows[soitemlistrowindex].Cells[4].Value)) * mqty;
                    soitemlist.Rows[soitemlistrowindex].Cells[7].Value = (Convert.ToDouble(soitemlist.Rows[soitemlistrowindex].Cells[5].Value)) * (Convert.ToDouble(soitemlist.Rows[soitemlistrowindex].Cells[6].Value));
                    calculateSaleorderItemTotal();
                }
                else if (columnIndex == 5 || columnIndex == 6)
                {
                    mcase = Convert.ToDouble(soitemlist.Rows[soitemlistrowindex].Cells[3].Value);
                    mbox = Convert.ToDouble(soitemlist.Rows[soitemlistrowindex].Cells[4].Value);
                    mqty = Convert.ToDouble(soitemlist.Rows[soitemlistrowindex].Cells[5].Value);
                    mprice = Convert.ToDouble(soitemlist.Rows[soitemlistrowindex].Cells[6].Value);
                    mamount = mqty * mprice;
                    soitemlist.Rows[soitemlistrowindex].Cells[7].Value = Convert.ToString(mamount);
                    calculateSaleorderItemTotal();
                }
            }
            int totalrowcount = soitemlist.Rows.Count;
            sale_order_amount = 0;
            for (int i = 0; i < totalrowcount; i++)
            {
                sale_order_amount = sale_order_amount + Convert.ToDouble(soitemlist.Rows[i].Cells[7].Value);
            }
        }

        private void sobasicamt_TextChanged(object sender, EventArgs e)
        {
            if (sobasicamt.Text != "")
            {
                sotaxamt.Text = Convert.ToString(Convert.ToDouble(sobasicamt.Text) * Convert.ToDouble(sotaxrate.Text) / 100);
                //soroundoffamt.Text = 
                sogrossamt.Text = Convert.ToString(Convert.ToDouble(sobasicamt.Text) + Convert.ToDouble(sotaxamt.Text));
            }
        }

        private void tbUserName_KeyPress(object sender, KeyPressEventArgs e)
        {
            dgv_user_list.Visible = true;
        }

        private void dgv_user_list_Click(object sender, EventArgs e)
        {
            tbUserName.Text = Convert.ToString(dgv_user_list.CurrentRow.Cells[0].Value);
            tbPassword.Text = Convert.ToString(dgv_user_list.CurrentRow.Cells[1].Value);
            readusersettingsfromfiletoMemory(tbUserName.Text, tbPassword.Text);
            changestatusaspermemory();
            dgv_user_list.Visible = false;
        }

        //private void generate_qr_code()
        //{
        //    QRCodeGenerator qrGenerator = new QRCodeGenerator();
        //    QRCodeGenerator.QRCode qrCode = qrGenerator.CreateQrCode(textBoxQRCode.Text, QRCodeGenerator.ECCLevel.Q);
        //    pictureBoxQRCode.BackgroundImage = qrCode.GetGraphic(20);
        //}

        private void cpdbc_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (cpdbc.Text != "")
            {
                refresh_cash_document_number();
                //ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[24] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + cpdbc.Text;
                //ConnectionCommand.ExportToText(cpdbc, cpdocno);
                //dateCheckForcashInvoice();
                get_a_n_from_d_c("C", Convert.ToInt32(cpdbc.Text));
                fillcptranlist();
            }
        }

        private void generate_barcode(string barcode_string)
        {
            //string barcode = sipartycode.Text;
            if (barcode_string.Length > 0)
            {
                Bitmap bitmap = new Bitmap(barcode_string.Length * 40, 150);
                string strBarcodeImage = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\" + "Barcode.png";
                using (Graphics graphics = Graphics.FromImage(bitmap))
                {
                    System.Drawing.Font oFont = new System.Drawing.Font("IDAutomationHC39M Free Version", 20);

                    PointF point = new PointF(2f, 2f);
                    SolidBrush black = new SolidBrush(Color.Black);
                    SolidBrush white = new SolidBrush(Color.White);
                    //graphics.FillRectangle(white, 0, 0, bitmap.Width, bitmap.Height);
                    graphics.FillRectangle(white, 0, 0, 444, 50);
                    //graphics.DrawString("*" + barcode_string + "*", oFont, black, point);
                    graphics.DrawString(barcode_string, oFont, black, point);
                }

                using (MemoryStream ms = new MemoryStream())
                {
                    barcode_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\temp_barcode.png";
                    bitmap.Save(barcode_filename, ImageFormat.Png);
                    //pb_barcode.Visible = true;
                    //pb_barcode.Location = new System.Drawing.Point(930, 4);
                    //pb_barcode.Size = new System.Drawing.Size(444, 50);
                    //pb_barcode.Image = bitmap;
                    ////pb_barcode.Height = bitmap.Height;
                    ////pb_barcode.Width = bitmap.Width;
                }
            }
            else
                pb_barcode.Visible = false;
        }

        private void ToolStripMenuItem6_Click(object sender, EventArgs e)
        {
            atbcancel_Click(sender, e);
        }

        private void btn_cheque_print_Click(object sender, EventArgs e)
        {
            get_account_details_from_01(bpa_n.Text, bps_a.Text);
            get_account_details_from_04(bpa_n.Text, bps_a.Text);
            cheque_pdf = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\cheque_print_" + bpdocno.Text;
            if (chb_add_datetime_in_output.Checked)
                cheque_pdf += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            cheque_pdf += ".pdf";
            doc1 = new Document(PageSize.A4.Rotate(), 50, 50, 50, 50);
            //doc1 = new Document(new Document(100f, 300f));
            FileStream FS1 = File.Create(cheque_pdf);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            invoice_jpg_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\" + "INVOICE.jpg";
            Paragraph para = new Paragraph("");
            para.Font.Size = 25;
            temp_word = bpdatetime.Text;
            print_pdf_line(cour_11_red, temp_word, 600, 100);
            temp_word = account_detail_from_01[04].Trim() + " - " + account_detail_from_01[08].Trim();
            print_pdf_line(cour_11_red, temp_word, 80, -18);
            temp_word = bpamt.Text.Trim() + "/-";
            if (!temp_word.Contains("."))
                temp_word = temp_word + ".00/-";
            print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(600, temp_word, "cour_11"), 18);
            temp_word = bpamt.Text;
            if (temp_word.Contains("."))
                temp_word = temp_word.Substring(0, temp_word.Length - 3);
            temp_word = (NumberToWords(Convert.ToInt32(temp_word))) + " Only";
            print_pdf_line(cour_11, temp_word, 80, 24);
            temp_word = bpdocno.Text;
            print_pdf_line(cour_11, temp_word, 450, 24);
            doc1.Close();
            pdf_invoice.BringToFront();
            pdf_invoice.Visible = true;
            //sisalelistdg.Visible = false;
            //pbdataentry.Visible = false;
            //pdf_invoice.Size = new System.Drawing.Size(1200, 381);
            pdf_invoice.LoadFile(cheque_pdf);
        }

        private void cb_all_purchase_item_list_CheckedChanged(object sender, EventArgs e)
        {
            if (cb_all_purchase_item_list.Checked == true)
            {
                cb_all_purchase_invoice_list.Checked = false;
                cb_all_purchase_invoice_ledger.Checked = false;
                fill_all_purchase_item_list();
            }
            else
            {
                pi_party_help.Visible = false;
            }
        }

        private void fill_purchase_invoice_dg()
        {
            if (pia_n.Text != "" && pis_a.Text != "")
            {
                if (cb_all_purchase_item_list.Checked == true)
                {
                    fill_all_purchase_item_list();
                }
                else if (cb_all_purchase_invoice_list.Checked == true)
                {
                    fill_all_purchase_invoice_list();
                }
                else if (cb_all_purchase_invoice_ledger.Checked == true)
                {
                    fill_all_purchase_invoice_ledger();
                }
            }
        }

        private void fill_all_purchase_item_list()
        {
            pi_party_help.Visible = true;
            pi_party_help.DataSource = null;
            ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N,f5.title,f3.qty,f3.price,f3.amount from " + ConnectionWithAccess.tablename[1] + " f1, " + ConnectionWithAccess.tablename[3] + " f3, " + ConnectionWithAccess.tablename[5] + " f5, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_c = " + Convert.ToInt32(pidbc.Text) + " and f3.prd = f22.prd and f3.d_c = f22.d_c and f3.d_n = f22.d_n and f22.a_n = '" + pia_n.Text + "' and f22.s_a = '" + pis_a.Text + "' and f3.item_code = f5.item_code order by f22.d_n desc";
            ConnectionCommand.accountHelp(pi_party_help, "pi_datagridview");
            pi_party_help.Columns[0].HeaderText = "Date";
            pi_party_help.Columns[1].HeaderText = "Inv.num";
            pi_party_help.Columns[2].HeaderText = "Title";
            pi_party_help.Columns[3].HeaderText = "Quantity";
            pi_party_help.Columns[4].HeaderText = "Price";
            pi_party_help.Columns[5].HeaderText = "Amount";
            pi_party_help.Columns[0].Width = 75;
            pi_party_help.Columns[1].Width = 60;
            pi_party_help.Columns[2].Width = 280;
            pi_party_help.Columns[3].Width = 90;
            pi_party_help.Columns[4].Width = 90;
            pi_party_help.Columns[5].Width = 120;
            pi_party_help.Columns[0].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            pi_party_help.Columns[1].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            pi_party_help.Columns[2].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleLeft;
            pi_party_help.Columns[3].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            pi_party_help.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            pi_party_help.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            if (pi_party_help.Rows.Count <= 1)
            {
                ConnectionWithAccess.mDateTime = Convert.ToDateTime(ConnectionWithAccess.msdate);
            }
        }

        private void fill_all_purchase_invoice_list()
        {
            pi_party_help.Visible = true;
            pi_party_help.Rows.Clear();
            ConnectionWithAccess.query = "select distinct f22.D_D, f22.D_N, f22.bamt, f22.tamt, f22.gamt from " + ConnectionWithAccess.tablename[1] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.prd = '" + ConnectionWithAccess.mprd + "' and f22.d_c = " + Convert.ToInt32(pidbc.Text) + " and f22.a_n = '" + pia_n.Text + "' and f22.s_a = '" + pis_a.Text + "' order by f22.d_n desc";
            ConnectionCommand.accountHelp(pi_party_help, "pi_datagridview");
            pi_party_help.Columns[0].HeaderText = "Date";
            pi_party_help.Columns[1].HeaderText = "Inv.num";
            pi_party_help.Columns[2].HeaderText = "basic";
            pi_party_help.Columns[3].HeaderText = "Tax";
            pi_party_help.Columns[4].HeaderText = "Gross";
            pi_party_help.Columns[0].Width = 75;
            pi_party_help.Columns[1].Width = 60;
            pi_party_help.Columns[2].Width = 120;
            pi_party_help.Columns[3].Width = 120;
            pi_party_help.Columns[4].Width = 120;
            pi_party_help.Columns[0].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            pi_party_help.Columns[1].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            pi_party_help.Columns[2].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            pi_party_help.Columns[3].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            pi_party_help.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            //update_gridview_balances(pi_datagridview, 2, 3, 4);
            //getTotal(pi_party_help, 2);
            //getTotal(pi_party_help, 3);
            //getTotal(pi_party_help, 4);
            if (pi_party_help.Rows.Count <= 1)
            {
                ConnectionWithAccess.mDateTime = Convert.ToDateTime(ConnectionWithAccess.msdate);
            }
        }

        private void fill_all_purchase_invoice_ledger()
        {
            pi_party_help.Visible = true;
            pi_party_help.Rows.Clear();
            ConnectionWithAccess.query = "select distinct '',f51.a_n, f51.s_a, f51.d_d, 'Open', 'O' as 'Type', f51.amt, '',f51.amt from " + ConnectionWithAccess.tablename[51] + " f51, " + ConnectionWithAccess.tablename[01] + " f1 where f51.prd = '@' and f51.a_n = '" + pia_n.Text + "' and f51.s_a = '" + pis_a.Text + "' and d_d = #01-01-1901#";
            ConnectionCommand.accountHelp(pi_party_help, "LEDGER");
            ConnectionWithAccess.query = "select '',f22.a_n, f22.s_a, f22.d_d ,f22.d_n,'P' as 'Type', '',f22.gamt ,'' from " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[22] + " f22 where f1.a_n = f22.a_n and f1.s_a = f22.s_a and f22.a_n = '" + pia_n.Text + "' and f22.s_a = '" + pis_a.Text + "'";
            ConnectionCommand.multiplerows(pi_party_help, "LEDGER");
            ConnectionWithAccess.query = "select '',f23.a_n, f23.s_a, f23.d_d, f23.d_n,'B' as 'Type', f23.bamt,'','' from " + ConnectionWithAccess.tablename[23] + " f23 where f23.a_n = '" + pia_n.Text + "' and f23.s_a = '" + pis_a.Text + "'" + " and f23.b_t = '3' and f23.bamt < 0";
            ConnectionCommand.multiplerows(pi_party_help, "LEDGER");
            ConnectionWithAccess.query = "select '',f23.a_n, f23.s_a, f23.d_d, f23.d_n,'B' as 'Type', '',f23.bamt from " + ConnectionWithAccess.tablename[23] + " f23 where f23.a_n = '" + pia_n.Text + "' and f23.s_a = '" + pis_a.Text + "'" + " and f23.b_t = '3' and f23.bamt > 0";
            ConnectionCommand.multiplerows(pi_party_help, "LEDGER");
            ConnectionWithAccess.query = "select '',f24.a_n, f24.s_a, f24.d_d, f24.d_n,'C' as 'Type', (f24.Camt * -1),'','' from " + ConnectionWithAccess.tablename[24] + " f24 where f24.a_n = '" + pia_n.Text + "' and f24.s_a = '" + pis_a.Text + "' and f24.camt < 0";
            ConnectionCommand.multiplerows(pi_party_help, "LEDGER");
            ConnectionWithAccess.query = "select '',f24.a_n, f24.s_a, f24.d_d, f24.d_n,'C' as 'Type', '',f24.Camt,''  from " + ConnectionWithAccess.tablename[24] + " f24 where f24.a_n = '" + pia_n.Text + "' and f24.s_a = '" + pis_a.Text + "' and f24.camt > 0";
            ConnectionCommand.multiplerows(pi_party_help, "LEDGER");
            ConnectionWithAccess.query = "select '',f25.a_n, f25.s_a, f25.d_d, f25.d_n,'J' as 'Type', '',f25.jamt, '' from " + ConnectionWithAccess.tablename[25] + " f25 where f25.a_n = '" + pia_n.Text + "' and f25.s_a = '" + pis_a.Text + "'";
            ConnectionCommand.multiplerows(pi_party_help, "LEDGER");
            ConnectionWithAccess.query = "select '',f25.a_n, f25.s_a, f25.d_d, f25.d_n,'J' as 'Type', f25.jamt,'', '' from " + ConnectionWithAccess.tablename[25] + " f25 where f25.na_n = '" + pia_n.Text + "' and f25.ns_a = '" + pis_a.Text + "'";
            ConnectionCommand.multiplerows(pi_party_help, "LEDGER");
            ConnectionWithAccess.query = "select '',f30.a_n, f30.s_a, f30.d_d, f30.d_n,'R' as 'Type', f30.gamt,'', '' from " + ConnectionWithAccess.tablename[30] + " f30 where f30.a_n = '" + pia_n.Text + "' and f30.s_a = '" + pis_a.Text + "'";
            ConnectionCommand.multiplerows(pi_party_help, "LEDGER");
            pi_party_help.Columns[0].HeaderText = "DATE SORT";
            pi_party_help.Columns[1].HeaderText = "A_N";
            pi_party_help.Columns[2].HeaderText = "S_A";
            pi_party_help.Columns[3].HeaderText = "Date";
            pi_party_help.Columns[4].HeaderText = "Document";
            pi_party_help.Columns[5].HeaderText = "Type";
            pi_party_help.Columns[6].HeaderText = "Debit";
            pi_party_help.Columns[7].HeaderText = "Credit";
            pi_party_help.Columns[8].HeaderText = "Balance";
            pi_party_help.Columns[0].Width = 75;
            pi_party_help.Columns[1].Width = 60;
            pi_party_help.Columns[2].Width = 60;
            pi_party_help.Columns[3].Width = 75;
            pi_party_help.Columns[4].Width = 75;
            pi_party_help.Columns[5].Width = 15;
            pi_party_help.Columns[6].Width = 120;
            pi_party_help.Columns[7].Width = 120;
            pi_party_help.Columns[8].Width = 120;
            if (pi_party_help.Columns.Count > 1)
            {
                if (pi_party_help.Rows.Count > 0)
                {
                    update_gridview_balances(pi_party_help, 6, 7, 8);
                    //getTotal(pi_party_help, 6);
                    //getTotal(pi_party_help, 7);
                }
            }
        }

        private void cb_all_purchase_invoice_list_CheckedChanged(object sender, EventArgs e)
        {
            if (cb_all_purchase_invoice_list.Checked == true)
            {
                cb_all_purchase_item_list.Checked = false;
                cb_all_purchase_invoice_ledger.Checked = false;
                fill_all_purchase_invoice_list();
            }
            else
            {
                pi_party_help.Visible = false;
            }
        }

        private void cb_all_purchase_invoice_ledger_CheckedChanged(object sender, EventArgs e)
        {
            if (cb_all_purchase_invoice_ledger.Checked == true)
            {
                cb_all_purchase_invoice_list.Checked = false;
                cb_all_purchase_item_list.Checked = false;
                fill_all_purchase_invoice_ledger();
            }
            else
            {
                pi_party_help.Visible = false;
            }
        }

        private string change_date_format(string old_date)
        {
            temp_word = Convert.ToString(old_date);
            month_int = temp_word.IndexOf("/");
            date_int = temp_word.IndexOf("/", month_int + 1);
            old_date = temp_word.Substring(month_int + 1, date_int - month_int - 1) + "/" + temp_word.Substring(0, month_int) + "/" + temp_word.Substring(date_int + 1, temp_word.Length - date_int - 1);
            return old_date;
        }

        private void generate_full_brief_purchase()
        {
            if (sale_purchase_party.Length > 0)
            {
                ConnectionWithAccess.ma_n = null;
                ConnectionWithAccess.ms_a = null;
                report_filetype = cbRepType.Text + " " + cbRepSubType.Text + " ";
                pdf_filename = ConnectionWithAccess.report_file_location + (report_filetype).Replace(" ", "");
                if (chb_add_datetime_in_output.Checked)
                    pdf_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                pdf_filename += ".pdf";
                pdf_filename = ConnectionWithAccess.remove_filename_error(pdf_filename);
                doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
                FileStream FS1 = File.Create(pdf_filename);
                writer = PdfWriter.GetInstance(doc1, FS1);
                doc1.Open();
                current_pdf_page_number = 1;
                add_header_footer = true;
                header_text_message = report_filetype + " " + " From : " + change_date_format(RepFrom.Text) + " to " + change_date_format(RepTo.Text);
                pdf_top_heading = "       Date          Doc.          Name                                                    City                                     Balance";
                Paragraph para = new Paragraph();
                lineno = 3;
                temp_double = 0;
                temp_word = ".";
                print_pdf_line(cour_9_bold, temp_word.Trim(), 30, 5);
                temp_word = " ";
                print_pdf_line(cour_9_bold, temp_word.Trim(), 30, 5);
                var cellArray = sale_purchase_party[0].Split(new[] { ',' });
                ConnectionWithAccess.ma_n = cellArray[12].ToString();
                ConnectionWithAccess.ms_a = cellArray[13].ToString();
                for (row_pointer = 0; row_pointer < sale_purchase_party.Length; row_pointer++)
                {
                    cellArray = sale_purchase_party[row_pointer].Split(new[] { ',' });
                    temp_word = change_date_format(cellArray[1]);
                    print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(0, temp_word, "cour_9"), 0);
                    temp_word = cellArray[2];
                    print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(35, temp_word, "cour_9"), -16);
                    temp_word = cellArray[3];
                    print_pdf_line(cour_9_bold, temp_word.Trim(), 130, -16);
                    temp_word = cellArray[4];
                    print_pdf_line(cour_9_bold, temp_word.Trim(), 340, -16);
                    temp_word = cellArray[8];
                    print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(360, temp_word, "cour_9"), -16);
                    temp_double = temp_double + Convert.ToSingle(temp_word);
                    fill_all_purchase_item_list_for_array(cellArray[10].ToString(), cellArray[11].ToString(), cellArray[12].ToString(), cellArray[13].ToString(), cellArray[2].ToString());
                    if (pi_party_help.Rows.Count > 0)
                    {
                        for (row_pointer2 = 0; row_pointer2 < pi_party_help.Rows.Count; row_pointer2++)
                        {
                            if (actual_line_number_of_page >= 44)
                            {
                                //temp_word = "-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
                                //print_pdf_line(cour_9, temp_word, 20, 0);
                                //print_pdf_line(cour_9, " ", 50, 24);
                                print_header_footer_with_top_contains(pdf_top_heading);
                                lineno = 3;
                                actual_line_number_of_page = 0;
                            }
                            if (ckbx_include_payments.Checked == true)
                            {
                                if (ConnectionWithAccess.ma_n != cellArray[12].ToString() && ConnectionWithAccess.ms_a != cellArray[13].ToString())
                                {
                                    fill_all_payment_for_array(ConnectionWithAccess.mprd, ConnectionWithAccess.ma_n, ConnectionWithAccess.ms_a);
                                    ConnectionWithAccess.ma_n = cellArray[12].ToString();
                                    ConnectionWithAccess.ms_a = cellArray[13].ToString();
                                }
                            }
                            if (pi_party_help.Rows[row_pointer2].Cells[2].Value != null)
                            {
                                temp_word = pi_party_help.Rows[row_pointer2].Cells[2].Value.ToString();
                                print_pdf_line(cour_9, temp_word.Trim(), 100, 0);
                            }
                            if (pi_party_help.Rows[row_pointer2].Cells[3].Value != null)
                            {
                                temp_word = pi_party_help.Rows[row_pointer2].Cells[3].Value.ToString();
                                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(330, temp_word, "cour_9"), -16);
                            }
                            if (pi_party_help.Rows[row_pointer2].Cells[4].Value != null)
                            {
                                temp_word = pi_party_help.Rows[row_pointer2].Cells[4].Value.ToString();
                                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(380, temp_word, "cour_9"), -16);
                            }
                            if (pi_party_help.Rows[row_pointer2].Cells[5].Value != null)
                            {
                                temp_word = pi_party_help.Rows[row_pointer2].Cells[5].Value.ToString();
                                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(440, temp_word, "cour_9"), -16);
                            }
                            lineno++;
                        }
                    }
                    lineno++;
                    if (actual_line_number_of_page >= 46)
                    {
                        print_pdf_line(cour_9, " ", 50, 5);
                        print_header_footer_with_top_contains(pdf_top_heading);
                        lineno = 3;
                        actual_line_number_of_page = 0;
                    }
                }
                temp_word = "------------";
                print_pdf_line(cour_9, temp_word.Trim(), 520, 0);
                print_pdf_line(cour_9_bold, "Final Total", 425, -5);
                temp_word = Convert.ToString(Convert.ToInt32(temp_double)) + ".00";
                print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(480, temp_word, "cour_9"), -16);
                temp_word = "------------";
                print_pdf_line(cour_9, temp_word.Trim(), 520, -5);
                //temp_word = "-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
                //print_pdf_line(cour_9, temp_word, 20, -5);
                if (ckbx_include_payments.Checked == true)
                {
                    fill_all_payment_for_array(ConnectionWithAccess.mprd, ConnectionWithAccess.ma_n, ConnectionWithAccess.ms_a);
                    if (pi_party_help.Rows.Count > 0)
                    {
                        for (row_pointer2 = 0; row_pointer2 < pi_party_help.Rows.Count; row_pointer2++)
                        {
                            if (actual_line_number_of_page >= 44)
                            {
                                temp_word = "-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
                                print_pdf_line(cour_9, temp_word, 20, 0);
                                print_pdf_line(cour_9, " ", 50, 24);
                                //                pdf_top_heading = "Date            Doc.          Name                                                                              City                                      Balance";
                                print_header_footer_with_top_contains(pdf_top_heading);
                                lineno = 3;
                                actual_line_number_of_page = 0;
                            }
                            if (pi_party_help.Rows[row_pointer2].Cells[3].Value != null)
                            {
                                temp_word = pi_party_help.Rows[row_pointer2].Cells[3].Value.ToString();
                                print_pdf_line(cour_9, temp_word.Trim(), 10, 0);
                            }
                            if (pi_party_help.Rows[row_pointer2].Cells[4].Value != null)
                            {
                                temp_word = pi_party_help.Rows[row_pointer2].Cells[4].Value.ToString();
                                print_pdf_line(cour_9, temp_word.Trim(), 100, 0);
                            }
                            //if (pi_datagridview.Rows[row_pointer2].Cells[5].Value != null)
                            //{
                            //    temp_word = pi_datagridview.Rows[row_pointer2].Cells[5].Value.ToString();
                            //    print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(330, temp_word, "cour_9"), -16);
                            //}
                            //if (pi_datagridview.Rows[row_pointer2].Cells[6].Value != null)
                            //{
                            //    temp_word = pi_datagridview.Rows[row_pointer2].Cells[6].Value.ToString();
                            //    print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(380, temp_word, "cour_9"), -16);
                            //}
                            //if (pi_datagridview.Rows[row_pointer2].Cells[7].Value != null)
                            //{
                            //    temp_word = pi_datagridview.Rows[row_pointer2].Cells[7].Value.ToString();
                            //    print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(440, temp_word, "cour_9"), -16);
                            //}
                            lineno++;
                        }
                    }
                }
                print_footer();
                doc1.Close();
            }
            Generate.Visible = false;
            pi_party_help.Visible = true;
            pdf_viewer1.Visible = true;
            pdf_viewer2.Visible = false;
            pdf_viewer3.Visible = false;
            pdf_viewer_report_outstanding.Visible = false;
            pdf_viewer1.BringToFront();
            pdf_viewer1.Visible = false;
            //pdf_viewer1.LoadFile(pdf_filename);
        }

        private void fill_all_purchase_item_list_for_array(string mprd, string pidbc, string pia_n, string pis_a, string strpidocno)
        {
            pi_party_help.Visible = true;
            pi_party_help.BringToFront();
            try
            {
                dataset.Clear();
                pi_party_help.Rows.Clear();
            }
            catch (Exception ex)
            { }
            if (cbRepType.Text == "Sale")
                ConnectionWithAccess.query = "select f21.D_D, f21.D_N,f3.title,f3.qty,f3.price,f3.amount from " + ConnectionWithAccess.tablename[3] + " f3, " + ConnectionWithAccess.tablename[21] + " f21 where f21.prd = '" + mprd + "' and f21.d_c = " + Convert.ToInt32(pidbc) + " and f21.a_n = '" + pia_n + "' and f21.s_a = '" + pis_a + "' and f21.d_n " + (strpidocno.Trim() == string.Empty ? "is null" : "= " + strpidocno.Trim()) + " AND F3.a_n = f21.a_n AND F3.D_C = f21.d_c and f3.s_a = f21.s_a and f3.d_n " + (strpidocno.Trim() == string.Empty ? "is null" : "= " + strpidocno.Trim()) + " order by f21.d_n desc";
            else
                ConnectionWithAccess.query = "select f22.D_D, f22.D_N,f3.title,f3.qty,f3.price,f3.amount from " + ConnectionWithAccess.tablename[3] + " f3, " + ConnectionWithAccess.tablename[22] + " f22 where f22.prd = '" + mprd + "' and f22.d_c = " + Convert.ToInt32(pidbc) + " and f22.a_n = '" + pia_n + "' and f22.s_a = '" + pis_a + "' and f22.d_n " + (strpidocno.Trim() == string.Empty ? "is null" : "= " + strpidocno.Trim()) + " AND F3.a_n = f22.a_n AND F3.D_C = f22.d_c and f3.s_a = f22.s_a and f3.d_n " + (strpidocno.Trim() == string.Empty ? "is null" : "= " + strpidocno.Trim()) + " order by f22.d_n desc";
            dataadapter = new OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
            dataadapter.Fill(dataset);
            pi_party_help.DataSource = dataset;
            pi_party_help.DataMember = "Table";
        }

        private void fill_all_payment_for_array(string mprd, string ma_n, string ms_a)
        {
            pi_party_help.Visible = true;
            pi_party_help.BringToFront();
            try
            {
                dataset.Clear();
                pi_party_help.Rows.Clear();
            }
            catch (Exception ex)
            { }
            if (cbRepType.Text == "Sale")
            {
                dataadapter = new OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
                ConnectionWithAccess.query = "select '',f23.a_n, f23.s_a, f23.d_d, f23.d_n,'B' as 'Type', '', f23.Bamt ,'' from " + ConnectionWithAccess.tablename[23] + " f23 where f23.a_n = '" + ma_n + "' and f23.s_a = '" + ms_a + "' and f23.bamt > 0";
                dataadapter.Fill(dataset);
                ConnectionWithAccess.query = "select '',f23.a_n, f23.s_a, f23.d_d, f23.d_n,'B' as 'Type', (f23.Bamt * -1) ,''  from " + ConnectionWithAccess.tablename[23] + " f23 where f23.a_n = '" + ma_n + "' and f23.s_a = '" + ms_a + "' and f23.bamt < 0";
                //dataadapter = new  OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
                dataadapter.Fill(dataset);
                ConnectionWithAccess.query = "select '',f24.a_n, f24.s_a, f24.d_d, f24.d_n,'C' as 'Type', '', f24.Camt ,'' from " + ConnectionWithAccess.tablename[24] + " f24 where f24.a_n = '" + ma_n + "' and f24.s_a = '" + ms_a + "' and f24.camt > 0";
                //dataadapter = new  OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
                dataadapter.Fill(dataset);
                ConnectionWithAccess.query = "select '',f24.a_n, f24.s_a, f24.d_d, f24.d_n,'C' as 'Type', (f24.Camt * -1) ,''  from " + ConnectionWithAccess.tablename[24] + " f24 where f24.a_n = '" + ma_n + "' and f24.s_a = '" + ms_a + "' and f24.camt < 0";
                //dataadapter = new  OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
                dataadapter.Fill(dataset);
            }
            else
                ConnectionWithAccess.query = "select f22.D_D, f22.D_N,f3.title,f3.qty,f3.price,f3.amount from " + ConnectionWithAccess.tablename[3] + " f3, " + ConnectionWithAccess.tablename[22] + " f22 where f22.prd = '" + mprd + "' and f22.d_c = " + Convert.ToInt32(pidbc) + " and f22.a_n = '" + pia_n + "' and f22.s_a = '" + pis_a + "' and f22.d_n " + (pidocno.Text.Trim() == string.Empty ? "is null" : "= " + pidocno.Text.Trim()) + " AND F3.a_n = f22.a_n AND F3.D_C = f22.d_c and f3.s_a = f22.s_a and f3.d_n " + (pidocno.Text.Trim() == string.Empty ? "is null" : "= " + pidocno.Text.Trim()) + " order by f22.d_n desc";
            //dataadapter = new  OleDbDataAdapter(ConnectionWithAccess.query, ConnectionWithAccess.connection);
            //dataadapter.Fill(dataset);
            pi_party_help.DataSource = dataset;
            pi_party_help.DataMember = "Table";
        }

        private void Scan_documents(string strModuleName)
        {
            clear_all_images();
            invisible_all_image();
            ImageScan objImgScan = new ImageScan();
            objImgScan.strScanImageModule = strModuleName;// "Purchase_";
            objImgScan.ShowDialog();
        }

        private void show_images()
        {
            if (cb_common_image.Checked == true)
            {
                invisible_all_image();
                find_scan_image_type();
                file_folder = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\scanned_images\\";
                strImageFileName = file_folder + ConnectionWithAccess.mNIK + "_Busi_card_" + ConnectionWithAccess.ma_n + "_" + ConnectionWithAccess.ms_a + ".jpeg";
                if (File.Exists(strImageFileName))
                {
                    pb_visiting_card.Visible = true;
                    pb_visiting_card.Image = System.Drawing.Image.FromFile(strImageFileName);
                    pb_visiting_card.SizeMode = PictureBoxSizeMode.Zoom;
                }
                strImageFileName = file_folder + ConnectionWithAccess.mNIK + "_Inv" + scan_image_type + ".jpeg";
                if (File.Exists(strImageFileName))
                {
                    pb_invoice.Visible = true;
                    pb_invoice.Image = System.Drawing.Image.FromFile(strImageFileName);
                    pb_invoice.SizeMode = PictureBoxSizeMode.Zoom;
                }
                strImageFileName = file_folder + ConnectionWithAccess.mNIK + "_Per_" + ConnectionWithAccess.ma_n + "_" + ConnectionWithAccess.ms_a + ".jpeg";
                if (File.Exists(strImageFileName))
                {
                    pb_personal_photo.Visible = true;
                    pb_personal_photo.Image = System.Drawing.Image.FromFile(strImageFileName);
                    pb_personal_photo.SizeMode = PictureBoxSizeMode.Zoom;
                }
                strImageFileName = file_folder + ConnectionWithAccess.mNIK + "_Tra" + scan_image_type + ".jpeg";
                if (File.Exists(strImageFileName))
                {
                    pb_receipt.Visible = true;
                    pb_receipt.Image = System.Drawing.Image.FromFile(strImageFileName);
                    pb_receipt.SizeMode = PictureBoxSizeMode.Zoom;
                }
                strImageFileName = file_folder + ConnectionWithAccess.mNIK + "_Product_" + scan_image_type + ".jpeg";
                if (File.Exists(strImageFileName))
                {
                    pb_product.Visible = true;
                    pb_product.Image = System.Drawing.Image.FromFile(strImageFileName);
                    pb_product.SizeMode = PictureBoxSizeMode.Zoom;
                }
                else
                {
                    strImageFileName = file_folder + ConnectionWithAccess.mNIK + "_Che" + scan_image_type + ".jpeg";
                    if (File.Exists(strImageFileName))
                    {
                        pb_receipt.Visible = true;
                        pb_receipt.Image = System.Drawing.Image.FromFile(strImageFileName);
                        pb_receipt.SizeMode = PictureBoxSizeMode.Zoom;
                    }
                }
            }
            else
                invisible_all_image();
        }

        private void atbscan_Click(object sender, EventArgs e)
        {
            find_scan_image_type();
            atbscan.Visible = false;
            Scan_documents(scan_image_type);
            //Scan_documents(maintab.SelectedTab.Text);
            atbscan.Visible = true;
        }

        private void find_scan_image_type()
        {

            //              100 sale invoice 
            //              110 purchase invoice
            //              120 bank receipt
            //              121 bank payment
            //              122 bank deposit
            //              123 bank withdrawal
            //              130 cash receipt
            //              131 cash payment
            //              140 journal
            //              20 masters accounts
            //              21 masters items
            //              22 masters tax
            //              23 masters daybook
            //              24 masters period
            //              25 masters additional
            scan_image_type = "";
            ConnectionWithAccess.ma_n = "";
            ConnectionWithAccess.ms_a = "";
            ConnectionWithAccess.accountname = "";
            ConnectionWithAccess.accountcity = "";
            ImageScan.image_title = "";
            if (current_working_tab == "100")
            {
                scan_image_type = "_" + ConnectionWithAccess.mprd + "_" + sidbc.Text + "_" + sidocno.Text;
                ConnectionWithAccess.ma_n = sia_n.Text;
                ConnectionWithAccess.ms_a = sis_a.Text;
                ConnectionWithAccess.accountname = sipartycode.Text;
                ConnectionWithAccess.accountcity = sicity.Text;
                ImageScan.image_title = sipartycode.Text + " ," + sicity.Text;
            }
            else if (current_working_tab == "101")
            {
                scan_image_type = "_" + ConnectionWithAccess.mprd + "_" + srdbc.Text + "_" + srdocno.Text;
                ConnectionWithAccess.ma_n = sra_n.Text;
                ConnectionWithAccess.ms_a = srs_a.Text;
                ConnectionWithAccess.accountname = srpartycode.Text;
                ConnectionWithAccess.accountcity = "";
                ImageScan.image_title = srpartycode.Text;
            }
            else if (current_working_tab == "102")
            {
                scan_image_type = "_" + ConnectionWithAccess.mprd + "_" + sodbc.Text + "_" + sodocno.Text;
                ConnectionWithAccess.ma_n = soa_n.Text;
                ConnectionWithAccess.ms_a = sos_a.Text;
                ConnectionWithAccess.accountname = sopartycode.Text;
                ConnectionWithAccess.accountcity = "";
                ImageScan.image_title = sopartycode.Text;
            }
            else if (current_working_tab == "110")
            {
                scan_image_type = "_" + ConnectionWithAccess.mprd + "_" + pidbc.Text + "_" + pia_n.Text + "_" + pis_a.Text + "_" + pidocno.Text;
                ConnectionWithAccess.ma_n = pia_n.Text;
                ConnectionWithAccess.ms_a = pis_a.Text;
                ConnectionWithAccess.accountname = pipartycode.Text;
                ConnectionWithAccess.accountcity = picity.Text;
                ImageScan.image_title = pipartycode.Text + " ," + picity.Text;
            }
            else if (current_working_tab == "111")
            {
                scan_image_type = "_" + ConnectionWithAccess.mprd + "_" + prpartycode.Text + "_" + prdbc.Text + "_" + prdocno.Text;
                ConnectionWithAccess.ma_n = pra_n.Text;
                ConnectionWithAccess.ms_a = prs_a.Text;
                ConnectionWithAccess.accountname = prpartycode.Text;
                ConnectionWithAccess.accountcity = "";
                ImageScan.image_title = prpartycode.Text;
            }
            else if (current_working_tab == "120")
            {
                scan_image_type = "_" + ConnectionWithAccess.mprd + "_" + brdbc.Text + "_" + brdocno.Text;
                ConnectionWithAccess.ma_n = bra_n.Text;
                ConnectionWithAccess.ms_a = brs_a.Text;
                ConnectionWithAccess.accountname = brpartycode.Text;
                ConnectionWithAccess.accountcity = brpartycity.Text;
                ImageScan.image_title = brpartycode.Text + " ," + brpartycity.Text;
            }
            else if (current_working_tab == "121")
            {
                scan_image_type = "_" + ConnectionWithAccess.mprd + "_" + bpdbc.Text + "_" + bpdocno.Text;
                ConnectionWithAccess.ma_n = bpa_n.Text;
                ConnectionWithAccess.ms_a = bps_a.Text;
                ConnectionWithAccess.accountname = bppartycode.Text;
                ConnectionWithAccess.accountcity = bppartycity.Text;
                ImageScan.image_title = bppartycode.Text + " ," + bppartycity.Text;
            }
            else if (current_working_tab == "122")
            {
                scan_image_type = "_" + ConnectionWithAccess.mprd + "_" + bddbc.Text + "_" + bddocno.Text;
                ConnectionWithAccess.ma_n = bda_n.Text;
                ConnectionWithAccess.ms_a = "@@@";
                ConnectionWithAccess.accountname = bdpartycode.Text;
                ConnectionWithAccess.accountcity = "";
                ImageScan.image_title = bdpartycode.Text;
            }
            else if (current_working_tab == "123")
            {
                scan_image_type = "_" + ConnectionWithAccess.mprd + "_" + bwdbc.Text + "_" + bwdocno.Text;
                ConnectionWithAccess.ma_n = bwa_n.Text;
                ConnectionWithAccess.ms_a = "@@@";
            }
            else if (current_working_tab == "130")
            {
                scan_image_type = "_" + ConnectionWithAccess.mprd + "_" + crdbc.Text + "_" + crdocno.Text;
                ConnectionWithAccess.ma_n = cra_n.Text;
                ConnectionWithAccess.ms_a = crs_a.Text;
                ConnectionWithAccess.accountname = crpartycode.Text;
                ConnectionWithAccess.accountcity = "";
                ImageScan.image_title = crpartycode.Text;
            }
            else if (current_working_tab == "131")
            {
                scan_image_type = "_" + ConnectionWithAccess.mprd + "_" + cpdbc.Text + "_" + cpdocno.Text;
                ConnectionWithAccess.ma_n = cpa_n.Text;
                ConnectionWithAccess.ms_a = cps_a.Text;
                ConnectionWithAccess.accountname = cppartycode.Text;
                ConnectionWithAccess.accountcity = "";
                ImageScan.image_title = cppartycode.Text;
            }
            else if (current_working_tab == "20")
            {
                ImageScan.image_title = tbDesc.Text + "_" + tbCity.Text;
                scan_image_type = tbA_N.Text + "_" + tbS_A.Text;
                ConnectionWithAccess.ma_n = tbA_N.Text;
                ConnectionWithAccess.ms_a = tbS_A.Text;
                ConnectionWithAccess.accountname = tbDesc.Text;
                ConnectionWithAccess.accountcity = tbCity.Text;
            }
            else if (current_working_tab == "21")
            {
                ImageScan.image_title = tbTitle.Text;
                scan_image_type = tbItemType.Text + "_" + tbItemCode.Text;
            }
            else if (current_working_tab == "31")
            {
                //scan_image_type = "_" + ConnectionWithAccess.mprd + "_" + cpdbc.Text + "_" + cpdocno.Text;
                ConnectionWithAccess.ma_n = rla_n.Text;
                ConnectionWithAccess.ms_a = rls_a.Text;
                ConnectionWithAccess.accountname = tb_ledger_account_name.Text;
                ConnectionWithAccess.accountcity = "";
                ImageScan.image_title = tb_ledger_account_name.Text;
            }
            //scan_image_type = "_" + tbItemCode.Text.Trim();// tbTitle.Text;
            atbscan.Visible = false;
            //Scan_documents(scan_image_type);
            //Scan_documents(maintab.SelectedTab.Text);
            atbscan.Visible = true;
        }

        //public void Show_Scanned_image()
        //{
        //    string strImageFileName = string.Empty;
        //    string strFullImagePath = string.Empty;
        //    string img_prefix = string.Empty;

        //    if (cbType.Text == "Business Card")
        //        img_prefix = "Busi_card";
        //    else if (cbType.Text == "Product")
        //        img_prefix = "Product";
        //    else if (cbType.Text != null)
        //        img_prefix = cbType.Text.Substring(0, 3);

        //    //if (cbType.Text == "Business Card")
        //    //    strImageFileName = file_folder + ConnectionWithAccess.mNIK + "_Busi_card_" + ConnectionWithAccess.accountname + "_" + ConnectionWithAccess.accountcity + ".jpeg";
        //    //else if (cbType.Text == "Product")
        //    //    strImageFileName = file_folder + ConnectionWithAccess.mNIK + "_Product_" + strScanImageModule + ".jpeg";
        //    //else
        //    //    strImageFileName = file_folder + ConnectionWithAccess.mNIK + "_" + img_prefix + strScanImageModule + ".jpeg";
        //    ////strImageFileName = file_folder + ConnectionWithAccess.mNIK + "_" + img_prefix + strScanImageModule + "_" + DateTime.Now.ToString("yyyy-MM-dd HHmmss") + ".jpeg";
        //    //strImageFileName = MainForm.remove_wrong_character_from_file(strImageFileName);


        //    if (current_working_tab == "100")
        //    {
        //        strImageFileName = ConnectionWithAccess.mNIK + "_" + img_prefix + "_" + ConnectionWithAccess.mprd + "_" + sidbc.Text + "_" + sidocno.Text;
        //    }
        //    else if (current_working_tab == "101")
        //    {
        //        strImageFileName = ConnectionWithAccess.mNIK + "_" + img_prefix + "_" + ConnectionWithAccess.mprd + "_" + srdbc.Text + "_" + srdocno.Text;
        //    }
        //    else if (current_working_tab == "102")
        //    {
        //        strImageFileName = ConnectionWithAccess.mNIK + "_" + img_prefix + "_" + ConnectionWithAccess.mprd + "_" + sodbc.Text + "_" + sodocno.Text;
        //    }
        //    else if (current_working_tab == "110")
        //    {
        //        strImageFileName = ConnectionWithAccess.mNIK + "_" + img_prefix + "_" + ConnectionWithAccess.mprd + "_" + pipartycode.Text + "_" + pidbc.Text + "_" + pidocno.Text;
        //    }
        //    else if (current_working_tab == "111")
        //    {
        //        strImageFileName = ConnectionWithAccess.mNIK + "_" + img_prefix + "_" + ConnectionWithAccess.mprd + "_" + prpartycode.Text + "_" + prdbc.Text + "_" + prdocno.Text;
        //    }
        //    else if (current_working_tab == "120")
        //    {
        //        strImageFileName = ConnectionWithAccess.mNIK + "_" + img_prefix + "_" + ConnectionWithAccess.mprd + "_" + brdbc.Text + "_" + brdocno.Text;
        //    }
        //    else if (current_working_tab == "121")
        //    {
        //        strImageFileName = ConnectionWithAccess.mNIK + "_" + img_prefix + "_" + ConnectionWithAccess.mprd + "_" + bpdbc.Text + "_" + bpdocno.Text;
        //    }
        //    else if (current_working_tab == "122")
        //    {
        //        strImageFileName = ConnectionWithAccess.mNIK + "_" + img_prefix + "_" + ConnectionWithAccess.mprd + "_" + bddbc.Text + "_" + bddocno.Text;
        //    }
        //    else if (current_working_tab == "123")
        //    {
        //        strImageFileName = ConnectionWithAccess.mNIK + "_" + img_prefix + "_" + ConnectionWithAccess.mprd + "_" + bwdbc.Text + "_" + bwdocno.Text;
        //    }
        //    else if (current_working_tab == "130")
        //    {
        //        strImageFileName = ConnectionWithAccess.mNIK + "_" + img_prefix + "_" + ConnectionWithAccess.mprd + "_" + crdbc.Text + "_" + crdocno.Text;
        //    }
        //    else if (current_working_tab == "131")
        //    {
        //        strImageFileName = ConnectionWithAccess.mNIK + "_" + img_prefix + "_" + ConnectionWithAccess.mprd + "_" + cpdbc.Text + "_" + cpdocno.Text;

        //    }
        //    else if (current_working_tab == "21")
        //    {
        //        strImageFileName = ConnectionWithAccess.mNIK + "_" + img_prefix + "_" + "_" + tbItemCode.Text.Trim();// tbTitle.Text;

        //    }

        //    if (!string.IsNullOrEmpty(strImageFileName))
        //    {
        //        strImageFileName = MainForm.remove_wrong_character_from_file(strImageFileName);

        //        strFullImagePath = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\scanned_images\\" + strImageFileName + ".jpeg";
        //        if (File.Exists(strFullImagePath))
        //        {
        //            pb_common.Visible = true;
        //            pb_common.SizeMode = PictureBoxSizeMode.AutoSize;
        //            pb_common.ImageLocation = strFullImagePath;
        //        }
        //    }

        //}

        public static string remove_wrong_character_from_file(string filename)
        {
            filename = filename.Replace("/", "");
            filename = filename.Replace("-", "");
            filename = filename.Replace("\"", "");
            return filename;
        }

        private void sidatetime_ValueChanged(object sender, EventArgs e)
        {
            set_period_of_gst();
        }

        private void pidatetime_ValueChanged(object sender, EventArgs e)
        {
            set_period_of_gst();
        }

        private void bar_code_image(string bar_code_string)
        {
            string barcode = bar_code_string;
            Bitmap bitmap = new Bitmap(barcode.Length * 39, 50);
            using (Graphics graphics = Graphics.FromImage(bitmap))
            {
                System.Drawing.Font oFont = new System.Drawing.Font("IDAutomationHC39M Free Version", 20);
                PointF point = new PointF(2f, 2f);
                SolidBrush black = new SolidBrush(Color.Black);
                SolidBrush white = new SolidBrush(Color.White);
                graphics.FillRectangle(white, 0, 0, bitmap.Width, bitmap.Height);
                graphics.DrawString("*" + barcode + "*", oFont, black, point);
            }
            using (MemoryStream ms = new MemoryStream())
            {
                bitmap.Save(ms, ImageFormat.Png);
                pb_common.Image = bitmap;
                pb_common.Height = bitmap.Height;
                pb_common.Width = bitmap.Width;

            }
        }

        private void load_std_code_in_gridview()
        {
            stdisd_filename = ConnectionWithAccess.setup_drive + "sharp\\STDISD.txt";
            if (File.Exists(stdisd_filename))
            {
                string[] cellArray;
                stdisd_array = new string[0];
                stdisd_array = File.ReadAllLines(stdisd_filename);
                if (stdisd_array.Length > 1)
                {
                    //oleDbCmd.CommandText = "SELECT * FROM DATAFILE";
                    //adapter = new OleDbDataAdapter(oleDbCmd.CommandText, VoterConn);
                    //adapter.Fill(ds, "Table");
                    cellArray = stdisd_array[0].Split(new[] { ',' });
                    //dgv_stdisd.Location = new System.Drawing.Point(75, 75);
                    //dgv_stdisd.Size = new System.Drawing.Size(1200, 450);
                    dgv_stdisd.DataSource = null;
                    dgv_stdisd.ColumnCount = cellArray.Length;
                    dgv_stdisd.ColumnHeadersVisible = true;
                    dgv_stdisd.Rows.Clear();
                    for (column_counter = 0; column_counter < cellArray.Length; column_counter++)
                    {
                        dgv_stdisd.Columns[column_counter].HeaderText = cellArray[column_counter];
                    }
                    string column_size = "100,100,100,60,60,60,60,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44";
                    var cellArray1 = column_size.Split(new[] { ',' });
                    for (int a = 0; a < cellArray.Length; a++)
                    {
                        dgv_stdisd.Columns[a].Width = Convert.ToInt32(cellArray1[a]);
                    }
                    //dgv_stdisd.Columns[0].HeaderText = "Old Word";
                    //dgv_stdisd.Columns[1].HeaderText = "New Word";
                    //dgv_stdisd.Columns[0].Width = 120;
                    //dgv_stdisd.Columns[1].Width = 120;
                    //gdvword.Columns[0].DefaultCellStyle.Font = new System.Drawing.Font("Arial", 15, FontStyle.Regular);
                    //gdvword.Columns[1].DefaultCellStyle.Font = new System.Drawing.Font("Arial", 15, FontStyle.Regular);
                    //gdvword.Columns[1].SortMode = DataGridViewColumnSortMode.Automatic;
                    dgv_stdisd.Columns[0].ReadOnly = true;
                    dgv_stdisd.Visible = false;
                    foreach (var cellValues in stdisd_array.Skip(0))
                    {
                        //var cellArray = cellValues.Split(new[] { ',' });
                        cellArray = cellValues.Split(new[] { ',' });
                        if (cellArray.Length == dgv_stdisd.Columns.Count)
                            dgv_stdisd.Rows.Add(cellArray);
                        else
                            dgv_stdisd.Rows.Add(cellArray);
                        word = cellValues;
                        //wordArrayList1.Add(cellValues);
                    }
                }
            }
        }

        private void load_std_code_in_datatable()
        {
            stdisd_filename = ConnectionWithAccess.setup_drive + "sharp\\STDISD.txt";
            if (File.Exists(stdisd_filename))
            {
                string[] cellArray;
                stdisd_array = new string[0];
                stdisd_array = File.ReadAllLines(stdisd_filename);
                if (stdisd_array.Length > 1)
                {
                    cellArray = stdisd_array[0].Split(new[] { ',' });
                    for (column_counter = 0; column_counter < cellArray.Length; column_counter++)
                    {
                        DataColumn dc = new DataColumn(cellArray[column_counter]);
                        dtStdCodes.Columns.Add(dc);
                    }
                    State_gst_code.Add("");
                    foreach (var cellValues in stdisd_array.Skip(1))
                    {
                        cellArray = cellValues.Split(new[] { ',' });
                        if (cellArray[0] == "INDIA")
                        {
                            DataRow drNewRow = dtStdCodes.NewRow();
                            if (cellArray.Length > 4)
                            {
                                string strSub = cellValues.Substring(cellValues.IndexOf("\""), cellValues.LastIndexOf("\"") - cellValues.IndexOf("\""));//.Replace(",", "~~");
                                string strcellValues = cellValues.Replace(strSub, strSub.Replace(",", "~~"));
                                cellArray = strcellValues.Split(new[] { ',' });

                                for (int i = 0; i < cellArray.Length; i++)
                                {
                                    drNewRow[i] = cellArray[i].Replace("~~", ",");
                                }
                            }
                            else
                            {
                                for (int i = 0; i < cellArray.Length; i++)
                                {
                                    drNewRow[i] = cellArray[i];
                                }
                            }
                            dtStdCodes.Rows.Add(drNewRow);
                        }
                        else
                        {
                            cellArray = cellValues.Split(new[] { '' });
                            State_gst_code.Add(cellArray[1]);
                        }
                    }
                }
            }
        }

        private void btn_reset_setup_code_Click(object sender, EventArgs e)
        {
            if (File.Exists(ConnectionWithAccess.setup_drive + "sharp\\sharp_info.txt"))
            {
                File.Delete(ConnectionWithAccess.setup_drive + "sharp\\sharp_info.txt");
                Application.Restart();
                Environment.Exit(1);
            }
        }

        private void btn_update_mdb_structure_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Updating Database files");
            objPleaseWait.Show();
            Application.DoEvents();

            // update_all_company_mdb_tables();
            btn_update_mdb_structure.Visible = false;
            tablestructureupdate.update_all_tables();
            btn_update_mdb_structure.Visible = true;
            objPleaseWait.Close();
        }

        private void delete_data_before_date(string tablename, string mdatetime)
        {
            if (tablename == "003" || tablename == "021" || tablename == "021" || tablename == "022" || tablename == "023" || tablename == "024" || tablename == "025" || tablename == "030")
            {
                if (ConnectionWithAccess.connection.State == ConnectionState.Open) { ConnectionWithAccess.connection.Close(); }
                DateTime vFDate = Convert.ToDateTime(mdatetime);
                ConnectionWithAccess.command.CommandText = "delete from " + ConnectionWithAccess.mNIK + "_0" + tablename + " where d_d < @FD";//#" + mdatetime + "#";
                ConnectionWithAccess.command.Parameters.Clear();
                ConnectionWithAccess.command.Parameters.AddWithValue("@FD", vFDate);

                prd_end_date = Convert.ToDateTime(mdatetime);
                ConnectionWithAccess.command.CommandText = "delete from " + ConnectionWithAccess.mNIK + "_0" + tablename + " where d_d < @FD";//#" + mdatetime + "#";
                ConnectionWithAccess.command.Parameters.AddWithValue("@FD", prd_end_date);

                //ConnectionWithAccess.command.CommandText = "delete from " + ConnectionWithAccess.mNIK + "_0" + tablename + " where d_d.value < format(#" + mdatetime + "#, 'dd/mm/yyyy')"; 
                ConnectionWithAccess.connection.Open();
                ConnectionWithAccess.command.ExecuteNonQuery();
                ConnectionWithAccess.connection.Close();
            }
            else if (tablename != "001" && tablename != "004" && tablename != "005" && tablename != "006")
            {
                truncate(tablename);
            }
        }

        private void tbStd_TextChanged(object sender, EventArgs e)
        {
            if (bstdcode && tbStd.Text != "")
            {
                if (dtStdCodes.Rows.Count == 0)
                    load_std_code_in_datatable();
                dgvStdCodeHelp.DataSource = null;

                DataTable dtFilter = dtStdCodes.Clone();
                dtStdCodes.Select("STD_CODE like '" + tbStd.Text.Trim() + "%' ").CopyToDataTable(dtFilter, LoadOption.OverwriteChanges);

                dgvStdCodeHelp.DataSource = dtFilter;
                dgvStdCodeHelp.Columns[0].Visible = false;
                dgvStdCodeHelp.Columns[1].Width = 120;
                dgvStdCodeHelp.Columns[2].Width = 120;
                dgvStdCodeHelp.Columns[3].Width = 120;
                //dgvStdCodeHelp.Visible = true;
            }
        }

        private void tbCity_TextChanged(object sender, EventArgs e)
        {
            if (master_account_help_dg.Visible == true)
                master_account_help_dg.Visible = false;
            if (tbCity.Text != "" && tbstate.Text != "")
            {
                dgvStdCodeHelp.DataSource = null;
                DataTable dtFilter = dtStdCodes.Clone();
                if (dtFilter.Rows.Count > 1)
                {
                    dtStdCodes.Select("STATION like '%" + tbCity.Text.Trim() + "%' ").CopyToDataTable(dtFilter, LoadOption.OverwriteChanges);
                    dgvStdCodeHelp.DataSource = dtFilter;
                    if (dgvStdCodeHelp.Rows.Count > 1)
                    {
                        if (dgvStdCodeHelp.Rows[0].Cells[3].Value.ToString() != tbstate.Text)
                        {
                            dgvStdCodeHelp.Visible = true;
                            tbstate.BackColor = Color.Red;
                        }
                    }
                    if (bstdcode && tbCity.Text != "" && dgvStdCodeHelp.Visible == true)
                    {
                        dgvStdCodeHelp.Columns[0].Visible = false;
                        dgvStdCodeHelp.Columns[1].Width = 120;
                        dgvStdCodeHelp.Columns[2].Width = 120;
                        dgvStdCodeHelp.Columns[3].Width = 120;
                    }
                }
            }
        }

        private void check_pincode_and_stdcode_and_update_state()
        {
            if (maintab.SelectedIndex == 2)
            {
                if (dtStdCodes.Rows.Count == 0)
                    load_std_code_in_datatable();

                dgvStdCodeHelp.DataSource = null;
                DataTable dtFilter = dtStdCodes.Clone();
                dtStdCodes.Select("STATION like '" + tbCity.Text.Trim() + "' ").CopyToDataTable(dtFilter, LoadOption.OverwriteChanges);
                dgvStdCodeHelp.DataSource = dtFilter;
                dgvStdCodeHelp.Columns[0].Visible = false;
                dgvStdCodeHelp.Columns[1].Width = 120;
                dgvStdCodeHelp.Columns[2].Width = 120;
                dgvStdCodeHelp.Columns[3].Width = 120;
                if (dgvStdCodeHelp.Rows.Count == 2)
                {
                    if (tbStd.Text == "")
                        tbStd.Text = dgvStdCodeHelp.Rows[0].Cells["std_code"].Value.ToString();
                    if (tbstate.Text == "")
                    {
                        tbstate.Text = dgvStdCodeHelp.Rows[0].Cells["state_abb"].Value.ToString();
                        tbstate.BackColor = Color.Red;
                    }
                }
            }
        }

        private void dgvStdCodeHelp_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Loading Std File");
            objPleaseWait.Show();
            Application.DoEvents();
            try
            {
                rowIndex = dgvStdCodeHelp.CurrentRow.Index;
                bstdcode = false;
                tbStd.Text = Convert.ToString(dgvStdCodeHelp.Rows[rowIndex].Cells[2].Value);
                tbstate.Text = Convert.ToString(dgvStdCodeHelp.Rows[rowIndex].Cells[3].Value);
                tbCity.Text = Convert.ToString(dgvStdCodeHelp.Rows[rowIndex].Cells[1].Value);
                dgvStdCodeHelp.Visible = false;
                tbstate.BackColor = Color.White;
            }
            catch (Exception ex)
            {

            }
            objPleaseWait.Close();
            bstdcode = true;
        }

        private void DispEmail_TextChanged(object sender, EventArgs e)
        {
            if (DispEmail.Text.Contains("@") && ConnectionWithAccess.mUserFeatures.Substring(37, 1) == "Y")
            {
                DispEmail.Visible = true;
                btnsendemail.Visible = true;
            }
            else
            {
                DispEmail.Visible = false;
                btnsendemail.Visible = false;
            }
        }

        private void pb_backup_data_Click(object sender, EventArgs e)
        {
            backup objbackstore = new backup();
            objbackstore.Show();
            Application.DoEvents();
            //objbackstore.Close();
        }

        private void vDeleteItem()
        {
            bool isItemUsed = false;
            if (!string.IsNullOrEmpty(tbItemCode.Text.Trim()))
            {
                string strQuery = "SELECT count(0) from " + ConnectionWithAccess.tablename[03] + " where item_code = '" + tbItemCode.Text.Trim() + "' ";
                isItemUsed = ConnectionWithAccess.CheckItemExists(strQuery);

                if (!isItemUsed)
                {
                    try
                    {
                        ConnectionWithAccess.query = "Delete from " + ConnectionWithAccess.tablename[05] + " where item_code = '" + tbItemCode.Text.Trim() + "' ";
                        ConnectionCommand.fUpdateInsertDeleteData();
                        vClearItemDetails();
                        MessageBox.Show("Item '" + tbTitle.Text.Trim() + "' deleted");
                        itemlistmastertab();
                    }
                    catch (Exception ex)
                    {

                    }
                }
                else
                {
                    MessageBox.Show("Item '" + tbTitle.Text.Trim() + "' is in use and cannot be deleted");
                }
            }

        }

        private void vDeleteAccount()
        {
            if (tbd_y.Text == "")
            {
                bool isaccountused = false;
                if (!string.IsNullOrEmpty(tbA_N.Text.Trim()) && !string.IsNullOrEmpty(tbS_A.Text.Trim()))
                {
                    string strQuery = "SELECT count(0) from " + ConnectionWithAccess.tablename[03] + " where a_n = '" + tbA_N.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "'";
                    isaccountused = ConnectionWithAccess.CheckItemExists(strQuery);
                    if (!isaccountused)
                    {
                        strQuery = "SELECT count(0) from " + ConnectionWithAccess.tablename[21] + " where a_n = '" + tbA_N.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "'";
                        isaccountused = ConnectionWithAccess.CheckItemExists(strQuery);
                        if (!isaccountused)
                        {
                            strQuery = "SELECT count(0) from " + ConnectionWithAccess.tablename[22] + " where a_n = '" + tbA_N.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "'";
                            isaccountused = ConnectionWithAccess.CheckItemExists(strQuery);
                            if (!isaccountused)
                            {
                                strQuery = "SELECT count(0) from " + ConnectionWithAccess.tablename[23] + " where a_n = '" + tbA_N.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "'";
                                isaccountused = ConnectionWithAccess.CheckItemExists(strQuery);
                                if (!isaccountused)
                                {
                                    strQuery = "SELECT count(0) from " + ConnectionWithAccess.tablename[24] + " where a_n = '" + tbA_N.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "'";
                                    isaccountused = ConnectionWithAccess.CheckItemExists(strQuery);
                                    if (!isaccountused)
                                    {
                                        strQuery = "SELECT count(0) from " + ConnectionWithAccess.tablename[25] + " where a_n = '" + tbA_N.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "'";
                                        isaccountused = ConnectionWithAccess.CheckItemExists(strQuery);
                                        if (!isaccountused)
                                        {
                                            strQuery = "SELECT count(0) from " + ConnectionWithAccess.tablename[30] + " where a_n = '" + tbA_N.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "'";
                                            isaccountused = ConnectionWithAccess.CheckItemExists(strQuery);
                                        }
                                    }
                                }
                            }
                        }
                    }
                    if (!isaccountused)
                    {
                        try
                        {
                            ConnectionWithAccess.query = "Delete from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + tbA_N.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "'";
                            ConnectionCommand.fUpdateInsertDeleteData();
                            ConnectionWithAccess.query = "Delete from " + ConnectionWithAccess.tablename[04] + " where a_n = '" + tbA_N.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "'";
                            ConnectionCommand.fUpdateInsertDeleteData();
                            MessageBox.Show("Account '" + tbDesc.Text.Trim() + "' deleted");
                            itemlistmastertab();
                        }
                        catch (Exception ex)
                        {

                        }
                    }

                    else
                    {
                        MessageBox.Show("Account '" + tbDesc.Text.Trim() + "' is in use and cannot be deleted");
                    }
                }
            }
            else
            {
                bool isaccountused = false;
                if (!string.IsNullOrEmpty(tbA_N.Text.Trim()) && !string.IsNullOrEmpty(tbS_A.Text.Trim()) && !string.IsNullOrEmpty(tbd_y.Text.Trim()))
                {
                    string strQuery = "SELECT count(0) from " + ConnectionWithAccess.tablename[21] + " where a_n = '" + tbA_N.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "' and d_y = '" + tbd_y.Text.Trim() + "'";
                    isaccountused = ConnectionWithAccess.CheckItemExists(strQuery);
                    //if (!isaccountused)
                    //{
                    //    strQuery = "SELECT count(0) from " + ConnectionWithAccess.tablename[21] + " where a_n = '" + tbA_N.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "' and d_y = '" + tbd_y.Text.Trim() + "'";
                    //    isaccountused = ConnectionWithAccess.CheckItemExists(strQuery);
                    //}
                    if (!isaccountused)
                    {
                        try
                        {
                            ConnectionWithAccess.query = "Delete from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + tbA_N.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "' and d_y = '" + tbd_y.Text.Trim() + "' ";
                            ConnectionCommand.fUpdateInsertDeleteData();
                            ConnectionWithAccess.query = "Delete from " + ConnectionWithAccess.tablename[04] + " where a_n = '" + tbA_N.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "' and s_a = '" + tbS_A.Text.Trim() + "'";
                            ConnectionCommand.fUpdateInsertDeleteData();
                            MessageBox.Show("Account '" + tbdelivery.Text.Trim() + "' deleted");
                            refresh_master_account();
                        }
                        catch (Exception ex)
                        {

                        }
                    }

                    else
                    {
                        MessageBox.Show("Account '" + tbDesc.Text.Trim() + "' is in use and cannot be deleted");
                    }
                }
            }
        }

        private void atbDelete_Click(object sender, EventArgs e)
        {
            if (maintab.SelectedIndex == 2)
            {
                if (subtabMasters.SelectedIndex == 0)
                {
                    vDeleteAccount(); //Delete Account
                }
                else if (subtabMasters.SelectedIndex == 1)
                {
                    vDeleteItem(); //Delete Item
                }
            }
        }

        private void btn_music_Click(object sender, EventArgs e)
        {
            report_filename = null;
            if (maintab.SelectedIndex == 1)
            {
                if (subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
                {
                    if (periodofgst)
                    {
                        Printing_delivery_challan();
                    }
                }
            }
        }

        private void crdatetime_ValueChanged(object sender, EventArgs e)
        {
            if (crdbc.Text != "")
            {
                temp_int = 0;
                ConnectionWithAccess.query = "select f24.d_d, f24.d_n, f1.[desc] as [Desc], f1.city, f24.camt, f24.mess, f24.a_n, f24.s_a from " + ConnectionWithAccess.tablename[24] + " f24  inner join " + ConnectionWithAccess.tablename[01] + " f1 on f24.a_n = f1.a_n and f24.s_a = f1.s_a where prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + crdbc.Text + " and f24.d_d = @D_D_Date";
                search_on_particular_date_in_select_query("@d_d_date", crdatetime.Value);
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    for (row_counter = 0; dtData1.Rows.Count > row_counter; row_counter++)
                    {
                        if (dtData1.Rows[row_counter][1] != null)
                            temp_int = Convert.ToInt32(dtData1.Rows[row_counter][1].ToString()) + 1;
                    }
                    crdocno.Text = temp_int.ToString();
                }
                else
                    crdocno.Text = "1";
            }
        }

        private string strSelectedFont = string.Empty;

        private void atbfont_Click(object sender, EventArgs e)
        {
            DialogResult result = fontDialog1.ShowDialog();
            if (result == DialogResult.OK)
            {
                foreach (Control c in this.Controls)
                {
                    c.Font = fontDialog1.Font;
                }
                var cvt = new FontConverter();
                //string s = cvt.ConvertToString(this.Font);
                strSelectedFont = cvt.ConvertToString(fontDialog1.Font);
                read_company_text_file();
                ConnectionWithAccess.company_font = cvt.ConvertToString(fontDialog1.Font);//.ToString();
                ConnectionWithAccess.company_details[35] = cvt.ConvertToString(fontDialog1.Font);//.ToString();
                save_company_text_file_from_memory();
            }
        }

        private void tbItemCode_TextChanged(object sender, EventArgs e)
        {

        }

        private void tbItemCode_KeyPress(object sender, KeyPressEventArgs e)
        {
            if (tbItemCode.Text != "")
            {
                master_item_help.Visible = false;
                ConnectionWithAccess.query = "select [title] from " + ConnectionWithAccess.tablename[05] + " where [type] = '" + tbItemType.Text.Trim() + "' and [item_code] LIKE '" + tbItemCode.Text.Trim() + "*'";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();

                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        tbTitle.Text = dtData1.Rows[0][0].ToString();
                    }
                }
            }
        }

        private void ItemListDG_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                tbTitle.Text = Convert.ToString(ItemListDG.CurrentRow.Cells[2].Value);
                update_masters_items_screen_details(tbTitle.Text);
            }
            else
            {
                if (e.KeyCode == Keys.Down)
                {
                    rowIndex = ItemListDG.CurrentRow.Index + 1;
                    tbTitle.Text = Convert.ToString(ItemListDG.Rows[rowIndex].Cells[2].Value);
                    update_masters_items_screen_details(tbTitle.Text);
                }
                else if (e.KeyCode == Keys.Up)
                {
                    rowIndex = ItemListDG.CurrentRow.Index - 1;
                    tbTitle.Text = Convert.ToString(ItemListDG.Rows[rowIndex].Cells[2].Value);
                    update_masters_items_screen_details(tbTitle.Text);
                }
            }
        }

        private void sritemlist_RowValidating(object sender, DataGridViewCellCancelEventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Sale Replacement Item";
            calculateSalereplaceItemTotal();
        }

        private void pb_data_migration_Click(object sender, EventArgs e)
        {
            try
            {
                disable_all_keys();
                pb_data_migration.Visible = false;
                update_database_text_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\" + ConnectionWithAccess.mNIK + "a_i_o.txt";
                if (File.Exists(update_database_text_filename))
                {
                    reload_from_file = File.ReadAllLines(update_database_text_filename);
                    for (int i = 0; i < reload_from_file.Length - 1; i++)
                    {
                        word = reload_from_file[i];
                        this.Text = "Please wait Updating Database File " + word;
                        if (word != null && word != "")
                        {
                            if (word.Contains("File"))
                            {
                                if (word.Contains("File END"))
                                {
                                    i++;
                                    if (i < reload_from_file.Length)
                                        word = reload_from_file[i];
                                }
                                file_number = word.Substring(6, word.Length - 6);
                                if (file_number == "025")
                                    temp_word = "Sanjay";
                                if (i < reload_from_file.Length - 1)
                                {
                                    i++;
                                    word = reload_from_file[i];
                                    field_name = word.Split(new[] { ',' });
                                    fieldnamedata = word;
                                    if (file_number != "70" && file_number != "27")
                                    {
                                        //truncate(file_number);
                                        delete_data_before_date(file_number, dtp_import_before.Value.ToShortDateString());
                                    }
                                }
                            }
                            else
                            {
                                if (file_number == "003")
                                {
                                    if (i == 3248)
                                        new_word = "Sanjay";
                                    new_word = "";
                                    data_in_record = word.Split(new[] { ',' });
                                    for (row_counter = 0; row_counter < data_in_record.Length; row_counter++)
                                    {
                                        if (row_counter != 7)
                                            new_word += data_in_record[row_counter] + " ,";
                                        else
                                            if (data_in_record[row_counter].Trim() == "''")
                                                new_word += "0,";
                                            else
                                                new_word += data_in_record[row_counter].Replace("'", "") + " ,";
                                    }
                                    new_word = new_word.Substring(0, new_word.Length - 1);
                                    word = new_word;
                                    record_number = i.ToString();
                                }
                                else if (file_number == "051")
                                {
                                    if (i == 3248)
                                        new_word = "Sanjay";
                                    new_word = "";
                                    data_in_record = word.Split(new[] { ',' });
                                    for (row_counter = 0; row_counter < data_in_record.Length; row_counter++)
                                    {
                                        if (row_counter == 0)
                                            new_word += data_in_record[row_counter].Replace("'", "") + "0,";
                                        else if (row_counter != 6 && row_counter != 7 && row_counter != 10 && row_counter != 11 && row_counter != 13)
                                            new_word += data_in_record[row_counter] + " ,";
                                        else
                                            if (data_in_record[row_counter].Trim() == "''")
                                                new_word += "0.00,";
                                            else if (!data_in_record[row_counter].Contains("."))
                                                new_word += data_in_record[row_counter] + ".00,";
                                            else
                                                new_word += data_in_record[row_counter].Replace("'", "") + " ,";
                                    }
                                    new_word = new_word.Substring(0, new_word.Length - 1);
                                    word = new_word;
                                    record_number = i.ToString();
                                }
                                if (file_number != null && file_number != "" && fieldnamedata != null && fieldnamedata != "" && word != null && word != "")
                                {
                                    if (file_number != "001" && file_number != "004" && file_number != "005" && file_number != "006")
                                        insert_table_data(file_number, fieldnamedata, word);
                                }
                            }
                        }
                    }
                }
                else
                {
                    MessageBox.Show("Import Text File Not Found");
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
            btn_clean_data_Click(sender, e);
            enable_all_keys();
            pb_data_migration.Visible = true;
        }

        private void btn_clean_data_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Cleaning Database Files");
            objPleaseWait.Show();
            Application.DoEvents();
            update_s_a_column_data();
            check_for_compulsory_records();
            remove_records_with_zero_amounts();
            remove_records_with_blank_a_n_s_a_d_y();
            replace_all_opening_and_closing_stock_with_zero_for_null();
            if (ConnectionWithAccess.mNIK == "AP2")
            {
                update_gp_per_of_ap2();
                repair_bank_data_for_ap2();
            }
            if (ConnectionWithAccess.mNIK == "AP1")
                remove_records_for_period_before_t_from_ap1();

            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[5] + " where [title] = '' ";
            ConnectionCommand.fUpdateInsertDeleteData();

            objPleaseWait.Close();
        }

        private void check_for_compulsory_records()
        {
            ConnectionWithAccess.query = "select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = '719999'";
            DataTable dtdata1 = ConnectionCommand.fGetDataTable();
            if (dtdata1 != null && dtdata1.Rows.Count == 0)
            {
                ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[01] + " (r_c, a_n,s_a,[desc]) values('3', '719999',  '@@@','GROSS PROFIT')";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
            ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[23] + " where a_n = '2010'";
            dtdata1 = ConnectionCommand.fGetDataTable();
            if (dtdata1 != null && dtdata1.Rows.Count > 0)
            {
                ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[23] + " set a_n = '2011' where d_c = 3 and tran_d_c <> 0 and a_n = '2010'";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
        }

        private void repair_bank_data_for_ap2()
        {
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[23] + " set a_n = '2011' where d_c = 3 and tran_d_c <> 0";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[23] + " set a_n = '201109' where d_c = 9 and tran_d_c <> 0";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[23] + " set a_n = '201112' where d_c = 12 and tran_d_c <> 0";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[23] + " set a_n = '201121' where d_c = 21 and tran_d_c <> 0";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[23] + " set a_n = '201131' where d_c = 31 and tran_d_c <> 0";
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void update_gp_per_of_ap2()
        {

            //                                                                                                      N
            temp_word = "-65,-158,-61.95,-30,-36,20,-42.7305,-20.21,-60.501,-147.1653,-62.9988,-56.83982,-26.4953,-34.9938,-47.7325,2.75,-30.5,48.55134,100,80";
            var cellArray = temp_word.Split(new[] { ',' });
            for (int i = 0; i < 20; i++)
            {
                ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[50] + " set gp = " + cellArray[i] + " where prd = '" + Convert.ToChar(i + 65) + "'";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
        }

        private void update_s_a_column_data()
        {
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[01] + " set s_a='@@@' where s_a is null or s_a ='' or s_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[03] + " set s_a='@@@' where s_a is null or s_a ='' or s_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[04] + " set s_a='@@@' where s_a is null or s_a ='' or s_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[21] + " set s_a='@@@' where s_a is null or s_a ='' or s_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[22] + " set s_a='@@@' where s_a is null or s_a ='' or s_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[23] + " set s_a='@@@' where s_a is null or s_a ='' or s_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[24] + " set s_a='@@@' where s_a is null or s_a ='' or s_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[25] + " set s_a='@@@' where s_a is null or s_a ='' or s_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[25] + " set ns_a='@@@' where ns_a is null or ns_a ='' or ns_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[26] + " set s_a='@@@' where s_a is null or s_a ='' or s_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[27] + " set s_a='@@@' where s_a is null or s_a ='' or s_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[30] + " set s_a='@@@' where s_a is null or s_a ='' or s_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[51] + " set s_a='@@@' where s_a is null or s_a ='' or s_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[70] + " set s_a='@@@' where s_a is null or s_a ='' or s_a =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[01] + " set d_y='@@@' where d_y is null or d_y ='' or d_y =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[04] + " set d_y='@@@' where d_y is null or d_y ='' or d_y =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[21] + " set d_y='@@@' where d_y is null or d_y ='' or d_y =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[22] + " set d_y='@@@' where d_y is null or d_y ='' or d_y =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[23] + " set d_y='@@@' where d_y is null or d_y ='' or d_y =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[24] + " set d_y='@@@' where d_y is null or d_y ='' or d_y =' '";
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void remove_records_with_zero_amounts()
        {

            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[51] + " where amt = 0.00";
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void remove_records_for_period_before_t_from_ap1()
        {

            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[03] + " where prd < 'T'";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[21] + " where prd < 'T'";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[22] + " where prd < 'T'";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[23] + " where prd < 'T'";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[24] + " where prd < 'T'";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[25] + " where prd < 'T'";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[51] + " where prd < 'T'";
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void remove_records_with_blank_a_n_s_a_d_y()
        {
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[01] + " where a_n = ''";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[21] + " where a_n = ''";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[22] + " where a_n = ''";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[23] + " where a_n = ''";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[24] + " where a_n = ''";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[25] + " where a_n = '' and s_a = '@@@' and na_n = '' and ns_a = '@@@' and d_n <> 999999";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[30] + " where a_n = ''";
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void replace_all_opening_and_closing_stock_with_zero_for_null()
        {

            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[05] + " set opn_stk = 0 where opn_stk is null";
            ConnectionCommand.fUpdateInsertDeleteData();
            ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[05] + " set clo_stk = 0 where clo_stk is null";
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void pb_calculator_Click(object sender, EventArgs e)
        {
            System.Diagnostics.Process.Start("calc");
        }

        private void pb_company_details_Click(object sender, EventArgs e)
        {
            if (chbPrivCompInE.Checked)
            {
                maintab.SelectedIndex = 4;
                maintab_Click(sender, e);
                subtabsettings.SelectedIndex = 2;
                subtabsettings_Click(sender, e);
                if (File.Exists(ConnectionWithAccess.mDataFile))
                    read_company_text_file();
            }
        }

        private void cb_change_master_account_name_Click(object sender, EventArgs e)
        {
            if (cb_change_master_account_name.Checked)
                tbDesc.ReadOnly = false;
            else
                tbDesc.ReadOnly = true;
        }

        private void tbA_N_TextChanged(object sender, EventArgs e)
        {
            temp_a_n = tbA_N.Text;
            temp_s_a = tbS_A.Text;
            get_account_details_from_01(tbA_N.Text, "@@@");
            lbl_account_name.Text = account_detail_from_01[4];
        }

        private void cb_change_item_name_CheckedChanged(object sender, EventArgs e)
        {
            if (cb_change_item_name.Checked)
                tbTitle.ReadOnly = false;
            else
                tbTitle.ReadOnly = true;
        }

        private void pb_party_balance_Click(object sender, EventArgs e)
        {
            maintab.SelectedIndex = 3;
            maintab_Click(sender, e);
            subtabreports.SelectedIndex = 1;
            subtabreports_Click(sender, e);
        }

        private void pb_sale_report_Click(object sender, EventArgs e)
        {
            maintab.SelectedIndex = 3;
            maintab_Click(sender, e);
            subtabreports.SelectedIndex = 0;
            subtabreports_Click(sender, e);
            cbRepType.SelectedIndex = 0;
        }

        private void pb_purchase_report_Click(object sender, EventArgs e)
        {
            maintab.SelectedIndex = 3;
            maintab_Click(sender, e);
            subtabreports.SelectedIndex = 0;
            subtabreports_Click(sender, e);
            cbRepType.SelectedIndex = 1;
        }

        private void btn_import_latest_version_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait downloading latest Setup");
            objPleaseWait.Show();
            Application.DoEvents();
            setup_filename = ConnectionWithAccess.data_drive + "\\ACC\\SHARP SETUP\\SHARP_setup";
            setup_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes + ".exe";
            ConnectionWithAccess.create_file_folder(setup_filename);
            FileDownloader.DownloadFileFromURLToPath("https://drive.google.com/open?id=0B6_3MAhBDc65bDJXQ3ltNWRPR00", setup_filename);
            objPleaseWait.Close();
            MessageBox.Show("Latest version downloaded at " + setup_filename);
        }

        private void btn_latest_exe_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait downloading latest Exe");
            objPleaseWait.Show();
            Application.DoEvents();
            exe_filename = myExeDir.Substring(0, 3) + "sharp\\sharp_latest\\sharp accounting.exe";
            ConnectionWithAccess.create_file_folder(exe_filename);
            FileDownloader.DownloadFileFromURLToPath("https://drive.google.com/open?id=0B6_3MAhBDc65aEtYbGphMmRJdFk", exe_filename);
            objPleaseWait.Close();
            MessageBox.Show("Latest version downloaded at " + exe_filename);
            string latest_setup_exe;
            latest_setup_exe = myExeDir.Substring(0, 3) + "sharp\\get_latest_software.exe";
            if (File.Exists(latest_setup_exe))
            {
                Process.Start(latest_setup_exe);
                login_user_time_out();
                System.Environment.Exit(1);
                System.Windows.Forms.Application.Exit();
                Application.Exit();
                this.Close();
            }
            else
            {
                MessageBox.Show("Sorry, Supported Latest_setup_exe File Not Found. Reinstall Setup & try Again");
            }
        }

        private void filedownloadcomplete(object sender, AsyncCompletedEventArgs e)
        {
            MessageBox.Show("Download Completed");
        }

        /// Download a file
        /// Documentation: https://developers.google.com/drive/v2/reference/files/get
        /// 

        /// a Valid authenticated DriveService
        /// File resource of the file to download
        /// location of where to save the file including the file name to save it as.
        /// 

        //public static Boolean downloadFile(DriveService _service, File _fileResource, string _saveTo)
        //{

        //    if (!String.IsNullOrEmpty(_fileResource.DownloadUrl))
        //    {
        //        try
        //        {
        //            var x = _service.HttpClient.GetByteArrayAsync(_fileResource.DownloadUrl);
        //            byte[] arrBytes = x.Result;
        //            System.IO.File.WriteAllBytes(_saveTo, arrBytes);
        //            return true;
        //        }
        //        catch (Exception e)
        //        {
        //            Console.WriteLine("An error occurred: " + e.Message);
        //            return false;
        //        }
        //    }
        //    else
        //    {
        //        // The file doesn't have any content stored on Drive.
        //        return false;
        //    }
        //}

        void wc_DownloadProgressChanged(object sender, DownloadProgressChangedEventArgs e)
        {
            //pb_latest_version.Value = e.ProgressPercentage;
        }

        private void pb_emerg_stock_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Emerging Data");
            objPleaseWait.Show();
            Application.DoEvents();
            temp_double = 0.0;
            item_stock.Clear();
            ConnectionWithAccess.query = "select [type], item_code,opn_stk,clo_stk from " + ConnectionWithAccess.tablename[05];
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                int mcolumncount = dtData1.Columns.Count;
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temp_word = "";
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        temp_word += (dtData1.Rows[iRowCount][i].ToString()) + " ,";
                    }
                    temp_word = temp_word.Substring(0, temp_word.Length - 1);
                    item_stock.Add(temp_word);
                }
            }

            for (int i = 0; i < item_stock.Count(); i++)
            {

                var cellArray = item_stock[i].Split(new[] { ',' });
                temp_double = Convert.ToDouble(cellArray[2].ToString());
                ConnectionWithAccess.query = "update " + ConnectionWithAccess.tablename[05] + " set [clo_stk] = " + temp_double + " where [type] = '" + cellArray[0].ToString() + "' and [item_code] = '" + cellArray[1].ToString() + "'";
                ConnectionCommand.fUpdateInsertDeleteData();
            }
            item_stock.Clear();
            ConnectionWithAccess.query = "select [type], item_code,qty,'P' from " + ConnectionWithAccess.tablename[03] + " where a_n like '4002%'";
            dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                int mcolumncount = dtData1.Columns.Count;
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temp_word = "";
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        temp_word += (dtData1.Rows[iRowCount][i].ToString()) + " ,";
                    }
                    temp_word = temp_word.Substring(0, temp_word.Length - 1);
                    item_stock.Add(temp_word);
                }
            }
            ConnectionWithAccess.query = "select [type], item_code,qty,'S' from " + ConnectionWithAccess.tablename[03] + " where a_n like '2002%'";
            dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                int mcolumncount = dtData1.Columns.Count;
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    temp_word = "";
                    for (int i = 0; i <= mcolumncount - 1; i++)
                    {
                        temp_word += (dtData1.Rows[iRowCount][i].ToString()) + " ,";
                    }
                    temp_word = temp_word.Substring(0, temp_word.Length - 1);
                    item_stock.Add(temp_word);
                }
            }
            for (int i = 0; i < item_stock.Count(); i++)
            {
                var cellArray = item_stock[i].Split(new[] { ',' });
                if (cellArray[3].ToString() == "P")
                    add_item_stock_in_05_using_type_item_code(cellArray[0], cellArray[1], (Convert.ToDouble(cellArray[2])));
                else
                    add_item_stock_in_05_using_type_item_code(cellArray[0], cellArray[1], (Convert.ToDouble(cellArray[2]) * -1));
                this.Text = "Please wait Emerging " + item_stock[i];
            }
            objPleaseWait.Close();
            this.Text = text_to_display_on_top;
        }

        private void pb_send_bulk_sms_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Sending Bulk Sms");
            objPleaseWait.Show();
            Application.DoEvents();
            SMS.SendSMS(tb_sms_mobilenumber.Text, rtb_sms_content.Text, "User Setting");
            //update_sms_table(tb_sms_mobilenumber.Text, rtb_sms_content.Text, "User Setting", SMS.sms_response);
            objPleaseWait.Close();
            //(string strMobileNo, string strMsg, string from_position, string response)
            //using (System.Net.WebClient client = new System.Net.WebClient()) ;
            //try
            //{
            //    string url = "http://www.smsjust.com/blank/sms/user/urlsms.php?username=sanjayailani&response=Y&pass=sanjay@1234&senderid=ANUPEG&dest_mobileno={0}&message={1}";
            //    //string result = client.DownloadString(url);
            //    //string result=Client
            //    //if (result.Contains("OK"))
            //    //    MessageBox.Show("Your message has been successfully Sent.", "Message", MessageBoxButtons.OK, MessageBoxIcon.Information);
            //    //else
            //    //    MessageBox.Show("Message send failuer.", "Message", MessageBoxButtons.OK, MessageBoxIcon.Information);
            //}

            //catch (Exception ex)
            //{
            //    MessageBox.Show(ex.Message, "Message", MessageBoxButtons.OK, MessageBoxIcon.Error);

            //}

        }

        private void blstgp_per_KeyPress(object sender, KeyPressEventArgs e)
        {
            gp_percentage_change = true;
        }

        private void blstclosingstock_KeyPress(object sender, KeyPressEventArgs e)
        {
            gp_percentage_change = false;
        }

        private void prpartycode_TextChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Purchase Replacement";
            if (!bsrPartyChangeIgnore)
            {
                ConnectionWithAccess.query = "select [desc], city, a_n, s_a,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[22] + " where d_c = " + Convert.ToInt32(prdbc.Text) + " and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[22] + " where d_c = " + Convert.ToInt32(prdbc.Text) + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='@@@') and [desc] like '%" + prpartycode.Text + "%'";
                ConnectionCommand.accountHelp_datatable(pr_acc_help_dgv, "pr_acc_help_dgv");
                if (pr_acc_help_dgv.Rows.Count == 1)
                {
                    ConnectionWithAccess.query = "select [desc], city, a_n, s_a,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[22] + " where d_c = " + Convert.ToInt32(prdbc.Text) + " and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[22] + " where d_c = " + Convert.ToInt32(prdbc.Text) + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='@@@') and [city] like '%" + prpartycode.Text + "%'";
                    ConnectionCommand.accountHelp_datatable(pr_acc_help_dgv, "pr_acc_help_dgv");
                }
            }
        }

        private void prpartycode_KeyPress(object sender, KeyPressEventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Purchase Replacement";
            pr_acc_help_dgv.Visible = true;
        }

        private void prdbc_SelectedIndexChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[30] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + Convert.ToInt32(prdbc.Text);
            ConnectionCommand.ExportToText(prdbc, prdocno);
            ConnectionWithAccess.md_n = prdocno.Text;
            pra_n.Text = get_a_n_from_d_c("P", Convert.ToInt32(prdbc.Text));
                ConnectionWithAccess.query = "select a_n from " + ConnectionWithAccess.tablename[30] + " where d_c = " + Convert.ToInt32(prdbc.Text) + " and d_n = 999999";
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        pra_n.Text = dtData1.Rows[0][0].ToString();
                    }
                }
        }

        private void prpurchaselistdg_Click(object sender, EventArgs e)
        {
            prdatetime.Value = Convert.ToDateTime(prpurchaselistdg.SelectedCells[0].Value);
            prdocno.Text = Convert.ToString(prpurchaselistdg.SelectedCells[1].Value);
            oldpurcreplacementdetails();
            //sale_replacement_item_filling();
            prpartycode.Enabled = false;
        }

        private void pr_acc_help_dgv_Click(object sender, EventArgs e)
        {

        }

        private void btn_notepad_Click(object sender, EventArgs e)
        {
            string filename = "Default";
            if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0)
                filename = "Sale";
            else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 1)
                filename = "Purchase";
            else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 2)
                filename = "Bank";
            else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 3)
                filename = "Cash";
            else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 4)
                filename = "Journal";
            else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 5)
                filename = "Additional";
            else if (maintab.SelectedIndex == 2 && subtabMasters.SelectedIndex == 0)
                filename = "Account";
            else if (maintab.SelectedIndex == 2 && subtabMasters.SelectedIndex == 1)
                filename = "Item";
            else if (maintab.SelectedIndex == 2 && subtabMasters.SelectedIndex == 2)
                filename = "Tax";
            else if (maintab.SelectedIndex == 2 && subtabMasters.SelectedIndex == 3)
                filename = "DayBook";
            else if (maintab.SelectedIndex == 2 && subtabMasters.SelectedIndex == 4)
                filename = "Period";
            else if (maintab.SelectedIndex == 2 && subtabMasters.SelectedIndex == 5)
                filename = "MastersAdditional";

            notepad_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\excel Reports\\" + filename + ".txt";
            Process.Start("notepad.exe", notepad_filename);
        }

        public void update_sms_table(string strMobileNo, string strMsg, string from_position, string response)
        {

            ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[10] + " (d_d_time,senderid, mobilenumber, message, from_position,response,[user]) values(#" + DateTime.Now + "# , '" + ConnectionWithAccess.com_senderid + "', '" + strMobileNo + "', '" + strMsg + "', '" + from_position + "', '" + response + "', '" + ConnectionWithAccess.muser + "')";
            ConnectionCommand.fUpdateInsertDeleteData();
        }

        private void sendsms()
        {
            ConnectionWithAccess.query = "select mobilenumber from " + ConnectionWithAccess.tablename[10] + " order by mobilenumber";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            lbl_balance_sms_count.Text = "Available Sms : " + (total_sms_count - dtData1.Rows.Count).ToString();
            if ((total_sms_count - dtData1.Rows.Count) > 1)
            {
                PleaseWait objPleaseWait = new PleaseWait("Please wait Sending Sms");
                objPleaseWait.Show();
                Application.DoEvents();
                if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
                {
                    //text_for_sms = "Thanks for Purchasing Goods worth Rs. " + sigrossamt.Text + " From M/s." + ConnectionWithAccess.company_details[1] + " ," + ConnectionWithAccess.company_details[4] + " against invoice # " + sidocno.Text + " dt. " + sidatetime.Text;
                    text_for_sms = "Thanks for Purchasing Goods worth Rs. " + sigrossamt.Text + " From M/s." + ConnectionWithAccess.company_details[1] + " ," + ConnectionWithAccess.company_details[4] + " on " + sidatetime.Text;
                    SMS.SendSMS(tb_si_mobilenumber.Text, text_for_sms, "Sale Invoice");
                    update_sms_table(tb_si_mobilenumber.Text, text_for_sms, "Sale Invoice", SMS.sms_response);
                }
                else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 1 && subtabsale.SelectedIndex == 0)
                {
                    get_account_details_from_01(pia_n.Text, pis_a.Text);
                    text_for_sms = "Purchased Goods worth Rs. " + pigrossamt.Text + " From M/s." + account_detail_from_01[4] + " ," + account_detail_from_01[8] + ".";
                    SMS.SendSMS(tb_pi_mobilenumber.Text, text_for_sms, "Sale Invoice");
                    update_sms_table(tb_si_mobilenumber.Text, text_for_sms, "Sale Invoice", SMS.sms_response);
                }
                else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 2 && subtabbank.SelectedIndex == 0)
                {
                    get_account_details_from_01(bra_n.Text, brs_a.Text);
                    text_for_sms = "Thanks received Payment of Rs. " + bramt.Text + " From M/s." + account_detail_from_01[4] + " ," + account_detail_from_01[8] + ".";
                    //SMS.SendSMS(tb_br_mobilenumber.Text, text_for_sms, "Sale Invoice");
                    update_sms_table(tb_pi_mobilenumber.Text, text_for_sms, "Bank Receipt", SMS.sms_response);
                }
                else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 2 && subtabbank.SelectedIndex == 1)
                {
                    get_account_details_from_01(bpa_n.Text, bps_a.Text);
                    text_for_sms = "Alloted Payment through Bank of Rs. " + bpamt.Text + " to " + account_detail_from_01[4] + " ," + account_detail_from_01[8] + ".";
                    //SMS.SendSMS(si_mobilenumber.Text, text_for_sms, "Sale Invoice");
                    update_sms_table(tb_br_mobilenumber.Text, text_for_sms, "Bank Payment", SMS.sms_response);
                }
                //else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 2 && subtabbank.SelectedIndex == 2)
                //{
                //    get_account_details_from_01(bda_n.Text, bds_a.Text);
                //    text_for_sms = "Thanks received Payment of Rs. " + bdamt.Text + " From M/s." + account_detail_from_01[4] + " ," + account_detail_from_01[8] + ".";
                //    //SMS.SendSMS(si_mobilenumber.Text, text_for_sms, "Sale Invoice");
                //    update_sms_table(tb_bd_mobilenumber.Text, text_for_sms, "Bank Deposit", SMS.sms_response);
                //}
                //else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 2 && subtabbank.SelectedIndex == 3)
                //{
                //    get_account_details_from_01(bwa_n.Text, bws_a.Text);
                //    text_for_sms = "Alloted Payment through Bank of Rs. " + bwamt.Text + " to " + account_detail_from_01[4] + " ," + account_detail_from_01[8] + ".";
                //    //SMS.SendSMS(si_mobilenumber.Text, text_for_sms, "Sale Invoice");
                //    update_sms_table(tb_bw_mobilenumber.Text, text_for_sms, "Bank Withdrawal", SMS.sms_response);
                //}
                else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 3 && subtabcash.SelectedIndex == 0)
                {
                    get_account_details_from_01(cra_n.Text, crs_a.Text);
                    text_for_sms = "Thanks received cash Rs. " + cramt.Text + " From M/s." + account_detail_from_01[4] + " ," + account_detail_from_01[8] + ". on " + DateTime.Today.ToShortDateString();
                    //SMS.SendSMS(si_mobilenumber.Text, text_for_sms, "Sale Invoice");
                    update_sms_table(tb_cr_mobilenumber.Text, text_for_sms, "Cash Receipt", SMS.sms_response);
                }
                else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 3 && subtabcash.SelectedIndex == 1)
                {
                    get_account_details_from_01(cpa_n.Text, cps_a.Text);
                    text_for_sms = "Cash paid Rs. " + cpamt.Text + " to " + account_detail_from_01[4] + " ," + account_detail_from_01[8] + ". on " + DateTime.Today.ToShortDateString();
                    //SMS.SendSMS(si_mobilenumber.Text, text_for_sms, "Sale Invoice");
                    update_sms_table(tb_cp_mobilenumber.Text, text_for_sms, "Cash Payment", SMS.sms_response);
                }
                objPleaseWait.Close();
                ConnectionWithAccess.query = "select mobilenumber from " + ConnectionWithAccess.tablename[10] + " order by mobilenumber";
                dtData1 = ConnectionCommand.fGetDataTable();
                lbl_balance_sms_count.Text = "Available Sms : " + (total_sms_count - dtData1.Rows.Count).ToString();
            }
            else
                MessageBox.Show("Sorry, There is no Sms credit available");
        }

        private void pb_si_sendsms_Click(object sender, EventArgs e)
        {
            sendsms();
        }

        private void sisalelistdg_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data..");
            objPleaseWait.Show();
            Application.DoEvents();
            PopulateSaleDetails();
            objPleaseWait.Close();
        }

        private void braccname_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (brdbc.Items.Count > braccname.SelectedIndex)
                brdbc.SelectedIndex = braccname.SelectedIndex;
        }

        private void bpaccname_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (bpdbc.Items.Count > bpaccname.SelectedIndex)
                bpdbc.SelectedIndex = bpaccname.SelectedIndex;
        }

        private void bdbankname_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (bddbc.Items.Count > bdbankname.SelectedIndex)
                bddbc.SelectedIndex = bdbankname.SelectedIndex;
        }

        private void bwbankname_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (bwdbc.Items.Count > bwbankname.SelectedIndex)
                bwdbc.SelectedIndex = bwbankname.SelectedIndex;
        }

        private void tbCity_KeyPress(object sender, KeyPressEventArgs e)
        {
            dgvStdCodeHelp.Visible = true;
        }

        private void tb_si_mobilenumber_TextChanged(object sender, EventArgs e)
        {
            if (maintab.SelectedIndex == 1)
            {
                if (subtabDataEntry.SelectedIndex == 0)
                {
                    if (tb_si_mobilenumber.Text.Length == 10 && sale_invoice_saved == true && Convert.ToDouble(sigrossamt.Text) > 0)
                    {
                        tb_si_mobilenumber.Visible = true;
                        pb_si_sendsms.Visible = true;
                    }
                    else
                    {
                        tb_si_mobilenumber.Visible = false;
                        pb_si_sendsms.Visible = false;
                    }
                }
                else if (subtabDataEntry.SelectedIndex == 1)
                {
                    if (tb_pi_mobilenumber.Text.Length == 10 && Convert.ToDouble(pigrossamt.Text) > 0)
                    {
                        tb_pi_mobilenumber.Visible = true;
                        pb_pi_sendsms.Visible = true;
                    }
                    else
                    {
                        tb_pi_mobilenumber.Visible = false;
                        pb_pi_sendsms.Visible = false;
                    }
                }
                else if (subtabDataEntry.SelectedIndex == 2)
                {
                    if (tb_br_mobilenumber.Text.Length == 10 && Convert.ToDouble(bramt.Text) > 0)
                    {
                        tb_br_mobilenumber.Visible = true;
                        pb_br_sendsms.Visible = true;
                    }
                    else
                    {
                        tb_br_mobilenumber.Visible = false;
                        pb_br_sendsms.Visible = false;
                    }
                    if (tb_bp_mobilenumber.Text.Length == 10 && Convert.ToDouble(bpamt.Text) > 0)
                    {
                        tb_bp_mobilenumber.Visible = true;
                        pb_bp_sendsms.Visible = true;
                    }
                    else
                    {
                        tb_bp_mobilenumber.Visible = false;
                        pb_bp_sendsms.Visible = false;
                    }
                    if (tb_bd_mobilenumber.Text.Length == 10 && Convert.ToDouble(bdamt.Text) > 0)
                    {
                        tb_bd_mobilenumber.Visible = true;
                        pb_bd_sendsms.Visible = true;
                    }
                    else
                    {
                        tb_bd_mobilenumber.Visible = false;
                        pb_bd_sendsms.Visible = false;
                    }
                    if (tb_bw_mobilenumber.Text.Length == 10 && Convert.ToDouble(bwamt.Text) > 0)
                    {
                        tb_bw_mobilenumber.Visible = true;
                        pb_bw_sendsms.Visible = true;
                    }
                    else
                    {
                        tb_bw_mobilenumber.Visible = false;
                        pb_bw_sendsms.Visible = false;
                    }
                }
                else if (subtabDataEntry.SelectedIndex == 3)
                {
                    if (tb_cr_mobilenumber.Text.Length == 10 && Convert.ToDouble(cramt.Text) > 0)
                    {
                        tb_cr_mobilenumber.Visible = true;
                        pb_cr_sendsms.Visible = true;
                    }
                    else
                    {
                        tb_cr_mobilenumber.Visible = false;
                        pb_cr_sendsms.Visible = false;
                    }
                    if (tb_cp_mobilenumber.Text.Length == 10 && Convert.ToDouble(cpamt.Text) > 0)
                    {
                        tb_cp_mobilenumber.Visible = true;
                        pb_cp_sendsms.Visible = true;
                    }
                    else
                    {
                        tb_cp_mobilenumber.Visible = false;
                        pb_cp_sendsms.Visible = false;
                    }
                }
            }
        }

        private void srsalelistdg_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data..");
            objPleaseWait.Show();
            Application.DoEvents();
            PopulateSale_replacement_Details();
            objPleaseWait.Close();
        }

        private void populate_screen()
        {
            if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 0)
            {
                get_account_details_from_01(sia_n.Text, sis_a.Text);
                get_account_details_from_04(sia_n.Text, sis_a.Text);
                sipartycode.Text = account_detail_from_01[4];
                sicity.Text = account_detail_from_01[8];
                party_city = account_detail_from_01[4];
                sipartyname.Text = account_detail_from_01[4];
                sipartyaddress.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[6] + " ," + account_detail_from_04[7];
                sicontactdetails.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20];
                sipartybalance.Text = Convert.ToString(calculate_account_balance(sia_n.Text, sis_a.Text, Convert.ToString(sidatetime.Text)));
                if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                    lbl_si_message.Visible = true;
                else
                    lbl_si_message.Visible = false;
                tb_si_mobilenumber.Text = account_detail_from_04[17];
                DispEmail.Text = account_detail_from_04[24];
                party_tin_num = account_detail_from_04[29];
            }
            else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 1)
            {
                get_account_details_from_01(sra_n.Text, srs_a.Text);
                get_account_details_from_04(sra_n.Text, srs_a.Text);
                srpartycode.Text = account_detail_from_01[4];
                srcity.Text = account_detail_from_01[8];
                srpartyname.Text = account_detail_from_01[4];
                srpartyaddress.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[6] + " ," + account_detail_from_04[7];
                srcontactdetails.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20];
                srpartybalance.Text = Convert.ToString(calculate_account_balance(sra_n.Text, srs_a.Text, Convert.ToString(srdatetime.Text)));
            }
            else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 2)
            {
                get_account_details_from_01(soa_n.Text, sos_a.Text);
                get_account_details_from_04(soa_n.Text, sos_a.Text);
                sopartycode.Text = account_detail_from_01[4];
                socity.Text = account_detail_from_01[8];
                sopartyname.Text = account_detail_from_01[4];
                sopartyaddress.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[6] + " ," + account_detail_from_04[7];
                socontactdetails.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20];
                sopartybalance.Text = Convert.ToString(calculate_account_balance(soa_n.Text, sos_a.Text, Convert.ToString(sodatetime.Text)));
            }
            else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 3)
            {
                get_account_details_from_01(simple_a_n.Text, simple_s_a.Text);
                get_account_details_from_04(simple_a_n.Text, simple_s_a.Text);
                simple_partyname.Text = account_detail_from_01[4];
                simple_partycity.Text = account_detail_from_01[8];
                sipartyname.Text = account_detail_from_01[4];
                simple_detail_party_address.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[6] + " ," + account_detail_from_04[7];
                simple_detail_party_contact.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20];
                sipartybalance.Text = Convert.ToString(calculate_account_balance(sia_n.Text, sis_a.Text, Convert.ToString(sidatetime.Text)));
                //if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                //    lbl_si_message.Visible = true;
                //else
                //    lbl_si_message.Visible = false;
                //tb_si_mobilenumber.Text = account_detail_from_04[17];
                //DispEmail.Text = account_detail_from_04[24];
                //party_tin_num = account_detail_from_04[29];
            }

            else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 1 && subtabpurchase.SelectedIndex == 0)
            {
                fill_transport(pia_n.Text, picity.Text, pitransport);
                get_account_details_from_01(pia_n.Text, pis_a.Text);
                get_account_details_from_04(pia_n.Text, pis_a.Text);
                if (ConnectionWithAccess.company_details[5].Trim() != account_detail_from_01[12].Trim())
                    lbl_pi_message.Visible = true;
                else
                    lbl_pi_message.Visible = false;
                tb_pi_mobilenumber.Text = account_detail_from_04[17];
                DispEmail.Text = account_detail_from_04[24];
                pisupplieraddress.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20];
                pisuppliername.Text = account_detail_from_01[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[6] + " ," + account_detail_from_04[7];
                pitransport.Text = account_detail_from_04[30];
                pitaxcode.Text = account_detail_from_04[32];
                pipartybalance.Text = Convert.ToString(calculate_account_balance(pia_n.Text, pis_a.Text, Convert.ToString(pidatetime.Text)));
            }
            else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 2 && subtabbank.SelectedIndex == 0)
            {
                get_account_details_from_01(bra_n.Text, brs_a.Text);
                get_account_details_from_04(bra_n.Text, brs_a.Text);
                tb_br_mobilenumber.Text = account_detail_from_04[17];
                brpartycontact.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20];
                brpartyaddress.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[6] + " ," + account_detail_from_04[7];
            }
            else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 4)
            {
                get_account_details_from_01(ja_n.Text, js_a.Text);
                get_account_details_from_04(ja_n.Text, js_a.Text);
                jjpartycode1.Text = account_detail_from_01[4];
                lbl_payee_name.Text = account_detail_from_01[4];
                lbl_payee_con_details.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20] + " ," + account_detail_from_04[21];
                lbl_payee_address.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[7];
                lbl_payee_overall_balance.Text = Convert.ToString(get_account_balance_from_51(ConnectionWithAccess.mprd, ja_n.Text, js_a.Text));
                get_account_details_from_01(jna_n.Text, jns_a.Text);
                get_account_details_from_04(jna_n.Text, jns_a.Text);
                jjpartycode2.Text = account_detail_from_01[4];
                lbl_payer_name.Text = account_detail_from_01[4];
                lbl_payer_con_details.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20] + " ," + account_detail_from_04[21];
                lbl_payer_address.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[7];
                lbl_payer_overall_balance.Text = Convert.ToString(get_account_balance_from_51(ConnectionWithAccess.mprd, jna_n.Text, jns_a.Text));
            }
        }

        private void LedDGV_DoubleClick(object sender, EventArgs e)
        {
            if (LedDGV.ColumnCount > 0)
            {
                if (LedDGV.CurrentRow.Cells[5].Value.ToString() == "Sale")
                {
                    sidbc.Text = "";
                    temp_prd = LedDGV.CurrentRow.Cells[10].Value.ToString();
                    ConnectionWithAccess.mprd = LedDGV.CurrentRow.Cells[10].Value.ToString();
                    go_to_selected_period(ConnectionWithAccess.mprd);
                    sidbc.Text = LedDGV.CurrentRow.Cells[9].Value.ToString();
                    temp_d_c = Convert.ToInt32(LedDGV.CurrentRow.Cells[9].Value.ToString());
                    temp_a_n = LedDGV.CurrentRow.Cells[11].Value.ToString();
                    temp_s_a = LedDGV.CurrentRow.Cells[12].Value.ToString();
                    sidocno.Text = LedDGV.CurrentRow.Cells[4].Value.ToString();
                    maintab.SelectedIndex = 1;
                    maintab_Click(sender, e);
                    subtabDataEntry.SelectedIndex = 0;
                    subtabDataEntry_Click(sender, e);
                    populate_screen();
                }
                else if (LedDGV.CurrentRow.Cells[5].Value.ToString() == "Purc")
                {
                    pidbc.Text = "";
                    pidocno.Text = ""; // first reset docno to blank and then fill docno
                    temp_prd = LedDGV.CurrentRow.Cells[10].Value.ToString();
                    ConnectionWithAccess.mprd = LedDGV.CurrentRow.Cells[10].Value.ToString();
                    go_to_selected_period(ConnectionWithAccess.mprd);
                    pidbc.Text = LedDGV.CurrentRow.Cells[9].Value.ToString();
                    temp_d_c = Convert.ToInt32(LedDGV.CurrentRow.Cells[9].Value.ToString());
                    temp_a_n = LedDGV.CurrentRow.Cells[11].Value.ToString();
                    temp_s_a = LedDGV.CurrentRow.Cells[12].Value.ToString();
                    pia_n.Text = LedDGV.CurrentRow.Cells[11].Value.ToString();
                    pis_a.Text = LedDGV.CurrentRow.Cells[12].Value.ToString();
                    pipartycode.Text = account_detail_from_01[4];
                    picity.Text = account_detail_from_01[8];
                    pidocno.Text = LedDGV.CurrentRow.Cells[4].Value.ToString();
                    maintab.SelectedIndex = 1;
                    maintab_Click(sender, e);
                    subtabDataEntry.SelectedIndex = 1;
                    subtabDataEntry_Click(sender, e);
                    populate_screen();
                }
                else if (LedDGV.CurrentRow.Cells[5].Value.ToString() == "Bank")
                {
                    if (LedDGV.CurrentRow.Cells[6].Value != System.DBNull.Value && LedDGV.CurrentRow.Cells[6].Value.Equals("0"))
                        subtabcash.SelectedIndex = 1;
                    else
                    {
                        maintab.SelectedIndex = 1;
                        subtabDataEntry.SelectedIndex = 2;
                        temp_prd = LedDGV.CurrentRow.Cells[10].Value.ToString();
                        ConnectionWithAccess.mprd = LedDGV.CurrentRow.Cells[10].Value.ToString();
                        go_to_selected_period(ConnectionWithAccess.mprd);
                        if (Convert.ToDouble(LedDGV.CurrentRow.Cells[7].Value.ToString()) > 0)
                        {
                            maintab_Click(sender, e);
                            subtabDataEntry_Click(sender, e);
                            subtabbank_Click(sender, e);
                            subtabbank.SelectedIndex = 0;
                            brdbc.Text = "";
                            brdocno.Text = "";
                            brdbc.Text = LedDGV.CurrentRow.Cells[9].Value.ToString();
                            temp_d_c = Convert.ToInt32(LedDGV.CurrentRow.Cells[9].Value.ToString());
                            temp_a_n = LedDGV.CurrentRow.Cells[11].Value.ToString();
                            temp_s_a = LedDGV.CurrentRow.Cells[12].Value.ToString();
                            brdatetime.Value = Convert.ToDateTime(LedDGV.CurrentRow.Cells[3].Value.ToString());
                            brdocno.Text = LedDGV.CurrentRow.Cells[4].Value.ToString();
                        }
                        else
                        {
                            maintab_Click(sender, e);
                            subtabDataEntry_Click(sender, e);
                            subtabbank_Click(sender, e);
                            subtabbank.SelectedIndex = 1;
                            bpdbc.Text = "";
                            bpdbc.Text = LedDGV.CurrentRow.Cells[9].Value.ToString();
                            temp_d_c = Convert.ToInt32(LedDGV.CurrentRow.Cells[9].Value.ToString());
                            temp_a_n = LedDGV.CurrentRow.Cells[11].Value.ToString();
                            temp_s_a = LedDGV.CurrentRow.Cells[12].Value.ToString();
                            bpdatetime.Value = Convert.ToDateTime(LedDGV.CurrentRow.Cells[3].Value.ToString());
                            bpdocno.Text = LedDGV.CurrentRow.Cells[4].Value.ToString();
                        }
                    }
                }
                else if (LedDGV.CurrentRow.Cells[5].Value.ToString() == "Cash")
                {
                    maintab.SelectedIndex = 1;
                    subtabDataEntry.SelectedIndex = 3;
                    temp_prd = LedDGV.CurrentRow.Cells[10].Value.ToString();
                    ConnectionWithAccess.mprd = LedDGV.CurrentRow.Cells[10].Value.ToString();
                    go_to_selected_period(ConnectionWithAccess.mprd);
                    if (Convert.ToDouble(LedDGV.CurrentRow.Cells[7].Value.ToString()) > 0)
                    {
                        subtabcash.SelectedIndex = 0;
                        crdbc.Text = "";
                        crdocno.Text = "";
                        crdbc.Text = LedDGV.CurrentRow.Cells[9].Value.ToString();
                        temp_d_c = Convert.ToInt32(LedDGV.CurrentRow.Cells[9].Value.ToString());
                        temp_a_n = LedDGV.CurrentRow.Cells[11].Value.ToString();
                        temp_s_a = LedDGV.CurrentRow.Cells[12].Value.ToString();
                        crdocno.Text = LedDGV.CurrentRow.Cells[4].Value.ToString();
                        maintab_Click(sender, e);
                        subtabDataEntry_Click(sender, e);
                        subtabcash_Click(sender, e);
                    }
                    else
                    {
                        subtabcash.SelectedIndex = 1;
                        temp_word = LedDGV.CurrentRow.Cells[3].Value.ToString();
                        temp_word = temp_word.Substring(0, temp_word.IndexOf(" "));
                        cpdatetime.Value = Convert.ToDateTime(temp_word);
                        cpdbc.Text = null;
                        cpdocno.Text = "";
                        cpdbc.Items.Add(LedDGV.CurrentRow.Cells[9].Value.ToString());
                        cpdbc.SelectedIndex = 0;
                        temp_d_c = Convert.ToInt32(LedDGV.CurrentRow.Cells[9].Value.ToString());
                        temp_a_n = LedDGV.CurrentRow.Cells[11].Value.ToString();
                        temp_s_a = LedDGV.CurrentRow.Cells[12].Value.ToString();
                        cpdocno.Text = LedDGV.CurrentRow.Cells[4].Value.ToString();
                        maintab_Click(sender, e);
                        subtabDataEntry_Click(sender, e);
                        subtabcash_Click(sender, e);
                    }
                }
                else if (LedDGV.CurrentRow.Cells[5].Value.ToString() == "Jour")
                {
                    maintab.SelectedIndex = 1;
                    subtabDataEntry.SelectedIndex = 4;
                    temp_prd = LedDGV.CurrentRow.Cells[10].Value.ToString();
                    ConnectionWithAccess.mprd = LedDGV.CurrentRow.Cells[10].Value.ToString();
                    go_to_selected_period(ConnectionWithAccess.mprd);
                    jjdbc.Text = "";
                    jjdocno.Text = "";
                    jjdbc.Text = LedDGV.CurrentRow.Cells[9].Value.ToString();
                    temp_d_c = Convert.ToInt32(LedDGV.CurrentRow.Cells[9].Value.ToString());
                    temp_a_n = LedDGV.CurrentRow.Cells[11].Value.ToString();
                    temp_s_a = LedDGV.CurrentRow.Cells[12].Value.ToString();
                    jjdocno.Text = LedDGV.CurrentRow.Cells[4].Value.ToString();
                    maintab_Click(sender, e);
                    subtabDataEntry_Click(sender, e);
                    subtabcash_Click(sender, e);
                }

            }
        }

        private void crdocno_TextChanged(object sender, EventArgs e)
        {
            if (crdocno.Text != "")
                oldcashreceiptentry();
        }

        private void oldcashreceiptentry()
        {
            if (crdbc.Text != "")
            {
                ConnectionWithAccess.query = "select f24.d_d, f24.d_n, f1.[desc] as [Desc], f1.city, f24.camt, f24.mess, f24.a_n, f24.s_a from " + ConnectionWithAccess.tablename[24] + " f24  inner join " + ConnectionWithAccess.tablename[01] + " f1 on f24.a_n = f1.a_n and f24.s_a = f1.s_a where prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + crdbc.Text + " and d_n = " + crdocno.Text + " and f24.d_d = @D_D_Date";
                List<ConnectionWithAccess.QueryParams> objParams = new List<ConnectionWithAccess.QueryParams>();
                ConnectionWithAccess.QueryParams ParamFrom = new ConnectionWithAccess.QueryParams();
                ParamFrom.paramName = "@D_D_Date";
                ParamFrom.paramValue = Convert.ToDateTime(crdatetime.Value.ToShortDateString());
                objParams.Add(ParamFrom);
                ConnectionWithAccess.QueryParamList = objParams;
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        crdatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
                        crdatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
                        crdatetime.Value = Convert.ToDateTime(dtData1.Rows[0][0].ToString());
                        crpartycode.Text = dtData1.Rows[0][2].ToString();
                        crpartycity.Text = dtData1.Rows[0][3].ToString();
                        cramt.Text = dtData1.Rows[0][4].ToString();
                        old_cash_receipt_amount = Convert.ToDouble(dtData1.Rows[0][4].ToString());
                        crcomm.Text = dtData1.Rows[0][5].ToString();
                        cra_n.Text = dtData1.Rows[0][6].ToString();
                        crs_a.Text = dtData1.Rows[0][7].ToString();
                        get_account_details_from_01(cra_n.Text, crs_a.Text);
                        get_account_details_from_04(cra_n.Text, crs_a.Text);
                        crpartyname.Text = account_detail_from_01[4] + " ," + account_detail_from_01[8];
                        crpartyaddress.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[6];
                        crpartycontact.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20];
                        crpartybalance.Text = Convert.ToString(calculate_account_balance(cra_n.Text, crs_a.Text, Convert.ToString(crdatetime.Value)));
                        tb_cr_mobilenumber.Text = account_detail_from_04[17];
                        cramt.ReadOnly = false;
                    }
                }
                else
                {
                    tb_cr_mobilenumber.Text = "";
                    cramt.ReadOnly = true;
                    cra_n.Clear();
                    crs_a.Clear();
                    old_cash_receipt_amount = 0;
                    crpartyname.Text = null;
                    crpartyaddress.Text = null;
                    crpartycontact.Text = null;
                    crpartybalance.Text = null;
                    cramt.Text = "0.00";
                    crcomm.Text = null;
                    crcurcashbal.Text = null;
                    crpartycode.Text = null;
                    crpartycity.Text = null;
                }
                crcurcashbal.Text = Convert.ToString(get_cash_balance(ConnectionWithAccess.cash_a_n, "@@@", crdatetime.Value.ToString()));
            }
        }

        private void brdocno_TextChanged(object sender, EventArgs e)
        {
            if (brdocno.Text != "")
                oldbankreceiptentry();
        }

        private void oldbankreceiptentry()
        {
            //ConnectionWithAccess.query = "select f23.d_d, f23.d_n, f1.[desc] as [Desc], f1.city, f23.bamt, f23.mess, f23.a_n, f23.s_a from " + ConnectionWithAccess.tablename[23] + " f23  inner join " + ConnectionWithAccess.tablename[01] + " f1 on f1.a_n = f23.a_n and f1.s_a = f23.s_a where f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_c = " + brdbc.Text + " and f23.d_d = #" + brdatetime.Text + "# and f23.d_n = " + brdocno.Text + " and r_p = '2'";
            ConnectionWithAccess.query = "select f23.d_d, f23.d_n, f1.[desc] as [Desc], f1.city, f23.bamt, f23.mess, f23.a_n, f23.s_a from " + ConnectionWithAccess.tablename[23] + " f23  inner join " + ConnectionWithAccess.tablename[01] + " f1 on f1.a_n = f23.a_n and f1.s_a = f23.s_a where f23.prd = '" + ConnectionWithAccess.mprd + "' and f23.d_c = " + brdbc.Text + " and f23.d_n = " + brdocno.Text + " and r_p = '2'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    brdatetime.MinDate = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
                    brdatetime.MaxDate = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
                    brdatetime.Value = Convert.ToDateTime(dtData1.Rows[0][0].ToString());
                    brpartycode.Text = dtData1.Rows[0][2].ToString();
                    bramt.Text = dtData1.Rows[0][4].ToString();
                    old_cash_receipt_amount = Convert.ToDouble(dtData1.Rows[0][4].ToString());
                    brcomm.Text = dtData1.Rows[0][5].ToString();
                    bra_n.Text = dtData1.Rows[0][6].ToString();
                    brs_a.Text = dtData1.Rows[0][7].ToString();
                    //get_account_details_from_01(bra_n.Text, brs_a.Text);
                    //get_account_details_from_04(bra_n.Text, brs_a.Text);
                    //brpartyname.Text = account_detail_from_01[4] + " ," + account_detail_from_01[8];
                    //brpartyaddress.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[6];
                    //brpartycontact.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20];
                    //brpartyoverallbalance.Text = Convert.ToString(calculate_account_balance(bra_n.Text, brs_a.Text, Convert.ToString(brdatetime.Value)));
                    //tb_br_mobilenumber.Text = account_detail_from_04[17];
                    bramt.ReadOnly = false;
                }
            }
            else
            {
                tb_br_mobilenumber.Text = "";
                bramt.ReadOnly = true;
                bra_n.Clear();
                brs_a.Clear();
                old_cash_receipt_amount = 0;
                brpartyname.Text = null;
                brpartyaddress.Text = null;
                brpartycontact.Text = null;
                brpartyoverallbalance.Text = "0.00";
                bramt.Text = "0.00";
                brcomm.Text = null;
                brpartycode.Text = null;
            }
        }

        private void bp_igst_per_KeyUp(object sender, KeyEventArgs e)
        {
            if (bp_basicamt.Text != "")
            {
                if (bp_igst_per.Text != "0.00" && bp_igst_per.Text != "")
                    bp_igstamt.Text = (Convert.ToDouble(bp_basicamt.Text) * Convert.ToDouble(bp_igst_per.Text) / 100).ToString();
                bpamt.Text = (Convert.ToDouble(bp_basicamt.Text) + Convert.ToDouble(bp_igstamt.Text)).ToString();
            }
        }

        private void bp_basicamt_KeyUp(object sender, KeyEventArgs e)
        {
            if (bp_basicamt.Text != "")
            {
                if (bp_igst_per.Text != "0.00" && bp_igst_per.Text != "")
                    bp_igstamt.Text = (Convert.ToDouble(bp_basicamt.Text) * Convert.ToDouble(bp_igst_per.Text) / 100).ToString();
                if (bp_igstamt.Text == "")
                    bp_igstamt.Text = "0.00";
                bpamt.Text = (Convert.ToDouble(bp_basicamt.Text) + Convert.ToDouble(bp_igstamt.Text)).ToString();
            }
        }

        private void bpamt_KeyUp(object sender, KeyEventArgs e)
        {
            if (bp_igst_per.Text != "0.00" && bp_igst_per.Text != "")
                bp_basicamt.Text = (Convert.ToDouble(bpamt.Text) / Convert.ToDouble(bp_igst_per.Text) * 10).ToString();
            else
                bp_basicamt.Text = bpamt.Text;
        }

        private void search_on_particular_date_in_select_query(string paramname, DateTime mdatetime)
        {
            List<ConnectionWithAccess.QueryParams> objParams = new List<ConnectionWithAccess.QueryParams>();
            ConnectionWithAccess.QueryParams ParamFrom = new ConnectionWithAccess.QueryParams();
            //ParamFrom.paramName = "@D_D_Date";
            ParamFrom.paramName = paramname;
            ParamFrom.paramValue = mdatetime;
            objParams.Add(ParamFrom);
            ConnectionWithAccess.QueryParamList = objParams;
        }

        private void bpdocno_TextChanged(object sender, EventArgs e)
        {
            if (bpdocno.Text != "")
            {
                ConnectionWithAccess.query = "select f23.D_D, f23.D_N, f1.[desc] as [Desc], f1.city as [city], f23.bamt, f23.ck_no,f23.ck_dt,f23.bank,f23.pass_date,f23.mess,f23.a_n,f23.s_a, f23.b_t, f23.r_p,f23.IGST_PER,f23.IGST_AMT,f23.BASIC_AMT from " + ConnectionWithAccess.tablename[23] + " f23 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f1.a_n = f23.a_n and f1.s_a = f23.s_a  where f23.prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + bpdbc.Text + " and F23.d_d = @D_D_Date and f23.r_p = '4' and f23.d_n = " + bpdocno.Text;
                search_on_particular_date_in_select_query("@d_d_date", bpdatetime.Value);
                //List<ConnectionWithAccess.QueryParams> objParams = new List<ConnectionWithAccess.QueryParams>();
                //ConnectionWithAccess.QueryParams ParamFrom = new ConnectionWithAccess.QueryParams();
                //ParamFrom.paramName = "@D_D_Date";
                //ParamFrom.paramValue = Convert.ToDateTime(bpdatetime.Value.ToShortDateString());
                //objParams.Add(ParamFrom);
                //ConnectionWithAccess.QueryParamList = objParams;
                //add_user_date_time_function_compulsory_program();
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        bppartycode.Text = dtData1.Rows[0][2].ToString();
                        bppartyname.Text = dtData1.Rows[0][2].ToString();
                        bppartycity.Text = dtData1.Rows[0][3].ToString();
                        bpamt.Text = Convert.ToString(Convert.ToDouble(dtData1.Rows[0][4].ToString()) * -1);
                        bpchkno.Text = dtData1.Rows[0][5].ToString();
                        bpchkdate.Value = Convert.ToDateTime(dtData1.Rows[0][6].ToString());
                        if (dtData1.Rows[0][8].ToString() != "")
                            bppassdate.Value = Convert.ToDateTime(dtData1.Rows[0][8].ToString());
                        bpcomm.Text = dtData1.Rows[0][9].ToString();
                        bpa_n.Text = dtData1.Rows[0][10].ToString();
                        bps_a.Text = dtData1.Rows[0][11].ToString();
                        bp_igst_per.Text = dtData1.Rows[0][14].ToString();
                        bp_igstamt.Text = dtData1.Rows[0][15].ToString();
                        bp_basicamt.Text = dtData1.Rows[0][16].ToString();
                        get_account_details_from_01(bpa_n.Text, bps_a.Text);
                        get_account_details_from_04(bpa_n.Text, bps_a.Text);
                        bppartycontact.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20];
                        bppartyaddress.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[6] + " ," + account_detail_from_04[7];
                        common_account_head(bpa_n.Text);
                        lbl_br_account_head.Text = ConnectionWithAccess.macc_desc;
                        bppartyoverallbalance.Text = Convert.ToString(calculate_account_balance(bpa_n.Text, bps_a.Text, Convert.ToString(bpdatetime.Text)));
                        //b_t = 2 for balance, b_t = 3 for passed, b_t = 4 for failed.
                        if (dtData1.Rows[0][12].ToString() == "2")
                            bpchkstatus.SelectedIndex = 0;
                        else if (dtData1.Rows[0][12].ToString() == "3")
                        {
                            bpchkstatus.SelectedIndex = 1;
                            old_bank_payment_amount = Convert.ToDouble(bpamt.Text);
                        }
                        else if (dtData1.Rows[0][12].ToString() == "4")
                            bpchkstatus.SelectedIndex = 2;
                        tb_bp_mobilenumber.Text = account_detail_from_04[17];
                        bp_basicamt.ReadOnly = false;
                        bp_igst_per.ReadOnly = false;
                        bpamt.ReadOnly = false;
                        bp_dgv_gst_tax_brief.Visible = true;
                        btn_cheque_print.Visible = true;
                        bp_dgv_gst_tax_brief.DataSource = null;
                        ConnectionWithAccess.query = "select f8.bamt, f8.igst_per, f8.igst_amt, f8.gamt from " + ConnectionWithAccess.tablename[8] + " f8 where f8.book = 'b' and f8.prd = '" + ConnectionWithAccess.mprd + "' and f8.d_c = " + bpdbc.Text + " and f8.r_p = '4' and F8.d_n = " + bpdocno.Text;
                        ConnectionCommand.accountHelp_datatable_Seperate(bp_dgv_gst_tax_brief, "bp_dgv_gst_tax_brief");
                    }
                }
            }
        }

        private void btnGenCustReport_Click(object sender, EventArgs e)
        {
            try
            {
                ConnectionWithAccess.query = "select a.Desc as [Name], a.PAN, a.aadhar_card as [Aadhar Card], a.gst_number as [GST #], b.o_mob as [Mobile1], b.r_mob as " +
                            " [Mobile2], b.email as [Email], b.isd as [ISD Code], b.std as [STD Code], b.phone1, b.phone12, b.phone2, b.phone22, b.fax " +
                            " from " + ConnectionWithAccess.tablename[01] + " a inner join " + ConnectionWithAccess.tablename[04] + " b on b.s_a = a.s_a " +
                            " where  a.a_n =  b.a_n and  a.a_n in ('2002', '4002') and (a.s_a <> '' and a.s_a <> '@@@') and (b.s_a <> '' and b.s_a <> '@@@') ";
                ConnectionCommand.accountHelp_datatable_Seperate(dgvCustomerList, "CustomerList");
                dgvCustomerList.Visible = true;
            }
            catch (Exception ex)
            {
            }
            finally
            {
                if (dgvCustomerList.Rows.Count > 0)
                    btnCustListToExcel.Visible = true;
                else
                    btnCustListToExcel.Visible = false;
            }
        }

        private void btnCustListToExcel_Click(object sender, EventArgs e)
        {
            if (dgvCustomerList.Rows.Count > 0)
            {
                string strexcel_filename = "Customer List as on " + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
                strexcel_filename = ConnectionWithAccess.remove_filename_error(strexcel_filename);
                ConnectionWithAccess.export(dgvCustomerList, strexcel_filename);
            }
        }

        private void btnClearCustList_Click(object sender, EventArgs e)
        {
            dgvCustomerList.DataSource = null;
            dgvCustomerList.Visible = false;
            btnCustListToExcel.Visible = false;
        }

        private void cp_basicamt_KeyUp(object sender, KeyEventArgs e)
        {
            if (cp_basicamt.Text != "")
            {
                if (cp_igst_per.Text != "0.00" && cp_igst_per.Text != "")
                    cp_igstamt.Text = (Convert.ToDouble(cp_basicamt.Text) * Convert.ToDouble(cp_igst_per.Text) / 100).ToString();
                if (cp_igstamt.Text == "")
                    cp_igstamt.Text = "0.00";
                cpamt.Text = (Convert.ToDouble(cp_basicamt.Text) + Convert.ToDouble(cp_igstamt.Text)).ToString();
            }
        }

        private void cp_igst_per_KeyUp(object sender, KeyEventArgs e)
        {
            if (cp_basicamt.Text != "")
            {
                if (cp_igst_per.Text != "0.00" && cp_igst_per.Text != "")
                    cp_igstamt.Text = (Convert.ToDouble(cp_basicamt.Text) * Convert.ToDouble(cp_igst_per.Text) / 100).ToString();
                cpamt.Text = (Convert.ToDouble(cp_basicamt.Text) + Convert.ToDouble(cp_igstamt.Text)).ToString();
            }
        }

        private void cpamt_KeyUp(object sender, KeyEventArgs e)
        {
            if (cp_igst_per.Text != "0.00" && cp_igst_per.Text != "")
                cp_basicamt.Text = (Convert.ToDouble(cpamt.Text) / Convert.ToDouble(cp_igst_per.Text) * 10).ToString();
            else
                cp_basicamt.Text = cpamt.Text;
        }

        private void cpdocno_TextChanged(object sender, EventArgs e)
        {
            if (cpdbc.Text != "" && cpdocno.Text != "")
            {
                ConnectionWithAccess.query = "select f24.D_D, f24.D_N, f1.[desc] as [Desc], f1.city as [city], f24.camt, f24.mess,f24.a_n,f24.s_a,f24.IGST_PER,f24.IGST_AMT,f24.BASIC_AMT from " + ConnectionWithAccess.tablename[24] + " f24 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f1.a_n = f24.a_n and f1.s_a = f24.s_a  where f24.prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + cpdbc.Text + " and F24.d_d = @D_D_Date and f24.r_p = '4' and f24.d_n = " + cpdocno.Text;

                List<ConnectionWithAccess.QueryParams> objParams = new List<ConnectionWithAccess.QueryParams>();
                ConnectionWithAccess.QueryParams ParamFrom = new ConnectionWithAccess.QueryParams();
                ParamFrom.paramName = "@D_D_Date";
                ParamFrom.paramValue = Convert.ToDateTime(cpdatetime.Value.ToShortDateString());
                objParams.Add(ParamFrom);
                ConnectionWithAccess.QueryParamList = objParams;
                //add_user_date_time_function_compulsory_program();
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        cppartycode.Text = dtData1.Rows[0][2].ToString();
                        cppartyname.Text = dtData1.Rows[0][2].ToString();
                        cppartycity.Text = dtData1.Rows[0][3].ToString();
                        cpamt.Text = Convert.ToString(Convert.ToDouble(dtData1.Rows[0][4].ToString()) * -1);
                        old_cash_payment_amount = Convert.ToDouble(dtData1.Rows[0][4].ToString()) * -1;
                        cpcomm.Text = dtData1.Rows[0][5].ToString();
                        cpa_n.Text = dtData1.Rows[0][6].ToString();
                        cps_a.Text = dtData1.Rows[0][7].ToString();
                        cp_igst_per.Text = dtData1.Rows[0][8].ToString();
                        cp_igstamt.Text = dtData1.Rows[0][9].ToString();
                        cp_basicamt.Text = dtData1.Rows[0][10].ToString();
                        get_account_details_from_01(cpa_n.Text, cps_a.Text);
                        get_account_details_from_04(cpa_n.Text, cps_a.Text);
                        cppartycontact.Text = account_detail_from_04[17] + " ," + account_detail_from_04[18] + " ," + account_detail_from_04[19] + " ," + account_detail_from_04[20];
                        cppartyaddress.Text = account_detail_from_04[4] + " ," + account_detail_from_04[5] + " ," + account_detail_from_04[6] + " ," + account_detail_from_04[7];
                        common_account_head(cpa_n.Text);
                        lbl_br_account_head.Text = ConnectionWithAccess.macc_desc;
                        cppartyoverallbalance.Text = Convert.ToString(calculate_account_balance(cpa_n.Text, cps_a.Text, Convert.ToString(cpdatetime.Text)));
                        //b_t = 2 for balance, b_t = 3 for passed, b_t = 4 for failed.
                        tb_cp_mobilenumber.Text = account_detail_from_04[17];
                        cp_basicamt.ReadOnly = false;
                        cp_igst_per.ReadOnly = false;
                        cpamt.ReadOnly = false;
                    }
                }
                else
                {
                    cppartycode.Text = null;
                    cppartycity.Text = null;
                }
            }
            else
            {
                cppartycode.Text = null;
                cppartycity.Text = null;
            }
        }

        private void si_frieght_amt_KeyUp(object sender, KeyEventArgs e)
        {
            if (sibasicamt.Text != "0")
            {
                si_frieght_amt.ReadOnly = false;
                si_packing_amt.ReadOnly = false;
                si_insurance_amt.ReadOnly = false;
                si_other_amt.ReadOnly = false;
                if (periodofgst)
                {
                    tb_si_igst_tax_amount.Text = "0.00";
                    si_invoice_tax_amount = 0;
                    int totalrowcount = siitemlist.Rows.Count;
                    sale_invoice_amount = 0;
                    for (int i = 0; i < totalrowcount; i++)
                    {
                        if (siitemlist.Rows[i].Cells[7].Value != System.DBNull.Value)
                            sale_invoice_amount = sale_invoice_amount + Convert.ToDouble(siitemlist.Rows[i].Cells[7].Value);
                        if (siitemlist.Rows[i].Cells[9].Value == System.DBNull.Value || siitemlist.Rows[i].Cells[9].Value == null)
                            siitemlist.Rows[i].Cells[9].Value = "0";
                        si_invoice_tax_amount += (Convert.ToDouble(siitemlist.Rows[i].Cells[7].Value) * Convert.ToDouble(siitemlist.Rows[i].Cells[9].Value) / 100);

                    }
                    tb_si_igst_tax_amount.Text = Convert.ToString(si_invoice_tax_amount);
                    sale_invoice_amount += Convert.ToDouble(tb_si_igst_tax_amount.Text);
                    if (si_frieght_amt.Text != "" && si_frieght_amt.Text != "0.00")
                        sale_invoice_amount += Convert.ToDouble(si_frieght_amt.Text);
                    if (si_packing_amt.Text != "" && si_packing_amt.Text != "0.00")
                        sale_invoice_amount += Convert.ToDouble(si_packing_amt.Text);
                    if (si_insurance_amt.Text != "" && si_insurance_amt.Text != "0.00")
                        sale_invoice_amount += Convert.ToDouble(si_insurance_amt.Text);
                    if (si_other_amt.Text != "" && si_other_amt.Text != "0.00")
                        sale_invoice_amount += Convert.ToDouble(si_other_amt.Text);
                    calculate_roundoff();
                    sigrossamt.Text = Convert.ToString(sale_invoice_amount);
                }
            }
        }

        private void tbCurStock_KeyUp(object sender, KeyEventArgs e)
        {

        }

        private void cpdatetime_ValueChanged(object sender, EventArgs e)
        {
            refresh_cash_document_number();
        }

        private void jjdocno_TextChanged(object sender, EventArgs e)
        {
            if (jjdocno.Text != "")
            {
                ConnectionWithAccess.query = "select a_n, s_a, na_n, ns_a, d_d, d_n, jamt, mess from " + ConnectionWithAccess.tablename[25] + " f25 where d_n " + (jjdocno.Text.Trim() == string.Empty ? "is null" : "= " + jjdocno.Text.Trim()) + " and prd = '" + ConnectionWithAccess.mprd + "' and d_c = " + Convert.ToInt32(jjdbc.Text);
                DataTable dtData1 = ConnectionCommand.fGetDataTable();
                if (dtData1 != null && dtData1.Rows.Count > 0)
                {
                    if (dtData1.Rows[0][0] != null)
                    {
                        ja_n.Text = dtData1.Rows[0][0].ToString();
                        js_a.Text = dtData1.Rows[0][1].ToString();
                        jna_n.Text = dtData1.Rows[0][2].ToString();
                        jns_a.Text = dtData1.Rows[0][3].ToString();
                        jjdatetime.Value = Convert.ToDateTime(dtData1.Rows[0][4].ToString());
                        jjamt.Text = dtData1.Rows[0][6].ToString();
                        jjcomm.Text = dtData1.Rows[0][7].ToString();
                        old_journal_amount = Convert.ToDouble(dtData1.Rows[0][6].ToString());
                        populate_screen();
                    }
                }
                else
                {
                    ja_n.Clear();
                    js_a.Clear();
                    jna_n.Clear();
                    jns_a.Clear();
                    old_journal_amount = 0;
                    jjcomm.Text = null;
                    jjamt.Text = "0.00";
                    jjbamt.Text = "0.00";
                    jjigst_per.Text = "0.00";
                    jjigst_amt.Text = "0.00";
                    jjpartycode1.Text = null;
                    jjpartycode2.Text = null;
                    lbl_jour_payer_acc_head.Visible = false;
                }
            }
        }

        private void blstclosingstock_KeyUp(object sender, KeyEventArgs e)
        {
            if (maintab.SelectedIndex == 3)
            {
                if ((cb_emerg_sale.Checked == true || cb_emerg_purchase.Checked == true || cb_emerg_bank.Checked == true || cb_emerg_cash.Checked == true || cb_emerg_journal.Checked == true) && gp_percentage_change == false)
                {
                    emerg_prd = cbBalShPer.Text;
                    double mTAMT, mSAMT, mRSAMT, mGP_AMT, mOSAMT, mPAMT, mTRAMT, mGP, mpl_exp, mgp_per;
                    mGP = ConnectionWithAccess.gp_percent * -1;
                    this.Text = "Please wait Emerging Gross Profit and Closing Stock";
                    balance_amount = new string[0];
                    list_of_balance_amount.Clear();
                    ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n >= '61' and a_n <= '65ZZZZ' and s_a ='@@@'";
                    DataTable dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                        {
                            if (dtData1.Rows[iRowCount][0] != null)
                            {
                                list_of_balance_amount.Add(dtData1.Rows[iRowCount][0].ToString());
                            }
                        }
                    }
                    ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n >= '7001' and a_n <= '70ZZZZ' and s_a ='@@@'";
                    dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                        {
                            if (dtData1.Rows[iRowCount][0] != null)
                            {
                                list_of_balance_amount.Add(dtData1.Rows[iRowCount][0].ToString());
                            }
                        }
                    }
                    mTRAMT = 0;
                    for (int i = 0; i < list_of_balance_amount.Count; i++)
                    {
                        mTRAMT = mTRAMT + Convert.ToDouble(list_of_balance_amount[i]);
                    }
                    mSAMT = Math.Round(get_account_balance_from_51(emerg_prd, "6000", "@@@"), 2);
                    mRSAMT = Math.Round(get_account_balance_from_51(emerg_prd, "6000R1", "@@@"), 2);
                    mGP_AMT = mSAMT * ConnectionWithAccess.gp_percent / 100;
                    mOSAMT = Math.Round(get_account_balance_from_51(emerg_prd, "2001", "@@@"), 2);
                    mPAMT = Math.Round(get_account_balance_from_51(emerg_prd, "7000", "@@@"), 2);
                    mTAMT = ((mSAMT + mRSAMT + mGP_AMT + mOSAMT + mPAMT + mTRAMT) * -1);
                    mTAMT = Math.Round(mTAMT, 2);
                    //mTAMT = (-mSAMT - mRSAMT - mOSAMT - mPAMT - mTRAMT) - ((mSAMT + mRSAMT) * 1 / 100 * -1);
                    //mTAMT = Math.Round(mTAMT, 2);
                    if (blstclosingstock.Text != "" && blstclosingstock.Text != "-")
                        mTAMT = Convert.ToDouble(blstclosingstock.Text);
                    else
                        mTAMT = 0;
                    ConnectionWithAccess.closing_stock = mTAMT;
                    mgp_per = ((((-mSAMT - mRSAMT - mOSAMT - mPAMT - mTRAMT) - mTAMT) * 1) * 100) / (mSAMT + mRSAMT);
                    mgp_per = Math.Round(mgp_per, 4);
                    mGP_AMT = mTAMT - mSAMT - mRSAMT - mOSAMT - mPAMT - mTRAMT;
                    ConnectionWithAccess.gross_profit = mGP_AMT;
                    //ConnectionWithAccess.closing_stock = mTAMT;
                    this.Text = "Please wait Emerging Gross Profit and Closing Stock";
                    list_of_balance_amount.Clear();
                    ConnectionWithAccess.query = "select amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + emerg_prd + "' and a_n >= '75A' and a_n <= '75ZZZZ' and s_a ='@@@'";
                    dtData1 = ConnectionCommand.fGetDataTable();
                    if (dtData1 != null && dtData1.Rows.Count > 0)
                    {
                        for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                        {
                            if (dtData1.Rows[iRowCount][0] != null)
                            {
                                list_of_balance_amount.Add(dtData1.Rows[iRowCount][0].ToString());
                            }
                        }
                    }
                    mpl_exp = 0;
                    for (int i = 0; i < list_of_balance_amount.Count; i++)
                    {
                        mpl_exp = mpl_exp + Convert.ToDouble(list_of_balance_amount[i]);
                    }
                    blstsales.Text = mSAMT.ToString();
                    blstrepairs.Text = mRSAMT.ToString();
                    blstgp.Text = mGP_AMT.ToString();
                    blstopenstock.Text = mOSAMT.ToString();
                    blstpurchase.Text = mPAMT.ToString();
                    blsttradexp.Text = mTRAMT.ToString();
                    blstplexpense.Text = mpl_exp.ToString();
                    blstgp.Text = Convert.ToString(ConnectionWithAccess.gross_profit);
                    blstplgp.Text = Convert.ToString(ConnectionWithAccess.gross_profit);
                    ConnectionWithAccess.net_profit = Math.Round((ConnectionWithAccess.gross_profit - Convert.ToDouble(blstplexpense.Text)), 2);
                    blstnetprofit.Text = Convert.ToString(ConnectionWithAccess.net_profit);
                    blstgp_per.Text = Convert.ToString(mgp_per);
                }
                else
                {
                    ConnectionWithAccess.closing_stock = Math.Round(get_account_balance_from_51(emerg_prd, "2001", "@@@"), 2);
                    ConnectionWithAccess.gross_profit = 0;
                }
            }
        }

        private void cb_emerg_full_period_CheckedChanged(object sender, EventArgs e)
        {
            if (cb_emerg_full_period.Checked == true)
                cb_emerg_stop.Checked = true;
        }

        private void blstclosingstock_TextChanged(object sender, EventArgs e)
        {
            if (blstclosingstock.Text != "" && blstclosingstock.Text != "-")
            {
                check_data_type(blstclosingstock.Text);
                if (data_type == "Numeric")
                {
                    if (Convert.ToDouble(blstclosingstock.Text) < 0)
                    {
                        blstclosingstock.BackColor = Color.Red;
                    }
                    else
                        blstclosingstock.BackColor = Color.Green;
                }
            }
        }

        private void jjdbc_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (jjdbc.Text != "")
            {
                ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[25] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + Convert.ToInt32(jjdbc.Text);
                ConnectionCommand.ExportToText(jjdbc, jjdocno);
                ConnectionWithAccess.md_n = jjdocno.Text;
            }
        }

        private void BalShDGV_DoubleClick(object sender, EventArgs e)
        {
            if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 2)
            {
                maintab.SelectedIndex = 3;
                maintab_Click(sender, e);
                subtabreports.SelectedIndex = 1;
                tbA_N.Text = BalShDGV.CurrentRow.Cells[1].Value.ToString();
                tbS_A.Text = BalShDGV.CurrentRow.Cells[2].Value.ToString();
                if (BalShDGV.CurrentRow.Cells[3].Value.ToString() != "")
                {
                    tb_ledger_account_name.Text = BalShDGV.CurrentRow.Cells[3].Value.ToString();
                    tb_ledger_account_city.Text = BalShDGV.CurrentRow.Cells[4].Value.ToString();
                }
                else
                {
                    tb_ledger_account_name.Text = BalShDGV.CurrentRow.Cells[6].Value.ToString();
                    tb_ledger_account_city.Text = BalShDGV.CurrentRow.Cells[7].Value.ToString();
                }
            }
        }

        private void UserListDG_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            ConnectionWithAccess.muser = Convert.ToString(UserListDG.CurrentRow.Cells[0].Value);
            ConnectionWithAccess.mpassword = Convert.ToString(UserListDG.CurrentRow.Cells[1].Value);
            tbUserName.Text = Convert.ToString(UserListDG.CurrentRow.Cells[0].Value);
            tbPassword.Text = Convert.ToString(UserListDG.CurrentRow.Cells[1].Value);
            ConnectionWithAccess.mUserFeatures = Convert.ToString(UserListDG.CurrentRow.Cells[2].Value);
            //if (ConnectionWithAccess.muser != "admin" && ConnectionWithAccess.mpassword != "admin)
            //readusersettingsfromfiletoMemory(ConnectionWithAccess.muser, ConnectionWithAccess.mpassword);
            changestatusaspermemory();
        }

        private void tbgst_number_KeyUp(object sender, KeyEventArgs e)
        {
            if (tbgst_number.Text != "")
            {
                for (int i = 0; i < State_gst_code.Count(); i++)
                {
                    if (tbstate.Text.ToLower() == State_gst_code[i].ToLower())
                    {
                        if (tbgst_number.Text.Length >= 2)
                        {
                            if (tbgst_number.Text.Substring(0, 2) != i.ToString())
                                tbgst_number.BackColor = Color.Red;
                            else
                                tbgst_number.BackColor = Color.Green;
                        }
                    }
                }
            }
        }

        private void btnGenerateChart_Click(object sender, EventArgs e)
        {
            GenerateChart();
        }

        private void GenerateChart()
        {
            ConnectionWithAccess.query = "select prd, amt from " + ConnectionWithAccess.tablename[51] + " where a_n = '2010' and s_a = '@@@'";
            DataTable dtChartData = ConnectionCommand.fGetDataTable();
            if (dtChartData != null && dtChartData.Rows.Count > 0)
            {
                ctProfitLoss.Visible = true;
                //ctProfitLoss.Series.Add("test");
                ctProfitLoss.Series["Amount"].IsValueShownAsLabel = true;
                ctProfitLoss.Series["Amount"].XValueMember = "prd";
                ctProfitLoss.Series["Amount"].YValueMembers = "amt";
                ctProfitLoss.ChartAreas["ChartArea1"].AxisX.Interval = 1;
                ctProfitLoss.DataSource = dtChartData;
                ctProfitLoss.DataBind();
            }
            else
                ctProfitLoss.Visible = false;
        }

        private void btnClearChart_Click(object sender, EventArgs e)
        {
            ctProfitLoss.Visible = false;
        }

        private void tbItemRate_KeyUp(object sender, KeyEventArgs e)
        {
            if (tb_purc_price.Text == "")
            {
                tb_purc_price.Text = (Convert.ToDouble(tbItemRate.Text) - (Convert.ToDouble(tbItemRate.Text) * 20 / 100)).ToString();
            }
        }

        private void tb_purc_price_KeyUp(object sender, KeyEventArgs e)
        {
            if (tbItemRate.Text == "")
            {
                tbItemRate.Text = (Convert.ToDouble(tb_purc_price.Text) + (Convert.ToDouble(tb_purc_price.Text) * 20 / 100)).ToString();
            }
        }

        private void btn_mix_sundry_debitors_Click(object sender, EventArgs e)
        {
            mix_reports_dgv.Visible = false;
            if (tbselacc.Text == "0 Selected" && tbreportcity.Text == "0 Selected" && tbreportitems.Text == "0 Selected" && tbreporttax.Text == "0 Selected")
                ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f51.amt > 0";
            else
            {
                if (tbselacc.Text != "0 Selected")
                    ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f1.[desc] in (" + selectedpartyname + " and f51.amt > 0)";
                else if (tbreportcity.Text != "0 Selected")
                    ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f1.city in (" + selectedcitylist + " and f51.amt > 0)";
                else if (tbreporttax.Text != "0 Selected")
                    ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f1.tx_code in (" + selectedtaxlist + " and f51.amt > 0)";
            }
            excel_filename = "Debitors Outsanding List_" + ConnectionWithAccess.mprd;
            //parameters_for_date_range(mix_dt_from.Text, mix_dt_to.Text);
            ConnectionCommand.accountHelp_datatable_Seperate(mix_reports_dgv, "SaleList", "[desc] ASC");
            fAdd_total_row(mix_reports_dgv, "amt", 4, "[desc] ASC");
            //fAdd_Sale_Report_Totals("d_d ASC");

            if (mix_reports_dgv.Rows.Count > 1)
            {
                mix_reports_dgv.Visible = true;
                mix_reports_dgv.DefaultCellStyle.Font = new System.Drawing.Font("Microsoft Sans Serif", 15);
                mix_reports_dgv.Columns[0].HeaderText = "A_N";
                mix_reports_dgv.Columns[1].HeaderText = "S_A";
                mix_reports_dgv.Columns[2].HeaderText = "Name";
                mix_reports_dgv.Columns[3].HeaderText = "City";
                mix_reports_dgv.Columns[4].HeaderText = "Amt";
                mix_reports_dgv.Columns[0].Width = 90;
                mix_reports_dgv.Columns[1].Width = 75;
                mix_reports_dgv.Columns[2].Width = 500;
                mix_reports_dgv.Columns[3].Width = 250;
                mix_reports_dgv.Columns[4].Width = 180;
                mix_reports_dgv.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                mix_reports_dgv.Columns[4].DefaultCellStyle.Format = "N2";
                mix_reports_dgv.AllowUserToResizeColumns = false;
                mix_reports_dgv.Columns[0].Visible = false;
                mix_reports_dgv.Columns[1].Visible = false;
                mix_reports_dgv.Columns[5].Visible = false;
                mix_reports_dgv.FirstDisplayedScrollingRowIndex = mix_reports_dgv.Rows.Count - 2;
                if (mix_reports_dgv.Rows.Count > 0)
                    excel_filename = "Mini Sale List as on " + ConnectionWithAccess.mprd;
                ConnectionWithAccess.export(mix_reports_dgv, excel_filename);
                //generate_sale_balance_report();
            }
        }

        private void btn_mix_debitors_advances_Click(object sender, EventArgs e)
        {
            mix_reports_dgv.Visible = false;
            if (tbselacc.Text == "0 Selected" && tbreportcity.Text == "0 Selected" && tbreportitems.Text == "0 Selected" && tbreporttax.Text == "0 Selected")
                ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f51.amt < 0";
            else
            {
                if (tbselacc.Text != "0 Selected")
                    ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f1.[desc] in (" + selectedpartyname + " and f51.amt < 0)";
                else if (tbreportcity.Text != "0 Selected")
                    ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f1.city in (" + selectedcitylist + " and f51.amt < 0)";
                else if (tbreporttax.Text != "0 Selected")
                    ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + raa_n.Text + "' and f51.s_a <> '@@@' and f1.tx_code in (" + selectedtaxlist + " and f51.amt < 0)";
            }
            excel_filename = "Debitors Outsanding List_" + ConnectionWithAccess.mprd;
            //parameters_for_date_range(mix_dt_from.Text, mix_dt_to.Text);
            ConnectionCommand.accountHelp_datatable_Seperate(mix_reports_dgv, "SaleList", "[desc] ASC");
            fAdd_total_row(mix_reports_dgv, "amt", 4, "[desc] ASC");
            //fAdd_Sale_Report_Totals("d_d ASC");

            if (mix_reports_dgv.Rows.Count > 1)
            {
                mix_reports_dgv.Visible = true;
                mix_reports_dgv.DefaultCellStyle.Font = new System.Drawing.Font("Microsoft Sans Serif", 15);
                mix_reports_dgv.Columns[0].HeaderText = "A_N";
                mix_reports_dgv.Columns[1].HeaderText = "S_A";
                mix_reports_dgv.Columns[2].HeaderText = "Name";
                mix_reports_dgv.Columns[3].HeaderText = "City";
                mix_reports_dgv.Columns[4].HeaderText = "Amt";
                mix_reports_dgv.Columns[0].Width = 90;
                mix_reports_dgv.Columns[1].Width = 75;
                mix_reports_dgv.Columns[2].Width = 500;
                mix_reports_dgv.Columns[3].Width = 250;
                mix_reports_dgv.Columns[4].Width = 180;
                mix_reports_dgv.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                mix_reports_dgv.Columns[4].DefaultCellStyle.Format = "N2";
                mix_reports_dgv.AllowUserToResizeColumns = false;
                mix_reports_dgv.Columns[0].Visible = false;
                mix_reports_dgv.Columns[1].Visible = false;
                mix_reports_dgv.Columns[5].Visible = false;
                mix_reports_dgv.FirstDisplayedScrollingRowIndex = mix_reports_dgv.Rows.Count - 2;
                if (mix_reports_dgv.Rows.Count > 0)
                    excel_filename = "Mini Sale List as on " + ConnectionWithAccess.mprd;
                ConnectionWithAccess.export(mix_reports_dgv, excel_filename);
                //generate_sale_balance_report();
            }
        }

        private void mix_reports_combo_box_SelectedIndexChanged(object sender, EventArgs e)
        {
            btn_mix_generate.Visible = true;
            mix_reports_dgv.Visible = false;
            if (mix_reports_combo_box.SelectedItem.Equals("DEBITOR'S OUTSTANDING"))
            {
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[21] + " where d_n = 999999";
                ConnectionCommand.retrieval(mix_reports_d_c_combo_box);
                if (mix_reports_d_c_combo_box.Text != "")
                    tb_mix_a_n.Text = get_a_n_from_d_c("S", Convert.ToInt32(mix_reports_d_c_combo_box.Text));
            }
            else if (mix_reports_combo_box.SelectedItem.Equals("CREDITOR'S OUTSTANDING"))
            {
                ConnectionWithAccess.query = "select distinct d_c from " + ConnectionWithAccess.tablename[22] + " where d_n = 999999";
                ConnectionCommand.retrieval(mix_reports_d_c_combo_box);
                if (mix_reports_d_c_combo_box.Text != "")
                    tb_mix_a_n.Text = get_a_n_from_d_c("P", Convert.ToInt32(mix_reports_d_c_combo_box.Text));
            }

        }

        private void btn_mix_generate_Click(object sender, EventArgs e)
        {
            mix_reports_dgv.Visible = false;
            //DEBITOR'S OUTSTANDING DEBITOR'S ADVANCES CREDITOR'S OUTSTANDING CREDITOR'S ADVANCES 
            if (mix_reports_combo_box.SelectedItem.Equals("DEBITOR'S OUTSTANDING"))
            {
                if (tbselacc.Text == "0 Selected" && tbreportcity.Text == "0 Selected" && tbreportitems.Text == "0 Selected" && tbreporttax.Text == "0 Selected")
                    ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f51.amt > 0";
                else
                {
                    if (tbselacc.Text != "0 Selected")
                        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f1.[desc] in (" + selectedpartyname + " and f51.amt > 0)";
                    else if (tbreportcity.Text != "0 Selected")
                        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f1.city in (" + selectedcitylist + " and f51.amt > 0)";
                    else if (tbreporttax.Text != "0 Selected")
                        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f1.tx_code in (" + selectedtaxlist + " and f51.amt > 0)";
                }
                excel_filename = "Debitors Outsanding List_" + ConnectionWithAccess.mprd;
                ConnectionCommand.accountHelp_datatable_Seperate(mix_reports_dgv, "SaleList", "[desc] ASC");
                fAdd_total_row(mix_reports_dgv, "amt", 4, "[desc] ASC");
            }
            else if (mix_reports_combo_box.SelectedItem.Equals("DEBITOR'S ADVANCES"))
            {
                if (tbselacc.Text == "0 Selected" && tbreportcity.Text == "0 Selected" && tbreportitems.Text == "0 Selected" && tbreporttax.Text == "0 Selected")
                    ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, (f51.amt * -1),f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f51.amt < 0";
                else
                {
                    if (tbselacc.Text != "0 Selected")
                        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, (f51.amt * -1),f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f1.[desc] in (" + selectedpartyname + " and f51.amt > 0)";
                    else if (tbreportcity.Text != "0 Selected")
                        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, (f51.amt * -1),f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f1.city in (" + selectedcitylist + " and f51.amt > 0)";
                    else if (tbreporttax.Text != "0 Selected")
                        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, (f51.amt * -1),f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f1.tx_code in (" + selectedtaxlist + " and f51.amt > 0)";
                }
                excel_filename = "Debitors Outsanding List_" + ConnectionWithAccess.mprd;
                ConnectionCommand.accountHelp_datatable_Seperate(mix_reports_dgv, "SaleList", "[desc] ASC"); fAdd_total_row(mix_reports_dgv, "amt", 4, "[desc] ASC");
                fAdd_total_row(mix_reports_dgv, "amt", 4, "[desc] ASC");
            }
            else if (mix_reports_combo_box.SelectedItem.Equals("CREDITOR'S OUTSTANDING"))
            {
                if (tbselacc.Text == "0 Selected" && tbreportcity.Text == "0 Selected" && tbreportitems.Text == "0 Selected" && tbreporttax.Text == "0 Selected")
                    ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, (f51.amt * -1),f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f51.amt < 0";
                else
                {
                    if (tbselacc.Text != "0 Selected")
                        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, (f51.amt * -1),f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f1.[desc] in (" + selectedpartyname + " and f51.amt > 0)";
                    else if (tbreportcity.Text != "0 Selected")
                        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, (f51.amt * -1),f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f1.city in (" + selectedcitylist + " and f51.amt > 0)";
                    else if (tbreporttax.Text != "0 Selected")
                        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, (f51.amt * -1),f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f1.tx_code in (" + selectedtaxlist + " and f51.amt > 0)";
                }
                excel_filename = "Debitors Outsanding List_" + ConnectionWithAccess.mprd;
                ConnectionCommand.accountHelp_datatable_Seperate(mix_reports_dgv, "SaleList", "[desc] ASC");
                fAdd_total_row(mix_reports_dgv, "amt", 4, "[desc] ASC");
            }
            else if (mix_reports_combo_box.SelectedItem.Equals("CREDITOR'S ADVANCES"))
            {
                if (tbselacc.Text == "0 Selected" && tbreportcity.Text == "0 Selected" && tbreportitems.Text == "0 Selected" && tbreporttax.Text == "0 Selected")
                    ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f51.amt > 0";
                else
                {
                    if (tbselacc.Text != "0 Selected")
                        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f1.[desc] in (" + selectedpartyname + " and f51.amt > 0)";
                    else if (tbreportcity.Text != "0 Selected")
                        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f1.city in (" + selectedcitylist + " and f51.amt > 0)";
                    else if (tbreporttax.Text != "0 Selected")
                        ConnectionWithAccess.query = "select f51.a_n, f51.s_a,f1.[desc] as [Desc], f1.city, f51.amt,f51.d_d from " + ConnectionWithAccess.tablename[51] + " f51 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f51.a_n = f1.a_n and f51.s_a = f1.s_a where f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + tb_mix_a_n.Text + "' and f51.s_a <> '@@@' and f1.tx_code in (" + selectedtaxlist + " and f51.amt > 0)";
                }
                excel_filename = "Debitors Outsanding List_" + ConnectionWithAccess.mprd;
                ConnectionCommand.accountHelp_datatable_Seperate(mix_reports_dgv, "SaleList", "[desc] ASC");
                fAdd_total_row(mix_reports_dgv, "amt", 4, "[desc] ASC");
            }
            else if (mix_reports_combo_box.SelectedItem.Equals("ITEM'S CLOSING STOCK"))
            {
                ConnectionWithAccess.query = "select [type], item_code, [title],packing,box,price,clo_stk,cat,igst_per,hsn_code from " + ConnectionWithAccess.tablename[05] + " where clo_stk <> 0";
                ConnectionCommand.accountHelp_datatable_Seperate(mix_reports_dgv, "SaleList", "[title] ASC");
                excel_filename = "ITEMS_CLOSING_LIST_OF_" + ConnectionWithAccess.mprd;
            }
            else if (mix_reports_combo_box.SelectedItem.Equals("OMS PURCHASE LIST"))
            {
                ConnectionWithAccess.query = "select f22.D_D, f22.D_N, f1.[desc] as [Desc], f1.city,f1.state, f1.gst_number, f22.gamt, f22.d_c,f22.a_n,f22.s_a from " + ConnectionWithAccess.tablename[22] + " f22 inner join " + ConnectionWithAccess.tablename[01] + " f1 on f22.a_n = f1.a_n and f22.s_a = f1.s_a where f22.prd = '" + ConnectionWithAccess.mprd + "'";
                ConnectionCommand.accountHelp_datatable_Seperate(mix_reports_dgv, "OMS PURCHASE LIST", "d_d,d_n");
                filter_oms_purchase();
                excel_filename = "OMS PURCHASE LIST_OF_" + ConnectionWithAccess.mprd;
            }
            if (mix_reports_dgv.Rows.Count > 1)
            {
                mix_reports_dgv.Visible = true;
                //mix_reports_dgv.DefaultCellStyle.Font = new System.Drawing.Font("Microsoft Sans Serif", 15);
                //mix_reports_dgv.Columns[0].HeaderText = "A_N";
                //mix_reports_dgv.Columns[1].HeaderText = "S_A";
                //mix_reports_dgv.Columns[2].HeaderText = "Name";
                //mix_reports_dgv.Columns[3].HeaderText = "City";
                //mix_reports_dgv.Columns[4].HeaderText = "Amt";
                //mix_reports_dgv.Columns[0].Width = 90;
                //mix_reports_dgv.Columns[1].Width = 75;
                //mix_reports_dgv.Columns[2].Width = 500;
                //mix_reports_dgv.Columns[3].Width = 250;
                //mix_reports_dgv.Columns[4].Width = 180;
                //mix_reports_dgv.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
                //mix_reports_dgv.Columns[4].DefaultCellStyle.Format = "N2";
                //mix_reports_dgv.AllowUserToResizeColumns = false;
                //mix_reports_dgv.Columns[0].Visible = false;
                //mix_reports_dgv.Columns[1].Visible = false;
                //mix_reports_dgv.Columns[5].Visible = false;
                mix_reports_dgv.FirstDisplayedScrollingRowIndex = mix_reports_dgv.Rows.Count - 2;

                ConnectionWithAccess.export(mix_reports_dgv, excel_filename);
                //generate_sale_balance_report();
            }
        }

        private void filter_oms_purchase()
        {
            if (mix_reports_dgv.DataSource != null && mix_reports_dgv.Rows.Count > 0)
            {
                temp_word = ConnectionWithAccess.company_details[5].Trim().ToLower();
                DataTable dtReport = (DataTable)mix_reports_dgv.DataSource;
                if (dtReport != null && mix_reports_dgv.Rows.Count > 0)
                {
                    for (int i = dtReport.Rows.Count - 1; i >= 0; i--)
                    {
                        DataRow dr = dtReport.Rows[i];
                        if (dr["state"].ToString().ToLower() == temp_word)
                            dr.Delete();
                    }
                    //DataColumn dtCol = new DataColumn("SortOrder");
                    //dtReport.Columns.Add(dtCol);

                    //DataRow drTotalRow = dtReport.NewRow();

                    //string strPaymentTotal = dtReport.Compute("Sum(gamt)", "").ToString();
                    //drTotalRow[4] = "Total";
                    //drTotalRow[5] = strPaymentTotal;
                    //drTotalRow[9] = "1";

                    //dtReport.Rows.Add(drTotalRow);

                    //dtReport.DefaultView.Sort = "SortOrder ASC, " + strSortColumnOrder;

                    mix_reports_dgv.DataSource = null;
                    mix_reports_dgv.DataSource = dtReport;
                    //mix_reports_dgv.Columns["SortOrder"].Visible = false;
                }
            }
        }

        private void ledger_item_help_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            lbl_ledger_master_account_name.Visible = false;
            btn_gen_ledg.Visible = true;
            ledger_type.Text = ledger_item_help.CurrentRow.Cells[0].Value.ToString();
            ledger_item_code.Text = ledger_item_help.CurrentRow.Cells[1].Value.ToString();
            tb_ledger_account_name.Text = ledger_item_help.CurrentRow.Cells[2].Value.ToString();
            ledger_item_help.Visible = false;
            btn_gen_ledg.Visible = true;
        }

        private void gdvreport_CellDoubleClick(object sender, DataGridViewCellEventArgs e)
        {
            if (gdvreport.ColumnCount > 0)
            {
                if (cbRepType.SelectedItem.Equals("Sale"))
                {
                    sidbc.Text = "";
                    sidbc.Text = gdvreport.CurrentRow.Cells[6].Value.ToString();
                    temp_d_c = Convert.ToInt32(gdvreport.CurrentRow.Cells[6].Value.ToString());
                    temp_a_n = gdvreport.CurrentRow.Cells[7].Value.ToString();
                    temp_s_a = gdvreport.CurrentRow.Cells[8].Value.ToString();
                    sidocno.Text = gdvreport.CurrentRow.Cells[1].Value.ToString();
                    maintab.SelectedIndex = 1;
                    maintab_Click(sender, e);
                    subtabDataEntry.SelectedIndex = 0;
                    subtabDataEntry_Click(sender, e);
                    populate_screen();
                }
            }
        }

        private void EnableDisableDateControls(bool bEnabled, DateTimePicker dtFrom, DateTimePicker dtTo)
        {
            dtFrom.Enabled = bEnabled;
            dtTo.Enabled = bEnabled;
        }

        private void SetDateOnSelectedDateRange(ComboBox cmDateRange, DateTimePicker dtFrom, DateTimePicker dtTo)
        {
            DateTime dtPrdStartYear = Convert.ToDateTime(ConnectionWithAccess.msdate);
            DateTime dtPrdEndYear = Convert.ToDateTime(ConnectionWithAccess.medate);

            var today = DateTime.Today;
            int iYear = dtPrdStartYear.Year;

            switch (cmDateRange.Text)
            {
                case "Today":
                    dtFrom.Value = DateTime.Today;
                    dtTo.Value = DateTime.Today;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "Yesterday":
                    dtFrom.Value = DateTime.Today.AddDays(-1);
                    dtTo.Value = DateTime.Today.AddDays(-1);
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "This Week":
                    dtFrom.Value = DateTime.Today.AddDays(-1 * (int)(DateTime.Today.DayOfWeek));
                    dtTo.Value = DateTime.Today;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "Last 7 Days":
                    dtFrom.Value = DateTime.Today.AddDays(-7);
                    dtTo.Value = DateTime.Today;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "Last 30 Days":
                    dtFrom.Value = DateTime.Today.AddDays(-30);
                    dtTo.Value = DateTime.Today;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "This Month":
                    dtFrom.Value = new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1);
                    dtTo.Value = DateTime.Today;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "Last Month":
                    var month = new DateTime(today.Year, today.Month, 1);
                    var first = month.AddMonths(-1);
                    var last = month.AddDays(-1);

                    dtFrom.Value = first;
                    dtTo.Value = last;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "Custom Range":
                    if (DateTime.Today.Date >= dtPrdStartYear.Date && DateTime.Today.Date <= dtPrdEndYear.Date)
                    {
                        if ((subtabreports.SelectedIndex == 3 || subtabreports.SelectedIndex == 3) && DateTime.Today.Year == 2017) // its used for gst report start from july 2017
                            dtFrom.Value = Convert.ToDateTime("01/07/2017");
                        else
                            dtFrom.Value = dtPrdStartYear.Date;
                        //dtFrom.Value = DateTime.Today;
                        dtTo.Value = last_date;
                    }
                    else
                    {
                        if (DateTime.Today.Date < dtPrdStartYear.Date)
                        {
                            dtFrom.Value = new DateTime(dtPrdStartYear.Year, 4, 1);
                            dtTo.Value = new DateTime(dtPrdStartYear.Year, 4, DateTime.DaysInMonth(dtPrdStartYear.Year, 4));
                        }
                        else
                        {
                            dtFrom.Value = dtPrdStartYear.Date;
                            dtTo.Value = dtPrdEndYear.Date;
                        }
                    }
                    EnableDisableDateControls(true, dtFrom, dtTo);

                    break;
                case "January":
                    dtFrom.Value = new DateTime(dtPrdEndYear.Year, 1, 1);
                    DateTime dtToDate1 = new DateTime(dtPrdEndYear.Year, 1, DateTime.DaysInMonth(today.Year, 1));
                    if (dtToDate1.Date >= today.Date)
                        dtTo.Value = today.Date;
                    else
                        dtTo.Value = dtToDate1;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "February":
                    dtFrom.Value = new DateTime(dtPrdEndYear.Year, 2, 1);
                    DateTime dtToDate2 = new DateTime(dtPrdEndYear.Year, 2, DateTime.DaysInMonth(today.Year, 2));
                    if (dtToDate2.Date >= today.Date)
                        dtTo.Value = today.Date;
                    else
                        dtTo.Value = dtToDate2;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "March":
                    dtFrom.Value = new DateTime(dtPrdEndYear.Year, 3, 1);
                    DateTime dtToDate3 = new DateTime(dtPrdEndYear.Year, 3, DateTime.DaysInMonth(today.Year, 3));
                    if (dtToDate3.Date >= today.Date)
                        dtTo.Value = today.Date;
                    else
                        dtTo.Value = dtToDate3;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "April":
                    dtFrom.Value = new DateTime(iYear, 4, 1);
                    DateTime dtToDate4 = new DateTime(iYear, 4, DateTime.DaysInMonth(today.Year, 4));
                    if (dtToDate4.Date >= today.Date)
                        dtTo.Value = today.Date;
                    else
                        dtTo.Value = dtToDate4;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "May":
                    dtFrom.Value = new DateTime(iYear, 5, 1);
                    DateTime dtToDate5 = new DateTime(iYear, 5, DateTime.DaysInMonth(today.Year, 5));
                    if (dtToDate5.Date >= today.Date)
                        dtTo.Value = today.Date;
                    else
                        dtTo.Value = dtToDate5;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "June":
                    dtFrom.Value = new DateTime(iYear, 6, 1);
                    DateTime dtToDate6 = new DateTime(iYear, 6, DateTime.DaysInMonth(today.Year, 6));
                    if (dtToDate6.Date >= today.Date)
                        dtTo.Value = today.Date;
                    else
                        dtTo.Value = dtToDate6;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "July":
                    dtFrom.Value = new DateTime(iYear, 7, 1);
                    DateTime dtToDate7 = new DateTime(iYear, 7, DateTime.DaysInMonth(today.Year, 7));
                    if (dtToDate7.Date >= today.Date)
                        dtTo.Value = today.Date;
                    else
                        dtTo.Value = dtToDate7;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "August":
                    dtFrom.Value = new DateTime(iYear, 8, 1);
                    DateTime dtToDate8 = new DateTime(iYear, 8, DateTime.DaysInMonth(today.Year, 8));
                    if (dtToDate8.Date >= today.Date)
                        dtTo.Value = today.Date;
                    else
                        dtTo.Value = dtToDate8;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "September":
                    dtFrom.Value = new DateTime(iYear, 9, 1);
                    DateTime dtToDate9 = new DateTime(iYear, 9, DateTime.DaysInMonth(today.Year, 9));
                    if (dtToDate9.Date >= today.Date)
                        dtTo.Value = today.Date;
                    else
                        dtTo.Value = dtToDate9;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "October":
                    dtFrom.Value = new DateTime(iYear, 10, 1);
                    DateTime dtToDate10 = new DateTime(iYear, 10, DateTime.DaysInMonth(today.Year, 10));
                    if (dtToDate10.Date >= today.Date)
                        dtTo.Value = today.Date;
                    else
                        dtTo.Value = dtToDate10;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "November":
                    dtFrom.Value = new DateTime(iYear, 11, 1);
                    DateTime dtToDate11 = new DateTime(iYear, 11, DateTime.DaysInMonth(today.Year, 11));
                    if (dtToDate11.Date >= today.Date)
                        dtTo.Value = today.Date;
                    else
                        dtTo.Value = dtToDate11;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "December":
                    dtFrom.Value = new DateTime(iYear, 12, 1);
                    DateTime dtToDate12 = new DateTime(iYear, 12, DateTime.DaysInMonth(today.Year, 12));
                    if (dtToDate12.Date >= today.Date)
                        dtTo.Value = today.Date;
                    else
                        dtTo.Value = dtToDate12;
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
                case "Full Period":
                    dtFrom.Value = Convert.ToDateTime(ConnectionWithAccess.com_start_date);
                    dtTo.Value = Convert.ToDateTime(ConnectionWithAccess.com_end_date);
                    EnableDisableDateControls(false, dtFrom, dtTo);
                    break;
            }
        }

        private void fSetDateRangeOnPeriodChange()
        {
            if (subtabreports.SelectedIndex == 1)
            {
                fPopulatecmbDateRange(cmbDateRangeLedger);
            }
            else if (subtabreports.SelectedIndex == 3)
            {
                fPopulatecmbDateRange(cmbDateRangeGST);
            }
            else if (subtabreports.SelectedIndex == 7)
            {
                fPopulatecmbDateRange(cmbDateRangeOut);
            }
        }

        string[] strDateRangeItems = { "Today", "Yesterday", "This Week", "Last 7 Days", "Last 30 Days", "This Month", "Last Month", "Custom Range" };
        string[] strDateRangeItemsPrevPeriod = { "Custom Range",
                                             "April", "May", "June", "July", "August", "September", "October", "November", "December", "January", "February", "March"};

        private void fPopulatecmbDateRange(ComboBox cmbDateRange)
        {
            cmbDateRange.Items.Clear();

            int iCurrentMonth = DateTime.Today.Month;
            int iMonthCouter = 0;
            int icurrentyear = DateTime.Today.Year;

            if (DateTime.Today.Date >= Convert.ToDateTime(ConnectionWithAccess.msdate).Date && DateTime.Today.Date <= Convert.ToDateTime(ConnectionWithAccess.medate).Date)
            {
                cmbDateRange.Items.AddRange(strDateRangeItems);

                if (iCurrentMonth < 4)
                    iMonthCouter = 12;
                else
                    iMonthCouter = iCurrentMonth;
                if ((subtabreports.SelectedIndex == 3 || subtabreports.SelectedIndex == 3) && icurrentyear == 2017) // its used for gst report start from july 2017
                {
                    for (int i = 7; i <= iMonthCouter; i++)
                    {
                        cmbDateRange.Items.Add(CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(i));
                    }
                }
                else
                {
                    for (int i = 4; i <= iMonthCouter; i++)
                    {
                        cmbDateRange.Items.Add(CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(i));
                    }
                }
                if (iCurrentMonth < 4)
                {
                    for (int i = 1; i <= iCurrentMonth; i++)
                    {
                        cmbDateRange.Items.Add(CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(i));
                    }
                }
            }
            else
            {
                cmbDateRange.Items.AddRange(strDateRangeItemsPrevPeriod);
            }
            if (subtabreports.SelectedIndex == 1 || subtabreports.SelectedIndex == 7)
            {
                cmbDateRange.Items.Add("Full Period");
                cmbDateRange.Text = "Full Period";
            }
            else
                cmbDateRange.Text = "Custom Range";
        }

        private void cmbDateRangeGST_SelectedIndexChanged(object sender, EventArgs e)
        {
            SetDateOnSelectedDateRange(cmbDateRangeGST, dtp_rg_from_date, dtp_rg_to_date);
        }

        private void cmbDateRangeLedger_SelectedIndexChanged(object sender, EventArgs e)
        {
            SetDateOnSelectedDateRange(cmbDateRangeLedger, Ledfrom, LedTo);
        }

        private void cmbDateRangeANALYSIS_SelectedIndexChanged(object sender, EventArgs e)
        {
            SetDateOnSelectedDateRange(cmbDateRangeANALYSIS, RepFrom, RepTo);
        }

        private void sr_item_help_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            mtype = Convert.ToString(sr_item_help.CurrentRow.Cells[0].Value);
            mitem_code = Convert.ToString(sr_item_help.CurrentRow.Cells[1].Value);
            ConnectionWithAccess.query = "select [type], item_code, [title],price,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where a_n = '" + sra_n.Text + "' and s_a = '" + srs_a.Text + "' and [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    sritemlist.CurrentRow.Cells[0].Value = dtData1.Rows[0][0].ToString();
                    sritemlist.CurrentRow.Cells[1].Value = dtData1.Rows[0][1].ToString();
                    sritemlist.CurrentRow.Cells[2].Value = dtData1.Rows[0][2].ToString();
                    sritemlist.CurrentRow.Cells[6].Value = dtData1.Rows[0][3].ToString();
                    if (dtData1.Rows[0][4].ToString() != "")
                        sritemlist.CurrentRow.Cells[7].Value = dtData1.Rows[0][4].ToString();
                    if (dtData1.Rows[0][5].ToString() != "")
                        sritemlist.CurrentRow.Cells[8].Value = dtData1.Rows[0][5].ToString();
                }
            }
            get_item_details_from_05_using_type_item_code(mtype, mitem_code);
            sritemlist.CurrentRow.Cells[0].Value = item_details_from_05[0];
            sritemlist.CurrentRow.Cells[1].Value = item_details_from_05[1];
            sritemlist.CurrentRow.Cells[2].Value = item_details_from_05[2];
            mtitle = Convert.ToString(sritemlist.CurrentRow.Cells[2].Value);
            mcase = 1;
            mbox = Convert.ToDouble(item_details_from_05[3]);
            mqty = Convert.ToDouble(item_details_from_05[4]);
            mprice = Convert.ToDouble(item_details_from_05[5]);
            //sritemlist.CurrentRow.Cells[3].Value = 1;
            //sritemlist.CurrentRow.Cells[4].Value = 1;
            //sritemlist.CurrentRow.Cells[5].Value = mbox * mcase * mqty;
            if (sritemlist.CurrentRow.Cells[6].Value == null)
                sritemlist.CurrentRow.Cells[6].Value = mprice;
            else
                if (sritemlist.CurrentRow.Cells[6].Value == System.DBNull.Value)
                    sritemlist.CurrentRow.Cells[6].Value = mprice.ToString();
            mamount = mcase * mbox * mqty * mprice;
            sritemlist.CurrentRow.Cells[7].Value = Convert.ToString(mamount);
            sritemlist.CurrentRow.Cells[8].Value = item_details_from_05[7];
            sritemlist.CurrentRow.Cells[9].Value = item_details_from_05[8];
            sritemlist.CurrentRow.Cells[10].Value = item_details_from_05[9];
            sr_item_help.Visible = false;
            calculateSalereplaceItemTotal();
            show_images();
        }

        private void tbCity_KeyUp(object sender, KeyEventArgs e)
        {
            dgvStdCodeHelp.DataSource = null;
            DataTable dtFilter = dtStdCodes.Clone();
            dtStdCodes.Select("STATION like '%" + tbCity.Text.Trim() + "%' ").CopyToDataTable(dtFilter, LoadOption.OverwriteChanges);
            dgvStdCodeHelp.DataSource = dtFilter;
            if (dgvStdCodeHelp.Rows.Count > 1)
            {
                if (dgvStdCodeHelp.Rows[0].Cells[3].Value.ToString() != tbstate.Text)
                {
                    dgvStdCodeHelp.Visible = true;
                    tbstate.BackColor = Color.Red;
                }
            }
            if (bstdcode && tbCity.Text != "" && dgvStdCodeHelp.Visible == true)
            {
                dgvStdCodeHelp.Columns[0].Visible = false;
                dgvStdCodeHelp.Columns[1].Width = 120;
                dgvStdCodeHelp.Columns[2].Width = 120;
                dgvStdCodeHelp.Columns[3].Width = 120;
            }
        }

        #region Area

        private void radioButton1_CheckedChanged(object sender, EventArgs e)
        {
            if (radioButton1.Checked)
            {
                txtNewArea.Visible = true;
                cmbArea.Text = "";
                cmbArea.SelectedIndex = 0;
                fFillAreaGrid();
            }
        }

        private void cmbArea_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (((ComboBox)(sender)).Text != "")
            {
                txtNewArea.Visible = false;
                fFillAreaGrid();
            }
        }

        private void btnSaveArea_Click(object sender, EventArgs e)
        {
            string strAreaCode = string.Empty;
            if (txtNewArea.Visible)
            {
                strAreaCode = txtNewArea.Text.Trim();

                ConnectionWithAccess.query = "select * from " + ConnectionWithAccess.tablename[02] + " f2 where f2.Area_Code = '" + strAreaCode + "' ";
                DataTable dtData = ConnectionCommand.fGetDataTable();
                if (dtData != null && dtData.Rows.Count > 0)
                {
                    MessageBox.Show("Area Code already exist, please enter unique Area Code");
                    return;
                }
            }
            else
                strAreaCode = cmbArea.Text.Trim();

            ConnectionWithAccess.query = "delete from " + ConnectionWithAccess.tablename[02] + " f2 where f2.Area_Code = '" + strAreaCode + "' ";
            ConnectionCommand.fUpdateInsertDeleteData();

            foreach (DataGridViewRow row in dgvArea.Rows)
            {
                if (row.Cells[0].Value != DBNull.Value && Convert.ToBoolean(row.Cells[0].Value))
                {
                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[02] + " (Area_Code, City) values ('" + strAreaCode + "', '" + row.Cells[1].Value.ToString().Trim() + "' )";// f2.Area_Code = '" + strAreaCode + "' ";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }

            if (txtNewArea.Visible)
            {
                fFillAreaList(cmbArea);
                cmbArea.Text = strAreaCode;
                txtNewArea.Visible = false;
                radioButton1.Checked = false;
            }
            fFillAreaGrid();
        }

        private void fFillAreaGrid()
        {
            dgvArea.DataSource = null;
            if (cmbArea.SelectedIndex != 0)
                ConnectionWithAccess.query = "select distinct (switch(f2.Area_Code = '" + cmbArea.Text.Trim() + "', 1, f2.Area_Code <> '" + cmbArea.Text.Trim() + "', 0, f2.Area_Code is null, 0) )   as AreaSelect, f2.Area_Code as Area,  f1.City from " + ConnectionWithAccess.tablename[01] + " f1 " +
                    "left outer join " + ConnectionWithAccess.tablename[02] + " f2 on f2.City = f1.City " +
                    "where f1.s_a <> '@@@' and f1.City <> '' order by (switch(f2.Area_Code = '" + cmbArea.Text.Trim() + "', 1, f2.Area_Code <> '" + cmbArea.Text.Trim() + "', 0, f2.Area_Code is null, 0) ) desc, f1.City ";
            else
                ConnectionWithAccess.query = "select distinct 0 as AreaSelect, f2.Area_Code as Area,  f1.City from " + ConnectionWithAccess.tablename[01] + " f1 " +
                   "left outer join " + ConnectionWithAccess.tablename[02] + " f2 on f2.City = f1.City " +
                   "where f1.s_a <> '@@@' and f1.City <> ''  order by f1.City ";
            DataTable dtCity = ConnectionCommand.fGetDataTable();
            if (dtCity != null)
            {
                dgvArea.AutoGenerateColumns = false;
                dgvArea.DataSource = dtCity;
            }
        }

        private void fFillAreaList(ComboBox m_cmbArea)
        {
            ConnectionWithAccess.query = "select distinct Area_Code from " + ConnectionWithAccess.tablename[02];
            DataTable dtCity = ConnectionCommand.fGetDataTable();
            if (dtCity != null)
            {
                DataRow drNewRow = dtCity.NewRow();
                drNewRow[0] = "";
                dtCity.Rows.InsertAt(drNewRow, 0);

                m_cmbArea.DataSource = dtCity;
                m_cmbArea.ValueMember = "Area_Code";
            }
        }
        #endregion Area

        private void jjbamt_KeyUp(object sender, KeyEventArgs e)
        {
            if (jjbamt.Text != "")
            {
                if (jjigst_per.Text != "0.00" && jjigst_per.Text != "")
                    jjigst_amt.Text = (Convert.ToDouble(jjbamt.Text) * Convert.ToDouble(jjigst_per.Text) / 100).ToString();
                if (jjigst_amt.Text == "")
                    jjigst_amt.Text = "0.00";
                jjamt.Text = (Math.Round(Convert.ToDouble(jjbamt.Text) + Convert.ToDouble(jjigst_amt.Text), 2)).ToString();
            }
        }

        private void jjigst_per_KeyUp(object sender, KeyEventArgs e)
        {
            if (jjbamt.Text != "")
            {
                if (jjigst_per.Text != "0.00" && jjigst_per.Text != "")
                    jjigst_amt.Text = (Math.Round(Convert.ToDouble(jjbamt.Text) * Convert.ToDouble(jjigst_per.Text) / 100, 2)).ToString();

                jjamt.Text = (Math.Round(Convert.ToDouble(jjbamt.Text) + Convert.ToDouble(jjigst_amt.Text), 2)).ToString();
            }
        }

        private void jjamt_KeyUp(object sender, KeyEventArgs e)
        {
            if (jjigst_per.Text != "0.00" && jjigst_per.Text != "" && jjamt.Text != "")
            {
                temp_double = Convert.ToDouble("1." + jjigst_per.Text.Trim().Replace(".", ""));
                jjbamt.Text = (Math.Round(Convert.ToDouble(jjamt.Text) / Convert.ToDouble(temp_double), 2)).ToString();
                jjigst_amt.Text = Math.Round(Convert.ToDouble(jjamt.Text) - Convert.ToDouble(jjbamt.Text), 2).ToString();
            }
            else
                jjbamt.Text = jjamt.Text;
        }

        private void crdatetime_KeyUp(object sender, KeyEventArgs e)
        {
            if (crdbc.Text != "")
            {

                //ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[24] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + crdbc.Text + " and d_d = #" + crdatetime.Text + "#";
                ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[24] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + crdbc.Text;
                ConnectionCommand.ExportToText(crdbc, crdocno);
                //temp_word = Convert.ToString(crdatetime.Value.Year) + Convert.ToString(crdatetime.Value.Month) + Convert.ToString(crdatetime.Value.Date.ToString().Substring(0, crdatetime.Value.ToString().IndexOf("/")));
                //crdocno.Text = crdocno.Text.Replace(temp_word, "");
            }
        }

        protected void UserControl_ButtonClick(object sender, EventArgs e)
        {
            pb_rep_ana_printer.Visible = false;
            Generate.Visible = true;
            gdvreport.Visible = false;
            dgv_tax_report.Visible = false;
        }

        private void valid_gstr_number()
        {
            //           var regex = /^\d{2}\w{4}[a-zA-Z0-9]{1}\d{3}\w{1}[a-zA-Z0-9]{3}$/i;

            //if (regex.test('GSTNumber')) { console.log('valid'); }

        }

        private void cmbDateRangeMIX_SelectedIndexChanged(object sender, EventArgs e)
        {
            SetDateOnSelectedDateRange(cmbDateRangeMIX, mix_dt_from, mix_dt_to);
        }

        private void bp_dgv_gst_tax_brief_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
        {
            e.Control.TextChanged += new EventHandler(textBox_TextChanged);
            cntObject = e.Control;
            cntObject.TextChanged += textBox_TextChanged;
        }

        private DataTable fGetOutstaningBalanceData_new(string strrla_n, string strrls_a)
        {
            DataTable dtTable = new DataTable();
            {
                ConnectionWithAccess.query = query_contains_for_ledger_account_union(strrla_n, strrls_a, (OutTo.Value).ToString());
                DataTable dtNewTable2 = ConnectionCommand.fGetDataTable();
                //dgvOutstanding.Visible = true;
                //contains_for_Outstanding_Report(strrla_n, strrls_a, (OutTo.Value).ToString());
                if (dtNewTable2.Rows.Count > 0)
                {
                    double iOutstandingBalance = 0;
                    get_account_details_from_01(strrla_n, strrls_a);
                    if (cmbDateRangeOut.Text != "Full Period")
                    {
                        if (Convert.ToDateTime(OutFrom.Text) > Convert.ToDateTime(ConnectionWithAccess.com_start_date))
                            delete_old_date_record(dgvOutstanding, 3, OutFrom.Text);
                    }
                    DataTable dtNewTable = ((DataTable)dgvOutstanding.DataSource).Clone();

                    dtNewTable = ((DataTable)dgvOutstanding.DataSource);

                    if (dtNewTable.Rows.Count == 1)
                    {
                        double.TryParse(dtNewTable.Rows[0]["DEBIT"].ToString(), out iOutstandingBalance);
                        temp_word = Convert.ToDateTime(dtNewTable.Rows[0]["DATE"].ToString()).ToShortDateString();
                        temp_word1 = ConnectionWithAccess.ma_n + "," + ConnectionWithAccess.ms_a + "," + temp_word + "," + dtNewTable.Rows[0]["DOCUMENTS"].ToString() + "," + dtNewTable.Rows[0]["DEBIT"].ToString();
                        temporary_list_2.Add(temp_word1);
                    }
                    else if (dtNewTable.Rows.Count > 1)
                    {
                        DataView view = new DataView(dtNewTable);
                        DataColumnCollection columns = dtNewTable.Columns;
                        if (columns.Contains("Date"))
                        {
                            view.Sort = "[Date] asc";
                        }

                        DataTable dtNewTable1 = view.ToTable();

                        DataTable sortedTable = update_datatable_balances(dtNewTable1, 6, 7, 8);

                        string strTotalCol1 = getTotal_Datatable(sortedTable, 6);
                        string strTotalCol2 = getTotal_Datatable(sortedTable, 7);

                        //if (!string.IsNullOrEmpty(strTotalCol1) && !string.IsNullOrEmpty(strTotalCol2))
                        //{
                        //    DataRow drTotalRow = sortedTable.NewRow();
                        //    //drTotalRow[6] = strTotalCol1;
                        //    //drTotalRow[7] = strTotalCol2;
                        //    sortedTable.Rows.Add(drTotalRow);
                        //}

                        iOutstandingBalance = 0;
                        string strAccName = string.Empty;

                        if (sortedTable != null && sortedTable.Rows.Count > 1)
                        {
                            //strAccName = sortedTable.Rows[0]["ACC_NAME"].ToString();
                            double.TryParse(sortedTable.Rows[sortedTable.Rows.Count - 1]["balance"].ToString(), out iOutstandingBalance);
                            if (!chkBill.Checked)
                            {
                                DataTable dtSummary = new DataTable();
                                DataColumn dcName = new DataColumn("Name");
                                DataColumn dcCity = new DataColumn("City");
                                DataColumn dcBalance = new DataColumn("Balance");

                                dtSummary.Columns.Add(dcName);
                                dtSummary.Columns.Add(dcCity);
                                dtSummary.Columns.Add(dcBalance);

                                DataRow dtNewRow = dtSummary.NewRow();
                                dtNewRow["Name"] = account_detail_from_01[4];
                                dtNewRow["City"] = account_detail_from_01[8];
                                dtNewRow["Balance"] = iOutstandingBalance;

                                dtSummary.Rows.Add(dtNewRow);
                                dtTable = dtSummary;
                                temp_word = ConnectionWithAccess.ma_n + "," + ConnectionWithAccess.ms_a + "," + account_detail_from_01[4] + "," + account_detail_from_01[8] + "," + iOutstandingBalance;
                                temporary_list_2.Add(temp_word);
                            }
                            else
                            {
                                isRecord = 0;
                                for (row_counter = 0; row_counter < sortedTable.Rows.Count - 1; row_counter++)
                                {
                                    if (Convert.ToDouble(sortedTable.Rows[row_counter]["DEBIT"].ToString()) != 0.00)
                                    {
                                        isRecord = 1;
                                        row_counter = sortedTable.Rows.Count;
                                    }
                                }
                                if (isRecord == 1)
                                {
                                    //foreach (DataRow dr in sortedTable.Rows)
                                    //{
                                    //    temp_word = dr["date"].ToString();
                                    //    if (dr["date"].ToString() == "")
                                    //        dr[6] = "0.00";
                                    //}
                                    DataTable dtBills1 = sortedTable.Select("DEBIT > 0").CopyToDataTable();
                                    DataView view1 = new DataView(dtBills1);
                                    DataColumnCollection columns1 = dtBills1.Columns;
                                    if (columns1.Contains("Date"))
                                    {
                                        view1.Sort = "[Date] asc";
                                    }
                                    DataTable dtBills = view1.ToTable();
                                    //DataTable dtBills = sortedTable.Select("ACC_TYPE = 'Sale'").CopyToDataTable();
                                    if (dtBills != null && dtBills.Rows.Count > 0)
                                    {
                                        double iCurrSum = 0;
                                        DataTable dtBillList = dtBills.Clone();
                                        if (dtBills.Rows.Count > 2)
                                        {
                                            bool bLoop = true;
                                            int ibottomRow = dtBills.Rows.Count - 1;
                                            double iDebitSum = 0;
                                            List<int> iRowNum = new List<int>();
                                            while (bLoop)
                                            {
                                                if (iOutstandingBalance > iDebitSum && ibottomRow >= 0)
                                                    iCurrSum = Convert.ToDouble(dtBills.Rows[ibottomRow]["DEBIT"].ToString());
                                                if (iDebitSum < iOutstandingBalance)
                                                {
                                                    if (iCurrSum < (iOutstandingBalance - iDebitSum))
                                                    {
                                                        if (iDebitSum == 0 && iCurrSum > iOutstandingBalance)
                                                            temp_word2 = Math.Round(iOutstandingBalance, 2).ToString();
                                                        else
                                                            temp_word2 = Math.Round(iCurrSum, 2).ToString();
                                                    }
                                                    else
                                                        temp_word2 = Math.Round((iOutstandingBalance - iDebitSum), 2).ToString();
                                                    iDebitSum += iCurrSum;
                                                    iRowNum.Add(ibottomRow);
                                                    temp_word = Convert.ToDateTime(dtBills.Rows[ibottomRow]["DATE"].ToString()).ToShortDateString();
                                                    //temp_word1 = ConnectionWithAccess.ma_n + "," + ConnectionWithAccess.ms_a + "," + temp_word + "," + dtBills.Rows[ibottomRow]["DOCUMENTS"].ToString() + "," + dtBills.Rows[ibottomRow]["DEBIT"].ToString();
                                                    temp_word1 = ConnectionWithAccess.ma_n + "," + ConnectionWithAccess.ms_a + "," + temp_word + "," + dtBills.Rows[ibottomRow]["DOCUMENTS"].ToString() + "," + temp_word2;
                                                    temporary_list_2.Add(temp_word1);
                                                    ibottomRow = ibottomRow - 1;
                                                }
                                                else
                                                    bLoop = false;
                                            }
                                            for (int i = iRowNum.Count; i > 0; i--)
                                            {
                                                dtBillList.ImportRow(dtBills.Rows[iRowNum[i - 1]]);
                                            }
                                            dtTable = dtBillList;
                                        }
                                        else if (dtBills.Rows.Count == 2)
                                        {
                                            bool bLoop = true;
                                            int ibottomRow = dtBills.Rows.Count - 1;
                                            double iDebitSum = 0;
                                            List<int> iRowNum = new List<int>();
                                            while (bLoop)
                                            {
                                                if (iOutstandingBalance > iDebitSum && ibottomRow >= 0)
                                                    iCurrSum = Convert.ToDouble(dtBills.Rows[ibottomRow]["DEBIT"].ToString());
                                                if (iDebitSum < iOutstandingBalance)
                                                {
                                                    iDebitSum += iCurrSum;
                                                    iRowNum.Add(ibottomRow);
                                                    if (iDebitSum > iOutstandingBalance)
                                                        temp_double = iCurrSum - (iDebitSum - iOutstandingBalance);
                                                    else
                                                        temp_double = Convert.ToDouble(dtBills.Rows[ibottomRow]["DEBIT"].ToString());
                                                    temp_word = Convert.ToDateTime(dtBills.Rows[ibottomRow]["DATE"].ToString()).ToShortDateString();
                                                    temp_word1 = ConnectionWithAccess.ma_n + "," + ConnectionWithAccess.ms_a + "," + temp_word + "," + dtBills.Rows[ibottomRow]["DOCUMENTS"].ToString() + "," + temp_double.ToString();
                                                    temporary_list_2.Add(temp_word1);
                                                    ibottomRow = ibottomRow - 1;
                                                }
                                                else
                                                    bLoop = false;
                                            }
                                            for (int i = iRowNum.Count; i > 0; i--)
                                            {
                                                dtBillList.ImportRow(dtBills.Rows[iRowNum[i - 1]]);
                                            }
                                            dtTable = dtBillList;
                                        }
                                        else if (dtBills.Rows.Count == 1)
                                        {
                                            temp_word = Convert.ToDateTime(dtBills.Rows[0]["DATE"].ToString()).ToShortDateString();
                                            temp_word1 = ConnectionWithAccess.ma_n + "," + ConnectionWithAccess.ms_a + "," + temp_word + "," + dtBills.Rows[0]["DOCUMENTS"].ToString() + "," + iOutstandingBalance.ToString();
                                            temporary_list_2.Add(temp_word1);
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            return dtTable;
        }

        private DataTable fGetOutstaningBalanceData(string strrla_n, string strrls_a)
        {
            DataTable dtTable = new DataTable();
            {
                dgvOutstanding.Visible = true;
                contains_for_Outstanding_Report(strrla_n, strrls_a, (OutTo.Value).ToString());
                if (dgvOutstanding.Columns.Count > 1)
                {
                    if (dgvOutstanding.Rows.Count > 0)
                    {
                        double iOutstandingBalance = 0;
                        get_account_details_from_01(strrla_n, strrls_a);
                        if (cmbDateRangeOut.Text != "Full Period")
                        {
                            if (Convert.ToDateTime(OutFrom.Text) > Convert.ToDateTime(ConnectionWithAccess.com_start_date))
                                delete_old_date_record(dgvOutstanding, 3, OutFrom.Text);
                        }
                        DataTable dtNewTable = ((DataTable)dgvOutstanding.DataSource).Clone();

                        dtNewTable = ((DataTable)dgvOutstanding.DataSource);

                        if (dtNewTable.Rows.Count == 1)
                        {
                            double.TryParse(dtNewTable.Rows[0]["DEBIT"].ToString(), out iOutstandingBalance);
                            temp_word = Convert.ToDateTime(dtNewTable.Rows[0]["DATE"].ToString()).ToShortDateString();
                            temp_word1 = ConnectionWithAccess.ma_n + "," + ConnectionWithAccess.ms_a + "," + temp_word + "," + dtNewTable.Rows[0]["DOCUMENTS"].ToString() + "," + dtNewTable.Rows[0]["DEBIT"].ToString();
                            temporary_list_2.Add(temp_word1);
                        }
                        else if (dtNewTable.Rows.Count > 1)
                        {
                            DataView view = new DataView(dtNewTable);
                            DataColumnCollection columns = dtNewTable.Columns;
                            if (columns.Contains("Date"))
                            {
                                view.Sort = "[Date] asc";
                            }

                            DataTable dtNewTable1 = view.ToTable();

                            DataTable sortedTable = update_datatable_balances(dtNewTable1, 6, 7, 8);

                            string strTotalCol1 = getTotal_Datatable(sortedTable, 6);
                            string strTotalCol2 = getTotal_Datatable(sortedTable, 7);

                            //if (!string.IsNullOrEmpty(strTotalCol1) && !string.IsNullOrEmpty(strTotalCol2))
                            //{
                            //    DataRow drTotalRow = sortedTable.NewRow();
                            //    //drTotalRow[6] = strTotalCol1;
                            //    //drTotalRow[7] = strTotalCol2;
                            //    sortedTable.Rows.Add(drTotalRow);
                            //}

                            iOutstandingBalance = 0;
                            string strAccName = string.Empty;

                            if (sortedTable != null && sortedTable.Rows.Count > 1)
                            {
                                //strAccName = sortedTable.Rows[0]["ACC_NAME"].ToString();
                                double.TryParse(sortedTable.Rows[sortedTable.Rows.Count - 1]["balance"].ToString(), out iOutstandingBalance);
                                if (iOutstandingBalance > 0)
                                {
                                    if (!chkBill.Checked)
                                    {
                                        DataTable dtSummary = new DataTable();
                                        DataColumn dcName = new DataColumn("Name");
                                        DataColumn dcCity = new DataColumn("City");
                                        DataColumn dcBalance = new DataColumn("Balance");

                                        dtSummary.Columns.Add(dcName);
                                        dtSummary.Columns.Add(dcCity);
                                        dtSummary.Columns.Add(dcBalance);

                                        DataRow dtNewRow = dtSummary.NewRow();
                                        dtNewRow["Name"] = account_detail_from_01[4];
                                        dtNewRow["City"] = account_detail_from_01[8];
                                        dtNewRow["Balance"] = iOutstandingBalance;

                                        dtSummary.Rows.Add(dtNewRow);
                                        dtTable = dtSummary;
                                        temp_word = ConnectionWithAccess.ma_n + "," + ConnectionWithAccess.ms_a + "," + account_detail_from_01[4] + "," + account_detail_from_01[8] + "," + iOutstandingBalance;
                                        temporary_list_2.Add(temp_word);
                                    }
                                    else
                                    {
                                        isRecord = 0;
                                        for (row_counter = 0; row_counter < sortedTable.Rows.Count - 1; row_counter++)
                                        {
                                            if (Convert.ToDouble(sortedTable.Rows[row_counter]["DEBIT"].ToString()) != 0.00)
                                            {
                                                isRecord = 1;
                                                row_counter = sortedTable.Rows.Count;
                                            }
                                        }
                                        if (isRecord == 1)
                                        {
                                            //foreach (DataRow dr in sortedTable.Rows)
                                            //{
                                            //    temp_word = dr["date"].ToString();
                                            //    if (dr["date"].ToString() == "")
                                            //        dr[6] = "0.00";
                                            //}
                                            DataTable dtBills1 = sortedTable.Select("DEBIT > 0").CopyToDataTable();
                                            DataView view1 = new DataView(dtBills1);
                                            DataColumnCollection columns1 = dtBills1.Columns;
                                            if (columns1.Contains("Date"))
                                            {
                                                view1.Sort = "[Date] asc";
                                            }
                                            DataTable dtBills = view1.ToTable();
                                            //DataTable dtBills = sortedTable.Select("ACC_TYPE = 'Sale'").CopyToDataTable();
                                            if (dtBills != null && dtBills.Rows.Count > 0)
                                            {
                                                double iCurrSum = 0;
                                                DataTable dtBillList = dtBills.Clone();
                                                if (dtBills.Rows.Count > 2)
                                                {
                                                    bool bLoop = true;
                                                    int ibottomRow = dtBills.Rows.Count - 1;
                                                    double iDebitSum = 0;
                                                    List<int> iRowNum = new List<int>();
                                                    while (bLoop)
                                                    {
                                                        if (iOutstandingBalance > iDebitSum && ibottomRow >= 0)
                                                            iCurrSum = Convert.ToDouble(dtBills.Rows[ibottomRow]["DEBIT"].ToString());
                                                        if (iDebitSum < iOutstandingBalance)
                                                        {
                                                            if (iCurrSum < (iOutstandingBalance - iDebitSum))
                                                            {
                                                                if (iDebitSum == 0 && iCurrSum > iOutstandingBalance)
                                                                    temp_word2 = Math.Round(iOutstandingBalance, 2).ToString();
                                                                else
                                                                    temp_word2 = Math.Round(iCurrSum, 2).ToString();
                                                            }
                                                            else
                                                                temp_word2 = Math.Round((iOutstandingBalance - iDebitSum), 2).ToString();
                                                            iDebitSum += iCurrSum;
                                                            iRowNum.Add(ibottomRow);
                                                            temp_word = Convert.ToDateTime(dtBills.Rows[ibottomRow]["DATE"].ToString()).ToShortDateString();
                                                            //temp_word1 = ConnectionWithAccess.ma_n + "," + ConnectionWithAccess.ms_a + "," + temp_word + "," + dtBills.Rows[ibottomRow]["DOCUMENTS"].ToString() + "," + dtBills.Rows[ibottomRow]["DEBIT"].ToString();
                                                            temp_word1 = ConnectionWithAccess.ma_n + "," + ConnectionWithAccess.ms_a + "," + temp_word + "," + dtBills.Rows[ibottomRow]["DOCUMENTS"].ToString() + "," + temp_word2;
                                                            temporary_list_2.Add(temp_word1);
                                                            ibottomRow = ibottomRow - 1;
                                                        }
                                                        else
                                                            bLoop = false;
                                                    }
                                                    for (int i = iRowNum.Count; i > 0; i--)
                                                    {
                                                        dtBillList.ImportRow(dtBills.Rows[iRowNum[i - 1]]);
                                                    }
                                                    dtTable = dtBillList;
                                                }
                                                else if (dtBills.Rows.Count == 2)
                                                {
                                                    bool bLoop = true;
                                                    int ibottomRow = dtBills.Rows.Count - 1;
                                                    double iDebitSum = 0;
                                                    List<int> iRowNum = new List<int>();
                                                    while (bLoop)
                                                    {
                                                        if (iOutstandingBalance > iDebitSum && ibottomRow >= 0)
                                                            iCurrSum = Convert.ToDouble(dtBills.Rows[ibottomRow]["DEBIT"].ToString());
                                                        if (iDebitSum < iOutstandingBalance)
                                                        {
                                                            iDebitSum += iCurrSum;
                                                            iRowNum.Add(ibottomRow);
                                                            if (iDebitSum > iOutstandingBalance)
                                                                temp_double = iCurrSum - (iDebitSum - iOutstandingBalance);
                                                            else
                                                                temp_double = Convert.ToDouble(dtBills.Rows[ibottomRow]["DEBIT"].ToString());
                                                            temp_word = Convert.ToDateTime(dtBills.Rows[ibottomRow]["DATE"].ToString()).ToShortDateString();
                                                            temp_word1 = ConnectionWithAccess.ma_n + "," + ConnectionWithAccess.ms_a + "," + temp_word + "," + dtBills.Rows[ibottomRow]["DOCUMENTS"].ToString() + "," + temp_double.ToString();
                                                            temporary_list_2.Add(temp_word1);
                                                            ibottomRow = ibottomRow - 1;
                                                        }
                                                        else
                                                            bLoop = false;
                                                    }
                                                    for (int i = iRowNum.Count; i > 0; i--)
                                                    {
                                                        dtBillList.ImportRow(dtBills.Rows[iRowNum[i - 1]]);
                                                    }
                                                    dtTable = dtBillList;
                                                }
                                                else if (dtBills.Rows.Count == 1)
                                                {
                                                    temp_word = Convert.ToDateTime(dtBills.Rows[0]["DATE"].ToString()).ToShortDateString();
                                                    temp_word1 = ConnectionWithAccess.ma_n + "," + ConnectionWithAccess.ms_a + "," + temp_word + "," + dtBills.Rows[0]["DOCUMENTS"].ToString() + "," + iOutstandingBalance.ToString();
                                                    temporary_list_2.Add(temp_word1);
                                                }
                                            }
                                        }
                                    }
                                }
                                else
                                {
                                    temp_word = ConnectionWithAccess.ma_n + "," + ConnectionWithAccess.ms_a + "," + account_detail_from_01[4] + "," + account_detail_from_01[8] + "," + iOutstandingBalance;
                                    temporary_list_2.Add(temp_word);
                                }
                            }
                        }
                    }
                }
            }
            return dtTable;
        }

        private void btnGenerateOutstandingReport_Click(object sender, EventArgs e)
        {
            btnGenerateOutstandingReport.Visible = false;
            temporary_list_1.Clear();
            temporary_list_2.Clear();
            temporary_list_3.Clear();
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data");
            objPleaseWait.Show();
            Application.DoEvents();
            ConnectionWithAccess.ma_n = get_a_n_from_d_c("S", Convert.ToInt32(rodbc.Text));
            get_list_of_outstanding_accounts();
            if (chkBill.Checked)
            {
                for (array_counter1 = 0; array_counter1 < temporary_list_1.Count(); array_counter1++)
                //for (array_counter1 = 0; array_counter1 < 20; array_counter1++)
                {
                    var cellArray = temporary_list_1[array_counter1].Split(new[] { ',' });
                    ConnectionWithAccess.ms_a = cellArray[2];
                    if (Convert.ToSingle(cellArray[3]) > 0)
                    {
                        extract_outstanding_details_of_accounts();
                        if (array_counter1 == 31)
                            temp_word2 = "";
                    }
                }
                generate_outstanding_list_with_invoices();
            }
            else
                generate_outstanding_list_only();
            atbpreview_Click(sender, e);
            objPleaseWait.Close();
        }

        private void generate_outstanding_list_only()
        {
            total_double = 0;
            pdf_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\" + "Outstanding_List" + "_" + rodbc.Text;
            if (chb_add_datetime_in_output.Checked)
                pdf_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            pdf_filename += ".pdf";
            doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
            FileStream FS1 = File.Create(pdf_filename);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            add_header_footer = true;
            header_text_message = "Debitor's Outstainding Report [" + mix_dt_from.Value.ToShortDateString() + "-" + mix_dt_to.Value.ToShortDateString() + "]" + " as on " + DateTime.Today.Date.ToShortDateString();
            pdf_top_heading = "Sr.no                    Name    City                                                                                                  Amount ";
            //print_header_footer();
            Paragraph para = new Paragraph("");
            para.Font.Size = 25;
            //temp_word = ConnectionWithAccess.company_details[1];
            //print_pdf_line(cour_11_bold, temp_word, 50,0);
            //temp_word = "Debitor's Outstainding Report [" + mix_dt_from.Value.ToShortDateString() + "-" + mix_dt_to.Value.ToShortDateString() + "]"  + " as on " + DateTime.Today.Date.ToShortDateString();
            //print_pdf_line(cour_11_bold, temp_word, 50, 0);
            for (array_counter1 = 0; array_counter1 < temporary_list_1.Count(); array_counter1++)
            {
                temp_word = (array_counter1 + 1).ToString();
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(0, temp_word, "cour_11"), 0);
                var cellArray = temporary_list_1[array_counter1].Split(new[] { ',' });
                get_account_details_from_01(cellArray[1], cellArray[2]);
                temp_word = account_detail_from_01[4] + "," + account_detail_from_01[8];
                print_pdf_line(cour_11, temp_word, 90, -16);
                temp_word = cellArray[3].ToString();
                total_double += Convert.ToDouble(temp_word);
                temp_word = string.Format("{0:0.00}", Convert.ToDouble(temp_word));
                print_pdf_line(cour_11, temp_word, para_IndentationLeft_position(400, temp_word, "cour_11"), -18);
            }
            temp_word = "------------------";
            print_pdf_line(cour_9, temp_word, 420, 0);
            print_pdf_line(cour_9, "Total", 350, -7);
            temp_word = string.Format("{0:0.00}", total_double);
            print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(398, temp_word, "cour_9"), -16);
            temp_word = "==========";
            print_pdf_line(cour_9, temp_word, 420, -7);
            doc1.Close();
        }

        private void generate_outstanding_list_with_invoices()
        {
            total_double = 0;
            pdf_filename = ConnectionWithAccess.data_drive + "acc\\" + ConnectionWithAccess.mNIK + "\\reports\\" + "Outstanding_List" + "_" + rodbc.Text;
            if (chb_add_datetime_in_output.Checked)
                pdf_filename += "_" + DateTime.Now.Day + "_" + DateTime.Now.Month + "_" + DateTime.Now.Year + "_" + DateTime.Now.TimeOfDay.Hours + "_" + DateTime.Now.TimeOfDay.Minutes;
            pdf_filename += ".pdf";
            doc1 = new Document(PageSize.A4, 10, 10, 35, 20);
            FileStream FS1 = File.Create(pdf_filename);
            writer = PdfWriter.GetInstance(doc1, FS1);
            doc1.Open();
            current_pdf_page_number = 1;
            add_header_footer = true;
            header_text_message = "Debitor's Outstainding Report [" + mix_dt_from.Value.ToShortDateString() + "-" + mix_dt_to.Value.ToShortDateString() + "]" + " as on " + DateTime.Today.Date.ToShortDateString();
            Paragraph para = new Paragraph("");
            para.Font.Size = 25;
            for (array_counter1 = 0; array_counter1 < temporary_list_1.Count(); array_counter1++)
            {
                temp_word = (array_counter1 + 1).ToString();
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(-20, temp_word, "cour_9"), 0);
                var cellArray = temporary_list_1[array_counter1].Split(new[] { ',' });
                get_account_details_from_01(cellArray[1], cellArray[2]);
                temp_word = account_detail_from_01[4] + "," + account_detail_from_01[8];
                print_pdf_line(cour_9, temp_word, 70, -16);
                temp_word = cellArray[3].ToString();
                total_double += Convert.ToDouble(temp_word);
                temp_word = string.Format("{0:0.00}", Convert.ToDouble(temp_word));
                print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(400, temp_word, "cour_9"), -16);
                for (array_counter2 = 0; array_counter2 < temporary_list_2.Count(); array_counter2++)
                {
                    var cellArray2 = temporary_list_2[array_counter2].Split(new[] { ',' });
                    if (cellArray[1].Trim() == cellArray2[0].Trim() && cellArray[2].Trim() == cellArray2[1].Trim())
                    {
                        temp_int = 0;
                        print_pdf_line(cour_9, cellArray2[3].ToString(), 100, 0);
                        print_pdf_line(cour_9, cellArray2[2].ToString(), 130, -16);
                        temp_datetime = Convert.ToDateTime(cellArray2[2]);
                        if (DateTime.Today.Date > temp_datetime)
                            temp_int = (DateTime.Today.Date - temp_datetime.Date).Days;
                        temp_word = "[" + temp_int.ToString() + "]";
                        print_pdf_line(cour_9_bold, temp_word, 185, -16);
                        temp_word = cellArray2[4];
                        temp_word = string.Format("{0:0.00}", Convert.ToDouble(temp_word));
                        if (temp_int <= 30)
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(200, temp_word, "cour_9"), -16);
                        else if (temp_int > 30 && temp_int <= 60)
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(240, temp_word, "cour_9"), -16);
                        else if (temp_int > 60 && temp_int <= 120)
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(280, temp_word, "cour_9"), -16);
                        else if (temp_int > 120)
                            print_pdf_line(cour_9, temp_word, para_IndentationLeft_position(320, temp_word, "cour_9"), -16);
                    }
                }

            }
            temp_word = "------------------";
            print_pdf_line(cour_9, temp_word, 420,0);
            print_pdf_line(cour_9, "Total", 350, -7);
            temp_word = string.Format("{0:0.00}", total_double);
            print_pdf_line(cour_9_bold, temp_word, para_IndentationLeft_position(398, temp_word, "cour_9"), -16);
            temp_word = "==========";
            print_pdf_line(cour_9, temp_word, 420,-7);
            doc1.Close();
        }

        private void extract_outstanding_details_of_accounts()
        {
            DataTable dtOutstandingReprot = fGetOutstaningBalanceData(ConnectionWithAccess.ma_n, ConnectionWithAccess.ms_a);
            if (dtOutstandingReprot != null && dtOutstandingReprot.Rows.Count > 0)
            {
                dgvOutstanding.DataSource = null;
                dgvOutstanding.DataSource = dtOutstandingReprot;
                if (chkBill.Checked)
                    ConnectionCommand.hide_columns_of_datagridview(dgvOutstanding, "0,1,2");
            }
        }

        private void get_list_of_outstanding_accounts()
        {
            if (AFOutstanding.tbselacc.Text == "0 Selected" && AFOutstanding.tbreportcity.Text == "0 Selected" && AFOutstanding.tbreprotArea.Text == "0 Selected" && AFOutstanding.tbreportitems.Text == "0 Selected" && AFOutstanding.tbreporttax.Text == "0 Selected")
                ConnectionWithAccess.query = "select prd,a_n,s_a,amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + ConnectionWithAccess.mprd + "' and a_n = '" + ConnectionWithAccess.ma_n + "' and s_a <> '@@@' and d_d = #01/01/1901# and amt <> 0 order by a_n,s_a";
            else
            {
                if (AFOutstanding.tbselacc.Text != "0 Selected")
                    ConnectionWithAccess.query = "select f51.prd, f51.a_n, f51.s_a, f51.amt, f1.[desc] from " + ConnectionWithAccess.tablename[1] + " f1, " + ConnectionWithAccess.tablename[51] + " f51 where f51.a_n = '" + ConnectionWithAccess.ma_n + "' and f1.a_n = f51.a_n and f1.s_a = f51.s_a and f51.prd = '" + ConnectionWithAccess.mprd + "' and f1.[desc] in (" + AFOutstanding.selectedPartyList + ") and f1.city in (" + AFOutstanding.selectedPartyCityList + ") and f51.d_d = #01/01/1901# and d_y = '@@@'and f51.amt <> 0";
                else if (AFOutstanding.tbreportcity.Text != "0 Selected")
                    ConnectionWithAccess.query = "select f51.prd, f51.a_n, f51.s_a, f51.amt, f1.[desc] from " + ConnectionWithAccess.tablename[1] + " f1, " + ConnectionWithAccess.tablename[51] + " f51 where f51.a_n = '" + ConnectionWithAccess.ma_n + "' and f1.a_n = f51.a_n and f1.s_a = f51.s_a and f51.prd = '" + ConnectionWithAccess.mprd + "' and f1.city in (" + AFOutstanding.selectedCityList + ") and f51.d_d = #01/01/1901# and d_y = '@@@' and f51.amt <> 0";
                else if (AFOutstanding.tbreprotArea.Text != "0 Selected")
                    ConnectionWithAccess.query = "select f51.prd,f51.a_n,f51.s_a,f51.amt from " + ConnectionWithAccess.tablename[51] + " f51, " + ConnectionWithAccess.tablename[01] + " f1, " + ConnectionWithAccess.tablename[02] + " f2 where f1.a_n = f51.a_n and f1.s_a = f51.s_a and f2.city = f1.city and f51.prd = '" + ConnectionWithAccess.mprd + "' and f51.a_n = '" + ConnectionWithAccess.ma_n + "' and f51.s_a <> '@@@' and f51.d_d = #01/01/1901# and f51.amt <> 0 and f2.Area_code in (" + AFOutstanding.selectedAreaList + ")  and d_y = '@@@' order by f51.a_n,f51.s_a";
                else if (AFOutstanding.tbreporttax.Text != "0 Selected")
                    ConnectionWithAccess.query = "select prd,a_n,s_a,amt from " + ConnectionWithAccess.tablename[51] + " where prd = '" + ConnectionWithAccess.mprd + "' and a_n = '" + ConnectionWithAccess.ma_n + "' and s_a <> '@@@' and f21.tx_code in (" + AFOutstanding.selectedTaxList + ") and d_d = #01/01/1901#  and d_y = '@@@' and amt <> 0";
            }
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                for (int iRowCount = 0; iRowCount < dtData1.Rows.Count; iRowCount++)
                {
                    if (dtData1.Rows[iRowCount][0] != null)
                    {
                        temp_word = emerg_prd + " ," + dtData1.Rows[iRowCount][1].ToString() + " ," + dtData1.Rows[iRowCount][2].ToString() + " ," + dtData1.Rows[iRowCount][3].ToString() + " ,O, 0";
                        temporary_list_1.Add(temp_word);
                    }
                }
            }
        }

        private void cmbDateRangeOut_SelectedIndexChanged(object sender, EventArgs e)
        {
            SetDateOnSelectedDateRange(cmbDateRangeOut, OutFrom, OutTo);
        }

        private void contains_for_Outstanding_Report(string ma_n, string ms_a, string end_date)
        {
            StringBuilder strQuery = new StringBuilder();

            ConnectionWithAccess.query = query_contains_for_ledger_account_union(ma_n, ms_a, end_date);// strQuery.ToString();
            ConnectionCommand.accountHelp_datatable_Seperate(dgvOutstanding, "Outstanding");
        }
        
        private void bpdatetime_ValueChanged(object sender, EventArgs e)
        {
            bpchkdate.Value = bpdatetime.Value;
            bppassdate.Value = bpdatetime.Value;
        }

        private void brdatetime_ValueChanged(object sender, EventArgs e)
        {
            brchkdate.Value = brdatetime.Value;
            brpassdate.Value = brdatetime.Value;
        }

        private void bddatetime_ValueChanged(object sender, EventArgs e)
        {
            bdamt.Focus();
        }

        private void bwdatetime_ValueChanged(object sender, EventArgs e)
        {
            bwamt.Focus();
        }

        private void jj_dgv_gst_tax_brief_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
        {
            e.Control.TextChanged += new EventHandler(textBox_TextChanged);
            cntObject = e.Control;
            cntObject.TextChanged += textBox_TextChanged;
        }

        private void generate_qr_code()
        {
            //if (textBox1.Text == "")
            //{
            //    MessageBox.Show("Please Enter Value ", "Error");
            //    textBox1.Focus();
            //}
            //else
            //{
            //    using (SaveFileDialog sv = new SaveFileDialog() { Filter = "JPEG|.jpg", ValidateNames = true })
            //    {
            //        if (sv.ShowDialog() == DialogResult.OK)
            //        {
            //            MessagingToolkit.QRCode.Codec.QRCodeEncoder encoder = new MessagingToolkit.QRCode.Codec.QRCodeEncoder();
            //            encoder.QRCodeScale = 8;
            //            string encoding = "UserName : " + textBox1.Text + "\r\n" + "CardNo : " + textBox2.Text + "\r\n" + "Address:" + textBox3.Text + "\r\n" + textBox5.Text;
            //            Bitmap bmp = encoder.Encode(encoding);
            //            pictureBox1.Image = bmp;
            //            bmp.Save(sv.FileName, ImageFormat.Jpeg);
            //        }

            //    }
            //}
        }

        private void tb_ledger_account_name_KeyUp(object sender, KeyEventArgs e)
        {
            if (maintab.SelectedIndex == 3 && subtabreports.SelectedIndex == 1)
            {
                pdf_viewer2.Visible = false;
                dgv_ledger_acc_help.Visible = true;
                lbl_ledger_master_account_name.Visible = true;
                LedDGV.Visible = false;
                btn_gen_ledg.Visible = false;
                search_account_name = tb_ledger_account_name.Text;
                if (search_account_name != "")
                    common_account_help(search_account_name);
            }
        }

        bool bsoPartyChangeIgnore = false;
        private void so_party_help_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data");
            objPleaseWait.Show();
            Application.DoEvents();
            int selectedrowindex = so_party_help.SelectedCells[0].RowIndex;
            if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 2)
            {
                bsoPartyChangeIgnore = true;
                sopartycode.Text = Convert.ToString(so_party_help.CurrentRow.Cells[0].Value);
                socity.Text = Convert.ToString(so_party_help.CurrentRow.Cells[1].Value);
                soa_n.Text = Convert.ToString(so_party_help.CurrentRow.Cells[2].Value);
                sos_a.Text = Convert.ToString(so_party_help.CurrentRow.Cells[3].Value);
                get_account_details_from_04(soa_n.Text, sos_a.Text);
                //fill_transport(soa_n.Text, socity.Text, sotransport);
                sotransport.Text = account_detail_from_04[30];
            }
            else if (maintab.SelectedIndex == 1 && subtabDataEntry.SelectedIndex == 0 && subtabsale.SelectedIndex == 1)
            {

                sopartycode.Text = Convert.ToString(so_party_help.CurrentRow.Cells[0].Value);
                //socity.Text = Convert.ToString(so_party_help.Rows[selectedrowindex].Cells[1].Value);
                soa_n.Text = Convert.ToString(so_party_help.CurrentRow.Cells[2].Value);
                sos_a.Text = Convert.ToString(so_party_help.CurrentRow.Cells[3].Value);
            }
            populate_screen();
            if (sotaxcode.Text != "")
                get_tax_desc_from_dc("S", sodbc.Text, Convert.ToInt32(sotaxcode.Text));
            show_images();
            so_party_help.Visible = false;
            soitemlist.Enabled = true;
            objPleaseWait.Close();
        }

        private void dgvOutstanding_SelectionChanged(object sender, EventArgs e)
        {
            DataTable dtSaleList = null;
            dgvOutStandingItems.DataSource = null;
            if (chkBill.Checked && chkBill_items.Checked)
            {
                if (dgvOutstanding.Rows.Count > 3)
                {
                    if (dgvOutstanding.CurrentRow.Cells["prd"].Value != null && !string.IsNullOrEmpty(dgvOutstanding.CurrentRow.Cells["prd"].Value.ToString()))
                    {
                        dtSaleList = fGetSaleDetails("S", dgvOutstanding.CurrentRow.Cells["prd"].Value.ToString(), Convert.ToInt32(dgvOutstanding.CurrentRow.Cells["d_c"].Value.ToString()), dgvOutstanding.CurrentRow.Cells["ACC_NAME"].Value.ToString(), dgvOutstanding.CurrentRow.Cells["s_a"].Value.ToString(), dgvOutstanding.CurrentRow.Cells["DOCUMENTS"].Value.ToString());
                        if (dtSaleList != null && dtSaleList.Rows.Count > 0)
                        {
                            dgvOutStandingItems.Visible = true;
                            dgvOutStandingItems.DataSource = dtSaleList;
                        }
                        else
                        {
                            dgvOutStandingItems.Visible = false;
                        }
                    }
                }
            }
        }

        private void tb_outstanding_acc_name_KeyUp(object sender, KeyEventArgs e)
        {
            ro_account_help.Visible = true;
            function_working = "Outstanding Account";
            ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[desc] like '%" + tb_outstanding_acc_name.Text + "%'";
            ConnectionCommand.accountHelp_datatable_Seperate(ro_account_help, "ro_account_help");
            if (ro_account_help.Rows.Count == 1)
            {
                ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[city] like '%" + tb_outstanding_acc_name.Text + "%'";
                ConnectionCommand.accountHelp_datatable_Seperate(ro_account_help, "ro_account_help");
                if (ro_account_help.Rows.Count == 1)
                    ro_account_help.Visible = false;
            }
        }

        private void ro_account_help_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            rowIndex = ro_account_help.CurrentCell.RowIndex;
            ro_a_n.Text = ro_account_help.Rows[rowIndex].Cells[2].Value.ToString();
            ro_s_a.Text = ro_account_help.Rows[rowIndex].Cells[3].Value.ToString();
            tb_outstanding_acc_name.Text = ro_account_help.Rows[rowIndex].Cells[0].Value.ToString();
            tb_outstanding_acc_city.Text = ro_account_help.Rows[rowIndex].Cells[1].Value.ToString();
            show_images();
            ro_account_help.Visible = false;
            tb_outstanding_acc_name.Focus();
        }

        private void rodbc_SelectedIndexChanged(object sender, EventArgs e)
        {
            ConnectionWithAccess.ma_n = get_a_n_from_d_c("S", Convert.ToInt32(rodbc.Text));
            AFOutstanding.PartyListQuery = "select [desc],city,a_n,s_a from " + ConnectionWithAccess.tablename[01] + " f1 where f1.a_n = '" + ConnectionWithAccess.ma_n + "' and f1.s_a <> '@@@' order by a_n,s_a";
            AFOutstanding.CityListQuery = "select distinct [city] from " + ConnectionWithAccess.tablename[01] + " f1 where f1.a_n = '" + ConnectionWithAccess.ma_n + "' and f1.s_a <> '@@@'";
            AFOutstanding.TaxListQuery = "select distinct f6.tx_code, f6.[desc] from " + ConnectionWithAccess.tablename[06] + " f6 where f6.d_c = " + rodbc.Text;
            AFOutstanding.AreaListQuery = "select distinct area_code from " + ConnectionWithAccess.tablename[02];
        }

        private void blstgp_TextChanged(object sender, EventArgs e)
        {
            if (blstgp.Text != "" && blstgp.Text != "-")
            {
                check_data_type(blstgp.Text);
                if (data_type == "Numeric")
                {
                    if (Convert.ToDouble(blstgp.Text) < 0)
                    {
                        blstgp.BackColor = Color.Red;
                    }
                    else
                        blstgp.BackColor = Color.Green;
                }
            }
        }

        #region Bank Excel Upload
        private void txtBankAccountName_TextChanged(object sender, EventArgs e)
        {

            ConnectionWithAccess.data_entry_working = "Bank Payment";
            //ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where (d_y is null or d_y ='') and [desc] like '%" + bppartycode.Text + "%'";
            ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[desc] like '%" + txtBankAccountName.Text + "%'";
            ConnectionCommand.accountHelp_datatable(dgvBankExcelAccName, "bp_datagridview");
            if (dgvBankExcelAccName.Rows.Count == 1)
            {
                ConnectionWithAccess.query = "select f1.[desc], f1.city, f1.a_n, f1.s_a , f2.[desc] as [Master Account] from " + ConnectionWithAccess.tablename[01] + " f1 left outer join " + ConnectionWithAccess.tablename[01] + " f2 on f2.a_n = f1.a_n where f2.s_a = '@@@' and f1.[city] like '%" + txtBankAccountName.Text + "%'";
                ConnectionCommand.accountHelp_datatable(dgvBankExcelAccName, "bp_datagridview");
            }
            if (dgvBankExcelAccName.CurrentRow != null)
            {
                common_account_head(dgvBankExcelAccName.CurrentRow.Cells[2].Value.ToString());
                //lbl_bp_account_head.Text = ConnectionWithAccess.macc_desc;
            }

            //dgv_ledger_acc_help.Visible = true;
            //lbl_ledger_master_account_name.Visible = true;
            //LedDGV.Visible = false;
            //btn_gen_ledg.Visible = false;
            //search_account_name = tb_ledger_account_name.Text;
            //if (search_account_name != "")
            //    common_account_help(search_account_name);
        }

        private void btnBankExcelClear_Click(object sender, EventArgs e)
        {
            dgvBankExcelUpload.DataSource = null;
            pnlBankExcel.Visible = false;
        }

        private void btnBankExcelImport_Click(object sender, EventArgs e)
        {
            DataTable dtBank = null;
            pnlBankExcel.Visible = false;
            string strBankExcelFileName = string.Empty;
            OpenFileDialog openFileDialog = new OpenFileDialog();
            openFileDialog.InitialDirectory = Environment.GetFolderPath(Environment.SpecialFolder.Personal);
            openFileDialog.Filter = "Text Files (*.xls)|*.xls|All Files (*.*)|*.*";
            if (openFileDialog.ShowDialog(this) == DialogResult.OK)
            {
                strBankExcelFileName = openFileDialog.FileName;
            }

            if (!string.IsNullOrEmpty(strBankExcelFileName))
            {
                dtBank = ExcelToDataTable(strBankExcelFileName);
                if (dtBank != null && dtBank.Rows.Count > 0)
                {
                    //dgvBankExcelUpload.AutoGenerateColumns = true;
                    dgvBankExcelUpload.DataSource = dtBank;
                    pnlBankExcel.Visible = true;
                }
            }
        }

        public DataTable ExcelToDataTable(string strFilePath)
        {
            DataTable dtResult = new DataTable();
            DataColumn dcDate = new DataColumn("Date", typeof(DateTime));
            DataColumn dcDesc = new DataColumn("Desc");
            DataColumn dcDebitAmt = new DataColumn("DebitAmt");
            DataColumn dcCreditAmt = new DataColumn("CreditAmt");
            DataColumn dcValueDate = new DataColumn("ValueDate", typeof(DateTime));

            dtResult.Columns.Add(dcDate);
            dtResult.Columns.Add(dcDesc);
            dtResult.Columns.Add(dcDebitAmt);
            dtResult.Columns.Add(dcCreditAmt);
            dtResult.Columns.Add(dcValueDate);

            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(strFilePath);
            Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];
            Excel.Range xlRange = xlWorksheet.UsedRange;

            int rowCount = xlRange.Rows.Count;
            int colCount = xlRange.Columns.Count;

            for (int i = 1; i <= rowCount; i++)
            {
                if (xlRange.Cells[i, 2].Value != null && !string.IsNullOrEmpty(xlRange.Cells[i, 2].Value.ToString()) && xlRange.Cells[i, 1].Value != null && xlRange.Cells[i, 1].Value.ToString() != "SrNo")
                {//Add row to datatable
                    DataRow drNewRow = dtResult.NewRow();
                    drNewRow["Date"] = Convert.ToDateTime(xlRange.Cells[i, 2].Value.ToString());
                    drNewRow["Desc"] = xlRange.Cells[i, 3].Value.ToString();
                    if (xlRange.Cells[i, 6].Value.ToString().Trim().Equals("-"))
                        drNewRow["DebitAmt"] = "0";
                    else
                        drNewRow["DebitAmt"] = xlRange.Cells[i, 6].Value.ToString();
                    if (xlRange.Cells[i, 7].Value.ToString().Trim().Equals("-"))
                        drNewRow["CreditAmt"] = "0";
                    else
                        drNewRow["CreditAmt"] = xlRange.Cells[i, 7].Value.ToString();
                    drNewRow["ValueDate"] = Convert.ToDateTime(xlRange.Cells[i, 9].Value.ToString());

                    dtResult.Rows.Add(drNewRow);
                }
            }

            return dtResult;
        }

        private void txtBankAccountName_KeyPress(object sender, KeyPressEventArgs e)
        {
            dgvBankExcelAccName.Visible = true;
            dgvBankExcelAccName.BringToFront();
        }

        private void dgvBankExcelAccName_Click(object sender, EventArgs e)
        {
            bea_n.Text = dgvBankExcelAccName.CurrentRow.Cells[2].Value.ToString();
            bes_a.Text = Convert.ToString(dgvBankExcelAccName.CurrentRow.Cells[3].Value);
            txtBankAccountName.Text = Convert.ToString(dgvBankExcelAccName.CurrentRow.Cells[0].Value);
            dgvBankExcelAccName.Visible = false;
        }

        private void dgvBankExcelAccName_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                bea_n.Text = dgvBankExcelAccName.CurrentRow.Cells[2].Value.ToString();
                bes_a.Text = Convert.ToString(dgvBankExcelAccName.CurrentRow.Cells[3].Value);
                txtBankAccountName.Text = Convert.ToString(dgvBankExcelAccName.CurrentRow.Cells[0].Value);
                dgvBankExcelAccName.Visible = false;
            }
        }

        private void fUploadBankDetails()
        {
            foreach (DataGridViewRow dgRow in dgvBankExcelAccName.Rows)
            {
                if (Convert.ToBoolean(dgRow.Cells[0].Value) == true)
                {
                    string strPeriod = "A"; //TODO:: Get actual Period
                    string strd_c = dgRow.Cells[2].Value.ToString();
                    string strTran_d_c = dgRow.Cells[2].Value.ToString();
                    string strr_p = dgRow.Cells[2].Value.ToString();
                    string strb_t = dgRow.Cells[2].Value.ToString();
                    string strd_n = dgRow.Cells[2].Value.ToString();
                    string strd_d = dgRow.Cells[2].Value.ToString();
                    string stra_n = dgRow.Cells[2].Value.ToString();
                    string strs_a = dgRow.Cells[3].Value.ToString();
                    double bamt = Convert.ToDouble(dgRow.Cells[3].Value.ToString());
                    string strPassDate = dgRow.Cells[3].Value.ToString();

                    //ConnectionWithAccess.query = "select * from " + + "where 

                    ConnectionWithAccess.query = "insert into " + ConnectionWithAccess.tablename[23] + " (prd, [d_c], [Tran_d_c],  [r_p], b_t, d_n, d_d, a_n, s_a, bamt, pass_date) " +
                        " values('" + strPeriod + "', '" + strd_c + "','" + strTran_d_c + "', '" + strr_p + "',  '" + strb_t + "', '" + strd_n + "', '" + strd_d + "' , '" + stra_n + "', '" + strs_a + "', " + bamt.ToString() + ", " + strPassDate +" )";
                    ConnectionCommand.fUpdateInsertDeleteData();
                }
            }
        }

        #endregion Bank Excel Upload

        private void sopartycode_KeyUp(object sender, KeyEventArgs e)
        {
            so_party_help.Visible = true;
            ConnectionWithAccess.data_entry_working = "Sale Order Party";
            //ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + Convert.ToInt32(sodbc.Text) + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='') and [desc] like '%" + sopartycode.Text + "%'";
            ConnectionWithAccess.query = "select [desc], city, a_n, s_a,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[7] + " where d_c = " + Convert.ToInt32(sodbc.Text) + " and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[7] + " where d_c = " + Convert.ToInt32(sodbc.Text) + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='@@@') and [desc] like '%" + sopartycode.Text + "%'";
            ConnectionCommand.accountHelp_datatable(so_party_help, "so_party_help");
            if (so_party_help.Rows.Count == 1)
            {
                ConnectionWithAccess.query = "select [desc], city, a_n, s_a,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[7] + " where d_c = " + Convert.ToInt32(sodbc.Text) + " and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[7] + " where d_c = " + Convert.ToInt32(sodbc.Text) + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='@@@') and [city] like '%" + sopartycode.Text + "%'";
                ConnectionCommand.accountHelp_datatable(so_party_help, "so_party_help");
            }
        }

        private void siitemlist_KeyUp(object sender, KeyEventArgs e)
        {
            if (siitemlist.CurrentCell != null)
            {
                ConnectionWithAccess.data_entry_working = "Sale Item";
                if (Control.ModifierKeys == Keys.Down)
                {
                    mRowIndex = siitemlist.SelectedCells[0].RowIndex;
                    mtype = Convert.ToString(siitemlist.Rows[mRowIndex].Cells[0].Value);
                    mitem_code = Convert.ToString(siitemlist.Rows[mRowIndex].Cells[1].Value);
                    mtitle = Convert.ToString(siitemlist.Rows[mRowIndex].Cells[2].Value);
                }
                else
                {
                    columnIndex = siitemlist.CurrentCell.ColumnIndex;
                    if (columnIndex == 3)
                    {
                        mtype = Convert.ToString(siitemlist.Rows[siitemlistrowindex].Cells[0].Value);
                        mitem_code = Convert.ToString(siitemlist.Rows[siitemlistrowindex].Cells[1].Value);
                        mtitle = Convert.ToString(siitemlist.Rows[mRowIndex].Cells[2].Value);
                        ConnectionWithAccess.query = "select packing, box from " + ConnectionWithAccess.tablename[05] + " where [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
                        DataTable dtData1 = ConnectionCommand.fGetDataTable();
                        if (dtData1 != null && dtData1.Rows.Count > 0)
                        {
                            if (dtData1.Rows[0][0] != null)
                            {
                                mbox = Convert.ToDouble(dtData1.Rows[0][0].ToString());
                                mqty = Convert.ToDouble(dtData1.Rows[0][1].ToString());
                            }
                        }
                        temp_word = Convert.ToString(siitemlist.Rows[siitemlistrowindex].Cells[3].Value);
                        if (temp_word != "")
                        {
                            mcase = Convert.ToDouble(siitemlist.Rows[siitemlistrowindex].Cells[3].Value);
                            siitemlist.Rows[siitemlistrowindex].Cells[4].Value = mbox * mcase;
                            temp_word = Convert.ToString(siitemlist.Rows[siitemlistrowindex].Cells[4].Value);
                            if (temp_word != "")
                                siitemlist.Rows[siitemlistrowindex].Cells[5].Value = (Convert.ToDouble(siitemlist.Rows[siitemlistrowindex].Cells[4].Value)) * mqty;
                            temp_word = Convert.ToString(siitemlist.Rows[siitemlistrowindex].Cells[5].Value);
                        }
                        //if (ConnectionWithAccess.mUserFeatures.Substring(44, 1) != "Y")
                        if (!chb_allow_stock_check_bypass.Checked && item_details_from_05.Count > 6)
                        {
                            
                            double.TryParse(item_details_from_05[6].ToString(), out temp_double);
                            if (temp_double == 0.0)
                                MessageBox.Show("Sorry, There is no Stock to Sell");
                            else if (mqty > temp_double)
                            {
                                MessageBox.Show("Sorry, Available Stock for sell Quantity is " + temp_double.ToString());
                                if (temp_double > 0)
                                    mqty = temp_double;
                                else
                                    mqty = 0;
                                siitemlist.Rows[siitemlistrowindex].Cells[4].Value = Convert.ToDouble(mqty / Convert.ToDouble(item_details_from_05[4]));
                                siitemlist.Rows[siitemlistrowindex].Cells[5].Value = mqty;
                                mamount = mcase * mbox * mqty * mprice;
                                siitemlist.Rows[siitemlistrowindex].Cells[7].Value = Convert.ToString(mamount);
                            }
                        }
                        calculateSaleItemTotal();
                        show_images();
                    }
                    if (columnIndex == 4)
                    {
                        mtype = Convert.ToString(siitemlist.Rows[siitemlistrowindex].Cells[0].Value);
                        mitem_code = Convert.ToString(siitemlist.Rows[siitemlistrowindex].Cells[1].Value);
                        get_item_details_from_05_using_type_item_code(mtype, mitem_code);
                        temp_word = Convert.ToString(siitemlist.Rows[siitemlistrowindex].Cells[4].Value);
                        if (temp_word != "")
                            siitemlist.Rows[siitemlistrowindex].Cells[5].Value = (Convert.ToDouble(siitemlist.Rows[siitemlistrowindex].Cells[4].Value)) * Convert.ToDouble(item_details_from_05[4].ToString());
                        else
                            siitemlist.Rows[siitemlistrowindex].Cells[5].Value = "0";
                        mqty = Convert.ToDouble(siitemlist.Rows[siitemlistrowindex].Cells[5].Value);
                        if (!chb_allow_stock_check_bypass.Checked)
                        {
                            double.TryParse(item_details_from_05[6].ToString(), out temp_double);
                            if (temp_double == 0.0)
                                MessageBox.Show("Sorry, There is no Stock to Sell");
                            else if (mqty > temp_double)
                            {
                                MessageBox.Show("Sorry, Available Stock for sell Quantity is " + temp_double.ToString());
                                if (temp_double > 0)
                                    mqty = temp_double;
                                else
                                    mqty = 0;
                                siitemlist.Rows[siitemlistrowindex].Cells[4].Value = Convert.ToDouble(mqty / Convert.ToDouble(item_details_from_05[4]));
                                siitemlist.Rows[siitemlistrowindex].Cells[5].Value = mqty;
                                mamount = mcase * mbox * mqty * mprice;
                                siitemlist.Rows[siitemlistrowindex].Cells[7].Value = Convert.ToString(mamount);
                            }
                        }
                        calculateSaleItemTotal();
                        show_images();
                    }
                    if (columnIndex == 5 || columnIndex == 6)
                    {
                        try
                        {
                            //mqty = Convert.ToDouble(siitemlist.Rows[siitemlistrowindex].Cells[5].Value);
                            //update_item_stock_in_o5_using_type_item_code(mtype, mitem_code, mqty);
                            mtype = Convert.ToString(siitemlist.Rows[siitemlistrowindex].Cells[0].Value);
                            mitem_code = Convert.ToString(siitemlist.Rows[siitemlistrowindex].Cells[1].Value);
                            mqty = Convert.ToDouble(siitemlist.Rows[siitemlistrowindex].Cells[5].Value);
                            if (!chb_allow_stock_check_bypass.Checked)
                            {
                                double.TryParse(item_details_from_05[6].ToString(), out temp_double);
                                if (temp_double == 0.0)
                                    MessageBox.Show("Sorry, There is no Stock to Sell");
                                else if (mqty > temp_double)
                                {
                                    MessageBox.Show("Sorry, Available Stock for sell Quantity is " + temp_double.ToString());
                                    if (temp_double > 0)
                                        mqty = temp_double;
                                    else
                                        mqty = 0;
                                    siitemlist.Rows[siitemlistrowindex].Cells[4].Value = Convert.ToDouble(mqty / Convert.ToDouble(item_details_from_05[4]));
                                    siitemlist.Rows[siitemlistrowindex].Cells[5].Value = mqty;
                                    mamount = mcase * mbox * mqty * mprice;
                                    siitemlist.Rows[siitemlistrowindex].Cells[7].Value = Convert.ToString(mamount);
                                }
                            }
                        }
                        catch (Exception ex)
                        {
                        }
                        calculateSaleItemTotal();
                        show_images();
                    }
                }
            }
        }

        private void sodbc_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (sodbc.Text != "")
            {
                ConnectionWithAccess.query = "SELECT max(d_n) +1 from " + ConnectionWithAccess.tablename[7] + " where prd = '" + ConnectionWithAccess.mprd + "' and d_n <> 999999 and d_c = " + Convert.ToInt32(sodbc.Text);
                ConnectionCommand.ExportToText(sodbc, sodocno);
                ConnectionWithAccess.md_n = sodocno.Text;
                soa_n.Text = get_a_n_from_d_c("O", Convert.ToInt32(sodbc.Text));
                fillsosalelist();
            }
        }

        private void sosalelistdg_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data..");
            objPleaseWait.Show();
            Application.DoEvents();
            PopulateSaleDetails();
            objPleaseWait.Close();
        }

        private void sodocno_TextChanged(object sender, EventArgs e)
        {
            oldsaleinvoicedetails();
            sale_invoice_item_filling();
            sicity.Enabled = false;
            set_invoice_date(21, sidocno.Text, Convert.ToInt32(sidbc.Text));
        }

        private void btn_add_delivery_account_Click(object sender, EventArgs e)
        {
            btn_add_delivery_account.Visible = false;
            tbdelivery.Enabled = true;
            tbdelivery_city.Enabled = true;
        }

        private void tbdelivery_desc_KeyUp(object sender, KeyEventArgs e)
        {
            lbl_master_master_account_name.Visible = true;
            if (cbParent.SelectedItem != null)
            {
                if (cbParent.SelectedItem.Equals("Unknown"))
                {
                    ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where [desc] like '%" + tbDesc.Text + "%'";
                    ConnectionCommand.accountHelp_datatable_Seperate(master_account_help_dg, "master_account_help_dg");
                    if (master_account_help_dg.CurrentRow != null)
                    {
                        common_account_head(master_account_help_dg.CurrentRow.Cells[2].Value.ToString());
                        lbl_master_master_account_name.Text = ConnectionWithAccess.macc_desc;
                    }
                    else
                    {
                        MessageBox.Show("Account Cannot be saved with Unknown Parent Account");
                        lbl_master_master_account_name.Text = null;
                    }
                }
                else
                {
                    if (!cb_change_master_account_name.Checked)
                    {
                        ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where a_n like '" + tbA_N.Text + "%' and [desc] like '" + tbDesc.Text + "%'";
                        ConnectionCommand.accountHelp_datatable_Seperate(master_account_help_dg, "master_account_help_dg");
                        if (master_account_help_dg.CurrentRow != null)
                        {
                            common_account_head(master_account_help_dg.CurrentRow.Cells[2].Value.ToString());
                            lbl_master_master_account_name.Text = ConnectionWithAccess.macc_desc;
                        }
                        else
                        {
                            ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where a_n like '" + tbA_N.Text + "%' and [city] like '" + tbDesc.Text + "%'";
                            ConnectionCommand.accountHelp_datatable_Seperate(master_account_help_dg, "master_account_help_dg");
                            if (master_account_help_dg.CurrentRow == null)
                            {
                                master_account_help_dg.Visible = false;
                                tbS_A.Text = "@@@";
                                tbd_y.Text = "@@@";
                            }
                        }
                    }
                    else
                    {
                        temp_a_n = tbA_N.Text;
                        temp_s_a = tbS_A.Text;
                    }
                }
            }
            else
            {
                ConnectionWithAccess.query = "select [desc], city, a_n, s_a from " + ConnectionWithAccess.tablename[01] + " where a_n like '" + tbA_N.Text + "%' and s_a <> '@@@' and [desc] like '%" + tbDesc.Text + "%'";
                ConnectionCommand.accountHelp_datatable_Seperate(master_account_help_dg, "master_account_help_dg");
                if (master_account_help_dg.CurrentRow != null)
                {
                    common_account_head(master_account_help_dg.CurrentRow.Cells[2].Value.ToString());
                    lbl_master_master_account_name.Text = ConnectionWithAccess.macc_desc;
                }
                else
                {
                    MessageBox.Show("Account Cannot be saved with Unknown Parent Account");
                    lbl_master_master_account_name.Text = null;
                }
            }
        }

        private void tbdelivery_KeyUp(object sender, KeyEventArgs e)
        {
            if (!cb_change_master_account_name.Checked)
            {
                master_account_help_dg.Visible = true;
                Bank_Details.Visible = false;
            }
            tbDesc.Enabled = false;
            tbCity.Enabled = false;
            lbl_master_master_account_name.Visible = true;
            if (cbParent.SelectedItem != null)
            {
                    if (!cb_change_master_account_name.Checked)
                    {
                        ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + tbA_N.Text + "' and s_a = '" + tbS_A.Text + "' and d_y <> '@@@' and [desc] like '" + tbdelivery.Text + "%' order by d_y";
                        ConnectionCommand.accountHelp_datatable_Seperate(master_account_help_dg, "master_account_help_dg");
                        if (master_account_help_dg.CurrentRow != null)
                        {
                            common_account_head(master_account_help_dg.CurrentRow.Cells[2].Value.ToString());
                            lbl_master_master_account_name.Text = ConnectionWithAccess.macc_desc;
                        }
                        else
                            master_account_help_dg.Visible = false;
                    }
                    else
                    {
                        temp_a_n = tbA_N.Text;
                        temp_s_a = tbS_A.Text;
                    }
            }
        }

        private void tbStd_KeyUp(object sender, KeyEventArgs e)
        {
            if (dtStdCodes.Rows.Count == 0)
                load_std_code_in_datatable();
            dgvStdCodeHelp.DataSource = null;

            DataTable dtFilter = dtStdCodes.Clone();
            dtStdCodes.Select("STD_CODE like '" + tbStd.Text.Trim() + "%' ").CopyToDataTable(dtFilter, LoadOption.OverwriteChanges);

            dgvStdCodeHelp.DataSource = dtFilter;
            dgvStdCodeHelp.Columns[0].Visible = false;
            dgvStdCodeHelp.Columns[1].Width = 120;
            dgvStdCodeHelp.Columns[2].Width = 120;
            dgvStdCodeHelp.Columns[3].Width = 120;
            dgvStdCodeHelp.Visible = true;
        }

        private void sideliverycode_KeyUp(object sender, KeyEventArgs e)
        {
            siitemlist.Enabled = false;
            sipartycode.Enabled = false;
            si_party_help.Visible = true;
            ConnectionWithAccess.data_entry_working = "Sale Party Delivery";
            //ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + Convert.ToInt32(sidbc.Text) + " and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = " + Convert.ToInt32(sidbc.Text) + " and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='' or d_y = '@@@') and [desc] like '%" + sideliverycode.Text + "%'";
            ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = '" + sia_n.Text + "' and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = '"+ sia_n.Text + "' and s_a <> '@@@' and d_y <> '@@@' and [desc] like '%" + sideliverycode.Text + "%'";
            ConnectionCommand.accountHelp_datatable(si_party_help, "si_party_help");
            if (si_party_help.Rows.Count == 1)
            {
                sipartycode.Text = sipartycode.Text.Substring(0, sipartycode.Text.Length - 1);
                sipartycode.SelectionStart = sipartycode.Text.Length;
            }
        }

        private void btn_si_cash_received_Click(object sender, EventArgs e)
        {

        }

        private void simple_docno_KeyUp(object sender, KeyEventArgs e)
        {
            oldsaleinvoicedetails();
            sale_invoice_item_filling();
            sicity.Enabled = false;
            set_invoice_date(21, simple_docno.Text, 1);
        }

        private void simple_partyname_KeyUp(object sender, KeyEventArgs e)
        {
            ConnectionWithAccess.data_entry_working = "Simple Sale Party";
            //if (!bsiPartyChangeIgnore && si_party_help.Visible == true)
            //{
                ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y,'' from " + ConnectionWithAccess.tablename[01] + " where a_n = '2002' and s_a <> '@@@' and (d_y is null or d_y ='' or d_y = '@@@') and [desc] like '%" + simple_partyname.Text + "%'";
                ConnectionCommand.accountHelp_datatable(simple_party_help, "si_party_help");
                if (simple_party_help.Rows.Count == 1)
                {
                    ConnectionWithAccess.query = "select [desc], city, a_n, s_a,d_y,(select [desc] from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = 1 and d_n = 999999) and s_a ='@@@')  from " + ConnectionWithAccess.tablename[01] + " where a_n = (select distinct a_n from " + ConnectionWithAccess.tablename[21] + " where d_c = 1 and d_n = 999999) and s_a <> '@@@' and (d_y is null or d_y ='' or d_y = '@@@') and [city] like '%" + simple_partyname.Text + "%'";
                    ConnectionCommand.accountHelp_datatable(simple_party_help, "si_party_help");
                    if (simple_party_help.Rows.Count == 1)
                    {
                        simple_partyname.Text = simple_partyname.Text.Substring(0, simple_partyname.Text.Length - 1);
                        simple_partyname.SelectionStart = simple_partyname.Text.Length;
                    }
                }
                else
                    simple_party_help.Visible = true;
            //}
        }

        private void simple_party_help_DoubleClick(object sender, EventArgs e)
        {
            rowIndex = simple_party_help.CurrentCell.RowIndex;
            simple_partyname.Text = Convert.ToString(simple_party_help.Rows[rowIndex].Cells[0].Value);
            simple_partycity.Text = Convert.ToString(simple_party_help.Rows[rowIndex].Cells[1].Value);
            simple_s_a.Text = simple_party_help.Rows[rowIndex].Cells[3].Value.ToString();
            simple_party_help.Visible = false;
            simple_itemsalelist.Visible = true;
        }

        private void simple_item_help_DoubleClick(object sender, EventArgs e)
        {
            rowIndex = simple_itemsalelist.CurrentCell.RowIndex;
            mtype = Convert.ToString(simple_item_help.CurrentRow.Cells[0].Value);
            mitem_code = Convert.ToString(simple_item_help.CurrentRow.Cells[1].Value);
            get_item_details_from_05_using_type_item_code(mtype, mitem_code);
            ConnectionWithAccess.query = "select [type], item_code, [title],price,igst_per,hsn_code from " + ConnectionWithAccess.tablename[03] + " where a_n = '" + simple_a_n.Text + "' and s_a = '" + simple_s_a.Text + "' and [type] = '" + mtype + "' and item_code = '" + mitem_code + "'";
            DataTable dtData1 = ConnectionCommand.fGetDataTable();
            if (dtData1 != null && dtData1.Rows.Count > 0)
            {
                if (dtData1.Rows[0][0] != null)
                {
                    simple_itemsalelist.Rows[rowIndex].Cells[0].Value = dtData1.Rows[0][0].ToString();
                    simple_itemsalelist.Rows[rowIndex].Cells[1].Value = dtData1.Rows[0][1].ToString();
                    simple_itemsalelist.Rows[rowIndex].Cells[6].Value = dtData1.Rows[0][3].ToString();
                    //if (dtData1.Rows[0][4].ToString() != "")
                    //    simple_salelist.Rows[rowIndex].Cells[7].Value = dtData1.Rows[0][4].ToString();
                    //if (dtData1.Rows[0][5].ToString() != "")
                    //    simple_salelist.Rows[rowIndex].Cells[8].Value = dtData1.Rows[0][5].ToString();
                }
            }
            else
            {
                simple_itemsalelist.Rows[rowIndex].Cells[0].Value = item_details_from_05[0];
                simple_itemsalelist.Rows[rowIndex].Cells[1].Value = item_details_from_05[1];
                simple_itemsalelist.Rows[rowIndex].Cells[6].Value = item_details_from_05[5];
            }
            simple_itemsalelist.Rows[rowIndex].Cells[2].Value = item_details_from_05[2];
            mtitle = Convert.ToString(simple_itemsalelist.Rows[rowIndex].Cells[2].Value);
            mcase = 1;
            mbox = Convert.ToDouble(item_details_from_05[3]);
            mqty = Convert.ToDouble(item_details_from_05[4]);
            mprice = Convert.ToDouble(item_details_from_05[5]);
            simple_itemsalelist.Rows[rowIndex].Cells[3].Value = mcase;
            simple_itemsalelist.Rows[rowIndex].Cells[4].Value = mbox * mcase;
            simple_itemsalelist.Rows[rowIndex].Cells[5].Value = mbox * mcase * mqty;
            if (simple_itemsalelist.Rows[rowIndex].Cells[6].Value == null)
                simple_itemsalelist.Rows[rowIndex].Cells[6].Value = mprice;
            else
                if (simple_itemsalelist.Rows[rowIndex].Cells[6].Value == System.DBNull.Value)
                    simple_itemsalelist.Rows[rowIndex].Cells[6].Value = mprice.ToString();
            mamount = mcase * mbox * mqty * mprice;
            simple_itemsalelist.Rows[rowIndex].Cells[7].Value = Convert.ToString(mamount);
            //simple_salelist.Rows[rowIndex].Cells[8].Value = item_details_from_05[7];
            //simple_salelist.Rows[rowIndex].Cells[9].Value = item_details_from_05[8];
            //simple_salelist.Rows[rowIndex].Cells[10].Value = item_details_from_05[9];
            simple_item_help.Visible = false;
            calculate_simple_SaleItemTotal();
        }

        private void simple_itemsalelist_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
        {
            cntObject = e.Control;
            cntObject.TextChanged += textBox_TextChanged;
            //issiTxtChangedAssigned = true;
        }

        private void simple_itemsalelist_KeyUp(object sender, KeyEventArgs e)
        {
            if (simple_itemsalelist.CurrentCell != null)
            {
                //rowIndex = simple_itemsalelist.CurrentCell.RowIndex;
                ConnectionWithAccess.data_entry_working = "Simple Sale Item";
                if (Control.ModifierKeys == Keys.Down)
                {
                    mtype = Convert.ToString(simple_itemsalelist.Rows[rowIndex].Cells[0].Value);
                    mitem_code = Convert.ToString(simple_itemsalelist.Rows[rowIndex].Cells[1].Value);
                    mtitle = Convert.ToString(simple_itemsalelist.Rows[mRowIndex].Cells[2].Value);
                }
                else
                {
                    columnIndex = simple_itemsalelist.CurrentCell.ColumnIndex;
                    if (columnIndex == 7)
                    {
                        mamount = Convert.ToSingle(simple_itemsalelist.Rows[rowIndex].Cells[7].Value.ToString());
                        mbox = Convert.ToDouble(item_details_from_05[3]);
                        mqty = Convert.ToDouble(item_details_from_05[4]);
                        mprice = mamount / (mcase * mbox * mqty);
                        simple_itemsalelist.Rows[rowIndex].Cells[6].Value = mprice;
                    }
                    calculate_simple_SaleItemTotal();
                    show_images();
                }
            }
        }

        private void simple_salelist_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data..");
            objPleaseWait.Show();
            Application.DoEvents();
            PopulateSaleDetails();
            objPleaseWait.Close();
        }

        private void simple_docno_TextChanged(object sender, EventArgs e)
        {
            if (ConnectionWithAccess.company_details[31] == "1")
            {
                cb_print_Tpt_copy.Visible = true;
                cb_print_chit_copy.Visible = true;
            }
            oldsaleinvoicedetails();
            sale_invoice_item_filling();
            sicity.Enabled = false;
            set_invoice_date(21, simple_docno.Text, Convert.ToInt32(sidbc.Text));
        }

        private void sr_party_help_Click(object sender, EventArgs e)
        {
            PleaseWait objPleaseWait = new PleaseWait("Please wait Collecting Data");
            objPleaseWait.Show();
            Application.DoEvents();
            try
            {
                bsrPartyChangeIgnore = true;
                srpartycode.Text = Convert.ToString(sr_party_help.CurrentRow.Cells[0].Value);
                srcity.Text = Convert.ToString(sr_party_help.CurrentRow.Cells[1].Value);
                sra_n.Text = Convert.ToString(sr_party_help.CurrentRow.Cells[2].Value);
                srs_a.Text = Convert.ToString(sr_party_help.CurrentRow.Cells[3].Value);
                srd_y.Text = Convert.ToString(sr_party_help.CurrentRow.Cells[4].Value);
                get_account_details_from_04(sra_n.Text, srs_a.Text);
                //fill_transport(sra_n.Text, srcity.Text, srtransport);
                srtransport.Text = account_detail_from_04[30];
                populate_screen();
                show_images();
                sr_party_help.Visible = false;
                sritemlist.Enabled = true;
            }
            catch (Exception ex)
            {

            }
            finally
            {
                bsiPartyChangeIgnore = false;
            }
            objPleaseWait.Close();
            siitemlist.Enabled = true;
        }

        //private void dgvOutstanding_SelectionChanged(object sender, EventArgs e)
        //{
        //    ////if (chkBill.Checked)
        //    ////{
        //    //        DataTable dtSaleList = fGetSaleDetails("S", dgvOutstanding.Rows[row_pointer].Cells["prd"].Value.ToString(), Convert.ToInt32(dgvOutstanding.Rows[row_pointer].Cells[d_c].Value.ToString()), dgvOutstanding.Rows[row_pointer].Cells[a_n].Value.ToString(), dgvOutstanding.Rows[row_pointer].Cells[s_a].Value.ToString(), dgvOutstanding.Rows[row_pointer].Cells["d_n].Value.ToString());

        //    ////    DataTable dtSaleList = fGetSaleDetails("S", dgvOutstanding.Rows[row_pointer].Cells["prd"].Value.ToString(), Convert.ToInt32(dgvOutstanding.Rows[row_pointer].Cells[d_c].Value.ToString()), dgvOutstanding.Rows[row_pointer].Cells[a_n].Value.ToString(), dgvOutstanding.Rows[row_pointer].Cells[s_a].Value.ToString(), dgvOutstanding.Rows[row_pointer].Cells["d_n].Value.ToString());

        //    ////}
        //}
    }
}